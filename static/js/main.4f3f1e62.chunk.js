(this.webpackJsonpdojo=this.webpackJsonpdojo||[]).push([[0],{116:function(e){e.exports=JSON.parse('{"name":"dojo","version":"8.9.3","license":"MIT","repository":"https://github.com/andyaiken/dojo.git","homepage":"https://andyaiken.github.io/dojo/","dependencies":{"@ant-design/icons":"^4.0.6","antd":"^4.1.3","react":"^16.13.1","react-dom":"^16.13.1","react-movable":"^2.4.2","showdown":"^1.9.1"},"devDependencies":{"@types/react":"^16.9.34","@types/react-dom":"^16.9.6","@types/showdown":"^1.9.3","gh-pages":"^2.2.0","node-sass":"^4.13.1","react-scripts":"^3.4.1","tslint":"^5.20.1","tslint-react":"^3.6.0","typescript":"^3.8.3"},"scripts":{"update":"npm update && npm update --save-dev","start":"react-scripts start --display-error-details","lint":"tslint --config tslint.json --format verbose \'src/**/*.{ts,tsx}\'","predeploy":"react-scripts build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":["eslint-recommended","react-app"]},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},137:function(e,t,a){e.exports=a(256)},142:function(e,t,a){},256:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(8),i=a.n(r),o=(a(142),a(266)),c=a(274),l=a(263);const m=["tiny","small","medium","large","huge","gargantuan"],d=["aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","humanoid","monstrosity","ooze","plant","undead"],p=["trait","action","bonus","reaction","legendary","lair"];class h{static getTypicalHP(e){const t=(u.hitDieType(e.size)+1)/2+u.modifierValue(e.abilityScores.con);return Math.floor(e.hitDice*t)}static getTypicalHPString(e){const t=u.hitDieType(e.size),a=u.modifierValue(e.abilityScores.con)*e.hitDice;let s="";return a>0&&(s=" +"+a),a<0&&(s=" "+a),e.hitDice+"d"+t+s}static nudgeValue(e,t,a){let s=e,n=null;const r=t.split(".");let i;switch(r.forEach(e=>{e===r[r.length-1]?n=s[e]:s=s[e]}),t){case"challenge":i=u.nudgeChallenge(n,a);break;case"size":i=u.nudgeSize(n,a);break;default:i=(n||0)+a}i=Math.max(i,0),h.changeValue(e,t,i)}static changeValue(e,t,a){let s=e;const n=t.split(".");n.forEach(e=>{e===n[n.length-1]?s[e]=a:s=s[e]})}static clear(e){e.name="",e.size="medium",e.category="beast",e.tag="",e.alignment="",e.challenge=1,e.abilityScores.str=10,e.abilityScores.dex=10,e.abilityScores.con=10,e.abilityScores.int=10,e.abilityScores.wis=10,e.abilityScores.cha=10,e.ac=10,e.hitDice=1,e.damage.resist="",e.damage.vulnerable="",e.damage.immune="",e.savingThrows="",e.speed="",e.skills="",e.senses="",e.languages="",e.equipment="",e.traits=[],e.conditionImmunities="",e.portrait=""}static clone(e,t){return{id:u.guid(),type:"monster",name:t||e.name+" copy",size:e.size,category:e.category,tag:e.tag,alignment:e.alignment,challenge:e.challenge,abilityScores:{str:e.abilityScores.str,dex:e.abilityScores.dex,con:e.abilityScores.con,int:e.abilityScores.int,wis:e.abilityScores.wis,cha:e.abilityScores.cha},ac:e.ac,hitDice:e.hitDice,damage:{resist:e.damage.resist,vulnerable:e.damage.vulnerable,immune:e.damage.immune},savingThrows:e.savingThrows,speed:e.speed,skills:e.skills,senses:e.senses,languages:e.languages,equipment:e.equipment,traits:e.traits.map(e=>({id:u.guid(),name:e.name,usage:e.usage,type:e.type,text:e.text,uses:0})),conditionImmunities:e.conditionImmunities,portrait:e.portrait,legendaryActions:0}}static createFromJSON(e){const t=g.createMonster();t.type="monster",t.name=e.name,t.size=e.size.toLowerCase(),t.category=e.type,t.tag=e.subtype,t.alignment=e.alignment,t.challenge=u.parseChallenge(e.challenge_rating),t.ac=e.armor_class,t.speed=e.speed,t.senses=e.senses,t.languages=e.languages;const a=e.hit_dice.indexOf("d");t.hitDice=parseInt(e.hit_dice.substring(0,a),10),t.abilityScores.str=e.strength,t.abilityScores.dex=e.dexterity,t.abilityScores.con=e.constitution,t.abilityScores.int=e.intelligence,t.abilityScores.wis=e.wisdom,t.abilityScores.cha=e.charisma,t.damage.resist=e.damage_resistances,t.damage.vulnerable=e.damage_vulnerabilities,t.damage.immune=e.damage_immunities,t.conditionImmunities=e.condition_immunities;[{field:"strength_save",text:"Strength"},{field:"dexterity_save",text:"Dexterity"},{field:"constitution_save",text:"Constitution"},{field:"intelligence_save",text:"Intelligence"},{field:"wisdom_save",text:"Wisdom"},{field:"charisma_save",text:"Charisma"}].forEach(a=>{if(e[a.field]){const s=a.text+" "+e[a.field];t.savingThrows+=""===t.savingThrows?s:", "+s}});return[{field:"acrobatics",text:"Acrobatics"},{field:"animal_handling",text:"Animal handling"},{field:"arcana",text:"Arcana"},{field:"athletics",text:"Athletics"},{field:"deception",text:"Deception"},{field:"history",text:"History"},{field:"insight",text:"Insight"},{field:"intimidation",text:"Intimidation"},{field:"investigation",text:"Investigation"},{field:"medicine",text:"Medicine"},{field:"nature",text:"Nature"},{field:"perception",text:"Perception"},{field:"performance",text:"Performance"},{field:"persuasion",text:"Persuasion"},{field:"religion",text:"Religion"},{field:"sleight_of_hand",text:"Sleight of hand"},{field:"stealth",text:"Stealth"},{field:"survival",text:"Survival"}].forEach(a=>{if(e[a.field]){const s=a.text+" "+e[a.field];t.skills+=""===t.skills?s:", "+s}}),e.special_abilities&&e.special_abilities.forEach(e=>{const a=this.buildTrait(e,"trait");t.traits.push(a)}),e.actions&&e.actions.forEach(e=>{const a=this.buildTrait(e,"action");t.traits.push(a)}),e.reactions&&e.reactions.forEach(e=>{const a=this.buildTrait(e,"reaction");t.traits.push(a)}),e.legendary_actions&&e.legendary_actions.forEach(e=>{const a=this.buildTrait(e,"legendary");t.traits.push(a)}),t}static buildTrait(e,t){let a="",s="";const n=e.name.indexOf("(");if(-1===n)a=e.name;else{const t=e.name.indexOf(")");a=e.name.substring(0,n-1),s=e.name.substring(n+1,t).toLowerCase()}const r=e.desc.replace(/\u2022/g,"*");let i=t;return"Lair Actions"===a&&(i="lair"),0===r.indexOf("As a bonus action")&&(i="bonus"),{id:u.guid(),type:i,name:a,usage:s,text:r,uses:0}}static import(e,t){h.clear(t);const a=(new DOMParser).parseFromString(e,"text/html");try{t.name=a.getElementsByClassName("mon-stat-block__name")[0].innerText.trim();let e=a.getElementsByClassName("mon-stat-block__meta")[0].innerText.toLowerCase().trim();const s=e.indexOf(" ");t.size=e.substring(0,s).trim(),e=e.substring(s+1).trim();const n=e.indexOf(",");t.alignment=e.substring(n+1).trim(),e=e.substring(0,n).trim();const r=e.indexOf("("),i=e.indexOf(")");-1!==r&&-1!==i&&(t.tag=e.substring(r+1,i).trim(),e=e.substring(0,r).trim()),t.category=e}catch(s){console.error(s)}try{const e=a.getElementsByClassName("mon-stat-block__attribute");for(let a=0;a!==e.length;++a){const s=e[a],n=s.getElementsByClassName("mon-stat-block__attribute-label")[0].innerText.toLowerCase().trim(),r=s.getElementsByClassName("mon-stat-block__attribute-data-value")[0].innerText.toLowerCase().trim();switch(n){case"armor class":t.ac=Number.parseInt(r,10);break;case"hit points":const e=s.getElementsByClassName("mon-stat-block__attribute-data-extra")[0].innerText.toLowerCase().trim();t.hitDice=Number.parseInt(e.substring(1,e.indexOf("d")),10);break;case"speed":t.speed=r}}}catch(s){console.error(s)}try{const e=a.getElementsByClassName("ability-block__stat");for(let a=0;a!==e.length;++a){const s=e[a],n=s.getElementsByClassName("ability-block__heading")[0].innerText.toLowerCase().trim(),r=s.getElementsByClassName("ability-block__score")[0].innerText.toLowerCase().trim(),i=Number.parseInt(r,10);t.abilityScores[n]=i}}catch(s){console.error(s)}try{const e=a.getElementsByClassName("mon-stat-block__tidbit");for(let a=0;a!==e.length;++a){const s=e[a],n=s.getElementsByClassName("mon-stat-block__tidbit-label")[0].innerText.toLowerCase().trim(),r=s.getElementsByClassName("mon-stat-block__tidbit-data")[0].innerText.toLowerCase().trim();switch(n){case"saving throws":t.savingThrows=r;break;case"skills":t.skills=r;break;case"damage vulnerabilities":t.damage.vulnerable=r;break;case"damage resistances":t.damage.resist=r;break;case"damage immunities":t.damage.immune=r;break;case"condition immunities":t.conditionImmunities=r;break;case"senses":t.senses=r;break;case"languages":t.languages=r;break;case"challenge":const e=r.indexOf(" ");t.challenge=Number.parseInt(r.substring(0,e),10)}}}catch(s){console.error(s)}try{const e=a.getElementsByClassName("mon-stat-block__description-block");for(let a=0;a!==e.length;++a){const s=e[a];let n="trait";const r=s.getElementsByClassName("mon-stat-block__description-block-heading");if(r.length>0){switch(r[0].innerText.toLowerCase().trim()){case"actions":n="action";break;case"bonus actions":n="bonus";break;case"reactions":n="reaction";break;case"legendary actions":n="legendary";break;case"lair actions":n="lair"}}const i=s.getElementsByTagName("p");for(let e=0;e!==i.length;++e){let a=i[e].innerText.trim();const s=g.createTrait();s.type=n;const r=a.indexOf(".");s.text=a.substring(r+1).trim(),a=a.substring(0,r);const o=a.indexOf("("),c=a.indexOf(")");if(-1!==o&&-1!==c&&(s.usage=a.substring(o+1,c).trim(),a=a.substring(0,o).trim()),s.name=a,s.name)t.traits.push(s);else{const e=t.traits[t.traits.length-1];e.text+="\n",e.text+=s.text}}}}catch(s){console.error(s)}}static copyTrait(e,t){const a=JSON.parse(JSON.stringify(t));a.id=u.guid(),e.traits.push(a)}static addTrait(e,t){const a=g.createTrait();a.type=t,a.name="New "+u.traitType(t,!1).toLowerCase(),e.traits.push(a)}static moveTrait(e,t,a){const s=e.traits.splice(t,1);e.traits.splice(a,0,...s)}static removeTrait(e,t){const a=e.traits.indexOf(t);e.traits.splice(a,1)}static swapTraits(e,t,a){const s=e.traits.indexOf(t),n=e.traits.indexOf(a);e.traits[n]=t,e.traits[s]=a}static spliceMonsters(e,t){["size","category","tag","alignment","challenge","speed","senses","languages","equipment","abilityScores.str","abilityScores.dex","abilityScores.con","abilityScores.int","abilityScores.wis","abilityScores.cha","savingThrows","skills","ac","hitDice","damage.resist","damage.vulnerable","damage.immune","conditionImmunities"].forEach(a=>{this.setRandomValue(e,a,t)}),e.traits=[],p.forEach(a=>{const s=[];t.forEach(e=>{e.traits.filter(e=>e.type===a).forEach(e=>s.push(e))});const n=[];s.forEach(e=>{const t=n.find(t=>t.trait.name===e.name);t?t.count+=1:n.push({trait:e,count:1})});const r=[];n.filter(e=>e.count===t.length).forEach(t=>{this.copyTrait(e,t.trait),r.push(t.trait.id)}),r.forEach(e=>{const t=n.findIndex(t=>t.trait.id===e);n.splice(t,1)});const i=s.length/t.length;for(;e.traits.filter(e=>e.type===a).length<i;){const t=Math.floor(Math.random()*n.length),a=n[t].trait;this.copyTrait(e,a),n.splice(t,1)}})}static setRandomValue(e,t,a){let s=a[Math.floor(Math.random()*a.length)],n=null;const r=t.split(".");r.forEach(e=>{e===r[r.length-1]?n=s[e]:s=s[e]}),this.changeValue(e,t,n)}static addRandomTrait(e,t,a){const s=[];a.forEach(e=>{e.traits.filter(e=>e.type===t).forEach(e=>{s.push(e)})});const n=Math.floor(Math.random()*s.length),r=s[n];this.copyTrait(e,r)}}class u{static getMonsterGroup(e,t){let a=this.monsterIdToGroup[e.id];if(!a){const s=t.find(t=>t.monsters.includes(e));s&&(a=s,this.monsterIdToGroup[e.id]=a)}return a}static guid(){const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}static sort(e,t=[]){0===t.length&&(t=[{field:"name",dir:"asc"}]);return e.sort((e,a)=>{let s=0;return t.forEach(t=>{0===s&&(s=((e,t,a)=>{if(void 0!==e[a]&&void 0!==t[a]){if(e[a]<t[a])return-1;if(e[a]>t[a])return 1}return 0})(e,a,t.field)*("asc"===t.dir?1:-1))}),s}),e}static debounce(e,t=500){let a;return()=>{clearTimeout(a),a=setTimeout(e,t)}}static toData(e){const t=e/1073741824;if(t>=1)return t.toFixed(2)+" GB";{const t=e/1048576;if(t>=1)return t.toFixed(2)+" MB";{const t=e/1024;if(t>=1)return t.toFixed(2)+" KB"}}return e+" B"}static saveFile(e,t){const a=JSON.stringify(t,null,"\t"),s=new Blob([a],{type:"application/json"}),n=document.createElement("a");n.download=e,n.href=window.URL.createObjectURL(s),n.click()}static modifierValue(e){return Math.floor((e-10)/2)}static modifier(e){const t=this.modifierValue(e);let a=t.toString();return t>=0&&(a="+"+a),a}static randomNumber(e){return Math.floor(Math.random()*e)}static randomBoolean(){return 0===u.randomNumber(2)}static dieRoll(e=20,t=1){let a=0;for(let s=0;s!==t;++s)a+=u.randomNumber(e)+1;return a}static miniSize(e){switch(e){case"tiny":return.4;case"small":return.6;case"medium":return 1;case"large":return 2;case"huge":return 3;case"gargantuan":return 4;default:return 1}}static hitDieType(e){switch(e){case"tiny":return 4;case"small":return 6;case"medium":return 8;case"large":return 10;case"huge":return 12;case"gargantuan":return 20;default:return 8}}static proficiency(e){return e<5?2:e<9?3:e<13?4:e<17?5:6}static challenge(e){switch(e){case.125:return"1/8";case.25:return"1/4";case.5:return"1/2";default:return e.toString()}}static parseChallenge(e){switch(e){case"1/8":return.125;case"1/4":return.25;case"1/2":return.5;default:return parseInt(e,10)}}static challengeDetails(){return[{cr:0,ac:13,hpMin:1,hpMax:6,attack:3,dmgMin:0,dmgMax:1,save:13},{cr:.125,ac:13,hpMin:7,hpMax:35,attack:3,dmgMin:2,dmgMax:3,save:13},{cr:.25,ac:13,hpMin:36,hpMax:49,attack:3,dmgMin:4,dmgMax:5,save:13},{cr:.5,ac:13,hpMin:50,hpMax:70,attack:3,dmgMin:6,dmgMax:8,save:13},{cr:1,ac:13,hpMin:71,hpMax:85,attack:3,dmgMin:9,dmgMax:14,save:13},{cr:2,ac:13,hpMin:86,hpMax:100,attack:3,dmgMin:15,dmgMax:20,save:13},{cr:3,ac:13,hpMin:101,hpMax:115,attack:4,dmgMin:21,dmgMax:26,save:13},{cr:4,ac:14,hpMin:116,hpMax:130,attack:5,dmgMin:27,dmgMax:32,save:14},{cr:5,ac:15,hpMin:131,hpMax:145,attack:6,dmgMin:33,dmgMax:38,save:15},{cr:6,ac:15,hpMin:146,hpMax:160,attack:6,dmgMin:39,dmgMax:44,save:15},{cr:7,ac:15,hpMin:161,hpMax:175,attack:6,dmgMin:45,dmgMax:50,save:15},{cr:8,ac:16,hpMin:176,hpMax:190,attack:7,dmgMin:51,dmgMax:56,save:16},{cr:9,ac:16,hpMin:191,hpMax:205,attack:7,dmgMin:57,dmgMax:62,save:16},{cr:10,ac:17,hpMin:206,hpMax:220,attack:7,dmgMin:63,dmgMax:68,save:16},{cr:11,ac:17,hpMin:221,hpMax:235,attack:8,dmgMin:69,dmgMax:74,save:17},{cr:12,ac:17,hpMin:236,hpMax:250,attack:8,dmgMin:75,dmgMax:80,save:17},{cr:13,ac:18,hpMin:251,hpMax:265,attack:8,dmgMin:81,dmgMax:86,save:18},{cr:14,ac:18,hpMin:266,hpMax:280,attack:8,dmgMin:87,dmgMax:92,save:18},{cr:15,ac:18,hpMin:281,hpMax:295,attack:8,dmgMin:93,dmgMax:98,save:18},{cr:16,ac:18,hpMin:296,hpMax:310,attack:9,dmgMin:99,dmgMax:104,save:18},{cr:17,ac:19,hpMin:311,hpMax:325,attack:10,dmgMin:105,dmgMax:110,save:19},{cr:18,ac:19,hpMin:326,hpMax:340,attack:10,dmgMin:111,dmgMax:116,save:19},{cr:19,ac:19,hpMin:341,hpMax:355,attack:10,dmgMin:117,dmgMax:122,save:19},{cr:20,ac:19,hpMin:356,hpMax:400,attack:10,dmgMin:123,dmgMax:140,save:19},{cr:21,ac:19,hpMin:401,hpMax:445,attack:11,dmgMin:141,dmgMax:158,save:20},{cr:22,ac:19,hpMin:446,hpMax:490,attack:11,dmgMin:159,dmgMax:176,save:20},{cr:23,ac:19,hpMin:491,hpMax:535,attack:11,dmgMin:177,dmgMax:194,save:20},{cr:24,ac:19,hpMin:536,hpMax:580,attack:12,dmgMin:195,dmgMax:212,save:21},{cr:25,ac:19,hpMin:581,hpMax:625,attack:12,dmgMin:213,dmgMax:230,save:21},{cr:26,ac:19,hpMin:626,hpMax:670,attack:12,dmgMin:231,dmgMax:248,save:21},{cr:27,ac:19,hpMin:671,hpMax:715,attack:13,dmgMin:249,dmgMax:266,save:22},{cr:28,ac:19,hpMin:716,hpMax:760,attack:13,dmgMin:267,dmgMax:284,save:22},{cr:29,ac:19,hpMin:761,hpMax:805,attack:13,dmgMin:285,dmgMax:302,save:22},{cr:30,ac:19,hpMin:806,hpMax:850,attack:14,dmgMin:303,dmgMax:320,save:23}]}static experience(e){switch(e){case 0:return 10;case.125:return 25;case.25:return 50;case.5:return 100;case 1:return 200;case 2:return 450;case 3:return 700;case 4:return 1100;case 5:return 1800;case 6:return 2300;case 7:return 2900;case 8:return 3900;case 9:return 5e3;case 10:return 5900;case 11:return 7200;case 12:return 8400;case 13:return 1e4;case 14:return 11500;case 15:return 13e3;case 16:return 15e3;case 17:return 18e3;case 18:return 2e4;case 19:return 22e3;case 20:return 25e3;case 21:return 33e3;case 22:return 41e3;case 23:return 5e4;case 24:return 62e3;case 30:return 155e3;default:return 0}}static experienceFactor(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 1.5;case 3:case 4:case 5:case 6:return 2;case 7:case 8:case 9:case 10:return 2.5;case 11:case 12:case 13:case 14:return 3;default:return 4}}static pcExperience(e,t){switch(t){case"easy":switch(e){case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 125;case 5:return 250;case 6:return 300;case 7:return 350;case 8:return 450;case 9:return 550;case 10:return 600;case 11:return 800;case 12:return 1e3;case 13:return 1100;case 14:return 1250;case 15:return 1400;case 16:return 1600;case 17:return 2e3;case 18:return 2100;case 19:return 2400;case 20:return 2800;default:return 0}case"medium":switch(e){case 1:return 50;case 2:return 100;case 3:return 150;case 4:return 250;case 5:return 500;case 6:return 600;case 7:return 750;case 8:return 900;case 9:return 1100;case 10:return 1200;case 11:return 1600;case 12:return 2e3;case 13:return 2200;case 14:return 2500;case 15:return 2800;case 16:return 3200;case 17:return 3900;case 18:return 4200;case 19:return 4900;case 20:return 5700;default:return 0}case"hard":switch(e){case 1:return 75;case 2:return 150;case 3:return 225;case 4:return 375;case 5:return 750;case 6:return 900;case 7:return 1100;case 8:return 1400;case 9:return 1600;case 10:return 1900;case 11:return 2400;case 12:return 3e3;case 13:return 3400;case 14:return 3800;case 15:return 4300;case 16:return 4800;case 17:return 5900;case 18:return 6300;case 19:return 7300;case 20:return 8500;default:return 0}case"deadly":switch(e){case 1:return 100;case 2:return 200;case 3:return 400;case 4:return 500;case 5:return 1100;case 6:return 1400;case 7:return 1700;case 8:return 2100;case 9:return 2400;case 10:return 2800;case 11:return 3600;case 12:return 4500;case 13:return 5100;case 14:return 5700;case 15:return 6400;case 16:return 7200;case 17:return 8800;case 18:return 9500;case 19:return 10900;case 20:return 12700;default:return 0}default:return 0}}static traitType(e,t){let a="";switch(e){case"trait":a="trait";break;case"action":a="action";break;case"bonus":a="bonus action";break;case"reaction":a="reaction";break;case"legendary":a="legendary action";break;case"lair":a="lair action"}return t&&(a+="s"),a}static nudgeChallenge(e,t){let a=0;switch(e){case 0:-1===t&&(a=0),1===t&&(a=.125);break;case.125:-1===t&&(a=0),1===t&&(a=.25);break;case.25:-1===t&&(a=.125),1===t&&(a=.5);break;case.5:-1===t&&(a=.25),1===t&&(a=1);break;case 1:-1===t&&(a=.5),1===t&&(a=2);break;default:a=e+t}return a}static nudgeSize(e,t){const a=["tiny","small","medium","large","huge","gargantuan"];let s=a.indexOf(e)+t;return s<0&&(s=0),s>=a.length&&(s=a.length-1),a[s]}static conditionText(e){switch(e.name){case"blinded":return["a blinded creature can\u2019t see and automatically fails any ability check that requires sight","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage"];case"charmed":return["a charmed creature can\u2019t attack the charmer or target the charmer with harmful abilities or magical effects","the charmer has advantage on any ability check to interact socially with the creature"];case"deafened":return["a deafened creature can\u2019t hear and automatically fails any ability check that requires hearing."];case"exhaustion":switch(e.level){case 1:return["disadvantage on ability checks"];case 2:return["disadvantage on ability checks","speed halved"];case 3:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws"];case 4:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved"];case 5:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0"];case 6:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0","death"];default:return[]}case"frightened":return["a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight","the creature can\u2019t willingly move closer to the source of its fear"];case"grappled":return["a grappled creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","the condition ends if the grappler is incapacitated","the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect"];case"incapacitated":return["an incapacitated creature can\u2019t take actions or reactions","being incapacitated breaks concentration"];case"invisible":return["an invisible creature is impossible to see without the aid of magic or a special sense","for the purpose of hiding, the creature is heavily obscured","the creature\u2019s location can be detected by any noise it makes or any tracks it leaves","attack rolls against the creature have disadvantage, and the creature\u2019s attack rolls have advantage"];case"paralyzed":return["a paralyzed creature is incapacitated (can\u2019t take actions or reactions) and can\u2019t move or speak","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"petrified":return["a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)","its weight increases by a factor of ten, and it ceases aging","the creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","attack rolls against the creature have advantage","the creature automatically fails strength and dexterity saving throws","the creature has resistance to all damage","the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized"];case"poisoned":return["a poisoned creature has disadvantage on attack rolls and ability checks"];case"prone":return["a prone creature\u2019s only movement option is to crawl, unless it stands up (using half its speed) and thereby ends the condition","the creature has disadvantage on attack rolls","an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage"];case"restrained":return["a restrained creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage","the creature has disadvantage on dexterity saving throws"];case"stunned":return["a stunned creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move, and can speak only falteringly","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage"];case"unconscious":return["an unconscious creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","the creature drops whatever its holding and falls prone","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];default:return[]}}static conditionDurationText(e,t){if(null!==e.duration)switch(e.duration.type){case"saves":const a=e.duration;let s=a.saveType.toString();"death"!==s&&(s=s.toUpperCase());const n=a.count>1?"saves":"save";return"until you make "+a.count+" "+s+" "+n+" at dc "+a.saveDC;case"combatant":const r=e.duration,i=r.point,o=t.combatants.find(e=>e.id===r.combatantID);return"until the "+i+" of "+(o?(o.displayName||o.name||"unnamed monster")+"'s":"their")+" next turn";case"rounds":const c=e.duration,l=c.count>1?"rounds":"round";return"for "+c.count+" "+l;default:return null}return null}static getCombatSlotData(e,t){const a=[];return e&&e.slots.forEach(e=>{const s=t.find(t=>t.name===e.monsterGroupName);if(s){const t=s.monsters.find(t=>t.name===e.monsterName);if(t){const s=g.createCombatSlotInfo();s.id=e.id,s.init=u.dieRoll()+u.modifierValue(t.abilityScores.dex),s.hp=h.getTypicalHP(t);for(let t=0;t!==e.count;++t){const t=g.createCombatSlotMember();t.init=s.init,t.hp=s.hp,t.name=e.monsterName,s.members.push(t)}if(e.count>1)for(let t=0;t!==e.count;++t)s.members[t].name=e.monsterName+" "+(t+1);a.push(s)}}}),a}static getTagTitle(e){if(e.startsWith("engaged"))return"engaged";switch(e){case"conc":return"concentrating";case"bane":return"affected by bane";case"bless":return"affected by bless";default:return e}}static getTagDescription(e){if(e.startsWith("engaged")){return e.split(":")[1]}switch(e){case"conc":return"if damaged, must make con save (dc is half damage taken or 10, whichever is higher) or lose concentration";case"bane":return"subtract d4 from attack rolls and saving throws";case"bless":return"add d4 to attack rolls and saving throws";default:return e}}}u.monsterIdToGroup={};class g{static createParty(){return{id:u.guid(),name:"",pcs:[]}}static createPC(){return{id:u.guid(),type:"pc",active:!0,player:"",name:"",size:"medium",race:"",classes:"",level:1,languages:"Common",passiveInsight:10,passiveInvestigation:10,passivePerception:10,portrait:"",url:"",companions:[]}}static createCompanion(){return{id:u.guid(),name:""}}static createMonsterGroup(){return{id:u.guid(),name:"",monsters:[]}}static createMonster(){return{id:u.guid(),type:"monster",name:"",size:"medium",category:"humanoid",tag:"",alignment:"",challenge:1,abilityScores:{str:10,dex:10,con:10,int:10,wis:10,cha:10},ac:10,hitDice:1,damage:{resist:"",vulnerable:"",immune:""},savingThrows:"",speed:"",skills:"",senses:"",languages:"",equipment:"",traits:[],conditionImmunities:"",portrait:"",legendaryActions:0}}static createTrait(){return{id:u.guid(),name:"",usage:"",type:"action",text:"",uses:0}}static createEncounter(){return{id:u.guid(),name:"",slots:[],waves:[]}}static createEncounterSlot(){return{id:u.guid(),monsterGroupName:"",monsterName:"",count:1}}static createEncounterWave(){return{id:u.guid(),name:"",slots:[]}}static createMonsterFilter(){return{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}}static createMap(){return{id:u.guid(),name:"",items:[],notes:[]}}static createMapItem(){return{id:u.guid(),type:"tile",x:0,y:0,width:4,height:4,terrain:"",customBackground:"",content:null,size:"medium",color:"",opacity:255,style:null}}static createMapNote(){return{id:u.guid(),targetID:"",text:""}}static createCombatSetup(){return{party:null,encounter:null,waveID:null,map:null,slotInfo:[]}}static createCombatSlotInfo(){return{id:"",useGroupHP:!0,useGroupInit:!0,hp:0,init:0,members:[]}}static createCombatSlotMember(){return{id:u.guid(),name:"",hp:0,init:0}}static createCombat(){return{id:u.guid(),name:"",encounter:g.createEncounter(),combatants:[],map:null,round:1,notifications:[],issues:[],report:[]}}static createNotification(){return{id:u.guid(),type:"condition-save",data:null,combatant:null}}static createCombatReportEntry(){return{id:u.guid(),type:"combat-start",timestamp:Date.now(),combatantID:"",value:0}}static createCondition(){return{id:u.guid(),name:"",level:1,text:"",duration:null}}static createConditionDurationSaves(){return{type:"saves",count:1,saveType:"str",saveDC:10,point:"start"}}static createConditionDurationCombatant(){return{type:"combatant",point:"start",combatantID:null}}static createConditionDurationRounds(){return{type:"rounds",count:1}}}const b=["default","cavern","dirt","flagstone","floorboard","grassland","pit","sand","snow","water","custom"],E=["single","double","arch","bars"],v=["stairs","spiral","ladder"];class y{static scatterCombatants(e,t){if(!e.map)return;if(e.map.items=e.map.items.filter(e=>e.type!==t),e.map.items.filter(e=>"tile"===e.type).length>0){const a=y.mapDimensions(e.map);if(a){e.combatants.filter(e=>e.type===t).forEach(s=>{const n=[];for(let t=a.minX;t<=a.maxX;++t)for(let r=a.minY;r<=a.maxY;++r){y.canAddMonsterHere(e.map,s,t,r)&&n.push({x:t,y:r})}if(n.length>0&&e.map){const a=n[Math.floor(Math.random()*n.length)],r=u.miniSize(s.displaySize),i=g.createMapItem();i.id=s.id,i.type=t,i.x=a.x,i.y=a.y,i.height=r,i.width=r,e.map.items.push(i)}})}}}static mapDimensions(e){const t=e.items.filter(e=>"tile"===e.type);if(t.length>0){let e=t[0].x,a=t[0].y,s=t[0].x+t[0].width-1,n=t[0].y+t[0].height-1;return t.forEach(t=>{e=Math.min(e,t.x),a=Math.min(a,t.y),s=Math.max(s,t.x+t.width-1),n=Math.max(n,t.y+t.height-1)}),{minX:e,minY:a,maxX:s,maxY:n}}return null}static canAddTileHere(e,t,a,s,n,r){const i=[],o=a-n,c=s-r,l=a+(t.width-1)+n,m=s+(t.height-1)+r;for(let d=o;d<=l;++d)for(let t=c;t<=m;++t){const a=y.itemsAt(e,d,t).every(e=>"tile"!==e.type);i.push(a)}return i.every(e=>e)}static canAddMonsterHere(e,t,a,s){const n=[],r=u.miniSize(t.displaySize),i=a+Math.max(1,r)-1,o=s+Math.max(1,r)-1;for(let c=a;c<=i;++c)for(let t=s;t<=o;++t){const a=y.itemsAt(e,c,t),s=a.length>0&&a.every(e=>"tile"===e.type);n.push(s)}return n.every(e=>e)}static itemsAt(e,t,a){return e.items.filter(e=>{const s=e.x,n=e.x+e.width-1,r=e.y,i=e.y+e.height-1;return t>=s&&t<=n&&a>=r&&a<=i})}static rotateMap(e){e.items.forEach(e=>{const t=-1*(e.y+e.height-1),a=e.x,s=e.height,n=e.width;e.x=t,e.y=a,e.width=s,e.height=n,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal")})}static mapSize(e){return e.items.filter(e=>"tile"===e.type).reduce((e,t)=>e+y.mapTileSize(t),0)}static mapTileSize(e){return"tile"===e.type?e.width*e.height:0}static getNote(e,t){return e.notes.find(e=>e.targetID===t.id)||null}static generate(e,t){switch(e){case"dungeon":let e=0;for(;e<10;)y.addRoom(t)&&(e+=1);break;case"delve":let a=0;for(;a<3;)y.addRoom(t)&&(a+=1);break;case"room":let s=!1;for(;!s;)s=y.addRoom(t)}}static addRoom(e){const t=g.createMapItem();t.type="tile",t.terrain="default",t.style="square",t.width=u.dieRoll(4,2)+2,t.height=u.dieRoll(4,2)+2;const a=y.mapDimensions(e);if(a){const s=1,n=2;a.minX-=t.width+n,a.minY-=t.height+n,a.maxX+=n,a.maxY+=n;const r=[];for(let o=a.minX;o!==a.maxX;++o)for(let n=a.minY;n!==a.maxY;++n){y.canAddTileHere(e,t,o,n,s,s)&&r.push({x:o,y:n})}if(!(r.length>0))return!1;{const e=Math.floor(Math.random()*r.length);t.x=r[e].x,t.y=r[e].y}const i=[];if(e.items.filter(e=>"tile"===e.type).forEach(a=>{const s=Math.max(t.x,a.x),n=Math.min(t.x+t.width-1,a.x+a.width-1);if(n-s+1>=2){const r=Math.min(t.y+t.height-1,a.y+a.height-1)+1,o=Math.max(t.y,a.y)-1;for(let t=s;t<=n-1;++t){const a=g.createMapItem();a.type="tile",a.terrain="default",a.style="square",a.x=t,a.y=r,a.width=2,a.height=o-r+1,y.canAddTileHere(e,a,a.x,a.y,1,0)&&i.push({tile:a,horizontal:!1})}}const r=Math.max(t.y,a.y),o=Math.min(t.y+t.height-1,a.y+a.height-1);if(o-r+1>=2){const s=Math.min(t.x+t.width-1,a.x+a.width-1)+1,n=Math.max(t.x,a.x)-1;for(let t=r;t<=o-1;++t){const a=g.createMapItem();a.type="tile",a.terrain="default",a.style="square",a.x=s,a.y=t,a.width=n-s+1,a.height=2,y.canAddTileHere(e,a,a.x,a.y,0,1)&&i.push({tile:a,horizontal:!0})}}}),!(i.length>0))return!1;{const a=Math.floor(Math.random()*i.length),s=i[a];if(!s.horizontal&&1===s.tile.height||s.horizontal&&1===s.tile.width)2===u.dieRoll(2)&&(s.tile.content={type:"doorway",style:y.getRandomDoorwayStyle(),orientation:s.horizontal?"vertical":"horizontal"});else{if(!s.horizontal&&s.tile.height>=4||s.horizontal&&s.tile.width>=4){if(2===u.dieRoll(2)){const t=g.createMapItem();t.type="tile",t.terrain="default",t.style="square",t.content={type:"doorway",style:y.getRandomDoorwayStyle(),orientation:""},s.horizontal?(t.x=s.tile.x,t.y=s.tile.y,t.width=1,t.height=2,t.content.orientation="vertical",s.tile.x+=1,s.tile.width-=1):(t.x=s.tile.x,t.y=s.tile.y,t.width=2,t.height=1,t.content.orientation="horizontal",s.tile.y+=1,s.tile.height-=1),e.items.push(t)}if(2===u.dieRoll(2)){const t=g.createMapItem();t.type="tile",t.terrain="default",t.style="square",t.content={type:"doorway",style:y.getRandomDoorwayStyle(),orientation:""},s.horizontal?(t.x=s.tile.x+s.tile.width-1,t.y=s.tile.y,t.width=1,t.height=2,t.content.orientation="vertical",s.tile.width-=1):(t.x=s.tile.x,t.y=s.tile.y+s.tile.height-1,t.width=2,t.height=1,t.content.orientation="horizontal",s.tile.height-=1),e.items.push(t)}}(!s.horizontal&&s.tile.height<=4||s.horizontal&&s.tile.width<=4)&&3===u.dieRoll(3)&&(s.tile.content={type:"stairway",style:"stairs",orientation:s.horizontal?"vertical":"horizontal"})}e.items.push(s.tile),e.items.push(t)}}else e.items.push(t);return!0}static getRandomDoorwayStyle(){const e=Math.floor(Math.random()*E.length);return E[e]}}class f{static matchParty(e,t){return!!f.match(e,t.name)||t.pcs.some(t=>f.matchPC(e,t))}static matchPC(e,t){return!!f.match(e,t.name)||(!!f.match(e,t.player)||(!!f.match(e,t.race)||(!!f.match(e,t.classes)||t.companions.some(t=>f.matchCompanion(e,t)))))}static matchCompanion(e,t){return!!f.match(e,t.name)}static matchGroup(e,t){return!!f.match(e,t.name)||t.monsters.some(t=>f.matchMonster(e,t))}static matchMonster(e,t){return!!f.match(e,t.name)||(!!f.match(e,t.category)||(!!f.match(e,t.tag)||(!!f.match(e,t.senses)||(!!f.match(e,t.languages)||(!!f.match(e,t.equipment)||t.traits.some(t=>f.matchTrait(e,t)))))))}static matchTrait(e,t){return!!f.match(e,t.name)||(!!f.match(e,t.usage)||!!f.match(e,t.text))}static matchEncounter(e,t){return!!f.match(e,t.name)||(!!t.waves.some(t=>f.matchEncounterWave(e,t))||t.slots.some(t=>f.matchEncounterSlot(e,t)))}static matchEncounterWave(e,t){return!!f.match(e,t.name)||t.slots.some(t=>f.matchEncounterSlot(e,t))}static matchEncounterSlot(e,t){return!!f.match(e,t.monsterName)}static matchMap(e,t){return!!f.match(e,t.name)||t.notes.some(t=>f.matchMapNote(e,t))}static matchMapNote(e,t){return!!f.match(e,t.text)}static match(e,t){if(!e)return!0;let a=!0;return e.toLowerCase().split(" ").forEach(e=>{-1===t.toLowerCase().indexOf(e)&&(a=!1)}),a}}class N{static getMonsterCount(e){let t=0,a=[];return a=a.concat(e.slots),e.waves.forEach(e=>{a=a.concat(e.slots)}),a.forEach(e=>{t+=e.count}),t}static getEncounterXP(e,t){let a=0,s=[];return s=s.concat(e.slots),e.waves.forEach(e=>{s=s.concat(e.slots)}),s.forEach(e=>{const s=t(e.monsterName,e.monsterGroupName);s&&(a+=u.experience(s.challenge)*e.count)}),a}static getAdjustedEncounterXP(e,t){let a=0,s=0,n=[];return n=n.concat(e.slots),e.waves.forEach(e=>{n=n.concat(e.slots)}),n.forEach(e=>{a+=e.count;const n=t(e.monsterName,e.monsterGroupName);n&&(s+=u.experience(n.challenge)*e.count)}),s*u.experienceFactor(a)}static getCombatXP(e){let t=0;return e.combatants.filter(e=>"monster"===e.type).forEach(e=>{const a=e;t+=u.experience(a.challenge)}),t}static getFilterDescription(e){let t="";"all sizes"!==e.size&&(t+=t?" "+e.size:e.size),"all types"!==e.category&&(t+=t?" "+e.category:e.category);const a=u.challenge(e.challengeMin),s=u.challenge(e.challengeMax);return t+=" monsters of cr "+(e.challengeMin===e.challengeMax?a:a+" to "+s),t}static buildEncounter(e,t,a,s,n){for(;N.getAdjustedEncounterXP(e,(e,t)=>n(e,t))<=t;)if(e.slots.length>0&&u.dieRoll(3)>1){const t=Math.floor(Math.random()*e.slots.length);e.slots[t].count+=1}else{const t=[];if(s.forEach(s=>{s.monsters.filter(e=>N.matchMonster(e,a)).filter(t=>!e.slots.find(e=>e.monsterGroupName===s.name&&e.monsterName===t.name)).forEach(e=>t.push({groupName:s.name,monsterName:e.name}))}),t.length>0){const a=Math.floor(Math.random()*t.length),s=g.createEncounterSlot();s.monsterGroupName=t[a].groupName,s.monsterName=t[a].monsterName,e.slots.push(s)}else if(0===e.slots.length)break}for(;e.slots.length>1&&10===u.dieRoll(10);){const t=Math.floor(Math.random()*e.slots.length),a=e.slots[t];e.slots=e.slots.filter(e=>e.id!==a.id);const s=g.createEncounterWave();s.name="wave "+(e.waves.length+2),s.slots.push(a),e.waves.push(s)}}static matchMonster(e,t){return!(e.challenge<t.challengeMin)&&(!(e.challenge>t.challengeMax)&&(!(""!==t.name&&!f.match(t.name,e.name))&&(("all types"===t.category||e.category===t.category)&&("all sizes"===t.size||e.size===t.size))))}static sortCombatants(e){e.combatants.sort((e,t)=>e.initiative&&t.initiative&&e.initiative<t.initiative?1:e.initiative&&t.initiative&&e.initiative>t.initiative||e.displayName<t.displayName?-1:e.displayName>t.displayName?1:0)}static combatHasLairActions(e){let t=!1;return e.combatants.filter(e=>!e.pending&&e.active&&!e.defeated).forEach(e=>{const a=e;a&&a.traits&&a.traits.some(e=>"lair"===e.type)&&(t=!0)}),t}static addPCToCombat(e,t){const a=JSON.parse(JSON.stringify(t));a.current=!1,a.pending=!0,a.active=!1,a.defeated=!1,a.displayName=t.name,a.displaySize=t.size,a.showOnMap=!0,a.initiative=10,a.hpMax=null,a.hpCurrent=null,a.hpTemp=null,a.conditions=[],a.tags=[],a.note="",a.altitude=0,a.aura={radius:0,style:"rounded",color:"#005080"},e.combatants.push(a)}static addMonsterToCombat(e,t,a,s,n){const r=JSON.parse(JSON.stringify(t));r.id=u.guid(),r.current=!1,r.pending=!1,r.active=!0,r.defeated=!1,r.displayName=n,r.displaySize=t.size,r.showOnMap=!0,r.initiative=a,r.hpMax=s,r.hpCurrent=s,r.hpTemp=0,r.conditions=[],r.tags=[],r.note="",r.altitude=0,r.aura={radius:0,style:"rounded",color:"#005080"},e.combatants.push(r)}static addCompanionToCombat(e,t){const a={id:t?t.id:u.guid(),type:"companion",current:!1,pending:!0,active:!1,defeated:!1,displayName:t?t.name:"companion",displaySize:"medium",showOnMap:!0,initiative:10,hpMax:null,hpCurrent:null,hpTemp:null,conditions:[],tags:[],note:"",altitude:0,aura:{radius:0,style:"rounded",color:"#005080"}};e.combatants.push(a)}static addPlaceholderToCombat(e){const t={id:u.guid(),type:"placeholder",current:!1,pending:!1,active:!0,defeated:!1,displayName:"lair actions",displaySize:"medium",showOnMap:!0,initiative:20,hpMax:null,hpCurrent:null,hpTemp:null,conditions:[],tags:[],note:"",altitude:0,aura:{radius:0,style:"rounded",color:"#005080"}};e.combatants.push(t)}}class k extends n.a.Component{click(e){e.stopPropagation(),this.props.changeValue(!this.props.checked)}render(){try{let e="checkbox "+this.props.display;this.props.checked&&(e+=" checked"),this.props.disabled&&(e+=" disabled");let t=null;return"switch"===this.props.display&&(t=n.a.createElement("div",{className:"toggle-container"},n.a.createElement("div",{className:"toggle"}))),n.a.createElement("div",{className:e,onClick:e=>this.click(e)},n.a.createElement("div",{className:"checkbox-label"},this.props.label),t)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}k.defaultProps={display:"switch",disabled:!1};class w extends n.a.Component{constructor(e){super(e),this.state={pressed:!1}}toggle(e){e.stopPropagation(),this.setState({pressed:!this.state.pressed})}perform(){this.setState({pressed:!1},()=>{this.props.callback()})}render(){try{let e=null;return this.state.pressed&&(e=n.a.createElement("div",{className:"confirm",onClick:()=>this.perform()},"confirm")),n.a.createElement("button",{className:this.props.disabled?"danger disabled":"danger",onClick:e=>this.toggle(e)},n.a.createElement("div",null,this.props.text),e)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}w.defaultProps={disabled:!1};var x=a(116);class C extends n.a.Component{render(){try{let e=0,t=0;for(let a=0;a!==localStorage.length;++a){const s=localStorage.key(a);if(s){const a=localStorage.getItem(s);a&&(s.startsWith("data")&&(e+=a.length),s.startsWith("image")&&(t+=a.length))}}return n.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},n.a.createElement("div",{className:"section"},"designed by ",n.a.createElement("a",{href:"mailto:andy.aiken@live.co.uk"},"andy aiken")),n.a.createElement("div",{className:"section"},"version ",n.a.createElement("b",null,x.version)),n.a.createElement("div",{className:"section"},"if you would like to raise a bug or request a new feature, you can do so ",n.a.createElement("a",{href:"https://github.com/andyaiken/dojo",target:"_blank",rel:"noopener noreferrer"},"here")),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"subheading"},"open game license"),n.a.createElement("div",{className:"section"},"The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved."),n.a.createElement("ol",null,n.a.createElement("li",null,n.a.createElement("b",null,"Definitions"),": (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement."),n.a.createElement("li",null,n.a.createElement("b",null,"The License"),": This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License."),n.a.createElement("li",null,n.a.createElement("b",null,"Offer and Acceptance"),": By Using the Open Game Content You indicate Your acceptance of the terms of this License."),n.a.createElement("li",null,n.a.createElement("b",null,"Grant and Consideration"),": In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content."),n.a.createElement("li",null,n.a.createElement("b",null,"Representation of Authority to Contribute"),": If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License."),n.a.createElement("li",null,n.a.createElement("b",null,"Notice of License Copyright"),": You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute."),n.a.createElement("li",null,n.a.createElement("b",null,"Use of Product Identity"),": You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity."),n.a.createElement("li",null,n.a.createElement("b",null,"Identification"),": If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content."),n.a.createElement("li",null,n.a.createElement("b",null,"Updating the License"),": Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License."),n.a.createElement("li",null,n.a.createElement("b",null,"Copy of this License"),": You MUST include a copy of this License with every copy of the Open Game Content You Distribute."),n.a.createElement("li",null,n.a.createElement("b",null,"Use of Contributor Credits"),": You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so."),n.a.createElement("li",null,n.a.createElement("b",null,"Inability to Comply"),": If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected."),n.a.createElement("li",null,n.a.createElement("b",null,"Termination"),": This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License."),n.a.createElement("li",null,n.a.createElement("b",null,"Reformation"),": If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable."),n.a.createElement("li",null,n.a.createElement("b",null,"COPYRIGHT NOTICE")," Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.")),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"subheading"},"options"),n.a.createElement("div",{className:"section"},"this will reset the entire app and cannot be undone"),n.a.createElement("div",{className:"section"},"use it at your own risk"),n.a.createElement(w,{text:"clear all data",callback:()=>this.props.resetAll()}),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"subheading"},"data"),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"total"),n.a.createElement(c.a,{span:8,className:"statistic-value"},u.toData(e+t))),n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"data"),n.a.createElement(c.a,{span:8,className:"statistic-value"},u.toData(e))),n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"images"),n.a.createElement(c.a,{span:8,className:"statistic-value"},u.toData(t)))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var S=a(296),M=a(261),I=a(290),T=a(291),V=a(265),D=a(283),P=a(284);class A extends n.a.Component{constructor(e){super(e),this.state={open:!1}}toggleOpen(e){e.stopPropagation(),this.setState({open:!this.state.open})}select(e){this.setState({open:!1}),this.props.select(e)}clear(e){e.stopPropagation(),this.props.clear()}render(){try{if(0===this.props.options.length)return null;let e=this.props.disabled?"dropdown disabled":"dropdown";const t=[];let a;this.props.selectedID&&(a=this.props.options.find(e=>e.id===this.props.selectedID));const s=a&&this.props.clear;if(t.push(n.a.createElement("div",{key:"selection",className:"dropdown-top",title:a?a.text:this.props.placeholder},n.a.createElement("div",{className:"item-text"},a?a.text:this.props.placeholder),s?n.a.createElement(D.a,{onClick:e=>this.clear(e)}):n.a.createElement(P.a,null))),this.state.open){e+=" open";const a=this.props.options.map(e=>null===e.text?n.a.createElement("div",{key:e.id,className:"divider"}):n.a.createElement(O,{key:e.id,option:e,selected:e.id===this.props.selectedID,select:e=>this.select(e)}));t.push(n.a.createElement("div",{key:"options",className:"dropdown-options"},a))}return n.a.createElement("div",{className:e,onClick:e=>this.toggleOpen(e)},t)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}A.defaultProps={selectedID:null,placeholder:"select...",disabled:!1,clear:null};class O extends n.a.Component{click(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}render(){try{let e="dropdown-option";return this.props.selected&&(e+=" selected"),this.props.option.disabled&&(e+=" disabled"),n.a.createElement("div",{className:e,title:this.props.option.text,onClick:e=>this.click(e)},this.props.option.text)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var z=a(285),L=a(262);class G extends n.a.Component{render(){try{let e="expander";return this.props.disabled&&(e+=" disabled"),n.a.createElement(L.a,{className:e,bordered:!1,defaultActiveKey:[],expandIcon:e=>n.a.createElement(z.a,{rotate:e.isActive?-180:0}),expandIconPosition:"right"},n.a.createElement(L.a.Panel,{key:"one",header:n.a.createElement("div",{className:"collapse-header-text"},this.props.text)},this.props.children))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}G.defaultProps={disabled:!1};var R=a(286),B=a(287);class j extends n.a.Component{click(e,t){e.stopPropagation(),this.props.nudgeValue(t)}touchEnd(e,t){e.preventDefault(),e.stopPropagation(),this.props.nudgeValue(t)}render(){try{let e="info-value",t=this.props.source[this.props.name];0===t&&(e+=" dimmed"),this.props.display&&(t=this.props.display(t));const a=[],s=[],r=this.props.factors||[1];return r.forEach(e=>{a.push(n.a.createElement("div",{key:"minus"+e,className:1===e?"spin-button":"spin-button multiple",onTouchEnd:t=>this.touchEnd(t,-1*e),onClick:t=>this.click(t,-1*e)},1===e?n.a.createElement(R.a,null):n.a.createElement("div",null,e))),s.push(n.a.createElement("div",{key:"plus"+e,className:1===e?"spin-button":"spin-button multiple",onTouchEnd:t=>this.touchEnd(t,1*e),onClick:t=>this.click(t,1*e)},1===e?n.a.createElement(B.a,null):n.a.createElement("div",null,e)))}),a.reverse(),n.a.createElement("div",{className:this.props.disabled?"number-spin disabled":"number-spin"},n.a.createElement("div",{className:"minus"},a),n.a.createElement("div",{className:"info",style:{width:"calc(100% - "+60*r.length+"px)"}},n.a.createElement("div",{className:"info-label"},this.props.label),n.a.createElement("div",{className:e},t)),n.a.createElement("div",{className:"plus"},s))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}j.defaultProps={label:null,disabled:!1,factors:null,display:null};var H=a(260);class q extends n.a.Component{render(){try{let e="textbox";return this.props.disabled&&(e+=" disabled"),this.props.maxLines>1?n.a.createElement(H.a.TextArea,{className:e,value:this.props.text,placeholder:this.props.placeholder,autoSize:{minRows:this.props.minLines,maxRows:this.props.maxLines},onChange:e=>this.props.onChange(e.target.value)}):n.a.createElement(H.a,{className:e,value:this.props.text,placeholder:this.props.placeholder,allowClear:!0,onChange:e=>this.props.onChange(e.target.value)})}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}q.defaultProps={placeholder:"",minLines:1,maxLines:1,disabled:!1};class F extends n.a.Component{constructor(e){super(e),this.state={showAbilityScores:!1}}toggleAbilityScores(){this.setState({showAbilityScores:!this.state.showAbilityScores})}render(){try{let e=null;return e=this.props.edit?n.a.createElement("div",null,n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"str",label:"strength",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.str",e)}),n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"dex",label:"dexterity",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.dex",e)}),n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"con",label:"constitution",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.con",e)}),n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"int",label:"intelligence",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.int",e)}),n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"wis",label:"wisdom",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.wis",e)}),n.a.createElement(j,{source:this.props.combatant.abilityScores,name:"cha",label:"charisma",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"abilityScores.cha",e)})):n.a.createElement("div",{className:"ability-scores",onClick:()=>this.toggleAbilityScores()},n.a.createElement("div",{className:"ability-score-group"},n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"str"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.str:u.modifier(this.props.combatant.abilityScores.str))),n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"dex"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.dex:u.modifier(this.props.combatant.abilityScores.dex))),n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"con"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.con:u.modifier(this.props.combatant.abilityScores.con)))),n.a.createElement("div",{className:"ability-score-group"},n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"int"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.int:u.modifier(this.props.combatant.abilityScores.int))),n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"wis"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.wis:u.modifier(this.props.combatant.abilityScores.wis))),n.a.createElement("div",{className:"ability-score"},n.a.createElement("div",{className:"ability-heading"},"cha"),n.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.cha:u.modifier(this.props.combatant.abilityScores.cha))))),e}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}F.defaultProps={edit:null,nudgeValue:null};var W=a(72),Y=a.n(W);class J extends n.a.Component{getEditor(){let e=null;this.props.source.portrait&&(e=n.a.createElement(D.a,{onClick:()=>this.props.clear()}));let t=Y.a;const a=localStorage.getItem("image-"+this.props.source.portrait);if(a){t=JSON.parse(a).data}return n.a.createElement("div",{className:"portrait editing"},n.a.createElement("div",{className:"section centered"},n.a.createElement("img",{src:t,alt:"portrait",onClick:()=>this.props.edit()}),e))}getDisplay(){if(!this.props.source.portrait)return null;const e=localStorage.getItem("image-"+this.props.source.portrait);if(!e)return null;const t=JSON.parse(e);if(!t.data)return null;let a="portrait";return this.props.inline?a+=" inline":a+=" section centered",n.a.createElement("div",{className:a},n.a.createElement("img",{src:t.data,alt:"portrait"}))}render(){try{return this.props.edit?this.getEditor():this.getDisplay()}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}J.defaultProps={inline:!1,edit:null,clear:null};var _=a(288),X=a(289),U=a(26),K=a.n(U);class Z extends n.a.Component{render(){try{let e="descriptive";return this.props.white&&(e+=" white"),n.a.createElement("div",{className:e},this.props.children)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}Z.defaultProps={white:!1};const Q=new K.a.Converter;class $ extends n.a.Component{createSection(e,t){const a=e[t];if(0===a.length)return null;let s=null;if("legendary"===this.props.mode||"lair"===this.props.mode)switch(t){case"legendary":let e=null,t=null;if(this.props.combatant.legendaryActions>0&&(e=n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("b",null,this.props.combatant.legendaryActions)," legendary actions per round"),n.a.createElement("div",{className:"divider"})),"legendary"===this.props.mode)){let e=0;this.props.combatant.traits.filter(e=>"legendary"===e.type&&e.uses>0).forEach(t=>{let a=1;if(t.usage){const e=t.usage.toLowerCase().match(/\D*(\d*)\D*/);e&&(a=parseInt(e[1],10))}e+=a}),e=Math.min(e,this.props.combatant.legendaryActions);const a=Math.max(this.props.combatant.legendaryActions-e,0),s=[];for(let t=0;t!==e;++t)s.push(n.a.createElement(_.a,{key:"used "+t}));for(let t=0;t!==a;++t)s.push(n.a.createElement(X.a,{key:"unused "+t}));t=n.a.createElement("div",null,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section centered legendary-usage"},s))}s=n.a.createElement(Z,{white:!0},e,"one legendary action can be used at the end of each other combatant's turn; spent actions are refreshed at the start of the monster's turn",t);break;case"lair":s=n.a.createElement(Z,{white:!0},"one lair action can be taken each round on initiative 20")}else"legendary"===t&&(s=n.a.createElement(Z,{white:!0},n.a.createElement("b",null,this.props.combatant.legendaryActions)," legendary actions per round"));return n.a.createElement("div",null,n.a.createElement("div",{className:"section subheading"},u.traitType(t,!0)),s,a)}render(){try{const e={};return p.forEach(t=>{e[t]=this.props.combatant.traits.filter(e=>e.type===t).map(e=>n.a.createElement(ee,{key:e.id,trait:e,mode:this.props.mode,copyTrait:e=>this.props.copyTrait(e),useTrait:e=>this.props.useTrait(e),rechargeTrait:e=>this.props.rechargeTrait(e)}))}),0===this.props.combatant.traits.length?n.a.createElement("div",null,n.a.createElement("i",null,"no traits or actions")):"combat"===this.props.mode?n.a.createElement("div",null,this.createSection(e,"trait"),this.createSection(e,"action"),this.createSection(e,"bonus"),this.createSection(e,"reaction")):"legendary"===this.props.mode?n.a.createElement("div",null,this.createSection(e,"legendary")):"lair"===this.props.mode?n.a.createElement("div",null,this.createSection(e,"lair")):n.a.createElement("div",null,this.createSection(e,"trait"),this.createSection(e,"action"),this.createSection(e,"bonus"),this.createSection(e,"reaction"),this.createSection(e,"legendary"),this.createSection(e,"lair"))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}$.defaultProps={mode:"view",copyTrait:null,useTrait:null,rechargeTrait:null};class ee extends n.a.Component{render(){try{let e=0,t=this.props.trait.name||"unnamed "+u.traitType(this.props.trait.type,!1);if(this.props.trait.usage){let a="";this.props.trait.usage.toLowerCase().startsWith("recharge ")&&(e=1,this.props.trait.uses>0&&(a="; used"));const s=this.props.trait.usage.toLowerCase().match(/(\d+)\s*\/\s*day/);s&&(e=parseInt(s[1],10),this.props.trait.uses>0&&(a="; used "+this.props.trait.uses)),t+=" *("+this.props.trait.usage+a+")*"}"legendary"===this.props.trait.type&&(e=1,this.props.trait.uses>0&&(t+=" *(used)*"));const a="**"+t+"** "+this.props.trait.text;switch(this.props.mode){case"view":return n.a.createElement("div",{key:this.props.trait.id,className:"section trait"},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:Q.makeHtml(a)}}));case"template":return n.a.createElement("div",{key:this.props.trait.id,className:"section trait trait-template",onClick:()=>this.props.copyTrait(this.props.trait)},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:Q.makeHtml(a)}}));case"combat":case"legendary":case"lair":let t="",s=null;return e>0&&(this.props.trait.uses>=e?(t="strikethrough",s=n.a.createElement("button",{onClick:()=>this.props.rechargeTrait(this.props.trait)},"recharge")):s=n.a.createElement("button",{onClick:()=>this.props.useTrait(this.props.trait)},"use")),n.a.createElement("div",{key:this.props.trait.id,className:"section trait"},n.a.createElement("div",{className:t,dangerouslySetInnerHTML:{__html:Q.makeHtml(a)}}),s)}}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class te extends n.a.Component{render(){try{return n.a.createElement("div",{className:"card"},this.props.heading,n.a.createElement("div",{className:"card-content"},this.props.children))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}te.defaultProps={heading:null};class ae extends n.a.Component{constructor(e){super(e),this.state={cloneName:e.monster.name+" copy"}}setCloneName(e){this.setState({cloneName:e})}canSelect(){return-1!==this.props.mode.indexOf("template")||-1!==this.props.mode.indexOf("candidate")}monsterIsInWave(e){return e.slots.some(e=>{const t=this.props.library.find(e=>e.monsters.includes(this.props.monster));return!!t&&e.monsterGroupName===t.name&&e.monsterName===this.props.monster.name})}getHP(){const e=this.props.monster;if(void 0!==e.hpCurrent){var t,a;let s=(null!==(t=e.hpCurrent)&&void 0!==t?t:0).toString();return(null!==(a=e.hpTemp)&&void 0!==a?a:0)>0&&(s+="+"+e.hpTemp),s}return h.getTypicalHP(this.props.monster)+" ("+h.getTypicalHPString(this.props.monster)+")"}statSection(e,t){return t?n.a.createElement("div",{className:"section"},n.a.createElement("b",null,e)," ",t):null}getTags(){const e=[];let t=this.props.monster.size;const a=this.props.monster;a&&(t=a.displaySize||t);let s=(t+" "+this.props.monster.category).toLowerCase();return this.props.monster.tag&&(s+=" ("+this.props.monster.tag.toLowerCase()+")"),e.push(n.a.createElement(V.a,{key:"tag-main"},s)),this.props.monster.alignment&&e.push(n.a.createElement(V.a,{key:"tag-align"},this.props.monster.alignment.toLowerCase())),e.push(n.a.createElement(V.a,{key:"tag-cr"},"cr ",u.challenge(this.props.monster.challenge))),e}getButtons(){const e=[];if(-1!==this.props.mode.indexOf("editable")){e.push(n.a.createElement("button",{key:"view",onClick:()=>this.props.viewMonster(this.props.monster)},"view monster")),e.push(n.a.createElement("button",{key:"edit",onClick:()=>this.props.editMonster(this.props.monster)},"edit monster")),e.push(n.a.createElement("button",{key:"export",onClick:()=>this.props.exportMonster(this.props.monster)},"export monster")),e.push(n.a.createElement(G,{key:"clone",text:"clone monster"},n.a.createElement(q,{text:this.state.cloneName,placeholder:"monster name",onChange:e=>this.setCloneName(e)}),n.a.createElement("button",{onClick:()=>this.props.cloneMonster(this.props.monster,this.state.cloneName)},"create copy")));const t=[];this.props.library.forEach(e=>{-1===e.monsters.indexOf(this.props.monster)&&t.push({id:e.id,text:e.name})}),e.push(n.a.createElement(A,{key:"move",options:t,placeholder:"move to group...",select:e=>this.props.moveToGroup(this.props.monster,e)})),e.push(n.a.createElement(w,{key:"remove",text:"delete monster",callback:()=>this.props.removeMonster(this.props.monster)}))}if(-1!==this.props.mode.indexOf("encounter"))if(e.push(n.a.createElement("button",{key:"view",onClick:()=>this.props.viewMonster(this.props.monster)},"view monster")),this.props.slot){const t=[];if(this.props.library.forEach(e=>{e.monsters.filter(e=>e.challenge===this.props.monster.challenge).filter(e=>e.id!==this.props.monster.id).forEach(a=>t.push({id:a.id,text:a.name,group:e.name}))}),u.sort(t,[{field:"text",dir:"asc"}]),t.length>0&&e.push(n.a.createElement(A,{key:"replace",placeholder:"replace with...",options:t,select:e=>{const a=t.find(t=>t.id===e);a&&this.props.swapEncounterSlot(this.props.slot,a.group,a.text)}})),this.props.encounter.waves.length>0){let t=this.props.encounter.slots;const a=[];this.props.encounter.slots.includes(this.props.slot)||a.push({id:"",text:"main encounter"}),this.props.encounter.waves.forEach(e=>{e.slots.includes(this.props.slot)?t=e.slots:a.push({id:e.id,text:e.name})}),e.push(n.a.createElement(A,{key:"move",placeholder:"move to...",options:a,select:e=>this.props.moveToWave(this.props.slot,t,e)}))}e.push(n.a.createElement("button",{key:"remove",onClick:()=>this.props.removeEncounterSlot(this.props.slot)},"remove"))}else this.monsterIsInWave(this.props.encounter)||e.push(n.a.createElement("button",{key:"add encounter",onClick:()=>this.props.addEncounterSlot(this.props.monster,null)},"add to encounter")),this.props.encounter.waves.forEach(t=>{this.monsterIsInWave(t)||e.push(n.a.createElement("button",{key:"add "+t.id,onClick:()=>this.props.addEncounterSlot(this.props.monster,t.id)},"add to ",t.name))});return e}getStats(){let e=null;if(-1===this.props.mode.indexOf("template")){let t=null;this.props.slot&&(t=n.a.createElement("div",null,n.a.createElement("div",{className:"divider"}),n.a.createElement(j,{source:this.props.slot,name:"count",label:"count",nudgeValue:e=>this.props.nudgeValue(this.props.slot,"count",e)})));let a=null;-1===this.props.mode.indexOf("full")&&-1===this.props.mode.indexOf("combat")||(a=n.a.createElement("div",null,n.a.createElement("div",{className:"divider"}),n.a.createElement(F,{combatant:this.props.monster}),this.statSection("ac",this.props.monster.ac.toString()),this.statSection("hp",this.getHP()),this.statSection("saving throws",this.props.monster.savingThrows),this.statSection("skills",this.props.monster.skills),this.statSection("speed",this.props.monster.speed),this.statSection("senses",this.props.monster.senses),this.statSection("damage resistances",this.props.monster.damage.resist),this.statSection("damage vulnerabilities",this.props.monster.damage.vulnerable),this.statSection("damage immunities",this.props.monster.damage.immune),this.statSection("condition immunities",this.props.monster.conditionImmunities),this.statSection("languages",this.props.monster.languages),this.statSection("equipment",this.props.monster.equipment),n.a.createElement("div",{className:"divider"}),n.a.createElement($,{combatant:this.props.monster,mode:-1!==this.props.mode.indexOf("combat")?"combat":"view",useTrait:e=>this.props.useTrait(e),rechargeTrait:e=>this.props.rechargeTrait(e)}))),e=n.a.createElement("div",{className:"stats"},n.a.createElement(J,{source:this.props.monster}),n.a.createElement("div",{className:"section centered"},this.getTags()),t,a)}else-1!==this.props.mode.indexOf("overview")&&(e=n.a.createElement("div",{className:"stats"},n.a.createElement(J,{source:this.props.monster}),n.a.createElement("div",{className:"section centered"},this.getTags()),n.a.createElement("div",{className:"divider"}),this.statSection("speed",this.props.monster.speed),this.statSection("senses",this.props.monster.senses),this.statSection("languages",this.props.monster.languages),this.statSection("equipment",this.props.monster.equipment))),-1!==this.props.mode.indexOf("abilities")&&(e=n.a.createElement("div",{className:"stats"},n.a.createElement(F,{combatant:this.props.monster}),this.statSection("saving throws",this.props.monster.savingThrows),this.statSection("skills",this.props.monster.skills))),-1!==this.props.mode.indexOf("cbt-stats")&&(e=n.a.createElement("div",{className:"stats"},this.statSection("ac",this.props.monster.ac.toString()),this.statSection("hp",this.getHP()),this.statSection("damage resistances",this.props.monster.damage.resist),this.statSection("damage vulnerabilities",this.props.monster.damage.vulnerable),this.statSection("damage immunities",this.props.monster.damage.immune),this.statSection("condition immunities",this.props.monster.conditionImmunities))),-1!==this.props.mode.indexOf("actions")&&(e=n.a.createElement($,{combatant:this.props.monster,mode:"template",copyTrait:e=>this.props.copyTrait(e)}));return e}getIcon(){return this.canSelect()?-1!==this.props.mode.indexOf("selected")?n.a.createElement(I.a,{onClick:()=>this.props.deselectMonster(this.props.monster)}):n.a.createElement(T.a,{onClick:()=>this.props.selectMonster(this.props.monster)}):null}render(){try{const e=this.getButtons();if(0===e.length&&-1!==this.props.mode.indexOf("encounter"))return n.a.createElement(te,{heading:n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.monster.name))},n.a.createElement("div",{className:"section"},n.a.createElement("i",null,"this monster is already part of this encounter")));const t=(this.props.monster?this.props.monster.displayName:null)||this.props.monster.name||"unnamed monster";return n.a.createElement("div",{className:"card monster"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},t),this.getIcon()),n.a.createElement("div",{className:"card-content"},this.getStats(),n.a.createElement("div",{style:{display:e.length>0?"":"none"}},n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},e))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}ae.defaultProps={mode:"full",library:null,nudgeValue:null,viewMonster:null,editMonster:null,removeMonster:null,exportMonster:null,cloneMonster:null,moveToGroup:null,copyTrait:null,selectMonster:null,deselectMonster:null,encounter:null,slot:null,addEncounterSlot:null,removeEncounterSlot:null,swapEncounterSlot:null,moveToWave:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,changeHP:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null,toggleTag:null,toggleCondition:null,useTrait:null,rechargeTrait:null};class se extends n.a.Component{render(){try{const e=this.props.itemsPerRow?this.props.itemsPerRow:this.props.options.length,t=Math.ceil(this.props.options.length/e),a=[];for(let n=0;n!==t;++n)a.push([]);this.props.options.forEach(t=>{const s=this.props.options.indexOf(t),r=Math.floor(s/e);a[r].push(n.a.createElement(ne,{key:t.id,option:t,selected:t.id===this.props.selectedID,count:e,select:e=>this.props.select(e)}))});const s=a.map(e=>{const t=a.indexOf(e);return n.a.createElement("div",{key:t,className:"selector-row"},e)});return n.a.createElement("div",{className:this.props.disabled?"selector disabled":"selector"},s)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}se.defaultProps={disabled:!1,itemsPerRow:null};class ne extends n.a.Component{click(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}render(){try{const e="calc(((100% - 1px) / "+this.props.count+") - 2px )";let t="option";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),n.a.createElement("div",{key:this.props.option.id,className:t,style:{width:e},title:this.props.option.text,onClick:e=>this.click(e)},this.props.option.text)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class re extends n.a.Component{constructor(e){super(e),this.state={selectedPartyID:e.party?e.party.id:null}}selectParty(e){this.setState({selectedPartyID:e})}render(){try{const e=N.getMonsterCount(this.props.encounter),t=N.getEncounterXP(this.props.encounter,this.props.getMonster),a=N.getAdjustedEncounterXP(this.props.encounter,this.props.getMonster),s=n.a.createElement("div",null,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"xp for this encounter"),n.a.createElement(c.a,{span:8,className:"statistic-value"},t," xp"))),n.a.createElement("div",{className:"section",style:{display:a===t?"none":""}},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"effective xp for ",e," monster(s)"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a," xp"))));let r,i;const l=this.props.parties.find(e=>e.id===this.state.selectedPartyID);if(l){let e=0,t=0,m=0,d=0;const p=l.pcs.filter(e=>e.active);p.forEach(a=>{e+=u.pcExperience(a.level,"easy"),t+=u.pcExperience(a.level,"medium"),m+=u.pcExperience(a.level,"hard"),d+=u.pcExperience(a.level,"deadly")});let h="trivial",g="trivial";if(a>0&&(a>=e&&(h="easy",g="easy"),a>=t&&(h="medium",g="medium"),a>=m&&(h="hard",g="hard"),a>=d&&(h="deadly",g="deadly"),d>0&&a>=10*d&&(h="tpk",g="tpk"),d>0&&a>=100*d&&(h="dm with a grudge",g="dm with a grudge"),d>0&&a>=1e3*d&&(h="now you're just being silly",g="now you're just being silly"),p.length<3||p.length>5)){const e=p.length<3;switch(h){case"trivial":g=e?"easy":"trivial";break;case"easy":g=e?"medium":"trivial";break;case"medium":g=e?"hard":"easy";break;case"hard":g=e?"deadly":"medium";break;case"deadly":g=e?"deadly":"hard";break;default:g=""}}r=n.a.createElement("div",{className:"table"},n.a.createElement("div",null,n.a.createElement("div",{className:"cell four easy"},n.a.createElement("b",null,"easy")),n.a.createElement("div",{className:"cell four medium"},n.a.createElement("b",null,"medium")),n.a.createElement("div",{className:"cell four hard"},n.a.createElement("b",null,"hard")),n.a.createElement("div",{className:"cell four deadly"},n.a.createElement("b",null,"deadly"))),n.a.createElement("div",null,n.a.createElement("div",{className:"cell four"},e," xp"),n.a.createElement("div",{className:"cell four"},t," xp"),n.a.createElement("div",{className:"cell four"},m," xp"),n.a.createElement("div",{className:"cell four"},d," xp")));const b=e=>100*e/Math.max(a,1.2*d),E=e=>100-b(e);i=n.a.createElement("div",null,n.a.createElement("div",{className:"difficulty-gauge"},n.a.createElement("div",{className:"bar-container"},n.a.createElement("div",{className:"bar trivial",style:{left:"0",right:E(e)+"%"}})),n.a.createElement("div",{className:"bar-container"},n.a.createElement("div",{className:"bar easy",style:{left:b(e)+"%",right:E(t)+"%"}})),n.a.createElement("div",{className:"bar-container"},n.a.createElement("div",{className:"bar medium",style:{left:b(t)+"%",right:E(m)+"%"}})),n.a.createElement("div",{className:"bar-container"},n.a.createElement("div",{className:"bar hard",style:{left:b(m)+"%",right:E(d)+"%"}})),n.a.createElement("div",{className:"bar-container"},n.a.createElement("div",{className:"bar deadly",style:{left:b(d)+"%",right:"0"}})),n.a.createElement("div",{className:"encounter-container"},n.a.createElement("div",{className:"encounter",style:{left:b(a)-.5+"%"}}))),s,n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"difficulty for this party"),n.a.createElement(c.a,{span:8,className:"statistic-value"},h))),n.a.createElement("div",{className:"section",style:{display:g===h?"none":""}},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"effective difficulty for ",p.length," pc(s)"),n.a.createElement(c.a,{span:8,className:"statistic-value"},g))))}else i=s;let m=null;if(!this.props.party){const e=[];if(this.props.parties)for(let t=0;t!==this.props.parties.length;++t){const a=this.props.parties[t];e.push({id:a.id,text:a.name})}m=n.a.createElement(A,{options:e,placeholder:"select party...",selectedID:this.state.selectedPartyID?this.state.selectedPartyID:void 0,select:e=>this.selectParty(e),clear:()=>this.selectParty(null)})}return m?n.a.createElement("div",{className:"group-panel"},n.a.createElement("div",{className:"subheading"},"difficulty"),m,r,i):n.a.createElement("div",null,r,i)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}re.defaultProps={party:null};class ie extends n.a.Component{render(){try{const e={};this.props.noTopMargin&&(e.marginTop="-5px");const t=["all sizes"].concat(m).map(e=>({id:e,text:e})),a=["all types"].concat(d).map(e=>({id:e,text:e})),s=a.find(e=>"aberration"===e.id);s&&(s.text="aberr.");const r=a.find(e=>"celestial"===e.id);r&&(r.text="celest.");const i=a.find(e=>"construct"===e.id);i&&(i.text="const.");const o=a.find(e=>"elemental"===e.id);o&&(o.text="elem.");const c=a.find(e=>"humanoid"===e.id);c&&(c.text="human.");const l=a.find(e=>"monstrosity"===e.id);return l&&(l.text="monst."),n.a.createElement("div",{style:e},n.a.createElement(H.a.Search,{key:"search",value:this.props.filter.name,placeholder:"filter by name",allowClear:!0,onChange:e=>this.props.changeValue("name",e.target.value),onSearch:e=>this.props.changeValue("name",e)}),n.a.createElement(G,{text:"showing "+N.getFilterDescription(this.props.filter)},n.a.createElement(M.a,{range:!0,min:0,max:35,value:[this.props.filter.challengeMin,this.props.filter.challengeMax],onChange:e=>this.props.changeValue("challenge",e)}),n.a.createElement(A,{options:t,placeholder:"filter by size...",selectedID:this.props.filter.size,select:e=>this.props.changeValue("size",e)}),n.a.createElement(se,{options:a,selectedID:this.props.filter.category,itemsPerRow:3,select:e=>this.props.changeValue("category",e)}),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("button",{onClick:()=>this.props.resetFilter()},"clear filter"))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}ie.defaultProps={noTopMargin:!1};var oe=a(293),ce=a(294),le=a(295),me=a(74);class de extends n.a.Component{render(){try{const e=this.props.combatant.hpCurrent||0,t=this.props.combatant.hpMax||0,a=this.props.combatant.hpTemp||0,s=t/2,r=100*Math.max(e,0)/(t+a);let i="";i=e>=t?"bar unhurt":e<=s?"bar bloodied":"bar injured";let o=null;if(null!==this.props.combatant.hpTemp&&this.props.combatant.hpTemp>0){const e=100*Math.max(this.props.combatant.hpTemp,0)/(t+a);o=n.a.createElement("div",{className:"bar temp",style:{width:e+"%"}})}return n.a.createElement("div",{className:"hp-gauge"},n.a.createElement("div",{className:i,style:{width:r+"%"}}),o)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}const pe=new K.a.Converter;pe.setOption("tables",!0);class he extends n.a.Component{getMapDimensions(e){let t=null;if(this.props.map.items.filter(e=>"edit"!==this.props.mode||"tile"===e.type).forEach(e=>{t?(t.minX=Math.min(t.minX,e.x),t.maxX=Math.max(t.maxX,e.x+e.width-1),t.minY=Math.min(t.minY,e.y),t.maxY=Math.max(t.maxY,e.y+e.height-1)):t={minX:e.x,maxX:e.x+e.width-1,minY:e.y,maxY:e.y+e.height-1}}),this.props.combatants&&this.props.combatants.filter(e=>e.aura.radius>0).forEach(e=>{const a=this.props.map.items.find(t=>t.id===e.id);if(a){const s=e.aura.radius/5;let n=1;const r=e;r&&(n=u.miniSize(r.size));const i=a.x-s,o=a.x+(n-1)+s,c=a.y-s,l=a.y+(n-1)+s;t&&(t.minX=Math.min(t.minX,i),t.maxX=Math.max(t.maxX,o),t.minY=Math.min(t.minY,c),t.maxY=Math.max(t.maxY,l))}}),!t){if("thumbnail"===this.props.mode)return null;t={minX:0,maxX:0,minY:0,maxY:0}}return t.minX-=e,t.maxX+=e,t.minY-=e,t.maxY+=e,t}getStyle(e,t,a,s,n,r){let i=0,o=0;a<1&&(i=(1-a)/2),s<1&&(o=(1-s)/2);let c="0";switch(n){case"rounded":c=this.props.size+"px";break;case"circle":c="50%"}return{left:"calc("+this.props.size+"px * "+(e+i-r.minX)+")",top:"calc("+this.props.size+"px * "+(t+o-r.minY)+")",width:"calc(("+this.props.size+"px * "+a+") + 1px)",height:"calc(("+this.props.size+"px * "+s+") + 1px)",borderRadius:c,backgroundSize:this.props.size+"px"}}render(){try{const e="edit"===this.props.mode?4:0,t=this.getMapDimensions(e);if(!t)return n.a.createElement("div",{className:"section centered"},"(blank map)");let a=[];a=a.concat(this.props.map.items),this.props.floatingItem&&a.push(this.props.floatingItem);const s=a.filter(e=>"tile"===e.type).map(e=>{const a=this.getStyle(e.x,e.y,e.width,e.height,e.style,t);return n.a.createElement(ge,{key:e.id,tile:e,note:"combat-player"!==this.props.mode?y.getNote(this.props.map,e):null,style:a,selectable:"edit"===this.props.mode,selected:this.props.selectedItemIDs.includes(e.id),select:(e,t)=>"edit"===this.props.mode?this.props.itemSelected(e,t):null})});let r=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(r=a.filter(e=>"overlay"===e.type).map(e=>{const a=this.getStyle(e.x,e.y,e.width,e.height,e.style,t);return a.backgroundColor=e.color+e.opacity.toString(16),n.a.createElement(be,{key:e.id,overlay:e,note:"combat-player"!==this.props.mode?y.getNote(this.props.map,e):null,style:a,selected:this.props.selectedItemIDs.includes(e.id),select:(e,t)=>this.props.itemSelected(e,t)})}));let i=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(i=this.props.combatants.filter(e=>e.aura.radius>0).filter(e=>e.showOnMap||"combat-player"!==this.props.mode).map(e=>{const s=a.find(t=>t.id===e.id);if(s){const a=e.aura.radius/5,r=2*a+u.miniSize(e.displaySize),i=this.getStyle(s.x-a,s.y-a,r,r,e.aura.style,t);return i.backgroundColor=e.aura.color,n.a.createElement("div",{key:e.id+" aura",className:"aura",style:i})}return null}).filter(e=>null!==e));let o=[];"edit"!==this.props.mode&&(o=a.filter(e=>"monster"===e.type||"pc"===e.type||"companion"===e.type||"token"===e.type).map(e=>{let a=u.miniSize(e.size),s=y.getNote(this.props.map,e),r=!1;const i=this.props.combatants.find(t=>t.id===e.id);i&&(a=u.miniSize(i.displaySize),!s&&i.note&&(s=g.createMapNote(),s.targetID=i.id,s.text=i.note),r="pc"===i.type);const o=this.getStyle(e.x,e.y,a,a,"circle",t);return n.a.createElement(Ee,{key:e.id,token:e,note:"combat-player"!==this.props.mode?s:null,combatant:i||null,style:o,simple:"thumbnail"===this.props.mode,showGauge:"combat"===this.props.mode,showHidden:"combat"===this.props.mode||r,selectable:"combat"===this.props.mode||"combat-player"===this.props.mode,selected:this.props.selectedItemIDs.includes(e.id),select:(e,t)=>this.props.itemSelected(e,t)})}).filter(e=>null!==e));const c=[];if(this.props.showOverlay)for(let p=t.minY;p!==t.maxY+1;++p)for(let e=t.minX;e!==t.maxX+1;++e){const a=this.getStyle(e,p,1,1,"square",t);c.push(n.a.createElement(ue,{key:e+","+p,x:e,y:p,style:a,overlay:!0,onMouseEnter:(e,t)=>this.props.gridSquareEntered(e,t),onClick:(e,t)=>this.props.gridSquareClicked(e,t)}))}const l="map-panel "+this.props.mode,m=1+t.maxX-t.minX,d=1+t.maxY-t.minY;return n.a.createElement("div",{className:l,onClick:()=>this.props.itemSelected(null,!1)},n.a.createElement("div",{className:"grid",style:{width:this.props.size*m+2+"px",height:this.props.size*d+2+"px"}},s,r,i,o,c))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}he.defaultProps={floatingItem:null,combatants:null,showOverlay:!1,selectedItemIDs:[],itemSelected:null,gridSquareEntered:null,gridSquareClicked:null};class ue extends n.a.Component{mouseEnter(e){e.stopPropagation(),this.props.onMouseEnter(this.props.x,this.props.y)}click(e,t){e.stopPropagation(),"single"===t&&this.props.onClick&&this.props.onClick(this.props.x,this.props.y),"double"===t&&this.props.onDoubleClick&&this.props.onDoubleClick(this.props.x,this.props.y)}render(){try{return n.a.createElement("div",{className:this.props.overlay?"grid-square grid-overlay":"grid-square",style:this.props.style,onMouseEnter:e=>this.mouseEnter(e),onClick:e=>this.click(e,"single"),onDoubleClick:e=>this.click(e,"double")})}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}ue.defaultProps={overlay:!1,onDoubleClick:null};class ge extends n.a.Component{select(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.tile.id,e.ctrlKey))}getNoteText(){return this.props.note?this.props.note.text.trim():""}render(){try{let e="tile "+this.props.tile.terrain;this.props.selected&&(e+=" selected");let t=null;if("custom"===this.props.tile.terrain){let e=Y.a;const a=localStorage.getItem("image-"+this.props.tile.customBackground);if(a){e=JSON.parse(a).data}t=n.a.createElement("img",{className:"custom-image",alt:"map tile",src:e})}let a=null;if(this.props.tile.content)switch(this.props.tile.content.type){case"doorway":switch(this.props.tile.content.style){case"single":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),n.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),n.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}))}break;case"double":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),n.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}),n.a.createElement("line",{className:"thin",x1:"50%",y1:"25%",x2:"50%",y2:"75%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),n.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}),n.a.createElement("line",{className:"thin",x1:"25%",y1:"50%",x2:"75%",y2:"50%"}))}break;case"arch":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"20%",y2:"50%"}),n.a.createElement("line",{className:"thick",x1:"80%",y1:"50%",x2:"100%",y2:"50%"}),n.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"20%",y2:"80%"}),n.a.createElement("line",{className:"medium",x1:"80%",y1:"20%",x2:"80%",y2:"80%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"20%"}),n.a.createElement("line",{className:"thick",x1:"50%",y1:"80%",x2:"50%",y2:"100%"}),n.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"80%",y2:"20%"}),n.a.createElement("line",{className:"medium",x1:"20%",y1:"80%",x2:"80%",y2:"80%"}))}break;case"bars":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("circle",{className:"thin filled",cx:"10%",cy:"50%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"30%",cy:"50%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"70%",cy:"50%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"90%",cy:"50%",r:"5%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"10%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"30%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"70%",r:"5%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"90%",r:"5%"}))}}break;case"stairway":switch(this.props.tile.content.style){case"stairs":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thin",x1:"0",y1:"12.5%",x2:"100%",y2:"12.5%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"25%",x2:"100%",y2:"25%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"37.5%",x2:"100%",y2:"37.5%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"62.5%",x2:"100%",y2:"62.5%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"75%",x2:"100%",y2:"75%"}),n.a.createElement("line",{className:"thin",x1:"0",y1:"87.5%",x2:"100%",y2:"87.5%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("line",{className:"thin",x1:"12.5%",y1:"0",x2:"12.5%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"25%",y1:"0",x2:"25%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"37.5%",y1:"0",x2:"37.5%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"62.5%",y1:"0",x2:"62.5%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"75%",y1:"0",x2:"75%",y2:"100%"}),n.a.createElement("line",{className:"thin",x1:"87.5%",y1:"0",x2:"87.5%",y2:"100%"}))}break;case"spiral":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("ellipse",{className:"thin outline",cx:"50%",cy:"50%",rx:"40%",ry:"40%"}),n.a.createElement("ellipse",{className:"thin filled",cx:"50%",cy:"50%",rx:"10%",ry:"10%"}),n.a.createElement("line",{className:"thin",x1:"50%",y1:"10%",x2:"50%",y2:"90%"}),n.a.createElement("line",{className:"thin",x1:"10%",y1:"50%",x2:"90%",y2:"50%"}),n.a.createElement("line",{className:"thin",x1:"20%",y1:"20%",x2:"80%",y2:"80%"}),n.a.createElement("line",{className:"thin",x1:"20%",y1:"80%",x2:"80%",y2:"20%"}));break;case"ladder":switch(this.props.tile.content.orientation){case"horizontal":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("circle",{className:"thin filled",cx:"20%",cy:"50%",r:"7%"}),n.a.createElement("line",{className:"thin",x1:"20%",y1:"50%",x2:"80%",y2:"50%"}),n.a.createElement("circle",{className:"thin filled",cx:"80%",cy:"50%",r:"7%"}));break;case"vertical":a=n.a.createElement("svg",{className:"tile-content"},n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"20%",r:"7%"}),n.a.createElement("line",{className:"thin",x1:"50%",y1:"20%",x2:"50%",y2:"80%"}),n.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"80%",r:"7%"}))}}}const s=n.a.createElement("div",{className:e,style:this.props.style,onClick:e=>this.select(e)},t,a),r=this.getNoteText();return r?n.a.createElement(me.a,{placement:"bottom",title:n.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.makeHtml(r)}})},s):s}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class be extends n.a.Component{select(e){e.stopPropagation(),this.props.select(this.props.overlay.id,e.ctrlKey)}getNoteText(){return this.props.note?this.props.note.text.trim():""}render(){try{let e="overlay";this.props.selected&&(e+=" selected");const t=n.a.createElement("div",{className:e,style:this.props.style,onClick:e=>this.select(e)}),a=this.getNoteText();return a?n.a.createElement(me.a,{placement:"bottom",title:n.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.makeHtml(a)}})},t):t}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ee extends n.a.Component{select(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.token.id,e.ctrlKey))}getNoteText(){let e=this.props.combatant?"**"+this.props.combatant.displayName+"**":"";return this.props.combatant&&(this.props.combatant.showOnMap||(e+="\n\n",e+="**hidden**"),this.props.combatant.tags.forEach(t=>{e+="\n\n",e+="**"+u.getTagTitle(t)+"**",e+="\n\n",e+="* "+u.getTagDescription(t)}),this.props.combatant.conditions.forEach(t=>{e+="\n\n",e+="**"+t.name+"**",u.conditionText(t).forEach(t=>{e+="\n\n",e+="* "+t})})),this.props.note&&this.props.note.text&&(e+="\n\n",e+=this.props.note.text),e.trim()}render(){try{let e="token",t="token";if(this.props.selected&&(t+=" selected"),this.props.combatant&&(e=this.props.combatant.displayName||"combatant",t+=" "+this.props.combatant.type,this.props.combatant.current&&(t+=" current"),!this.props.combatant.showOnMap)){if(!this.props.showHidden)return null;t+=" hidden"}let a=null,s=null,r=null,i=null;if(this.props.combatant&&!this.props.simple){let t="";const o=this.props.combatant;if(o&&o.portrait){const e=localStorage.getItem("image-"+o.portrait);if(e){t=JSON.parse(e).data}}if(a=t?n.a.createElement("img",{className:"portrait",src:t,alt:e}):n.a.createElement("div",{className:"initials"},e.split(" ").map(e=>e[0])),"monster"===this.props.combatant.type&&this.props.showGauge){(this.props.combatant.hpCurrent||0)<(this.props.combatant.hpMax||0)&&(s=n.a.createElement(de,{combatant:this.props.combatant}))}this.props.combatant.altitude>0&&(r=n.a.createElement("div",{className:"badge"},n.a.createElement(oe.a,{twoToneColor:"#3c78dc"}))),this.props.combatant.altitude<0&&(r=n.a.createElement("div",{className:"badge"},n.a.createElement(ce.a,{twoToneColor:"#3c78dc"})));let c=0;this.props.combatant.conditions&&(c+=this.props.combatant.conditions.length),this.props.combatant.tags&&(c+=this.props.combatant.tags.filter(e=>!e.startsWith("engaged")).length),c>0&&(i=n.a.createElement("div",{className:"conditions"},n.a.createElement(le.a,{twoToneColor:"#3c78dc"})))}const o=n.a.createElement("div",{className:t,style:this.props.style,onClick:e=>this.select(e)},a,s,r,i),c=this.getNoteText();return c?n.a.createElement(me.a,{placement:"bottom",title:n.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.makeHtml(c)}})},o):o}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ve extends n.a.Component{constructor(e){super(e),this.state={combatSetup:e.combatSetup}}setPartyID(e){const t=this.state.combatSetup,a=this.props.parties.find(t=>t.id===e);t.party=a?JSON.parse(JSON.stringify(a)):null,this.setState({combatSetup:t},()=>this.props.notify())}setEncounterID(e){const t=this.state.combatSetup,a=this.props.encounters.find(t=>t.id===e);t.encounter=a?JSON.parse(JSON.stringify(a)):null,t.slotInfo=u.getCombatSlotData(t.encounter,this.props.library),this.setState({combatSetup:t},()=>this.props.notify())}setMapID(e){const t=this.props.maps.find(t=>t.id===e),a=this.state.combatSetup;a.map=t||null,this.setState({combatSetup:a})}setWaveID(e){const t=this.state.combatSetup;if(t.waveID=e,t.encounter){const a=t.encounter.waves.find(t=>t.id===e);a&&(t.slotInfo=u.getCombatSlotData(a,this.props.library))}this.setState({combatSetup:t},()=>this.props.notify())}generateEncounter(e){const t=g.createEncounter();t.name="new encounter";const a=g.createMonsterFilter();let s=0,n=0;if(this.state.combatSetup.party){const t=this.state.combatSetup.party.pcs.filter(e=>e.active);t.forEach(t=>{s+=u.pcExperience(t.level,e),n+=t.level});const r=n/t.length;a.challengeMax=Math.max(r,5)}N.buildEncounter(t,s,a,this.props.library,this.props.getMonster);const r=this.state.combatSetup;r.encounter=t,r.slotInfo=u.getCombatSlotData(t,this.props.library),this.setState({combatSetup:r},()=>this.props.notify())}generateMap(e){const t=g.createMap();t.name="new map",y.generate(e,t);const a=this.state.combatSetup;a.map=t,this.setState({combatSetup:a},()=>this.props.notify())}changeValue(e,t,a){e[t]=a;const s=e;s.members&&("init"===t&&s.members.forEach(e=>e.init=a),"hp"===t&&s.members.forEach(e=>e.hp=a)),this.setState({combatSetup:this.state.combatSetup})}nudgeCount(e,t){const a=this.state.combatSetup;if(a.encounter){const s=a.encounter.slots.find(t=>t.id===e);s&&(s.count=Math.max(0,s.count+t),a.slotInfo=u.getCombatSlotData(a.encounter,this.props.library),this.setState({combatSetup:a}))}}render(){try{let e=null,t=null;switch(this.props.type){case"start":e=n.a.createElement("div",null,n.a.createElement(ye,{combatSetup:this.state.combatSetup,parties:this.props.parties,setPartyID:e=>this.setPartyID(e)}),n.a.createElement(fe,{combatSetup:this.state.combatSetup,encounters:this.props.encounters,setEncounterID:e=>this.setEncounterID(e),generateEncounter:e=>this.generateEncounter(e)}),n.a.createElement(Ne,{combatSetup:this.state.combatSetup,maps:this.props.maps,setMapID:e=>this.setMapID(e),generateMap:e=>this.generateMap(e)})),t=n.a.createElement("div",null,n.a.createElement(xe,{combatSetup:this.state.combatSetup,parties:this.props.parties,encounters:this.props.encounters,getMonster:(e,t)=>this.props.getMonster(e,t)}),n.a.createElement(Ce,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:(e,t)=>this.props.getMonster(e,t),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeCount:(e,t)=>this.nudgeCount(e,t)}));break;case"add-wave":e=n.a.createElement("div",null,n.a.createElement(ke,{combatSetup:this.state.combatSetup,setWaveID:e=>this.setWaveID(e)})),t=n.a.createElement("div",null,n.a.createElement(Ce,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:(e,t)=>this.props.getMonster(e,t),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeCount:(e,t)=>this.nudgeCount(e,t)}));break;case"add-combatants":e=n.a.createElement("div",null,n.a.createElement(we,{combatSetup:this.state.combatSetup,library:this.props.library,addMonster:e=>this.props.addMonster(e)})),t=n.a.createElement("div",null,n.a.createElement(Ce,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:(e,t)=>this.props.getMonster(e,t),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeCount:(e,t)=>this.nudgeCount(e,t)}))}return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},e),n.a.createElement(c.a,{span:12,className:"scrollable"},t))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}ve.defaultProps={parties:null,encounters:null,maps:null,addMonster:null};class ye extends n.a.Component{render(){if(0===this.props.parties.length)return n.a.createElement("div",{className:"section"},"you have not defined any parties");const e=this.props.parties.map(e=>({id:e.id,text:e.name||"unnamed party"}));let t=null;if(this.props.combatSetup.party){const e=this.props.combatSetup.party.pcs.filter(e=>e.active).map(e=>n.a.createElement("div",{key:e.id,className:"group-panel"},e.name||"unnamed pc"," (level ",e.level,")"));0===e.length&&e.push(n.a.createElement(Z,{key:"empty"},"no pcs")),t=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"pcs"),e)}return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"party"),n.a.createElement(A,{options:e,placeholder:"select a party",selectedID:this.props.combatSetup.party?this.props.combatSetup.party.id:void 0,select:e=>this.props.setPartyID(e),clear:()=>this.props.setPartyID(null)}),t)}}class fe extends n.a.Component{render(){let e=null;if(this.props.combatSetup.encounter)e=n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.props.setEncounterID(null)},"choose a different encounter"));else{let t=null;if(this.props.encounters.length>0){const e=this.props.encounters.map(e=>({id:e.id,text:e.name||"unnamed encounter"}));t=n.a.createElement(A,{options:e,placeholder:"select an encounter",select:e=>this.props.setEncounterID(e)})}let a=null;this.props.combatSetup.party&&(a=n.a.createElement("button",{onClick:()=>this.props.generateEncounter("medium")},"generate a random encounter")),e=n.a.createElement("div",null,t,a)}let t=null;if(this.props.combatSetup.encounter){const e=this.props.combatSetup.encounter.slots.map(e=>{let t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),n.a.createElement("div",{key:e.id,className:"group-panel"},t)});0===e.length&&e.push(n.a.createElement(Z,{key:"empty"},"no monsters"));const a=this.props.combatSetup.encounter.waves.map(e=>{if(0===e.slots.length)return null;const t=e.slots.map(e=>{let t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" x"+e.count),n.a.createElement("div",{key:e.id,className:"group-panel"},t)});return n.a.createElement("div",{key:e.id},n.a.createElement("div",{className:"subheading"},e.name||"unnamed wave"),t)});t=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"monsters"),e,a)}return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"encounter"),e,t)}}class Ne extends n.a.Component{render(){let e=null;if(this.props.combatSetup.map)e=n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.props.setMapID(null)},"choose a different map"));else{let t=null;if(this.props.maps.length>0){const e=this.props.maps.map(e=>({id:e.id,text:e.name||"unnamed map"}));t=n.a.createElement(A,{options:e,placeholder:"select a map",select:e=>this.props.setMapID(e)})}e=n.a.createElement("div",null,t,n.a.createElement("button",{onClick:()=>this.props.generateMap("delve")},"generate a random delve"))}let t=null;return this.props.combatSetup.map&&(t=n.a.createElement(he,{map:this.props.combatSetup.map,mode:"thumbnail",size:12})),n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"map"),e,t)}}class ke extends n.a.Component{render(){if(null===this.props.combatSetup.encounter)return n.a.createElement("div",{className:"section"},"you have not selected an encounter");{if(0===this.props.combatSetup.encounter.waves.length)return n.a.createElement("div",{className:"section"},"you have not defined any waves");const e=this.props.combatSetup.encounter.waves.map(e=>({id:e.id,text:e.name||"unnamed wave"}));let t=null;if(this.props.combatSetup.waveID){const e=this.props.combatSetup.encounter.waves.find(e=>e.id===this.props.combatSetup.waveID);if(e){const a=e.slots.map(e=>{let t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),n.a.createElement("div",{key:e.id,className:"group-panel"},t)});0===a.length&&a.push(n.a.createElement(Z,{key:"empty"},"no monsters")),t=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"monsters"),a)}}return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"wave"),n.a.createElement(A,{options:e,placeholder:"select wave",selectedID:this.props.combatSetup.waveID?this.props.combatSetup.waveID:void 0,select:e=>this.props.setWaveID(e),clear:()=>this.props.setWaveID(null)}),t)}}}class we extends n.a.Component{constructor(e){super(e),this.state={filter:g.createMonsterFilter()}}changeFilterValue(e,t){const a=this.state.filter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({filter:a})}resetFilter(){this.setState({filter:g.createMonsterFilter()})}matchMonster(e){return N.matchMonster(e,this.state.filter)}render(){const e=[];this.props.library.forEach(t=>{t.monsters.forEach(t=>{this.matchMonster(t)&&e.push(t)})}),e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);const t=this.props.combatSetup.slotInfo.map(e=>e.id);let a=e.filter(e=>!t.includes(e.id)).map(e=>n.a.createElement(ae,{key:e.id,monster:e,mode:"candidate",selectMonster:e=>this.props.addMonster(e)}));return 0===a.length&&(a=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"there are no monsters that match the above criteria (or you have already selected them all)"))),n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"monsters"),n.a.createElement(ie,{filter:this.state.filter,changeValue:(e,t)=>this.changeFilterValue(e,t),resetFilter:()=>this.resetFilter()}),a)}}class xe extends n.a.Component{render(){return this.props.combatSetup.party&&this.props.combatSetup.encounter?n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"encounter difficulty"),n.a.createElement(re,{parties:this.props.parties,party:this.props.combatSetup.party,encounter:this.props.combatSetup.encounter,getMonster:(e,t)=>this.props.getMonster(e,t)})):n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"encounter difficulty"),n.a.createElement("div",{className:"section"},"select a party and an encounter on the left to see difficulty information."))}}class Ce extends n.a.Component{constructor(e){super(e),this.state={view:"init"}}setView(e){this.setState({view:e})}render(){var e;if("start"===this.props.type&&!this.props.combatSetup.encounter)return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"monsters"),n.a.createElement("div",{className:"section"},"select an encounter to see monster information here."));if("add-wave"===this.props.type&&!this.props.combatSetup.waveID)return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"monsters"),n.a.createElement("div",{className:"section"},"select a wave to see monster information here."));if("add-combatants"===this.props.type&&0===(null===(e=this.props.combatSetup.encounter)||void 0===e?void 0:e.slots.length))return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"monsters"),n.a.createElement("div",{className:"section"},"add monsters to see their information here."));if(this.props.combatSetup.encounter){let e=this.props.combatSetup.encounter;if(this.props.combatSetup.waveID){const t=this.props.combatSetup.encounter.waves.find(e=>e.id===this.props.combatSetup.waveID);t&&(e=t)}if(0===e.slots.length)return null;const t=["init","hit points","names","count"].map(e=>({id:e,text:e})),a=this.props.combatSetup.slotInfo.map(t=>{const a=e.slots.find(e=>e.id===t.id);if(!a)return null;const s=this.props.getMonster(a.monsterName,a.monsterGroupName);return s?n.a.createElement(Se,{key:t.id,slotInfo:t,encounterSlot:a,monster:s,view:this.state.view,changeValue:(e,t,a)=>this.props.changeValue(e,t,a),nudgeCount:(e,t)=>this.props.nudgeCount(e,t)}):null});return n.a.createElement("div",null,n.a.createElement("div",{className:"heading"},"monsters"),n.a.createElement(se,{options:t,selectedID:this.state.view,select:e=>this.setView(e)}),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",null,a))}return null}}class Se extends n.a.Component{rollInit(e){const t=u.dieRoll(),a=u.modifierValue(this.props.monster.abilityScores.dex);this.props.changeValue(null!==e&&void 0!==e?e:this.props.slotInfo,"init",t+a)}rollHP(e){const t=u.hitDieType(this.props.monster.size),a=u.dieRoll(t,this.props.monster.hitDice),s=u.modifierValue(this.props.monster.abilityScores.con)*this.props.monster.hitDice;this.props.changeValue(null!==e&&void 0!==e?e:this.props.slotInfo,"hp",a+s)}getValueSection(e,t,a,s,r){return n.a.createElement(o.a,{align:"middle"},n.a.createElement(c.a,{span:20},n.a.createElement(M.a,{min:e,max:t,value:a[s],onChange:e=>this.props.changeValue(a,s,e)})),n.a.createElement(c.a,{span:4},n.a.createElement("div",{className:"combatant-value"},a[s],n.a.createElement(S.a,{onClick:()=>r()}))))}getInitSection(){let e=null;this.props.encounterSlot.count>1&&(e=n.a.createElement(k,{label:"roll initiative once for this group",checked:this.props.slotInfo.useGroupInit,changeValue:e=>this.props.changeValue(this.props.slotInfo,"useGroupInit",e)}));const t=u.modifierValue(this.props.monster.abilityScores.dex),a=1+t,s=20+t,r=[];return this.props.slotInfo.useGroupInit?r.push(n.a.createElement("div",{key:"init"},this.getValueSection(a,s,this.props.slotInfo,"init",()=>this.rollInit(null)))):this.props.slotInfo.members.forEach(e=>{r.push(n.a.createElement("div",{key:e.id},n.a.createElement("div",{className:"combatant-name"},e.name),this.getValueSection(a,s,e,"init",()=>this.rollInit(e))))}),n.a.createElement("div",null,e,r)}getHPSection(){let e=null;this.props.encounterSlot.count>1&&(e=n.a.createElement(k,{label:"roll hit points once for this group",checked:this.props.slotInfo.useGroupHP,changeValue:e=>this.props.changeValue(this.props.slotInfo,"useGroupHP",e)}));const t=h.getTypicalHP(this.props.monster),a=u.modifierValue(this.props.monster.abilityScores.con)*this.props.monster.hitDice,s=this.props.monster.hitDice+a,r=this.props.monster.hitDice*u.hitDieType(this.props.monster.size)+a,i=[];return this.props.slotInfo.useGroupHP?i.push(n.a.createElement("div",{key:"hp"},this.getValueSection(s,r,this.props.slotInfo,"hp",()=>this.rollHP(null)),n.a.createElement("button",{className:this.props.slotInfo.hp!==t?"":"disabled",onClick:()=>this.props.changeValue(this.props.slotInfo,"hp",t)},"reset to average hp"))):this.props.slotInfo.members.forEach(e=>{i.push(n.a.createElement("div",{key:e.id},n.a.createElement("div",{className:"combatant-name"},e.name),this.getValueSection(s,r,e,"hp",()=>this.rollHP(e)),n.a.createElement("button",{className:e.hp!==t?"":"disabled",onClick:()=>this.props.changeValue(e,"hp",t)},"reset to average hp")))}),n.a.createElement("div",null,e,i)}getNameSection(){return this.props.slotInfo.members.map(e=>n.a.createElement(q,{key:e.id,text:e.name,onChange:t=>this.props.changeValue(e,"name",t)}))}getCountSection(){return n.a.createElement(j,{source:this.props.encounterSlot,name:"count",nudgeValue:e=>this.props.nudgeCount(this.props.encounterSlot.id,e)})}render(){let e=this.props.encounterSlot.monsterName,t=null;switch(this.props.view){case"init":e+=" (1d20 "+u.modifier(this.props.monster.abilityScores.dex)+")",t=this.getInitSection();break;case"hit points":e+=" ("+h.getTypicalHPString(this.props.monster)+")",t=this.getHPSection();break;case"names":t=this.getNameSection();break;case"count":t=this.getCountSection()}return n.a.createElement("div",{className:"group-panel combatant-setup"},n.a.createElement("div",{className:"subheading"},e),n.a.createElement("div",{className:"divider"}),t)}}const Me=["blinded","charmed","deafened","exhaustion","frightened","grappled","incapacitated","invisible","paralyzed","petrified","poisoned","prone","restrained","stunned","unconscious"];class Ie extends n.a.Component{render(){try{const e=this.props.items.map(e=>n.a.createElement(Te,{key:e.id,item:e,selected:this.props.selectedItemID===e.id,select:e=>this.props.select(e)}));return n.a.createElement("div",{className:"radio-group"},e)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}Ie.defaultProps={};class Te extends n.a.Component{render(){try{let e="radio-item",t=null;return this.props.selected&&(e+=" selected",this.props.item.details&&(t=n.a.createElement("div",{className:"radio-item-details"},this.props.item.details))),this.props.item.disabled&&(e+=" disabled"),n.a.createElement("div",{className:e,onClick:()=>this.props.select(this.props.item.id)},n.a.createElement("div",{className:"radio-item-text"},this.props.item.text),t)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ve extends n.a.Component{constructor(e){super(e),this.state={condition:e.condition}}setCondition(e){if(this.state.condition.name!==e){const t=this.state.condition;t.name=e,t.level=1,t.text="",this.setState({condition:t})}}setDuration(e){let t=null;switch(e){case"saves":t=g.createConditionDurationSaves();break;case"combatant":t=g.createConditionDurationCombatant();break;case"rounds":t=g.createConditionDurationRounds()}const a=this.state.condition;a.duration=t,this.setState({condition:a})}changeValue(e,t,a){e[t]=a,this.setState({condition:this.state.condition})}nudgeValue(e,t,a){let s=e[t]+a;"level"===t&&(s=Math.max(s,1),s=Math.min(s,6)),"count"===t&&(s=Math.max(s,1)),"saveDC"===t&&(s=Math.max(s,0)),e[t]=s,this.setState({condition:this.state.condition})}render(){try{const e=Me.map(e=>{const t=[],a=[];if(e===this.state.condition.name){"exhaustion"===e&&t.push(n.a.createElement(j,{key:"exhaustion-spin",source:this.props.condition,name:"level",label:"exhaustion",nudgeValue:e=>this.nudgeValue(this.props.condition,"level",e)}));const s=u.conditionText(this.state.condition);for(let e=0;e!==s.length;++e)a.push(n.a.createElement("li",{key:e,className:"section"},s[e]))}const s=this.props.combatants.filter(e=>"monster"===e.type).some(t=>!!t&&-1!==t.conditionImmunities.indexOf(e));return{id:e,text:e,details:n.a.createElement("div",{key:e},t,n.a.createElement("ul",null,a)),disabled:s}}),t=["str","dex","con","int","wis","cha","death"].map(e=>({id:e,text:e})),a=[{id:"start",text:"start of turn"},{id:"end",text:"end of turn"}],s=this.props.combat.combatants.map(e=>{const t=e;return{id:t.id,text:t.displayName||t.name||"unnamed monster"}}),r=[{id:"none",text:"until removed (default)",details:n.a.createElement("div",{className:"section"},n.a.createElement("div",null,"the condition persists until it is manually removed"))},{id:"saves",text:"until a successful save",details:n.a.createElement("div",null,n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"number of saves required"),n.a.createElement(j,{source:this.props.condition.duration,name:"count",nudgeValue:e=>this.nudgeValue(this.props.condition.duration,"count",e)})),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"save dc"),n.a.createElement(j,{source:this.props.condition.duration,name:"saveDC",nudgeValue:e=>this.nudgeValue(this.props.condition.duration,"saveDC",e)})),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"type of save"),n.a.createElement(se,{options:t,selectedID:this.props.condition.duration?this.props.condition.duration.saveType:null,select:e=>this.changeValue(this.props.condition.duration,"saveType",e)})),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"make the save at the start or end of the turn"),n.a.createElement(se,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:e=>this.changeValue(this.props.condition.duration,"point",e)})))},{id:"combatant",text:"until someone's next turn",details:n.a.createElement("div",null,n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"start or end of the turn"),n.a.createElement(se,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:e=>this.changeValue(this.props.condition.duration,"point",e)})),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"combatant"),n.a.createElement(A,{options:s,selectedID:this.props.condition.duration&&this.props.condition.duration.combatantID||void 0,select:e=>this.changeValue(this.props.condition.duration,"combatantID",e)})))},{id:"rounds",text:"for a number of rounds",details:n.a.createElement("div",null,n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"number of rounds"),n.a.createElement(j,{source:this.props.condition.duration,name:"count",nudgeValue:e=>this.nudgeValue(this.props.condition.duration,"count",e)})))}];return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement("div",{className:"subheading"},"condition"),n.a.createElement(Ie,{items:e,selectedItemID:this.state.condition.name,select:e=>this.setCondition(e)})),n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement("div",{className:"subheading"},"duration"),n.a.createElement(Ie,{items:r,selectedItemID:this.state.condition.duration?this.state.condition.duration.type:"none",select:e=>this.setDuration(e)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class De extends n.a.Component{render(){try{if(0===this.props.data.length)return null;const e=Math.max(...this.props.data.map(e=>e.value));let t;if(this.props.collapse)t=this.props.data.filter(e=>e.value>0);else{const e=this.props.data.find(e=>e.value>0);this.props.data.reverse();const a=this.props.data.find(e=>e.value>0);this.props.data.reverse();const s=e?this.props.data.indexOf(e):0,n=a?this.props.data.indexOf(a):this.props.data.length-1;t=this.props.data.slice(s,n+1)}const a=t.map(t=>n.a.createElement("div",{key:t.text,className:"bar-container"},n.a.createElement("div",{className:"bar",style:{width:"calc((100% - 1px) * "+t.value+" / "+e+")"}},n.a.createElement("div",{className:"label"},t.text,": ",this.props.display(t.value)))));return n.a.createElement("div",{className:"plot"},a)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}De.defaultProps={collapse:!1,display:e=>e.toString()};class Pe extends n.a.Component{constructor(e){super(e),this.state={chart:"challenge"}}selectChart(e){this.setState({chart:e})}render(){try{const e=[];if(this.props.groups.forEach(t=>t.monsters.forEach(t=>e.push(t))),0===e.length)return null;let t=[];switch(this.state.chart){case"challenge":t=[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].map(t=>({text:"cr "+u.challenge(t),value:e.filter(e=>e.challenge===t).length}));break;case"size":t=m.map(t=>({text:t,value:e.filter(e=>e.size===t).length}));break;case"type":t=d.map(t=>({text:t,value:e.filter(e=>e.category===t).length}))}const a=[{id:"challenge",text:"challenge rating"},{id:"size",text:"size"},{id:"type",text:"type"}];return n.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},n.a.createElement(se,{options:a,selectedID:this.state.chart,select:e=>this.selectChart(e)}),n.a.createElement(De,{data:t}))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Ae=a(264);class Oe extends n.a.Component{constructor(e){super(e),this.state={showContent:!0}}toggleContentVisible(){this.setState({showContent:!this.state.showContent})}render(){try{const e=this.props.content.filter(e=>!!e);if(0===e.length)return null;let t=null;if(this.props.heading){let e=null;if(this.props.showToggle){const t=this.state.showContent?"rotate":"";e=n.a.createElement(z.a,{className:t,onClick:()=>this.toggleContentVisible()})}t=n.a.createElement("div",{className:"heading fixed-top"},n.a.createElement("div",{className:"title"},this.props.heading),e)}let a=null;if(this.state.showContent){let t={xs:24,sm:24,md:12,lg:8,xl:6};switch(this.props.columns){case 1:t={xs:24,sm:24,md:24,lg:24,xl:24};break;case 2:t={xs:24,sm:24,md:12,lg:12,xl:12};break;case 3:t={xs:24,sm:24,md:8,lg:8,xl:8}}a=n.a.createElement(o.a,{align:"top"},e.map(a=>n.a.createElement(c.a,{key:e.indexOf(a),xs:t.xs,sm:t.sm,md:t.md,lg:t.lg,xl:t.xl},a)))}return n.a.createElement("div",{className:"grid-panel"},t,a)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}Oe.defaultProps={columns:0,heading:null,showToggle:!1};class ze extends n.a.Component{render(){try{const e=[];-1!==this.props.mode.indexOf("edit")&&(e.push(n.a.createElement("button",{key:"edit",onClick:()=>this.props.editPC(this.props.pc)},"edit pc")),this.props.pc.url&&e.push(n.a.createElement("button",{key:"import",onClick:()=>this.props.updatePC(this.props.pc)},"update pc from d&d beyond")),e.push(n.a.createElement("button",{key:"export",onClick:()=>this.props.exportPC(this.props.pc)},"export pc")),this.props.pc.active?e.push(n.a.createElement("button",{key:"toggle-active",onClick:()=>this.props.changeValue(this.props.pc,"active",!1)},"mark pc as inactive")):e.push(n.a.createElement("button",{key:"toggle-active",onClick:()=>this.props.changeValue(this.props.pc,"active",!0)},"mark pc as active")),e.push(n.a.createElement(w,{key:"remove",text:"delete pc",callback:()=>this.props.removePC(this.props.pc)})));let t=null;this.props.pc.companions.length>0&&(t=this.props.pc.companions.map(e=>n.a.createElement("div",{key:e.id},e.name)));const a=(this.props.pc?this.props.pc.displayName:null)||this.props.pc.name||"unnamed pc";return n.a.createElement("div",{className:"card pc"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},a)),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"stats"},n.a.createElement(J,{source:this.props.pc}),n.a.createElement("div",{className:"section centered lowercase"},n.a.createElement(V.a,null,this.props.pc.race||"unknown race"),n.a.createElement(V.a,null,this.props.pc.classes||"unknown class"),n.a.createElement(V.a,null,"level "+this.props.pc.level)),n.a.createElement("div",{className:"section centered",style:{display:this.props.pc.url?"":"none"}},n.a.createElement("a",{href:this.props.pc.url,target:"_blank",rel:"noopener noreferrer"},"d&d beyond sheet")),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section subheading"},"languages"),n.a.createElement("div",{className:"section"},this.props.pc.languages||"-"),n.a.createElement("div",{className:"section subheading"},"passive skills"),n.a.createElement("div",{className:"section"},n.a.createElement("div",null,n.a.createElement("b",null,"insight")," ",this.props.pc.passiveInsight),n.a.createElement("div",null,n.a.createElement("b",null,"investigation")," ",this.props.pc.passiveInvestigation),n.a.createElement("div",null,n.a.createElement("b",null,"perception")," ",this.props.pc.passivePerception)),n.a.createElement("div",{style:{display:this.props.pc.companions.length>0?"":"none"}},n.a.createElement("div",{className:"section subheading"},"companions"),n.a.createElement("div",{className:"section"},t))),n.a.createElement("div",{style:{display:e.length>0?"":"none"}},n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},e))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}ze.defaultProps={changeValue:null,nudgeValue:null,removePC:null,editPC:null,updatePC:null,exportPC:null};class Le extends n.a.Component{render(){try{if(!this.props.source)return null;let e=null;switch(this.props.source.type){case"pc":e=n.a.createElement(ze,{pc:this.props.source,mode:"view"});break;case"monster":e=n.a.createElement(ae,{monster:this.props.source,mode:"full"})}return n.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},e)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ge extends n.a.Component{constructor(e){super(e),this.state={encounter:e.encounter,filter:g.createMonsterFilter(),selectedMonster:null,randomEncounterXP:1e3}}setSelectedMonster(e){this.setState({selectedMonster:e})}setRandomEncounterXP(e){this.setState({randomEncounterXP:Math.max(0,e)})}addWave(){const e=g.createEncounterWave();e.name="wave "+(this.state.encounter.waves.length+2),this.state.encounter.waves.push(e),this.setState({encounter:this.state.encounter})}removeWave(e){const t=this.state.encounter.waves.indexOf(e);this.state.encounter.waves.splice(t,1),this.setState({encounter:this.state.encounter})}buildEncounter(){const e=this.state.encounter;e.slots=[],e.waves=[],N.buildEncounter(e,this.state.randomEncounterXP,this.state.filter,this.props.library,this.props.getMonster),this.sortEncounterSlots(e),e.waves.forEach(e=>this.sortEncounterSlots(e)),this.setState({encounter:e})}clearEncounter(){const e=this.state.encounter;e.slots=[],e.waves=[],this.setState({encounter:e})}addEncounterSlot(e,t){const a=this.props.library.find(t=>t.monsters.includes(e));if(a){const s=g.createEncounterSlot();if(s.monsterGroupName=a.name,s.monsterName=e.name,null!==t){const e=this.state.encounter.waves.find(e=>e.id===t);e&&(e.slots.push(s),this.sortEncounterSlots(e))}else this.state.encounter.slots.push(s),this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}}sortEncounterSlots(e){const t=[];e.slots.forEach(e=>{let a=t.find(t=>t.monsterGroupName===e.monsterGroupName&&t.monsterName===e.monsterName);a?a.count+=e.count:(a=e,t.push(e))}),e.slots=t,e.slots.sort((e,t)=>{const a=e.monsterName.toLowerCase(),s=t.monsterName.toLowerCase();return a<s?-1:a>s?1:0})}removeEncounterSlot(e,t){if(t){const a=this.state.encounter.waves.find(e=>e.id===t);if(a){const t=a.slots.indexOf(e);a.slots.splice(t,1)}}else{const t=this.state.encounter.slots.indexOf(e);this.state.encounter.slots.splice(t,1)}this.setState({encounter:this.state.encounter})}swapEncounterSlot(e,t,a,s){if(e.monsterGroupName=a,e.monsterName=s,t){const e=this.state.encounter.waves.find(e=>e.id===t);e&&this.sortEncounterSlots(e)}else this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}moveToWave(e,t,a){const s=t.indexOf(e);if(t.splice(s,1),a){const t=this.state.encounter.waves.find(e=>e.id===a);t&&(t.slots.push(e),this.sortEncounterSlots(t))}else this.state.encounter.slots.push(e),this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}changeValue(e,t,a){e[t]=a,this.setState({encounter:this.state.encounter})}nudgeValue(e,t,a){let s=e[t];s+=a,this.changeValue(e,t,s)}changeFilterValue(e,t){const a=this.state.filter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({filter:a})}resetFilter(){this.setState({filter:g.createMonsterFilter()})}getMonsterCards(e,t){const a=[];return e.forEach(e=>{const s=this.props.getMonster(e.monsterName,e.monsterGroupName);s?a.push(n.a.createElement(ae,{monster:s,slot:e,encounter:this.props.encounter,mode:"encounter",library:this.props.library,nudgeValue:(e,t,a)=>this.nudgeValue(e,t,a),viewMonster:e=>this.setSelectedMonster(e),removeEncounterSlot:e=>this.removeEncounterSlot(e,t),swapEncounterSlot:(e,a,s)=>this.swapEncounterSlot(e,t,a,s),moveToWave:(e,t,a)=>this.moveToWave(e,t,a)})):a.push(n.a.createElement("div",{className:"card error"},n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"subheading"},"unknown monster"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"could not find a monster called '",n.a.createElement("b",null,e.monsterName),"' in a group called '",n.a.createElement("b",null,e.monsterGroupName,"'")),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.removeEncounterSlot(e,t)},"remove"))))}),0===e.length&&(t?a.push(n.a.createElement(Z,null,"there are no monsters in this wave")):a.push(n.a.createElement(Z,null,n.a.createElement("p",null,"there are no monsters in this encounter"),n.a.createElement("p",null,"you can add monsters from the list below, or try 'build a random encounter'")))),a}getLibrarySection(){const e=[];this.props.library.forEach(t=>{t.monsters.forEach(t=>{N.matchMonster(t,this.state.filter)&&e.push(t)})}),e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);const t=e.map(e=>n.a.createElement(ae,{key:e.id,monster:e,encounter:this.props.encounter,library:this.props.library,mode:"encounter",viewMonster:e=>this.setSelectedMonster(e),addEncounterSlot:(e,t)=>this.addEncounterSlot(e,t)}));return 0===t.length&&t.push(n.a.createElement(Z,null,n.a.createElement("p",null,"there are no monsters that meet the criteria ",n.a.createElement("i",null,N.getFilterDescription(this.state.filter))))),n.a.createElement(Oe,{heading:"monster library",content:t,columns:3,showToggle:!0})}render(){try{const e=this.props.encounter.waves.map(e=>n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement(q,{text:e.name,placeholder:"wave name",onChange:t=>this.changeValue(e,"name",t)}),n.a.createElement(w,{text:"delete wave",callback:()=>this.removeWave(e)}))),t=this.props.encounter.waves.map(e=>n.a.createElement(Oe,{key:e.id,heading:e.name||"unnamed wave",content:this.getMonsterCards(e.slots,e.id),columns:3}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:8,className:"scrollable sidebar sidebar-left"},n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"encounter name"),n.a.createElement(q,{text:this.props.encounter.name,placeholder:"encounter name",onChange:e=>this.changeValue(this.props.encounter,"name",e)})),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"waves"),e,n.a.createElement("button",{onClick:()=>this.addWave()},"add a new wave")),n.a.createElement("div",{className:"divider"}),n.a.createElement(re,{encounter:this.props.encounter,parties:this.props.parties,getMonster:(e,t)=>this.props.getMonster(e,t)}),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement(ie,{filter:this.state.filter,changeValue:(e,t)=>this.changeFilterValue(e,t),resetFilter:()=>this.resetFilter()})),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement(G,{text:"build a random encounter"},n.a.createElement("p",null,"add random monsters to this encounter until its (effective) xp value is at least the following value"),n.a.createElement(Ae.a,{value:this.state.randomEncounterXP,min:0,step:1e3,onChange:e=>this.setRandomEncounterXP(e||0)}),n.a.createElement("button",{onClick:()=>this.buildEncounter()},"build encounter")),n.a.createElement(w,{text:"clear encounter",callback:()=>this.clearEncounter()}))),n.a.createElement(c.a,{span:16,className:"scrollable"},n.a.createElement(Oe,{columns:3,content:this.getMonsterCards(this.props.encounter.slots,null),heading:"encounter"}),t,this.getLibrarySection()),n.a.createElement(l.a,{visible:!!this.state.selectedMonster,width:"50%",closable:!1,onClose:()=>this.setSelectedMonster(null)},n.a.createElement(Le,{source:this.state.selectedMonster})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Re=a(282),Be=a(281),je=a(280),He=a(279);class qe extends n.a.Component{click(e,t,a=null){e.stopPropagation(),this.props.click(t,a)}render(){try{let e="radial "+(this.props.direction||"out");this.props.disabled&&(e+=" disabled");const t="out"===this.props.direction||"both"===this.props.direction||"eight"===this.props.direction,a="in"===this.props.direction||"both"===this.props.direction,s="eight"===this.props.direction;return n.a.createElement("div",{className:e},n.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),n.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},n.a.createElement("div",{className:"arrow diag",style:{display:t?"block":"none"},onClick:e=>this.click(e,"NW")},n.a.createElement(Re.a,{rotate:-45}))),n.a.createElement("div",{className:"cell"},n.a.createElement("div",{className:"arrow vertical",style:{display:t?"block":"none"},onClick:e=>this.click(e,"N","out")},n.a.createElement(Re.a,null)),n.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:e=>this.click(e,"N","in")},n.a.createElement(Be.a,null))),n.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),n.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},n.a.createElement("div",{className:"arrow diag",style:{display:t?"block":"none"},onClick:e=>this.click(e,"NE")},n.a.createElement(Re.a,{rotate:45}))),n.a.createElement("div",{className:"cell"},n.a.createElement("div",{className:"arrow horizontal",style:{display:t?"inline-block":"none"},onClick:e=>this.click(e,"W","out")},n.a.createElement(je.a,null)),n.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:e=>this.click(e,"W","in")},n.a.createElement(He.a,null))),n.a.createElement("div",{className:"cell"}),n.a.createElement("div",{className:"cell"},n.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:e=>this.click(e,"E","in")},n.a.createElement(je.a,null)),n.a.createElement("div",{className:"arrow horizontal",style:{display:t?"inline-block":"none"},onClick:e=>this.click(e,"E","out")},n.a.createElement(He.a,null))),n.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),n.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},n.a.createElement("div",{className:"arrow diag",style:{display:t?"block":"none"},onClick:e=>this.click(e,"SW")},n.a.createElement(Be.a,{rotate:45}))),n.a.createElement("div",{className:"cell"},n.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:e=>this.click(e,"S","in")},n.a.createElement(Re.a,null)),n.a.createElement("div",{className:"arrow vertical",style:{display:t?"block":"none"},onClick:e=>this.click(e,"S","out")},n.a.createElement(Be.a,null))),n.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),n.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},n.a.createElement("div",{className:"arrow diag",style:{display:t?"block":"none"},onClick:e=>this.click(e,"SE","out")},n.a.createElement(Be.a,{rotate:-45}))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}qe.defaultProps={direction:"out",disabled:!1};class Fe extends n.a.Component{constructor(e){super(e),this.state={images:this.listImages(),filter:""}}listImages(){const e=[];for(let t=0;t!==localStorage.length;++t){const a=localStorage.key(t);if(a&&a.startsWith("image-")){const t=localStorage.getItem(a);if(t){const a=JSON.parse(t);e.push({id:a.id,name:a.name,data:a.data})}}}return u.sort(e,[{field:"name",dir:"asc"}])}setFilter(e){this.setState({filter:e})}onFileSelected(e){if(e.target.files){const t=new FileReader;t.onload=e=>{if(e.target){const t=e.target.result,s={id:u.guid(),name:a.name,data:t},n=JSON.stringify(s);localStorage.setItem("image-"+s.id,n),this.setState({images:this.listImages()})}};const a=e.target.files[0];t.readAsDataURL(a)}}delete(e){localStorage.removeItem("image-"+e),this.setState({images:this.listImages()})}render(){try{const e=this.state.images.filter(e=>f.match(this.state.filter,e.name)).map(e=>n.a.createElement("div",{key:e.id},n.a.createElement("div",{className:"subheading"},e.name),n.a.createElement("img",{className:"selectable-image",src:e.data,alt:e.name,onClick:()=>this.props.select(e.id)}),n.a.createElement("button",{onClick:()=>this.delete(e.id)},"delete this image")));return 0===e.length&&e.push(n.a.createElement(Z,{key:"empty"},"no images")),this.state.images.length>0&&e.unshift(n.a.createElement(H.a.Search,{key:"search",value:this.state.filter,placeholder:"search for an image",allowClear:!0,onChange:e=>this.setFilter(e.target.value),onSearch:e=>this.setFilter(e)})),n.a.createElement("div",{className:"full-height"},n.a.createElement("div",{className:"drawer-header"},n.a.createElement("div",{className:"app-title"},"select image")),n.a.createElement("div",{className:"drawer-content"},n.a.createElement("div",{className:"scrollable"},n.a.createElement("button",{onClick:()=>document.getElementById("file-upload").click()},"add a new image"),n.a.createElement("input",{type:"file",id:"file-upload",accept:"image/*",style:{display:"none"},onChange:e=>this.onFileSelected(e)}),e)),n.a.createElement("div",{className:"drawer-footer"},n.a.createElement("button",{onClick:()=>this.props.cancel()},"cancel")))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class We extends n.a.Component{constructor(e){super(e),this.state={map:e.map,selectedTileID:null,addingTile:null,mapSize:30,showImageSelection:!1}}setSelectedTileID(e){this.setState({selectedTileID:e})}setAddingTile(e){let t=null;switch(e){case"room":t=g.createMapItem(),t.terrain="default",t.width=6,t.height=6,t.style="square";break;case"corridor":t=g.createMapItem(),t.terrain="default",t.width=6,t.height=2,t.style="square";break;case"door":t=g.createMapItem(),t.terrain="default",t.width=2,t.height=1,t.style="square",t.content={type:"doorway",style:"single",orientation:"horizontal"};break;case"stairs":t=g.createMapItem(),t.terrain="default",t.width=4,t.height=2,t.style="square",t.content={type:"stairway",style:"stairs",orientation:"vertical"}}t&&0===this.state.map.items.length?(t.x=0,t.y=0,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})):this.setState({addingTile:t})}moveAddedTile(e,t){const a=this.state.addingTile;a&&(a.x=e,a.y=t,this.setState({addingTile:a}))}nudgeMapSize(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}toggleImageSelection(){this.setState({showImageSelection:!this.state.showImageSelection})}addMapTile(e,t){if(this.state.addingTile){const a=this.state.addingTile;a.x=e,a.y=t,this.state.map.items.push(a),this.setState({map:this.state.map,selectedTileID:a.id,addingTile:null})}}moveMapItem(e,t){switch(t){case"N":e.y-=1;break;case"NE":e.x+=1,e.y-=1;break;case"E":e.x+=1;break;case"SE":e.x+=1,e.y+=1;break;case"S":e.y+=1;break;case"SW":e.x-=1,e.y+=1;break;case"W":e.x-=1;break;case"NW":e.x-=1,e.y-=1}this.setState({map:this.state.map})}bigMapItem(e,t){switch(t){case"N":e.y-=1,e.height+=1;break;case"E":e.width+=1;break;case"S":e.height+=1;break;case"W":e.x-=1,e.width+=1}this.setState({map:this.state.map})}smallMapItem(e,t){switch(t){case"N":e.height>1&&(e.y+=1,e.height-=1);break;case"E":e.width>1&&(e.width-=1);break;case"S":e.height>1&&(e.height-=1);break;case"W":e.width>1&&(e.x+=1,e.width-=1)}this.setState({map:this.state.map})}resizeMapItem(e,t,a){switch(a){case"in":this.smallMapItem(e,t);break;case"out":this.bigMapItem(e,t)}}rotateMapItem(e){const t=e.width;e.width=e.height,e.height=t;const a=Math.floor((e.width-e.height)/2);e.x-=a,e.y+=a,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal"),this.setState({map:this.state.map,addingTile:this.state.addingTile})}sendToBack(e){const t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.unshift(e),this.setState({map:this.state.map})}bringToFront(e){const t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.push(e),this.setState({map:this.state.map})}cloneMapItem(e){const t=JSON.parse(JSON.stringify(e));t.id=u.guid(),t.x+=1,t.y+=1,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})}pickUpMapItem(e){const t=this.state.map,a=t.items.indexOf(e);t.items.splice(a,1),this.setState({map:t,selectedTileID:null,addingTile:e})}removeMapItem(e){const t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.setState({map:this.state.map,selectedTileID:null})}setCustomImage(e){const t=this.state.map.items.find(e=>e.id===this.state.selectedTileID);t&&this.changeValue(t,"customBackground",e)}rotateMap(){y.rotateMap(this.state.map),this.setState({map:this.state.map})}clearMap(){const e=this.state.map;e.items=[],this.setState({map:e,selectedTileID:null})}generate(e){y.generate(e,this.state.map),this.setState({map:this.state.map})}addNote(e){const t=g.createMapNote();t.targetID=e,this.state.map.notes.push(t),this.setState({map:this.state.map})}removeNote(e){const t=this.state.map.notes.findIndex(t=>t.targetID===e);this.state.map.notes.splice(t,1),this.setState({map:this.state.map})}changeValue(e,t,a){e[t]=a,this.setState({map:this.state.map,showImageSelection:!1})}nudgeValue(e,t,a){let s=e[t];s+=a,"width"!==t&&"height"!==t||(s=Math.max(s,1)),this.changeValue(e,t,s)}render(){try{let e=null;if(this.state.selectedTileID){const t=this.state.map.items.find(e=>e.id===this.state.selectedTileID);if(t){const a=y.getNote(this.state.map,t);e=n.a.createElement(Ye,{tile:t,note:a,toggleImageSelection:()=>this.toggleImageSelection(),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.nudgeValue(e,t,a),move:(e,t)=>this.moveMapItem(e,t),resize:(e,t,a)=>this.resizeMapItem(e,t,a),clone:e=>this.cloneMapItem(e),pickUp:e=>this.pickUpMapItem(e),remove:e=>this.removeMapItem(e),rotate:e=>this.rotateMapItem(e),sendToBack:e=>this.sendToBack(e),bringToFront:e=>this.bringToFront(e),addNote:e=>this.addNote(e),removeNote:e=>this.removeNote(e)})}}else e=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"map name"),n.a.createElement(q,{text:this.state.map.name,placeholder:"map name",onChange:e=>this.changeValue(this.state.map,"name",e)}),n.a.createElement("div",{className:"divider"}),n.a.createElement(Z,null,n.a.createElement("p",null,"to add a new tile to the map, click on one of the buttons below"),n.a.createElement("p",null,"to edit an existing tile, click on it to select it")),n.a.createElement("div",{className:"divider"}),this.state.addingTile?n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.setAddingTile(null)},"click somewhere on the map to lock the tile in place, or click here to remove it from the map"),n.a.createElement("button",{onClick:()=>this.rotateMapItem(this.state.addingTile)},"rotate tile")):n.a.createElement("div",null,n.a.createElement("div",{className:"section subheading"},"add a... "),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("button",{onClick:()=>this.setAddingTile("room")},"room tile")),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("button",{onClick:()=>this.setAddingTile("corridor")},"corridor tile")),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("button",{onClick:()=>this.setAddingTile("door")},"door tile")),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("button",{onClick:()=>this.setAddingTile("stairs")},"stairs tile"))),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.generate("room")},"add a random room"),n.a.createElement("button",{onClick:()=>this.rotateMap()},"rotate the map"),n.a.createElement(w,{text:"clear all tiles",callback:()=>this.clearMap()})));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:8,className:"scrollable sidebar sidebar-left"},e),n.a.createElement(c.a,{span:16,className:"scrollable both-ways"},n.a.createElement(j,{source:this.state,name:"mapSize",display:()=>"zoom",nudgeValue:e=>this.nudgeMapSize(3*e)}),n.a.createElement(he,{map:this.state.map,mode:"edit",size:this.state.mapSize,selectedItemIDs:this.state.selectedTileID?[this.state.selectedTileID]:[],showOverlay:!!this.state.addingTile,floatingItem:this.state.addingTile,itemSelected:(e,t)=>this.setSelectedTileID(e),gridSquareEntered:(e,t)=>this.moveAddedTile(e,t),gridSquareClicked:(e,t)=>this.addMapTile(e,t)})),n.a.createElement(l.a,{visible:this.state.showImageSelection,closable:!1,onClose:()=>this.toggleImageSelection()},n.a.createElement(Fe,{select:e=>this.setCustomImage(e),cancel:()=>this.toggleImageSelection()})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ye extends n.a.Component{constructor(e){super(e),this.state={view:"position"}}setView(e){this.setState({view:e})}getPositionSection(){return n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"move"),n.a.createElement("div",{className:"section centered"},n.a.createElement(qe,{direction:"eight",click:e=>this.props.move(this.props.tile,e)})),n.a.createElement("div",{className:"subheading"},"size"),n.a.createElement("div",{className:"section"},5*this.props.tile.width," ft x ",5*this.props.tile.height," ft"),n.a.createElement("div",{className:"section"},n.a.createElement(j,{source:this.props.tile,name:"width",label:"width",display:e=>e+" sq",nudgeValue:e=>this.props.nudgeValue(this.props.tile,"width",e)}),n.a.createElement(j,{source:this.props.tile,name:"height",label:"height",display:e=>e+" sq",nudgeValue:e=>this.props.nudgeValue(this.props.tile,"height",e)})),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.sendToBack(this.props.tile)},"send to back"),n.a.createElement("button",{onClick:()=>this.props.bringToFront(this.props.tile)},"bring to front"))}getStyleSection(){const e=b.map(e=>({id:e,text:e}));let t=null;"custom"===this.props.tile.terrain&&(t=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"custom image"),n.a.createElement("button",{onClick:()=>this.props.toggleImageSelection()},"select image"),n.a.createElement("button",{onClick:()=>this.props.changeValue(this.props.tile,"customBackground","")},"clear image")));const a=["square","rounded","circle"].map(e=>({id:e,text:e}));return n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"terrain"),n.a.createElement(A,{options:e,placeholder:"select terrain",selectedID:this.props.tile.terrain?this.props.tile.terrain:void 0,select:e=>this.props.changeValue(this.props.tile,"terrain",e)}),t,n.a.createElement("div",{className:"subheading"},"shape"),n.a.createElement(se,{options:a,selectedID:this.props.tile.style,select:e=>this.props.changeValue(this.props.tile,"style",e)}),n.a.createElement("div",{className:"subheading"},"content"),n.a.createElement(Ie,{items:[{id:"none",text:"none"},{id:"doorway",text:"doorway",details:n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("b",null,"style")),n.a.createElement(se,{options:E.map(e=>({id:e,text:e})),itemsPerRow:2,selectedID:this.props.tile.content?this.props.tile.content.style:null,select:e=>this.props.changeValue(this.props.tile.content,"style",e)}),n.a.createElement("div",null,n.a.createElement("b",null,"orientation")),n.a.createElement(se,{options:["horizontal","vertical"].map(e=>({id:e,text:e})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:e=>this.props.changeValue(this.props.tile.content,"orientation",e)}))},{id:"stairway",text:"stairway",details:n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("b",null,"style")),n.a.createElement(se,{options:v.map(e=>({id:e,text:e})),selectedID:this.props.tile.content?this.props.tile.content.style:null,select:e=>this.props.changeValue(this.props.tile.content,"style",e)}),n.a.createElement("div",null,n.a.createElement("b",null,"orientation")),n.a.createElement(se,{options:["horizontal","vertical"].map(e=>({id:e,text:e})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:e=>this.props.changeValue(this.props.tile.content,"orientation",e)}))}],selectedItemID:this.props.tile.content?this.props.tile.content.type:"none",select:e=>{let t=null;if("none"!==e){let a="";switch(e){case"doorway":a=E[0];break;case"stairway":a=v[0]}t={type:e,orientation:"horizontal",style:a}}this.props.changeValue(this.props.tile,"content",t)}}))}getNotesSection(){return this.props.note?n.a.createElement("div",null,n.a.createElement(q,{text:this.props.note.text,placeholder:"details",minLines:5,maxLines:10,onChange:e=>this.props.changeValue(this.props.note,"text",e)}),n.a.createElement("button",{onClick:()=>this.props.removeNote(this.props.tile.id)},"remove note from this tile")):n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.props.addNote(this.props.tile.id)},"add a note to this tile"))}render(){try{const e=["position","style","notes"].map(e=>({id:e,text:e}));let t=null;switch(this.state.view){case"position":t=this.getPositionSection();break;case"style":t=this.getStyleSection();break;case"notes":t=this.getNotesSection()}return n.a.createElement("div",{className:"card map"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},"map tile")),n.a.createElement("div",{className:"card-content"},n.a.createElement(se,{options:e,selectedID:this.state.view,select:e=>this.setView(e)}),n.a.createElement("div",{className:"divider"}),t,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("button",{onClick:()=>this.props.rotate(this.props.tile)},"rotate tile"),n.a.createElement("button",{onClick:()=>this.props.clone(this.props.tile)},"clone tile"),n.a.createElement("button",{onClick:()=>this.props.pickUp(this.props.tile)},"pick up tile"),n.a.createElement("button",{onClick:()=>this.props.remove(this.props.tile)},"remove tile"))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Je=a(278),_e=a(125);class Xe{static initModel(e){const t=[];let a=0;e.forEach(e=>{e.split(/\r?\n/).forEach(e=>{e&&(Xe.addLineToModel(e,t),a=Math.max(a,e.length))})}),Xe.model=t,Xe.maxLength=a}static addLineToModel(e,t){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);for(let a=2;a!==e.length;++a){const s=e.substr(a-2,2),n=e.substr(a,1);let r=t.find(e=>e.prev===s);r||(r={prev:s,freq:[]},t.push(r));let i=r.freq.find(e=>e.char===n);i||(i={char:n,count:0},r.freq.push(i)),i.count+=1}}static generate(e){const t=[];let a=0;for(;t.length<e&&a<100;){const e=Xe.extractLine();if(e&&!t.map(e=>e.line).includes(e)&&e.length<=Xe.maxLength){const a=Xe.fit(e);t.push({line:e,fit:a})}else a+=1}return t}static extractLine(){let e=String.fromCharCode(0,1);for(;;){const t=e.substr(e.length-2,2),a=Xe.model.find(e=>e.prev===t);if(!a)return null;{let t="";a.freq.forEach(e=>{t+=e.char.repeat(e.count)});const s=Math.floor(Math.random()*t.length);let n=t[s];if(n===String.fromCharCode(2))return e=e.substr(2),e;if(1===u.dieRoll()){["bdg","ptk","sz","aeiouy","lr","ckq","vf"].forEach(e=>{if(e.includes(n)){const t=Math.floor(Math.random()*e.length);n=e[t]}})}e+=n}}}static fit(e){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);const t=[];for(let a=2;a!==e.length;++a){const s=e.substr(a-2,2),n=e[a],r=Xe.model.find(e=>e.prev===s);if(r){const e=r.freq.find(e=>e.char===n);if(e){const a=r.freq.reduce((e,t)=>Math.max(e,t.count),0),s=e.count/a;t.push(s)}else t.push(0)}}return t.reduce((e,t)=>e+t,0)/t.length}static startsWithVowel(e){let t=!1;return["a","e","i","o","u"].forEach(a=>{e.toLowerCase().startsWith(a)&&(t=!0)}),t}static getMultipleValues(e){const t=[];for(;0!==u.randomNumber(3);)t.push(e[u.randomNumber(e.length)]);return t.join(", ")}static generateName(){const e=["As Has Khe Zash Gl Ig Iv Kos Miv Pav Ser Dar Even Gor Rand Sto Tam Barer Keth Mum","Mar Burg Al Hel Wrayt S Eag Eath Joan Answ L Ot Ced At Tal Ham Jasm Mail Yash Row","Adr Alber Ba Bar Gar Kildr Kath Dies Eld Gurd Har Morg Or Rur Mar Vis Jen Torg Tak Thor End Ris Em Gunn","Ad All Aram Berri Car Enial Gann Im Per Sorvi Var Adr An Beth Bir Jelen Key Lesh Mer Mia Naiv Quel Sar Shan","Al An C Cor Eld Er Finn Gar Lin Mer Os Per Ros An Cal Cor Kith Lav Ned Pae Seraph T V Chen","Are Bala Bhar Don Gh Hesk Med Meh Nad Pand Patr Sham Shed Ak Bir Farid Fla Ka Ko Mish Thav Uad Eder Hener","Alu Stos Fa Ravay Leo Stok Vic El Yeng Car Ric Ar Guir Es My Pey"].join(" ").toLowerCase().split(" "),t=["Eir Eid Eed El Ar An Or Ef Al Vin Orn Dur Stag Elm Ur Us","Ik Ich Ern End Tor Nor In Rak Gen Sik Gran Linn Vok Brek Dal Gar","An Ar Il Rian Ric Is Dan Arai Meral Cian En Rion Ialis Ior Nan Kas","Ton Der Ade Rin Don Rich Nan Ret Al Born Coe By Fire Yas Dal Yle","Han Asar Ash Aar Esch An Rash En Arr Jed Rin Gar Ash Dinn Hun Rek","Orel Aadi Ahn Aver Eiros Kain Retor Lannan Pet Ikos","Er Ey A E Il Elia Ya Ed Eue Ild Oane Yne Orna Ie Ala Erri Ea Ia","Ber Tin Hild Dryn A Eth Runn Ellen Loda Dis Ja Lin Ra Tyrd De Rasa","Rie Aea Striana Inua Rynna Ilia Na Neth Leth Iel Lee Qui Astra Ia Ania Ynn","Dry Ree Lie Ora Emia Ian Ri Inia Ina Aena Ani Erna Lyse La Da Aela","Ra Ir Eh Ann Ilar Rinn Ann La Ra A Ina Va Hit Ederei Ere Eila","Ina Ceryn Vyn Ella Aella Vyre"].join(" ").toLowerCase().split(" "),a=Math.floor(Math.random()*e.length),s=Math.floor(Math.random()*t.length);let n="";if(1===u.dieRoll(10)){const e=["-","'"];n=e[Math.floor(Math.random()*e.length)]}return e[a]+n+t[s]}static generatePotion(){let e="";const t=Xe.potionColour(!0),a=Xe.potionLiquid(),s=Xe.potionAdjective(),n=Xe.potionFeature();switch(u.randomNumber(5)){case 0:e=t+" "+a;break;case 1:e=t+" "+a+" "+n;break;case 2:e=s+" "+t+" "+a;break;case 3:e=s+" "+t+" "+a+" "+n;break;case 4:e=s+" "+a+", "+t+" "+n}switch(e=(Xe.startsWithVowel(e)?"an":"a")+" "+e+" in "+Xe.potionContainer(),u.randomNumber(6)){case 0:e+="; it smells "+Xe.potionSmell();break;case 1:e+="; it tastes "+Xe.potionSmell();break;case 2:e+="; it smells "+Xe.potionSmell()+" but tastes "+Xe.potionSmell();break;case 3:e+="; it smells and tastes "+Xe.potionSmell()}return e}static generateBookTitle(){let e="";const t=Xe.bookNounPhrase(u.randomBoolean(),u.randomBoolean());switch(u.randomNumber(5)){case 0:e=t+"'s "+Xe.bookNounPhrase(u.randomBoolean(),!1);break;case 1:e=t+" "+Xe.bookPreposition()+" "+Xe.bookNounPhrase(u.randomBoolean(),!0);break;case 2:e=Xe.bookGerund()+" "+Xe.bookNounPhrase(u.randomBoolean(),!0);break;case 3:e=Xe.bookAbout()+" "+t;break;case 4:e=t}if(0===u.randomNumber(10)&&(e+=": "+Xe.bookAbout()+" "+Xe.bookNounPhrase(u.randomBoolean(),u.randomBoolean())),0===u.randomNumber(10)){let t="";switch(u.randomNumber(3)){case 0:t="volume";break;case 1:t="part";break;case 2:t="book"}switch(u.randomNumber(5)){case 0:e+=", "+t+" one";break;case 1:e+=", "+t+" two";break;case 2:e+=", "+t+" three";break;case 3:e+=", "+t+" four";break;case 4:e+=", "+t+" five"}}return e}static generateNPC(){const e=["elderly","middle-aged","teenage","youthful","young","old"],t=e[u.randomNumber(e.length)],a=["apothecary","architect","armourer","arrowsmith","astrologer","baker","barber","lawyer","beggar","bellfounder","blacksmith","bookbinder","brewer","bricklayer","butcher","carpenter","carter","cartwright","chandler","peddler","clerk","clockmaker","cobbler","cook","cooper","merchant","embroiderer","engraver","fisherman","fishmonger","forester","furrier","gardener","gemcutter","glassblower","goldsmith","grocer","haberdasher","stableman","courtier","herbalist","innkeeper","ironmonger","labourer","painter","locksmith","mason","messenger","miller","miner","minstrel","ploughman","farmer","porter","sailor","scribe","seamstress","shepherd","shipwright","soapmaker","tailor","tinker","vintner","weaver"],s=a[u.randomNumber(a.length)];let n="";switch(u.randomNumber(3)){case 0:case 1:n=s;break;case 2:n=t+" "+s}n=(Xe.startsWithVowel(n)?"an":"a")+" "+n;const r=["gangly","gigantic","hulking","lanky","short","small","stumpy","tall","tiny","willowy"],i=r[u.randomNumber(r.length)],o=["broad-shouldered","fat","gaunt","obese","plump","pot-bellied","rotund","skinny","slender","slim","statuesque","stout","thin"],c=o[u.randomNumber(o.length)];let l="";switch(u.randomNumber(4)){case 0:case 1:l=i+" and "+c;break;case 2:l=i;break;case 3:l=c}const m=["short","cropped","long","braided","dreadlocked","shoulder-length","wiry","balding","receeding","curly","tightly-curled","straight","greasy","limp","sparse","thinning","wavy"],d=["black","brown","dark brown","light brown","red","ginger","strawberry blonde","blonde","ash blonde","graying","silver","white","gray","auburn"],p=m[u.randomNumber(m.length)]+" "+d[u.randomNumber(d.length)];let h="";switch(u.randomNumber(4)){case 0:case 1:h=n+", "+l+" with "+p+" hair";break;case 2:h=n+" with "+p+" hair";break;case 3:h=n+", "+l}return h}static generateNPCPhysical(){return Xe.getMultipleValues(["bearded","buck-toothed","chiselled","doe-eyed","fine-featured","florid","gap-toothed","goggle-eyed","grizzled","jowly","jug-eared","pock-marked","broken nose","red-cheeked","scarred","squinting","thin-lipped","toothless","weather-beaten","wrinkled"])}static generateNPCMental(){return Xe.getMultipleValues(["hot-tempered","overbearing","antagonistic","haughty","elitist","proud","rude","aloof","mischievous","impulsive","lusty","irreverent","madcap","thoughtless","absent-minded","insensitive","brave","craven","shy","fearless","obsequious","inquisitive","prying","intellectual","perceptive","keen","perfectionist","stern","harsh","punctual","driven","trusting","kind-hearted","forgiving","easy-going","compassionate","miserly","hard-hearted","covetous","avaricious","thrifty","wastrel","spendthrift","extravagant","kind","charitable","gloomy","morose","compulsive","irritable","vengeful","honest","truthful","innocent","gullible","bigoted","biased","narrow-minded","cheerful","happy","diplomatic","pleasant","foolhardy","affable","fatalistic","depressing","cynical","sarcastic","realistic","secretive","retiring","practical","level-headed","dull","reverent","scheming","paranoid","cautious","deceitful","nervous","uncultured","boorish","barbaric","graceless","crude","cruel","sadistic","immoral","jealous","belligerent","argumentative","arrogant","careless","curious","exacting","friendly","greedy","generous","moody","naive","opinionated","optimistic","pessimistic","quiet","sober","suspicious","uncivilised","violent","peaceful"])}static generateNPCSpeech(){return Xe.getMultipleValues(["accented","articulate","garrulous","breathless","crisp","gutteral","high-pitched","lisping","loud","nasal","slow","fast","squeaky","stuttering","wheezy","whiny","whispery","soft-spoken","laconic","blustering"])}static generateTreasure(){let e="";const t=["diamond","ruby","sapphire","emerald","amethyst","garnet","topaz","pearl","black pearl","opal","fire opal","amber","coral","agate","carnelian","jade","peridot","moonstone","alexandrite","aquamarine","jacinth","marble"];switch(u.randomNumber(12)){case 0:case 1:case 2:let a=t[u.randomNumber(t.length)];switch(u.randomBoolean()){case!0:a+=" gemstone";break;case!1:a="piece of "+a}switch(u.randomNumber(12)){case 0:a="well cut "+a;break;case 1:a="rough-cut "+a;break;case 2:a="poorly cut "+a;break;case 3:a="small "+a;break;case 4:a="large "+a;break;case 5:a="oddly shaped "+a;break;case 6:a="highly polished "+a}e=a;break;case 3:case 4:case 5:const s=["medal","statuette","sculpture","idol","chalice","goblet","dish","bowl"],n=s[u.randomNumber(s.length)],r=["small","large","light","heavy","delicate","fragile","masterwork","elegant"];e=r[u.randomNumber(r.length)]+" "+n;break;case 6:case 7:case 8:const i=["ring","necklace","crown","circlet","bracelet","anklet","torc","brooch","pendant","locket","diadem","tiara","earring"],o=i[u.randomNumber(i.length)],c=["gold","silver","bronze","platinum","electrum","mithral","orium","adamantine"];switch(e=c[u.randomNumber(c.length)]+" "+o,u.randomNumber(5)){case 0:e=(u.randomBoolean()?"enamelled":"laquered")+" "+e;break;case 1:e=c[u.randomNumber(c.length)]+"-"+(u.randomBoolean()?"plated":"filigreed")+" "+e}switch(u.randomNumber(10)){case 0:e="delicate "+e;break;case 1:e="intricate "+e;break;case 2:e="elegant "+e;break;case 3:e="simple "+e;break;case 4:e="plain "+e}break;case 9:case 10:let l="";switch(u.randomBoolean()){case!0:switch(l="painting",u.randomBoolean()){case!0:l="oil "+l;break;case!1:l="watercolour "+l}break;case!1:switch(l="drawing",u.randomNumber(3)){case 0:l="pencil "+l;break;case 1:l="charcoal "+l;break;case 2:l="pastel "+l}}const m=["small","large","delicate","fragile","elegant","detailed"],d=["canvas","paper","parchment","wood panels","fabric"];e=m[u.randomNumber(m.length)]+" "+l+" on "+d[u.randomNumber(d.length)];break;case 11:const p=["lute","lyre","mandolin","violin","drum","flute","clarinet","accordion","banjo","bodhran","ocarina","zither","djembe","shawm"],h=p[u.randomNumber(p.length)],g=["small","large","light","heavy","delicate","fragile","masterwork","elegant"];e=g[u.randomNumber(g.length)]+" "+h}switch(u.randomNumber(5)){case 0:const a=["feywild","shadowfell","elemental chaos","astral plane","abyss","distant north","distant east","distant west","distant south"];e+=" from the "+a[u.randomNumber(a.length)];break;case 1:const s=["decorated with","inscribed with","engraved with","embossed with","carved with"],n=["indecipherable","ancient","curious","unusual","dwarven","eladrin","elven","draconic","gith"],r=["script","designs","sigils","runes","glyphs","patterns"];e+=" "+s[u.randomNumber(s.length)]+" "+n[u.randomNumber(n.length)]+" "+r[u.randomNumber(r.length)];break;case 2:const i=["glowing with","suffused with","infused with","humming with","pulsing with"],o=["arcane","divine","primal","psionic","dark","shadow","elemental","ethereal","unknown"],c=["energy","power","magic"];e+=" "+i[u.randomNumber(i.length)]+" "+o[u.randomNumber(o.length)]+" "+c[u.randomNumber(c.length)];break;case 4:let l=t[u.randomNumber(t.length)];u.randomBoolean()?l+="s":l="a single "+l;const m=["set with","inlaid with","studded with","with shards of"];e+=" "+m[u.randomNumber(m.length)]+" "+l}return(Xe.startsWithVowel(e)?"an ":"a ")+e}static generateRoomName(){const e=["antechamber","arena","armoury","aviary","audience chamber","banquet hall","bath chamber","barracks","bedroom","boudoir","bestiary","burial chamber","cells","chamber","chantry","chapel","classroom","closet","court","crypt","dining room","dormitory","dressing room","dumping ground","entrance hall","gallery","game room","great hall","guard post","hall","harem","hoard","infirmary","kennels","kitchens","laboratory","lair","library","mausoleum","meditation room","museum","nursery","observatory","office","pantry","prison","quarters","reception room","refectory","ritual chamber","shrine","smithy","stable","storeroom","study","temple","throne room","torture chamber","trophy room","training area","treasury","waiting room","workroom","workshop","vault","vestibule"];return e[u.randomNumber(e.length)]}static potionColour(e){let t=["red","scarlet","crimson","carmine","vermillion","pink","blue","royal blue","sky blue","light blue","dark blue","midnight blue","indigo","yellow","lemon yellow","amber","green","light green","dark green","sea green","turquoise","aquamarine","emerald","purple","lavender","lilac","mauve","orange","brown","maroon","ochre","black","dark grey","grey","light grey","off-white","white","golden","silver"];return e&&(t=t.concat(["blood red","cherry red","ruby-coloured","rose-coloured","sapphire-coloured","straw-coloured","olive-coloured","plum-coloured","mud-coloured","cream-coloured","ivory-coloured","bronze-coloured","colourless","clear","transparent"])),t[u.randomNumber(t.length)]}static potionAdjective(){const e=["watery","syrupy","thick","viscous","gloopy","thin","runny","translucent","effervescent","fizzing","bubbling","foaming","volatile","smoking","fuming","vaporous","steaming","cold","icy cold","hot","sparkling","iridescent","cloudy","opalescent","luminous","phosphorescent","glowing"];return e[u.randomNumber(e.length)]}static potionFeature(){switch(u.randomNumber(5)){case 0:return"with "+this.potionColour(!0)+" specks";case 1:return"with flecks of "+this.potionColour(!1);case 2:const e=this.potionColour(!0);return"with "+(Xe.startsWithVowel(e)?"an":"a")+" "+e+" suspension";case 3:return"with a floating "+this.potionColour(!0)+" layer";case 4:return"with a ribbon of "+this.potionColour(!1)}return""}static potionLiquid(){const e=["liquid","solution","draught","oil","elixir","potion"];return e[u.randomNumber(e.length)]}static potionContainer(){const e=["small","rounded","tall","square","irregularly-shaped","long-necked","cylindrical","round-bottomed"],t=["glass","metal","ceramic","crystal"],a=["vial","jar","bottle","flask"],s=e[u.randomNumber(e.length)];let n=t[u.randomNumber(t.length)];const r=a[u.randomNumber(a.length)];0===u.randomNumber(3)&&(n=this.potionColour(!0)+" "+n);let i="";switch(u.randomBoolean()){case!0:i=n+" "+r;break;case!1:i=s+" "+n+" "+r}return(Xe.startsWithVowel(i)?"an":"a")+" "+i}static potionSmell(){const e=["acidic","acrid","of ammonia","of apples","bitter","brackish","buttery","of cherries","delicious","earthy","of earwax","of fish","floral","of lavender","lemony","of honey","fruity","meaty","metallic","musty","of onions","of oranges","peppery","of perfume","rotten","salty","sickly sweet","starchy","sugary","smokey","sour","spicy","of sweat","sweet","unpleasant","vile","vinegary"];return e[u.randomNumber(e.length)]}static bookNounPhrase(e,t){let a=Xe.bookNoun(e),s=!1;if(e&&0===u.randomNumber(5)&&(a+="s",s=!0),0===u.randomNumber(3)){a=Xe.bookAdjective()+" "+a}if(t&&u.randomBoolean())switch(u.randomBoolean()){case!0:a="the "+a;break;case!1:if(s)switch(u.randomNumber(6)){case 0:a="two "+a;break;case 1:a="three "+a;break;case 2:a="four "+a;break;case 3:a="five "+a;break;case 4:a="six "+a;break;case 5:a="seven "+a}else switch(u.randomBoolean()){case!0:a=(Xe.startsWithVowel(a)?"an":"a")+" "+a;break;case!1:a="one "+a}}return a}static bookNoun(e){let t=["elf","halfling","dwarf","gnome","tiefling","dragonborn","goliath","changeling","drow","minotaur","beast","orc","goblin","hobgoblin","dragon","demon","devil","angel","god","gith","night","day","eclipse","shadow","sky","sun","moon","star","void","battle","war","brawl","fist","blade","arrow","spell","prayer","eye","wing","army","legion","brigade","galleon","warship","frigate","potion","jewel","ring","amulet","cloak","sword","spear","helm","wizard","king","queen","prince","princess","warlock","barbarian","sorcerer","thief","mage","child","wayfarer","adventurer","pirate","spy","sage","assassin","mountain","forest","peak","cave","cavern","lake","swamp","marshland","island","shore","city","town","village","tower","arena","castle","citadel","bridge","game","wager","quest","challenge","rose","lily","thorn","leaf","word","snake","serpent","song","lament","dirge","elegy","storm","tempest"];return e||(t=t.concat(["darkness","light","dusk","twilight","revenge","vengeance","blood","earth","water","ice","wood","metal","lightning","thunder","mist","snow","flame","fire","wind","stone","destruction","life","death","time","end","danger","luck","chaos","truth","untruth","lie","deception","music","sound","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"])),t[u.randomNumber(t.length)]}static bookAdjective(){const e=["dark","bright","tyrannous","devout","noble","eldritch","mystical","magical","sorcerous","savage","silent","lonely","violent","peaceful","black","white","gold","silver","red","pale","dying","living","ascending","defiled","mythical","legendary","heroic","empty","mighty","despairing","spellbound","enchanted","soaring","falling","visionary","bold","perilous"];return e[u.randomNumber(e.length)]}static bookGerund(){const e=["killing","murdering","watching","examining","enchanting","destroying","defying","betraying","protecting","silencing","bearing","fighting"];return e[u.randomNumber(e.length)]}static bookPreposition(){const e=["and","in","of","with","against","for","to","towards"];return e[u.randomNumber(e.length)]}static bookAbout(){const e=["treatise","essay","monograph","discourse","dissertation","primer","history","enchiridion"];let t=e[u.randomNumber(e.length)];u.randomBoolean()?t=(Xe.startsWithVowel(t)?"an ":"a ")+t:t+="s";const a=["about","on","concerning","regarding","on the subject of"];return t+" "+a[u.randomNumber(a.length)]}}Xe.model=[],Xe.maxLength=0;class Ue extends n.a.Component{render(){try{const e=this.props.options.map(e=>n.a.createElement(Ke,{key:e.id,option:e,selected:e.id===this.props.selectedID,count:this.props.options.length,select:e=>this.props.select(e)}));return n.a.createElement("div",{className:this.props.disabled?"tabs disabled":"tabs"},e)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}Ue.defaultProps={disabled:!1};class Ke extends n.a.Component{click(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}render(){try{const e="calc(((100% - 1px) / "+this.props.count+") - 2px )";let t="tab";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),n.a.createElement("div",{key:this.props.option.id,className:t,style:{width:e},title:this.props.option.text,onClick:e=>this.click(e)},this.props.option.text)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ze extends n.a.Component{constructor(e){super(e),this.state={monster:e.monster,page:"overview",showFilter:!1,helpSection:"speed",sidebar:"similar",similarFilter:{size:!0,type:!0,subtype:!1,alignment:!1,challenge:!0},scratchpadFilter:g.createMonsterFilter(),scratchpadList:[],showImageSelection:!1}}setPage(e){const t=this.getHelpOptionsForPage(e);this.setState({page:e,helpSection:t[0]})}setHelpSection(e){this.setState({helpSection:e})}toggleMatch(e){const t=this.state.similarFilter;t[e]=!t[e],this.setState({similarFilter:t})}toggleImageSelection(){this.setState({showImageSelection:!this.state.showImageSelection})}addToScratchpad(e){const t=this.state.scratchpadList;t.push(e),u.sort(t),this.setState({scratchpadList:t})}removeFromScratchpad(e){const t=this.state.scratchpadList.indexOf(e);this.state.scratchpadList.splice(t,1),this.setState({scratchpadList:this.state.scratchpadList})}addAllToScratchpad(e){const t=this.state.scratchpadList;e.forEach(e=>t.push(e)),u.sort(t),this.setState({scratchpadList:t})}clearScratchpad(){this.setState({scratchpadList:[]})}getHelpOptionsForPage(e){switch(e){case"overview":return["speed","senses","languages","equipment"];case"abilities":return["str","dex","con","int","wis","cha","saves","skills"];case"cbt-stats":return["armor class","hit dice","resist","vulnerable","immune","conditions"];case"actions":return["actions"];default:return[]}}getSimilarMonsters(){const e=[];return this.props.library.forEach(t=>{t.monsters.forEach(t=>{let a=!0;this.state.monster.id===t.id&&(a=!1),this.state.similarFilter.size&&this.state.monster.size!==t.size&&(a=!1),this.state.similarFilter.type&&this.state.monster.category!==t.category&&(a=!1),this.state.similarFilter.subtype&&this.state.monster.tag!==t.tag&&(a=!1),this.state.similarFilter.alignment&&this.state.monster.alignment!==t.alignment&&(a=!1),this.state.similarFilter.challenge&&this.state.monster.challenge!==t.challenge&&(a=!1),a&&e.push(t)})}),e}setRandomValue(e,t){h.setRandomValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}spliceMonsters(e){h.spliceMonsters(this.state.monster,e),this.setState({monster:this.state.monster})}addTrait(e){h.addTrait(this.state.monster,e),this.setState({monster:this.state.monster})}addRandomTrait(e,t){h.addRandomTrait(this.state.monster,e,t),this.setState({monster:this.state.monster})}moveTrait(e,t){const a=this.state.monster.traits.indexOf(e),s=this.state.monster.traits.indexOf(t);h.moveTrait(this.state.monster,a,s),this.setState({monster:this.state.monster})}removeTrait(e){h.removeTrait(this.state.monster,e),this.setState({monster:this.state.monster})}copyTrait(e){h.copyTrait(this.state.monster,e),this.setState({monster:this.state.monster})}changeTrait(e,t,a){e[t]=a,this.setState({monster:this.state.monster})}nudgeValue(e,t){h.nudgeValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}changeValue(e,t){h.changeValue(this.state.monster,e,t),this.setState({monster:this.state.monster,showImageSelection:!1})}changeFilterValue(e,t){const a=this.state.scratchpadFilter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({scratchpadFilter:a})}resetFilter(){this.setState({scratchpadFilter:g.createMonsterFilter()})}matchMonster(e){return N.matchMonster(e,this.state.scratchpadFilter)}getHelpSection(e){switch(this.state.helpSection){case"speed":return this.getValueSection("speed","text",e);case"senses":return this.getValueSection("senses","text",e);case"languages":return this.getValueSection("languages","text",e);case"equipment":return this.getValueSection("equipment","text",e);case"str":return this.getValueSection("abilityScores.str","number",e);case"dex":return this.getValueSection("abilityScores.dex","number",e);case"con":return this.getValueSection("abilityScores.con","number",e);case"int":return this.getValueSection("abilityScores.int","number",e);case"wis":return this.getValueSection("abilityScores.wis","number",e);case"cha":return this.getValueSection("abilityScores.cha","number",e);case"saves":return this.getValueSection("savingThrows","text",e);case"skills":return this.getValueSection("skills","text",e);case"armor class":return this.getValueSection("ac","number",e);case"hit dice":return this.getValueSection("hitDice","number",e);case"resist":return this.getValueSection("damage.resist","text",e);case"vulnerable":return this.getValueSection("damage.vulnerable","text",e);case"immune":return this.getValueSection("damage.immune","text",e);case"conditions":return this.getValueSection("conditionImmunities","text",e);case"actions":return this.getActionsSection(e);default:return null}}getValueSection(e,t,a){const s=a.map(a=>{const s=e.split(".");let n=a,r=null;return s.forEach(e=>{e===s[s.length-1]?r=n[e]:n=n[e]}),"text"===t&&""===r&&(r=null),r}).filter(e=>null!==e),r=[];if("number"===t){let e=null,t=null;if(s.forEach(a=>{(null===e||a<e)&&(e=a),(null===t||a>t)&&(t=a)}),null!==e&&null!==t)for(let a=e;a<=t;++a)r.push({value:a,count:0})}switch(s.forEach(e=>{const t=r.find(t=>t.value===e);t?t.count+=1:r.push({value:e,count:1})}),t){case"number":u.sort(r,[{field:"value",dir:"asc"}]);break;case"text":u.sort(r,[{field:"count",dir:"desc"},{field:"value",dir:"asc"}])}if("text"===t){0!==a.length-s.length&&r.push({value:"",count:a.length-s.length})}const i=r.map(t=>{const s=100*t.count/a.length;return n.a.createElement(o.a,{gutter:10,className:"value-list",key:r.indexOf(t)},n.a.createElement(c.a,{span:8,className:"text-container"},t.value||"(none specified)"),n.a.createElement(c.a,{span:8,className:"bar-container"},n.a.createElement("div",{className:"bar",style:{width:s+"%"}})),n.a.createElement(c.a,{span:8},n.a.createElement("button",{onClick:()=>this.changeValue(e,t.value)},"use this value")))});return n.a.createElement("div",null,i,n.a.createElement("button",{onClick:()=>this.setRandomValue(e,a)},"select random value"))}getActionsSection(e){const t=[];return t.push(n.a.createElement(o.a,{gutter:10,className:"value-list",key:"header"},n.a.createElement(c.a,{span:8,className:"text-container"},n.a.createElement("b",null,"type")),n.a.createElement(c.a,{span:4,className:"text-container number"},n.a.createElement("b",null,"avg")),n.a.createElement(c.a,{span:4,className:"text-container number"},n.a.createElement("b",null,"min - max")))),p.forEach(a=>{let s=null,r=null,i=0;e.forEach(e=>{const t=e.traits.filter(e=>e.type===a).length;(null===s||t<s)&&(s=t),(null===r||t>r)&&(r=t),i+=t});const l=Math.round(i/e.length);t.push(n.a.createElement(o.a,{gutter:10,className:"value-list",key:a},n.a.createElement(c.a,{span:8,className:0===i?"text-container disabled":"text-container"},u.traitType(a,!0)),n.a.createElement(c.a,{span:4,className:0===i?"text-container number disabled":"text-container number"},l),n.a.createElement(c.a,{span:4,className:0===i?"text-container number disabled":"text-container number"},s," - ",r),n.a.createElement(c.a,{span:8},n.a.createElement("button",{className:0===i?"disabled":"",onClick:()=>this.addRandomTrait(a,e)},"add random"))))}),n.a.createElement("div",null,t)}getSidebar(){let e=null;if(this.props.showSidebar){let t=[];if(this.props.showSidebar)switch(this.state.sidebar){case"similar":t=this.getSimilarMonsters();break;case"all":this.props.library.forEach(e=>{e.monsters.forEach(e=>{!t.includes(e)&&this.matchMonster(e)&&t.push(e)})})}t=t.filter(e=>!this.state.scratchpadList.find(t=>t.id===e.id)),u.sort(t);let a=null;switch(this.state.sidebar){case"similar":a=n.a.createElement(G,{text:"similarity criteria"},n.a.createElement(k,{label:"size "+this.state.monster.size,checked:this.state.similarFilter.size,changeValue:e=>this.toggleMatch("size")}),n.a.createElement(k,{label:"type "+this.state.monster.category,checked:this.state.similarFilter.type,changeValue:e=>this.toggleMatch("type")}),n.a.createElement(k,{label:this.state.monster.tag?"subtype "+this.state.monster.tag:"subtype",checked:this.state.similarFilter.subtype,disabled:!this.state.monster.tag,changeValue:e=>this.toggleMatch("subtype")}),n.a.createElement(k,{label:this.state.monster.alignment?"alignment "+this.state.monster.alignment:"alignment",checked:this.state.similarFilter.alignment,disabled:!this.state.monster.alignment,changeValue:e=>this.toggleMatch("alignment")}),n.a.createElement(k,{label:"challenge rating "+u.challenge(this.state.monster.challenge),checked:this.state.similarFilter.challenge,changeValue:e=>this.toggleMatch("challenge")}));break;case"all":a=n.a.createElement(ie,{filter:this.state.scratchpadFilter,noTopMargin:!0,changeValue:(e,t)=>this.changeFilterValue(e,t),resetFilter:()=>this.resetFilter()})}const s=[{id:"similar",text:"similar"},{id:"all",text:"all"}];let r=null;0===this.state.scratchpadList.length&&(r=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"this is your ",n.a.createElement("b",null,"scratchpad")," list; you can add monsters to it from the list to the right"),n.a.createElement("div",{className:"section"},"you might find this useful if you're creating a monster and want it to have similar abilities to other monsters"),n.a.createElement("div",{className:"section"},"when there are monsters in this list, their combined stats will be shown on the left"),n.a.createElement("div",{className:"section"},"you can also quickly blend together all the monters in this list to create a new monster by clicking the ",n.a.createElement("b",null,"generate hybrid monster")," button above")));let i=null;0===t.length&&(i=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"there are no monsters in your library which match the above criteria (or they are all in your scratchpad already)"))),e=n.a.createElement(c.a,{span:12,className:"scrollable sidebar sidebar-right"},n.a.createElement(o.a,{gutter:5},n.a.createElement(c.a,{span:12},n.a.createElement(Ue,{options:[{id:"scratch",text:"scratchpad"}],selectedID:"scratch",select:()=>null}),n.a.createElement("button",{className:this.state.scratchpadList.length<2?"disabled":"",onClick:()=>this.spliceMonsters(this.state.scratchpadList)},"generate hybrid monster"),n.a.createElement("button",{className:0===t.length?"disabled":"",onClick:()=>this.addAllToScratchpad(t)},"add all from right"),n.a.createElement("button",{className:0===this.state.scratchpadList.length?"disabled":"",onClick:()=>this.clearScratchpad()},"clear scratchpad"),n.a.createElement("div",{className:"divider"}),this.getMonsterCards(this.state.scratchpadList,!0),r),n.a.createElement(c.a,{span:12},n.a.createElement(Ue,{options:s,selectedID:this.state.sidebar,select:e=>this.setState({sidebar:e})}),a,n.a.createElement("div",{className:"divider"}),this.getMonsterCards(t,!1),i)))}else{let t=null;const a=u.challengeDetails().find(e=>e.cr===this.state.monster.challenge);a&&(t=n.a.createElement(G,{text:"suggested stats"},n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"challenge"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.cr))),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"armor class"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.ac))),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"hit points"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.hpMin," - ",a.hpMax))),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"attack bonus"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.attack))),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"damage / rnd"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.dmgMin," - ",a.dmgMax))),n.a.createElement("div",{className:"section"},n.a.createElement(o.a,null,n.a.createElement(c.a,{span:16},"save dc"),n.a.createElement(c.a,{span:8,className:"statistic-value"},a.save))))),e=n.a.createElement(c.a,{span:12,className:"scrollable sidebar sidebar-right",style:{padding:"5px"}},t,t?n.a.createElement("div",{className:"divider"}):null,n.a.createElement(ae,{monster:this.state.monster}))}return e}getMonsterCards(e,t){return u.sort(e).map(e=>n.a.createElement("div",{className:"section",key:e.id},n.a.createElement(ae,{monster:e,mode:"template "+this.state.page+(t?" selected":""),copyTrait:e=>this.copyTrait(e),selectMonster:e=>this.addToScratchpad(e),deselectMonster:e=>this.removeFromScratchpad(e)}))).filter(e=>!!e)}render(){try{const e=[{id:"overview",text:"overview"},{id:"abilities",text:"abilities"},{id:"cbt-stats",text:"combat"},{id:"actions",text:"actions"}];let t=null;switch(this.state.page){case"overview":t=n.a.createElement(Qe,{monster:this.state.monster,toggleImageSelection:()=>this.toggleImageSelection(),changeValue:(e,t)=>this.changeValue(e,t),nudgeValue:(e,t)=>this.nudgeValue(e,t)});break;case"abilities":t=n.a.createElement($e,{monster:this.state.monster,changeValue:(e,t)=>this.changeValue(e,t),nudgeValue:(e,t)=>this.nudgeValue(e,t)});break;case"cbt-stats":t=n.a.createElement(et,{monster:this.state.monster,changeValue:(e,t)=>this.changeValue(e,t),nudgeValue:(e,t)=>this.nudgeValue(e,t)});break;case"actions":t=n.a.createElement(tt,{monster:this.state.monster,addTrait:e=>this.addTrait(e),moveTrait:(e,t)=>this.moveTrait(e,t),removeTrait:e=>this.removeTrait(e),changeValue:(e,t,a)=>this.changeTrait(e,t,a)})}let a=null;if(this.props.showSidebar&&this.state.scratchpadList.length>0){let e=null;if(this.getHelpOptionsForPage(this.state.page).length>1){const t=this.getHelpOptionsForPage(this.state.page).map(e=>({id:e,text:e}));e=n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"fields"),n.a.createElement(se,{options:t,selectedID:this.state.helpSection,select:e=>this.setHelpSection(e)}),n.a.createElement("div",{className:"subheading"},"values"))}a=n.a.createElement("div",{className:"monster-help group-panel"},n.a.createElement("div",{className:"heading"},"information from scratchpad monsters"),e,this.getHelpSection(this.state.scratchpadList))}return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Ue,{options:e,selectedID:this.state.page,select:e=>this.setPage(e)}),t,a),this.getSidebar(),n.a.createElement(l.a,{visible:this.state.showImageSelection,closable:!1,onClose:()=>this.toggleImageSelection()},n.a.createElement(Fe,{select:e=>this.changeValue("portrait",e),cancel:()=>this.toggleImageSelection()})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Qe extends n.a.Component{randomName(){let e=Xe.generateName();e=e[0].toUpperCase()+e.substr(1),this.props.changeValue("name",e)}render(){try{const e=d.map(e=>({id:e,text:e}));return n.a.createElement(o.a,{gutter:10,key:"overview"},n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"name"),n.a.createElement(q,{text:this.props.monster.name,onChange:e=>this.props.changeValue("name",e)}),n.a.createElement("button",{onClick:()=>this.randomName()},"generate a random name"),n.a.createElement("div",{className:"subheading"},"size"),n.a.createElement(j,{source:this.props.monster,name:"size",nudgeValue:e=>this.props.nudgeValue("size",e)}),n.a.createElement("div",{className:"subheading"},"type"),n.a.createElement(A,{options:e,selectedID:this.props.monster.category,select:e=>this.props.changeValue("category",e)}),n.a.createElement("div",{className:"subheading"},"subtype"),n.a.createElement(q,{text:this.props.monster.tag,onChange:e=>this.props.changeValue("tag",e)}),n.a.createElement("div",{className:"subheading"},"alignment"),n.a.createElement(q,{text:this.props.monster.alignment,onChange:e=>this.props.changeValue("alignment",e)}),n.a.createElement("div",{className:"subheading"},"challenge rating"),n.a.createElement(j,{source:this.props.monster,name:"challenge",display:e=>u.challenge(e),nudgeValue:e=>this.props.nudgeValue("challenge",e)})),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"speed"),n.a.createElement(q,{text:this.props.monster.speed,onChange:e=>this.props.changeValue("speed",e)}),n.a.createElement("div",{className:"subheading"},"senses"),n.a.createElement(q,{text:this.props.monster.senses,onChange:e=>this.props.changeValue("senses",e)}),n.a.createElement("div",{className:"subheading"},"languages"),n.a.createElement(q,{text:this.props.monster.languages,onChange:e=>this.props.changeValue("languages",e)}),n.a.createElement("div",{className:"subheading"},"equipment"),n.a.createElement(q,{text:this.props.monster.equipment,onChange:e=>this.props.changeValue("equipment",e)}),n.a.createElement("div",{className:"subheading"},"portrait"),n.a.createElement(J,{source:this.props.monster,edit:()=>this.props.toggleImageSelection(),clear:()=>this.props.changeValue("portrait","")})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class $e extends n.a.Component{render(){try{return n.a.createElement(o.a,{gutter:10,key:"abilities"},n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"ability scores"),n.a.createElement(F,{edit:!0,combatant:this.props.monster,nudgeValue:(e,t,a)=>this.props.nudgeValue(t,a)})),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"saving throws"),n.a.createElement(q,{text:this.props.monster.savingThrows,onChange:e=>this.props.changeValue("savingThrows",e)}),n.a.createElement("div",{className:"subheading"},"skills"),n.a.createElement(q,{text:this.props.monster.skills,onChange:e=>this.props.changeValue("skills",e)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class et extends n.a.Component{render(){try{return n.a.createElement(o.a,{gutter:10,key:"cbt-stats"},n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"armor class"),n.a.createElement(j,{source:this.props.monster,name:"ac",nudgeValue:e=>this.props.nudgeValue("ac",e)}),n.a.createElement("div",{className:"subheading"},"hit dice"),n.a.createElement(j,{source:this.props.monster,name:"hitDice",display:e=>e+"d"+u.hitDieType(this.props.monster.size),nudgeValue:e=>this.props.nudgeValue("hitDice",e)}),n.a.createElement("div",{className:"subheading"},"hit points"),n.a.createElement("div",{className:"hp-value"},h.getTypicalHP(this.props.monster)," hp"),n.a.createElement("div",{className:"subheading"},"legendary actions"),n.a.createElement(j,{source:this.props.monster,name:"legendaryActions",nudgeValue:e=>this.props.nudgeValue("legendaryActions",e)})),n.a.createElement(c.a,{xs:24,sm:24,md:24,lg:12,xl:12},n.a.createElement("div",{className:"subheading"},"damage resistances"),n.a.createElement(q,{text:this.props.monster.damage.resist,onChange:e=>this.props.changeValue("damage.resist",e)}),n.a.createElement("div",{className:"subheading"},"damage vulnerabilities"),n.a.createElement(q,{text:this.props.monster.damage.vulnerable,onChange:e=>this.props.changeValue("damage.vulnerable",e)}),n.a.createElement("div",{className:"subheading"},"damage immunities"),n.a.createElement(q,{text:this.props.monster.damage.immune,onChange:e=>this.props.changeValue("damage.immune",e)}),n.a.createElement("div",{className:"subheading"},"condition immunities"),n.a.createElement(q,{text:this.props.monster.conditionImmunities,onChange:e=>this.props.changeValue("conditionImmunities",e)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class tt extends n.a.Component{constructor(e){super(e),this.state={selectedTraitID:null}}setSelectedTraitID(e){this.setState({selectedTraitID:e})}createTraitBar(e){return n.a.createElement(at,{key:e.id,trait:e,isSelected:e.id===this.state.selectedTraitID,select:e=>this.setSelectedTraitID(e)})}moveTrait(e,t){this.props.moveTrait(e,t)}createSection(e,t){const a=e[t];return n.a.createElement("div",null,n.a.createElement("div",{className:"section subheading"},u.traitType(t,!0)),n.a.createElement(_e.List,{values:a,lockVertically:!0,onChange:({oldIndex:e,newIndex:t})=>this.moveTrait(a[e],a[t]),renderList:({children:e,props:t})=>n.a.createElement("div",t,e),renderItem:({value:e,props:t,isDragged:a})=>n.a.createElement("div",Object.assign({},t,{className:a?"dragged":""}),this.createTraitBar(e))}),n.a.createElement("button",{onClick:()=>this.props.addTrait(t)},"add a new ",t))}render(){try{const e=[],t={};p.forEach(a=>{e.push({id:a,text:u.traitType(a,!1)}),t[a]=this.props.monster.traits.filter(e=>e.type===a)});const a=this.props.monster.traits.find(e=>e.id===this.state.selectedTraitID);let s=null;return s=a?n.a.createElement(st,{trait:a,removeTrait:e=>this.props.removeTrait(e),changeValue:(e,t,a)=>this.props.changeValue(e,t,a)}):n.a.createElement(Z,null,"select one of the traits or actions from the column to the left to edit its details here"),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:10},this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction"),this.createSection(t,"legendary"),this.createSection(t,"lair")),n.a.createElement(c.a,{span:14},s))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}tt.defaultProps={addTrait:null,copyTrait:null,removeTrait:null,changeValue:null,swapTraits:null};class at extends n.a.Component{render(){try{return n.a.createElement("div",{className:this.props.isSelected?"trait-bar selected":"trait-bar",onClick:()=>this.props.select(this.props.trait.id)},n.a.createElement(Je.a,{className:"grabber","data-movable-handle":!0}),n.a.createElement("div",{className:"name"},this.props.trait.name||"unnamed "+u.traitType(this.props.trait.type,!1)))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class st extends n.a.Component{render(){try{return n.a.createElement("div",{key:this.props.trait.id,className:"section"},n.a.createElement("div",{className:"subheading"},"trait name"),n.a.createElement(q,{text:this.props.trait.name,onChange:e=>this.props.changeValue(this.props.trait,"name",e)}),n.a.createElement("div",{className:"subheading"},"usage"),n.a.createElement(q,{text:this.props.trait.usage,onChange:e=>this.props.changeValue(this.props.trait,"usage",e)}),n.a.createElement("div",{className:"subheading"},"details"),n.a.createElement(q,{text:this.props.trait.text,placeholder:"details",minLines:10,maxLines:20,onChange:e=>this.props.changeValue(this.props.trait,"text",e)}),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.removeTrait(this.props.trait)},"remove this trait"))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class nt extends n.a.Component{constructor(e){super(e),this.state={pc:e.pc,showImageSelection:!1}}toggleImageSelection(){this.setState({showImageSelection:!this.state.showImageSelection})}addCompanion(){const e=g.createCompanion();e.name="new companion",this.state.pc.companions.push(e),this.setState({pc:this.state.pc})}removeCompanion(e){const t=this.state.pc;t.companions=this.state.pc.companions.filter(t=>t.id!==e),this.setState({pc:t})}changeValue(e,t,a){e[t]=a,this.setState({pc:this.state.pc,showImageSelection:!1})}nudgeValue(e,t,a){const s=e[t];let n;switch(t){case"size":n=u.nudgeSize(s,a);break;default:n=(s||0)+a}this.changeValue(e,t,n)}render(){try{const e=this.state.pc.companions.map(e=>n.a.createElement(o.a,{gutter:10,className:"companion",key:e.id},n.a.createElement(c.a,{span:16},n.a.createElement(q,{text:e.name,onChange:t=>this.changeValue(e,"name",t)})),n.a.createElement(c.a,{span:8},n.a.createElement("button",{onClick:()=>this.removeCompanion(e.id)},"delete"))));return 0===e.length&&e.push(n.a.createElement("div",{className:"section",key:"empty"},n.a.createElement("i",null,"no companions (pets, retainers, mounts, etc)"))),n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement("div",{className:"subheading"},"character name:"),n.a.createElement(q,{text:this.state.pc.name,onChange:e=>this.changeValue(this.state.pc,"name",e)}),n.a.createElement("div",{className:"subheading"},"player name:"),n.a.createElement(q,{text:this.state.pc.player,onChange:e=>this.changeValue(this.state.pc,"player",e)}),n.a.createElement("div",{className:"subheading"},"size"),n.a.createElement(j,{source:this.state.pc,name:"size",nudgeValue:e=>this.nudgeValue(this.state.pc,"size",e)}),n.a.createElement("div",{className:"subheading"},"race:"),n.a.createElement(q,{text:this.state.pc.race,onChange:e=>this.changeValue(this.state.pc,"race",e)}),n.a.createElement("div",{className:"subheading"},"class:"),n.a.createElement(q,{text:this.state.pc.classes,onChange:e=>this.changeValue(this.state.pc,"classes",e)}),n.a.createElement("div",{className:"subheading"},"level:"),n.a.createElement(j,{source:this.state.pc,name:"level",nudgeValue:e=>this.nudgeValue(this.state.pc,"level",e)}),n.a.createElement("div",{className:"subheading"},"passive skills"),n.a.createElement(j,{source:this.state.pc,name:"passiveInsight",label:"insight",nudgeValue:e=>this.nudgeValue(this.state.pc,"passiveInsight",e)}),n.a.createElement(j,{source:this.state.pc,name:"passiveInvestigation",label:"investigation",nudgeValue:e=>this.nudgeValue(this.state.pc,"passiveInvestigation",e)}),n.a.createElement(j,{source:this.state.pc,name:"passivePerception",label:"perception",nudgeValue:e=>this.nudgeValue(this.state.pc,"passivePerception",e)})),n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement("div",{className:"subheading"},"languages:"),n.a.createElement(q,{text:this.state.pc.languages,onChange:e=>this.changeValue(this.state.pc,"languages",e)}),n.a.createElement("div",{className:"subheading"},"d&d beyond link:"),n.a.createElement(q,{text:this.state.pc.url,placeholder:"https://ddb.ac/characters/...",onChange:e=>this.changeValue(this.state.pc,"url",e)}),n.a.createElement("div",{className:"subheading"},"portrait"),n.a.createElement(J,{source:this.state.pc,edit:()=>this.toggleImageSelection(),clear:()=>this.changeValue(this.state.pc,"portrait","")}),n.a.createElement("div",{className:"subheading"},"companions:"),e,n.a.createElement("button",{onClick:()=>this.addCompanion()},"add a new companion")),n.a.createElement(l.a,{visible:this.state.showImageSelection,closable:!1,onClose:()=>this.toggleImageSelection()},n.a.createElement(Fe,{select:e=>this.changeValue(this.state.pc,"portrait",e),cancel:()=>this.toggleImageSelection()})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var rt=a(277),it=a(259);class ot extends n.a.Component{constructor(e){super(e),this.state={group:e.group}}readFile(e){return e.text().then(e=>{const t=JSON.parse(e);Object.keys(t).forEach(e=>{if("id"!==e){const a=t[e];this.state.group[e]=a}}),this.state.group.monsters.forEach(e=>{e.id=u.guid(),e.portrait=""}),this.setState({group:this.state.group})}),!1}render(){try{return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"select the file you want to upload")),n.a.createElement(it.a.Dragger,{accept:".monstergroup",showUploadList:!1,beforeUpload:e=>this.readFile(e)},n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(rt.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"click here, or drag a file here, to upload it")))),n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Oe,{heading:this.props.group.name,columns:1,content:this.props.group.monsters.map(e=>n.a.createElement(ae,{key:e.id,monster:e,mode:"view"}))})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ct extends n.a.Component{constructor(e){super(e),this.state={view:"paste",source:"",monster:e.monster}}setView(e){this.setState({view:e})}setSource(e){this.setState({source:e})}analyse(){h.import(this.state.source,this.state.monster),this.setState({monster:this.state.monster})}readFile(e){return e.text().then(e=>{const t=JSON.parse(e);Object.keys(t).forEach(e=>{if("id"!==e&&"portrait"!==e){const a=t[e];this.state.monster[e]=a}}),this.setState({monster:this.state.monster})}),!1}render(){try{const e=["paste","upload"].map(e=>({id:e,text:e}));let t=null;switch(this.state.view){case"paste":t=n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"go to the following link to find the monster you want to import"),n.a.createElement("div",{className:"section"},n.a.createElement("a",{href:"https://www.dndbeyond.com/monsters",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/monsters")),n.a.createElement("div",{className:"section"},"then right-click on the page and select ",n.a.createElement("b",null,"view page source")),n.a.createElement("div",{className:"section"},"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),n.a.createElement(q,{text:this.state.source,placeholder:"paste page source here",minLines:10,maxLines:10,onChange:e=>this.setSource(e)}),n.a.createElement("button",{onClick:()=>this.analyse()},"analyse"));break;case"upload":t=n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"select the file you want to upload")),n.a.createElement(it.a.Dragger,{accept:".monster",showUploadList:!1,beforeUpload:e=>this.readFile(e)},n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(rt.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"click here, or drag a file here, to upload it")))}return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Ue,{options:e,selectedID:this.state.view,select:e=>this.setView(e)}),t),n.a.createElement(c.a,{span:12,className:"scrollable",style:{padding:"5px"}},n.a.createElement(ae,{monster:this.state.monster})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class lt{static importParty(e,t){t.name="",t.pcs=[];const a=(new DOMParser).parseFromString(e,"text/html");try{t.name=a.getElementsByClassName("page-title")[0].innerText.trim()}catch(s){console.error(s)}try{const e=a.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-active")[0].getElementsByClassName("ddb-campaigns-character-card");for(let a=0;a!==e.length;++a){const s=e[a];t.pcs.push(lt.getCharacter(s,!0))}}catch(s){console.error(s)}try{const e=a.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-inactive")[0].getElementsByClassName("ddb-campaigns-character-card");for(let a=0;a!==e.length;++a){const s=e[a];t.pcs.push(lt.getCharacter(s,!1))}}catch(s){console.error(s)}}static getCharacter(e,t){const a=g.createPC();a.name=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-primary")[0].innerText.trim(),a.player=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[1].innerText.trim().substring(8),a.active=t;const s=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[0].innerText.trim().split("|");a.level=Number.parseInt(s[0].substring(4).trim(),10),a.race=s[1].trim(),a.classes=s[2].trim();const n=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-details-link")[0];return a.url="https://www.dndbeyond.com"+n.getAttribute("href"),a}static importPC(e,t){try{const a=JSON.parse(e);t.name=a.character.name,t.size=a.character.race.size,t.race=a.character.race.fullName;let s=0,n="";a.character.classes.forEach(e=>{s+=e.level,""!==n&&(n+=" / "),n+=e.definition.name,e.subclassDefinition&&(n+=" ("+e.subclassDefinition.name+")")}),t.classes=n,t.level=s;const r=[].concat(a.character.modifiers.race).concat(a.character.modifiers.class).concat(a.character.modifiers.background).concat(a.character.modifiers.item).concat(a.character.modifiers.feat).concat(a.character.modifiers.condition),i=r.filter(e=>"language"===e.type).map(e=>e.friendlySubtypeName);t.languages=i.join(", ");const o=u.proficiency(s);let c=a.character.stats[3].value,l=a.character.stats[4].value;r.filter(e=>"bonus"===e.type&&"intelligence-score"===e.subType).forEach(e=>c+=e.value),r.filter(e=>"bonus"===e.type&&"wisdom-score"===e.subType).forEach(e=>l+=e.value);let m=0,d=0,p=0;const h=r.filter(e=>"insight"===e.subType||"wisdom-ability-checks"===e.subType).map(e=>e.type);h.includes("expertise")?m=2:h.includes("proficiency")?m=1:h.includes("half-proficiency-round-up")&&(m=.5);const b=r.filter(e=>"investigation"===e.subType||"intelligence-ability-checks"===e.subType).map(e=>e.type);b.includes("expertise")?d=2:b.includes("proficiency")?d=1:h.includes("half-proficiency-round-up")&&(d=.5);const E=r.filter(e=>"perception"===e.subType||"wisdom-ability-checks"===e.subType).map(e=>e.type);E.includes("expertise")?p=2:E.includes("proficiency")?p=1:h.includes("half-proficiency-round-up")&&(p=.5),t.passiveInsight=10+u.modifierValue(l)+Math.floor(o*m),t.passiveInvestigation=10+u.modifierValue(c)+Math.floor(o*d),t.passivePerception=10+u.modifierValue(l)+Math.floor(o*p),t.companions=[],a.character.creatures.forEach(e=>{const a=g.createCompanion();a.name=e.name,t.companions.push(a)})}catch(a){console.error(a)}}}class mt extends n.a.Component{constructor(e){super(e),this.state={view:"paste",source:"",party:e.party}}setView(e){this.setState({view:e})}setSource(e){this.setState({source:e})}analyse(){lt.importParty(this.state.source,this.state.party),this.setState({party:this.state.party})}readFile(e){return e.text().then(e=>{const t=JSON.parse(e);Object.keys(t).forEach(e=>{if("id"!==e){const a=t[e];this.state.party[e]=a}}),this.state.party.pcs.forEach(e=>{e.id=u.guid(),e.portrait=""}),this.setState({party:this.state.party})}),!1}render(){try{const e=["paste","upload"].map(e=>({id:e,text:e}));let t=null;switch(this.state.view){case"paste":t=n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"go to the following link to find the party you want to import"),n.a.createElement("div",{className:"section"},n.a.createElement("a",{href:"https://www.dndbeyond.com/my-campaigns",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/my-campaigns")),n.a.createElement("div",{className:"section"},"then right-click on the page and select ",n.a.createElement("b",null,"view page source")),n.a.createElement("div",{className:"section"},"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),n.a.createElement(q,{text:this.state.source,placeholder:"paste page source here",minLines:10,maxLines:10,onChange:e=>this.setSource(e)}),n.a.createElement("button",{onClick:()=>this.analyse()},"analyse"));break;case"upload":t=n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"select the file you want to upload")),n.a.createElement(it.a.Dragger,{accept:".party",showUploadList:!1,beforeUpload:e=>this.readFile(e)},n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(rt.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"click here, or drag a file here, to upload it")))}return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Ue,{options:e,selectedID:this.state.view,select:e=>this.setView(e)}),t),n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Oe,{heading:this.props.party.name,columns:1,content:this.props.party.pcs.map(e=>n.a.createElement(ze,{key:e.id,pc:e,mode:"view"}))})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class dt extends n.a.Component{constructor(e){super(e),this.state={view:"paste",source:"",pc:e.pc}}setView(e){this.setState({view:e})}setSource(e){this.setState({source:e})}analyse(){lt.importPC(this.state.source,this.state.pc),this.setState({pc:this.state.pc})}readFile(e){return e.text().then(e=>{const t=JSON.parse(e);Object.keys(t).forEach(e=>{if("id"!==e&&"portrait"!==e){const a=t[e];this.state.pc[e]=a}}),this.setState({pc:this.state.pc})}),!1}render(){try{const e=["paste","upload"].map(e=>({id:e,text:e}));let t=null;switch(this.state.view){case"paste":let e=null,a=this.state.pc.url;""!==a?(a.endsWith("/")||(a+="/"),a+="json",e=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"go to the following link"),n.a.createElement("div",{className:"section"},n.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},a)),n.a.createElement("div",{className:"section"},"copy the data into the clipboard, paste it into the box below, and press the analyse button"))):e=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"go to the following link to find the pc you want to import"),n.a.createElement("div",{className:"section"},n.a.createElement("a",{href:"https://www.dndbeyond.com/",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/")),n.a.createElement("div",{className:"section"},"then right-click on the page and select ",n.a.createElement("b",null,"view page source")),n.a.createElement("div",{className:"section"},"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),t=n.a.createElement("div",null,e,n.a.createElement(q,{text:this.state.source,placeholder:"paste page source here",minLines:10,maxLines:10,onChange:e=>this.setSource(e)}),n.a.createElement("button",{onClick:()=>this.analyse()},"analyse"));break;case"upload":t=n.a.createElement("div",null,n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"select the file you want to upload")),n.a.createElement(it.a.Dragger,{accept:".pc",showUploadList:!1,beforeUpload:e=>this.readFile(e)},n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(rt.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"click here, or drag a file here, to upload it")))}return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(Ue,{options:e,selectedID:this.state.view,select:e=>this.setView(e)}),t),n.a.createElement(c.a,{span:12,className:"scrollable"},n.a.createElement(ze,{pc:this.state.pc,mode:"view"})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class pt extends n.a.Component{getKillsChart(){let e=[];return this.props.combat.report.filter(e=>"kill"===e.type).forEach(t=>{const a=this.props.combat.combatants.find(e=>e.id===t.combatantID);if(a&&"pc"===a.type){let t=e.find(e=>e.text===a.displayName);void 0===t&&(t={text:a.displayName,value:0},e.push(t)),t.value+=1}}),e=u.sort(e,[{field:"value",dir:"desc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"kills"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e}))}getDamageChart(){let e=[];return this.props.combat.report.filter(e=>"damage"===e.type).forEach(t=>{const a=this.props.combat.combatants.find(e=>e.id===t.combatantID);if(a&&"pc"===a.type){let s=e.find(e=>e.text===a.displayName);void 0===s&&(s={text:a.displayName,value:0},e.push(s)),s.value+=t.value}}),e=u.sort(e,[{field:"value",dir:"desc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"damage dealt"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e}))}getMobilityChart(){let e=[];return this.props.combat.report.filter(e=>"movement"===e.type).forEach(t=>{const a=this.props.combat.combatants.find(e=>e.id===t.combatantID);if(a&&"pc"===a.type){let t=e.find(e=>e.text===a.displayName);void 0===t&&(t={text:a.displayName,value:0},e.push(t)),t.value+=1}}),e=u.sort(e,[{field:"value",dir:"desc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"mobility"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e}))}getConditionsAddedChart(){let e=[];return this.props.combat.report.filter(e=>"condition-add"===e.type).forEach(t=>{const a=this.props.combat.combatants.find(e=>e.id===t.combatantID);if(a&&"pc"===a.type){let t=e.find(e=>e.text===a.displayName);void 0===t&&(t={text:a.displayName,value:0},e.push(t)),t.value+=1}}),e=u.sort(e,[{field:"value",dir:"desc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"conditions added"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e}))}getConditionsRemovedChart(){let e=[];return this.props.combat.report.filter(e=>"condition-remove"===e.type).forEach(t=>{const a=this.props.combat.combatants.find(e=>e.id===t.combatantID);if(a&&"pc"===a.type){let t=e.find(e=>e.text===a.displayName);void 0===t&&(t={text:a.displayName,value:0},e.push(t)),t.value+=1}}),e=u.sort(e,[{field:"value",dir:"desc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"conditions removed"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e}))}getTurnLengthChart(){let e=[],t=null,a=[];return this.props.combat.report.forEach(s=>{switch(s.type){case"turn-start":t=s.timestamp;break;case"turn-end":if(null!==t){const n=this.props.combat.combatants.find(e=>e.id===s.combatantID);if(n&&"pc"===n.type){let r=e.find(e=>e.text===n.displayName);void 0===r&&(r={text:n.displayName,value:0},e.push(r));let i=s.timestamp-t;a.forEach(e=>{if(e.start&&e.end){const t=e.end-e.start;i-=t}}),r.value+=i}t=null,a=[]}break;case"combat-pause":a.push({start:s.timestamp,end:null});break;case"combat-resume":if(a.length>0){a[a.length-1].end=s.timestamp}}}),e=u.sort(e,[{field:"value",dir:"asc"}]),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"turn length"),0===e.length?n.a.createElement("div",{className:"section"},"no data to display"):null,n.a.createElement(De,{data:e,display:e=>{const t=new Date(e);return t.getMinutes()+"m "+t.getSeconds()+"s"}}))}render(){try{return n.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},this.getKillsChart(),this.getDamageChart(),this.getMobilityChart(),this.getConditionsAddedChart(),this.getConditionsRemovedChart(),this.getTurnLengthChart())}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var ht=a(299);class ut extends n.a.Component{render(){try{const e="parties"===this.props.view?"navigator-item pcs selected":"navigator-item pcs",t="library"===this.props.view?"navigator-item monsters selected":"navigator-item monsters",a="encounters"===this.props.view?"navigator-item encounters selected":"navigator-item encounters",s="maps"===this.props.view?"navigator-item maps selected":"navigator-item maps",r="combat"===this.props.view?"navigator-item combat selected":"navigator-item combat";return n.a.createElement("div",{className:"page-footer"},n.a.createElement("div",{className:e,onClick:()=>this.props.setView("parties")},"pcs"),n.a.createElement("div",{className:t,onClick:()=>this.props.setView("library")},"monsters"),n.a.createElement("div",{className:a,onClick:()=>this.props.setView("encounters")},"encounters"),n.a.createElement("div",{className:s,onClick:()=>this.props.setView("maps")},"maps"),n.a.createElement("div",{className:r,onClick:()=>this.props.setView("combat")},"combat"),n.a.createElement("div",{className:"vertical-divider"}),n.a.createElement(ht.a,{title:"about",onClick:()=>this.props.openDrawer("about")}))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var gt=a(275),bt=a(276),Et=a(273),vt=a(272);class yt extends n.a.Component{render(){try{return n.a.createElement("div",{className:"page-header"},n.a.createElement("div",{className:"app-title app-name"},"dojo"),n.a.createElement("div",{className:"vertical-divider"}),n.a.createElement(gt.a,{className:"search"===this.props.sidebar?"title-bar-icon selected":"title-bar-icon",title:"search",onClick:()=>this.props.setSidebar("search"===this.props.sidebar?null:"search")}),n.a.createElement(bt.a,{className:"tools"===this.props.sidebar?"title-bar-icon selected":"title-bar-icon",title:"tools",onClick:()=>this.props.setSidebar("tools"===this.props.sidebar?null:"tools")}),n.a.createElement(Et.a,{className:"generators"===this.props.sidebar?"title-bar-icon selected":"title-bar-icon",title:"generators",onClick:()=>this.props.setSidebar("generators"===this.props.sidebar?null:"generators")}),n.a.createElement(vt.a,{className:"reference"===this.props.sidebar?"title-bar-icon selected":"title-bar-icon",title:"reference",onClick:()=>this.props.setSidebar("reference"===this.props.sidebar?null:"reference")}))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var ft=a(271);class Nt extends n.a.Component{render(){try{return n.a.createElement("div",{className:"readaloud"},this.props.children)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class kt extends n.a.Component{render(){try{if(!this.props.hasPCs||!this.props.hasMonsters)return n.a.createElement(o.a,{align:"middle",justify:"center",className:"scrollable"},n.a.createElement(c.a,{xs:20,sm:18,md:16,lg:12,xl:10},n.a.createElement(Nt,null,n.a.createElement("div",{className:"section"},"this screen is for running combat encounters, but before you can do that you need to do these things first:"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",{className:this.props.hasPCs?"strikethrough":""},"define a party of pcs in the ",n.a.createElement("button",{className:"link",onClick:()=>this.props.setView("parties")},"pcs screen")),this.props.hasPCs?n.a.createElement(ft.a,{title:"done",style:{marginLeft:"5px"}}):null),n.a.createElement("li",null,n.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",n.a.createElement("button",{className:"link",onClick:()=>this.props.setView("library")},"monsters screen")),this.props.hasMonsters?n.a.createElement(ft.a,{title:"done",style:{marginLeft:"5px"}}):null)),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"you probably want to design your encounter in the ",n.a.createElement("button",{className:"link",onClick:()=>this.props.setView("encounters")},"encounters screen"),", but you don't have to (you can generate a random encounter here instead)"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"if you want to use a tactical map, you can either build one in the ",n.a.createElement("button",{className:"link",onClick:()=>this.props.setView("maps")},"maps screen"),", or you can generate a random one here"))));const e=this.props.combats;u.sort(e);const t=e.map(e=>n.a.createElement(wt,{key:e.id,combat:e,resume:e=>this.props.resumeCombat(e),delete:e=>this.props.deleteCombat(e),openStatBlock:e=>this.props.openStatBlock(e)}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"here you can run a combat encounter by specifying a party and an encounter, and optionally a tactical map"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"on the right you will see a list of combats that you have paused"),n.a.createElement("div",{className:"section"},"you can resume a paused combat by selecting it"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"to start a combat encounter, press the ",n.a.createElement("b",null,"start a new combat")," button")),n.a.createElement("button",{onClick:()=>this.props.createCombat()},"start a new combat")),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{heading:"combats",content:t})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class wt extends n.a.Component{render(){try{let e=null;this.props.combat.map&&(e=n.a.createElement("div",{className:"section"},n.a.createElement(he,{map:this.props.combat.map,mode:"thumbnail",size:12,combatants:this.props.combat.combatants})));const t=this.props.combat.combatants.filter(e=>e.active).filter(e=>"placeholder"!==e.type).map(e=>n.a.createElement("div",{key:e.id,className:"combatant-row"},n.a.createElement(J,{source:e,inline:!0}),n.a.createElement("div",{className:"name"},e.displayName),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(e)})));return n.a.createElement("div",{className:"card combat"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.combat.name||"unnamed combat")),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"fixed-height"},n.a.createElement("div",{className:"section"},"paused at round ",this.props.combat.round),e,n.a.createElement("div",{className:"subheading"},"initiative order"),t),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.resume(this.props.combat)},"resume combat"),n.a.createElement(w,{text:"delete combat",callback:()=>this.props.delete(this.props.combat)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class xt extends n.a.Component{constructor(e){super(e),this.state={view:"position"}}setView(e){this.setState({view:e})}getPositionSection(){return n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"move"),n.a.createElement("div",{className:"section centered"},n.a.createElement(qe,{direction:"eight",click:e=>this.props.move(this.props.item,e)})),n.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},n.a.createElement("div",{className:"subheading"},"resize"),n.a.createElement("div",{className:"section centered"},n.a.createElement(qe,{direction:"both",click:(e,t)=>this.props.resize(this.props.item,e,t)}))))}getStyleSection(){const e=["overlay","token"].map(e=>({id:e,text:e})),t=["square","rounded","circle"].map(e=>({id:e,text:e}));return n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"type"),n.a.createElement(se,{options:e,selectedID:this.props.item.type,select:e=>this.props.changeValue(this.props.item,"type",e)}),n.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},n.a.createElement("div",{className:"subheading"},"shape"),n.a.createElement(se,{options:t,selectedID:this.props.item.style,select:e=>this.props.changeValue(this.props.item,"style",e)}),n.a.createElement("div",{className:"subheading"},"color"),n.a.createElement("input",{type:"color",value:this.props.item.color,onChange:e=>this.props.changeValue(this.props.item,"color",e.target.value)}),n.a.createElement("div",{className:"subheading"},"opacity"),n.a.createElement(M.a,{min:0,max:255,value:this.props.item.opacity,tooltipVisible:!1,onChange:e=>this.props.changeValue(this.props.item,"opacity",e)})),n.a.createElement("div",{style:{display:"token"===this.props.item.type?"block":"none"}},n.a.createElement("div",{className:"subheading"},"size"),n.a.createElement(j,{source:this.props.item,name:"size",nudgeValue:e=>this.props.nudgeValue(this.props.item,"size",e)})))}getNotesSection(){return this.props.note?n.a.createElement("div",null,n.a.createElement(q,{text:this.props.note.text,placeholder:"details",minLines:5,maxLines:10,onChange:e=>this.props.changeValue(this.props.note,"text",e)}),n.a.createElement("button",{onClick:()=>this.props.removeNote(this.props.item.id)},"remove note")):n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.props.addNote(this.props.item.id)},"add a note"))}render(){try{const e=["position","style","notes"].map(e=>({id:e,text:e}));let t=null;switch(this.state.view){case"position":t=this.getPositionSection();break;case"style":t=this.getStyleSection();break;case"notes":t=this.getNotesSection()}return n.a.createElement("div",{className:"card map",key:"selected"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},"map item")),n.a.createElement("div",{className:"card-content"},n.a.createElement(se,{options:e,selectedID:this.state.view,select:e=>this.setView(e)}),n.a.createElement("div",{className:"divider"}),t,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("button",{onClick:()=>this.props.remove(this.props.item)},"remove from the map"))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Ct=a(270),St=a(269);class Mt extends n.a.Component{render(){try{const e=[];return this.props.combatants.forEach(t=>{t.conditions.forEach(a=>{e.push(n.a.createElement(It,{key:a.id,condition:a,combatant:t,combat:this.props.combat,showCombatantName:this.props.combatants.length>1,nudgeConditionValue:(e,t,a)=>this.props.nudgeConditionValue(e,t,a),editCondition:e=>this.props.editCondition(t,e),removeCondition:e=>this.props.removeCondition(t,e)}))})}),n.a.createElement("div",{className:"section"},e,n.a.createElement("button",{onClick:()=>this.props.addCondition()},"add a condition"))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class It extends n.a.Component{render(){try{let e=this.props.condition.name||"condition";"exhaustion"===this.props.condition.name&&(e+=" ("+this.props.condition.level+")"),this.props.showCombatantName&&(e=this.props.combatant.displayName+": "+e);let t=null;null!==this.props.condition.duration&&(t=n.a.createElement("div",{className:"section"},n.a.createElement("i",null,u.conditionDurationText(this.props.condition,this.props.combat))));const a=[];"exhaustion"===this.props.condition.name&&a.push(n.a.createElement("div",{key:"level",className:"section"},n.a.createElement(j,{source:this.props.condition,name:"level",label:"level",nudgeValue:e=>this.props.nudgeConditionValue(this.props.condition,"level",e)})));const s=u.conditionText(this.props.condition);for(let r=0;r!==s.length;++r)a.push(n.a.createElement("div",{key:r,className:"section"},s[r]));return n.a.createElement("div",{className:"group-panel condition-panel"},n.a.createElement("div",{className:"condition-name"},e),n.a.createElement("div",{className:"condition-buttons"},n.a.createElement(Ct.a,{title:"edit",onClick:()=>this.props.editCondition(this.props.condition)}),n.a.createElement(St.a,{title:"remove",onClick:()=>this.props.removeCondition(this.props.condition)})),t,a)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Tt extends n.a.Component{constructor(e){super(e),this.state={view:"main",damageOrHealing:0,damageMultipliers:{}}}nudgeDamage(e){this.setState({damageOrHealing:Math.max(this.state.damageOrHealing+e,0)})}setView(e){this.setState({view:e})}setDamageMultiplier(e,t){const a=this.state.damageMultipliers;a[e]=t,this.setState({damageMultipliers:a})}heal(){const e=this.state.damageOrHealing;this.setState({damageOrHealing:0},()=>{const t=[];this.props.combatants.forEach(a=>{var s,n,r;const i=null!==(s=a.hpMax)&&void 0!==s?s:0;let o=(null!==(n=a.hpCurrent)&&void 0!==n?n:0)+e;o=Math.min(o,i),t.push({id:a.id,hp:o,temp:null!==(r=a.hpTemp)&&void 0!==r?r:0,damage:0})}),this.props.changeHP(t)})}damage(){const e=this.state.damageOrHealing;this.setState({damageOrHealing:0},()=>{const t=[];this.props.combatants.forEach(a=>{var s,n,r;const i=null!==(s=this.state.damageMultipliers[a.id])&&void 0!==s?s:1;let o=null!==(n=a.hpCurrent)&&void 0!==n?n:0,c=null!==(r=a.hpTemp)&&void 0!==r?r:0;const l=Math.floor(e*i);let m=l;const d=Math.min(m,c);m-=d,c-=d,o-=m,o=Math.max(o,0),t.push({id:a.id,hp:o,temp:c,damage:l})}),this.props.changeHP(t)})}getMainSection(){if(this.props.combatants.every(e=>e.pending))return n.a.createElement("div",{className:"section"},"pending initiative entry");if(this.props.combatants.every(e=>e.active)){const e=[];this.props.combatants.every(e=>e.current)?e.push(n.a.createElement("button",{key:"makeDefeated",onClick:()=>this.props.makeDefeated(this.props.combatants)},"mark as defeated and end turn")):(1===this.props.combatants.length&&e.push(n.a.createElement("button",{key:"makeCurrent",onClick:()=>this.props.makeCurrent(this.props.combatants[0])},"start turn")),e.push(n.a.createElement("button",{key:"makeDefeated",onClick:()=>this.props.makeDefeated(this.props.combatants)},"mark as defeated")));const t=[];if(this.props.combatants.every(e=>"pc"!==e.type)){this.props.combat.combatants.filter(e=>"pc"===e.type).forEach(e=>{const a="engaged:"+e.displayName;t.push(n.a.createElement(V.a.CheckableTag,{key:e.id,checked:this.props.combatants.every(e=>e.tags.includes(a)),onChange:()=>this.props.toggleTag(this.props.combatants,a)},e.displayName))})}let a=null;return t.length>0&&(a=n.a.createElement("div",{className:"section"},n.a.createElement("b",null,"engaged with: "),t)),n.a.createElement("div",null,e,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("b",null,"quick tags: "),n.a.createElement(V.a.CheckableTag,{checked:this.props.combatants.every(e=>e.tags.includes("conc")),onChange:()=>this.props.toggleTag(this.props.combatants,"conc")},"concentrating"),n.a.createElement(V.a.CheckableTag,{checked:this.props.combatants.every(e=>e.tags.includes("bane")),onChange:()=>this.props.toggleTag(this.props.combatants,"bane")},"bane"),n.a.createElement(V.a.CheckableTag,{checked:this.props.combatants.every(e=>e.tags.includes("bless")),onChange:()=>this.props.toggleTag(this.props.combatants,"bless")},"bless"),n.a.createElement(V.a.CheckableTag,{checked:this.props.combatants.every(e=>e.conditions.some(e=>"prone"===e.name)),onChange:()=>this.props.toggleCondition(this.props.combatants,"prone")},"prone"),n.a.createElement(V.a.CheckableTag,{checked:this.props.combatants.every(e=>e.conditions.some(e=>"unconscious"===e.name)),onChange:()=>this.props.toggleCondition(this.props.combatants,"unconscious")},"unconscious"),n.a.createElement(V.a.CheckableTag,{checked:!this.props.combatants.every(e=>e.showOnMap),onChange:()=>this.props.toggleHidden(this.props.combatants)},"hidden")),a)}return this.props.combatants.every(e=>e.defeated)?n.a.createElement("button",{onClick:()=>this.props.makeActive(this.props.combatants)},"mark as active"):n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"multiple combatants are selected"))}getHPSection(){if(!this.props.combatants.every(e=>"monster"===e.type))return null;let e=null;if(1===this.props.combatants.length){const t=this.props.combatants[0];e=n.a.createElement("div",null,n.a.createElement(j,{source:t,name:"hpCurrent",label:"hit points",factors:[1,10],nudgeValue:e=>this.props.nudgeValue(t,"hpCurrent",e)}),n.a.createElement(j,{source:t,name:"hpTemp",label:"temp hp",factors:[1,10],nudgeValue:e=>this.props.nudgeValue(t,"hpTemp",e)}),n.a.createElement("div",{className:"divider"}))}const t=this.props.combatants.map(e=>{const t=e;let a=null,s=null,r=null,i=null;return t.damage.resist&&(a=n.a.createElement("div",{className:"section"},n.a.createElement("b",null,"damage resistances")," ",t.damage.resist," ",this.props.combatants.length>1?n.a.createElement("i",null," - ",e.displayName):null)),t.damage.vulnerable&&(s=n.a.createElement("div",{className:"section"},n.a.createElement("b",null,"damage vulnerabilities")," ",t.damage.vulnerable," ",this.props.combatants.length>1?n.a.createElement("i",null," - ",e.displayName):null)),t.damage.immune&&(r=n.a.createElement("div",{className:"section"},n.a.createElement("b",null,"damage immunities")," ",t.damage.immune," ",this.props.combatants.length>1?n.a.createElement("i",null," - ",e.displayName):null)),t.tags.includes("conc")&&(i=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},t.displayName," is ",n.a.createElement("b",null,"concentrating"),", and will need to make a check if they take damage"))),a||s||r||i?n.a.createElement("div",{key:e.id},a,s,r,i):null}),a=[{id:"half",text:"half"},{id:"normal",text:"normal"},{id:"double",text:"double"}],s=this.props.combatants.map(e=>{var t;let s="normal";const r=null!==(t=this.state.damageMultipliers[e.id])&&void 0!==t?t:1;r<1&&(s="half"),r>1&&(s="double");const i=n.a.createElement(se,{options:a,selectedID:s,select:t=>{let a=1;"half"===t&&(a=.5),"double"===t&&(a=2),this.setDamageMultiplier(e.id,a)}});return 1===this.props.combatants.length?n.a.createElement("div",{key:e.id},i):n.a.createElement(o.a,{key:e.id,align:"middle",justify:"center"},n.a.createElement(c.a,{span:8},n.a.createElement("div",null,e.displayName)),n.a.createElement(c.a,{span:16},i))});let r=null;const i=this.props.combatants.filter(e=>null!=e.hpCurrent&&e.hpCurrent<=0);if(i.length>0){const e=1===i.length&&i[0].current?"mark as defeated and end turn":"mark as defeated";let t=null;this.props.combatants.length>1&&(t=n.a.createElement("ul",null,i.map(e=>n.a.createElement("li",{key:e.id},e.displayName)))),r=n.a.createElement("button",{onClick:()=>this.props.makeDefeated(i)},e,t)}return n.a.createElement("div",null,e,t,n.a.createElement(j,{source:this.state,name:"damageOrHealing",factors:[1,10],nudgeValue:e=>this.nudgeDamage(e)}),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{xs:24,sm:24,md:12,lg:12,xl:12},n.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:()=>this.heal()},"heal")),n.a.createElement(c.a,{xs:24,sm:24,md:12,lg:12,xl:12},n.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:()=>this.damage()},"damage"))),s,r)}getConditionSection(){const e=this.props.combatants.map(e=>{if("monster"!==e.type)return null;const t=e;return t.conditionImmunities?n.a.createElement("div",{key:e.id,className:"section"},n.a.createElement("b",null,"condition immunities")," ",t.conditionImmunities," ",this.props.combatants.length>1?n.a.createElement("i",null," - ",e.displayName):null):null}),t=n.a.createElement(Mt,{combatants:this.props.combatants,combat:this.props.combat,addCondition:()=>this.props.addCondition(this.props.combatants),editCondition:(e,t)=>this.props.editCondition(e,t),removeCondition:(e,t)=>this.props.removeCondition(e,t),nudgeConditionValue:(e,t,a)=>this.props.nudgeConditionValue(e,t,a)});return n.a.createElement("div",null,e,t)}getMapSection(){if(!this.props.combat.map)return null;if(this.props.combatants.every(e=>this.props.combat.map&&this.props.combat.map.items.find(t=>t.id===e.id))){let e=null,t=null;if(1===this.props.combatants.length){const a=this.props.combatants[0];e=n.a.createElement(j,{source:a,name:"altitude",label:"altitude",display:e=>e+" ft.",nudgeValue:e=>this.props.nudgeValue(a,"altitude",5*e)});let s=null;if(a.aura.radius>0){const e=[{id:"square",text:"square"},{id:"rounded",text:"rounded"},{id:"circle",text:"circle"}];s=n.a.createElement("div",null,n.a.createElement(se,{options:e,selectedID:a.aura.style,select:e=>this.props.changeValue(a.aura,"style",e)}),n.a.createElement("input",{type:"color",value:a.aura.color,onChange:e=>this.props.changeValue(a.aura,"color",e.target.value)}))}t=n.a.createElement(G,{text:"aura"},n.a.createElement(j,{source:a.aura,name:"radius",label:"size",display:e=>e+" ft.",nudgeValue:e=>this.props.nudgeValue(a.aura,"radius",5*e)}),s)}return n.a.createElement("div",null,n.a.createElement("div",{className:"section centered"},n.a.createElement(qe,{direction:"eight",click:e=>this.props.mapMove(this.props.combatants,e)})),n.a.createElement("div",{className:"divider"}),e,t,n.a.createElement("button",{onClick:()=>this.props.mapRemove(this.props.combatants)},"remove from map"))}return 1===this.props.combatants.length?n.a.createElement("button",{key:"mapAdd",onClick:()=>this.props.mapAdd(this.props.combatants[0])},"add to map"):null}getAdvancedSection(){let e=null;this.props.combatants.every(e=>!e.current)&&(e=n.a.createElement(w,{text:"remove from encounter",callback:()=>this.props.removeCombatants(this.props.combatants)}));let t=null,a=null,s=null;if(1===this.props.combatants.length){const e=this.props.combatants[0];t=n.a.createElement(G,{text:"change name"},n.a.createElement(q,{text:e.displayName,onChange:t=>this.props.changeValue(e,"displayName",t)})),a=n.a.createElement(G,{text:"change size"},n.a.createElement(j,{source:e,name:"displaySize",label:"size",nudgeValue:t=>this.props.nudgeValue(e,"displaySize",t)})),e.pending||(s=n.a.createElement(G,{text:"change initiative score"},n.a.createElement(j,{source:e,name:"initiative",label:"initiative",nudgeValue:t=>this.props.nudgeValue(e,"initiative",t)})))}const r=[];this.props.combatants.filter(e=>"pc"===e.type).forEach(e=>{e.companions.filter(e=>!this.props.combat.combatants.find(t=>t.id===e.id)).forEach(e=>{r.push(n.a.createElement("button",{key:e.id,onClick:()=>this.props.addCompanion(e)},"add ",e.name))})});let i=null;if(1===this.props.combatants.length){const e=this.props.combatants[0];i=n.a.createElement(q,{text:e.note,placeholder:"notes",minLines:3,maxLines:10,onChange:t=>this.props.changeValue(e,"note",t)})}return n.a.createElement("div",null,e,t,a,s,r,i)}render(){try{const e=["main","hp","cond","map","adv"].map(e=>({id:e,text:e}));this.props.combat.map||e.splice(3,1),this.props.combatants.every(e=>"monster"===e.type)||e.splice(1,1);let t=this.state.view;e.find(e=>e.id===t)||(t="main");let a=null;switch(t){case"main":a=this.getMainSection();break;case"hp":a=this.getHPSection();break;case"cond":a=this.getConditionSection();break;case"map":a=this.getMapSection();break;case"adv":a=this.getAdvancedSection()}const s=1===this.props.combatants.length?this.props.combatants[0].displayName:"multiple combatants";return n.a.createElement("div",{className:"group-panel combat-controls"},n.a.createElement("div",{className:"subheading"},s),n.a.createElement(se,{options:e,selectedID:t,select:e=>this.setView(e)}),n.a.createElement("div",{className:"divider"}),a)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Vt=a(268);const Dt=new K.a.Converter;Dt.setOption("tables",!0);class Pt extends n.a.Component{getInformationTag(){return this.props.combatant.current?n.a.createElement(V.a,{className:"info"},"current turn"):this.props.selected?n.a.createElement(V.a,{className:"info"},"selected"):null}onClick(e){e.stopPropagation(),this.props.select&&this.props.select(this.props.combatant,e.ctrlKey)}getContent(){if(this.props.combatant.pending)return n.a.createElement("div",null,n.a.createElement(j,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:e=>this.props.nudgeValue(this.props.combatant,"initiative",e)}),n.a.createElement("button",{onClick:e=>{e.stopPropagation(),this.props.makeActive(this.props.combatant)}},"add to encounter"));const e=[];if("pc"===this.props.combatant.type){const t=this.props.combatant;t.player&&e.push(n.a.createElement("div",{key:"player",className:"section"},t.player))}if("monster"===this.props.combatant.type&&!this.props.minimal){var t,a;const s=this.props.combatant;let r=(null!==(t=this.props.combatant.hpCurrent)&&void 0!==t?t:0).toString();(null!==(a=this.props.combatant.hpTemp)&&void 0!==a?a:0)>0&&(r+="+"+this.props.combatant.hpTemp),e.push(n.a.createElement("div",{key:"stats"},n.a.createElement("div",{className:"section key-stats"},n.a.createElement("div",{className:"key-stat"},n.a.createElement("div",{className:"stat-label"},"ac"),n.a.createElement("div",{className:"stat-value"},s.ac)),n.a.createElement("div",{className:"key-stat"},n.a.createElement("div",{className:"stat-value"},r),n.a.createElement("div",{className:"stat-label"},"hp"))),n.a.createElement(de,{combatant:this.props.combatant})))}const s=[];return this.props.combatant.tags.filter(e=>e.startsWith("engaged")).forEach(e=>{s.push(u.getTagDescription(e))}),s.length>0&&e.push(n.a.createElement(Z,{key:"engaged"},n.a.createElement("div",null,"engaged with: ",s.join(", ")))),this.props.combatant.tags.filter(e=>!e.startsWith("engaged")).forEach(t=>{e.push(n.a.createElement(Z,{key:t},n.a.createElement("div",{className:"condition"},n.a.createElement("div",{className:"condition-name"},u.getTagTitle(t)),u.getTagDescription(t))))}),this.props.combat.map&&!this.props.combat.map.items.find(e=>e.id===this.props.combatant.id)&&e.push(n.a.createElement(Z,{key:"not-on-map"},n.a.createElement("span",null,"not on the map"),n.a.createElement(Vt.a,{className:"icon-button",onClick:()=>this.props.addToMap(this.props.combatant)}))),this.props.combatant.showOnMap||e.push(n.a.createElement(Z,{key:"hidden"},"hidden")),this.props.combatant.conditions&&this.props.combatant.conditions.forEach(t=>{let a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),t.duration&&(a+=" "+u.conditionDurationText(t,this.props.combat));const s=[],r=u.conditionText(t);for(let e=0;e!==r.length;++e)s.push(n.a.createElement("div",{key:e,className:"condition-text"},r[e]));e.push(n.a.createElement(Z,{key:t.id},n.a.createElement("div",{className:"condition"},n.a.createElement("div",{className:"condition-name"},a),s)))}),this.props.combatant.note&&e.push(n.a.createElement(Z,{key:"text"},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:Dt.makeHtml(this.props.combatant.note)}}))),e}render(){try{let e="initiative-list-item "+this.props.combatant.type;this.props.combatant.current&&(e+=" current"),this.props.selected&&(e+=" highlight"),this.props.combatant.defeated&&(e+=" defeated");let t=null;const a=this.props.combatant;return a.portrait&&(t=n.a.createElement(J,{source:a,inline:!0})),n.a.createElement("div",{className:e,onClick:e=>this.onClick(e)},n.a.createElement("div",{className:"header"},t,n.a.createElement("div",{className:"name"},this.props.combatant.displayName||"combatant"),this.getInformationTag()),n.a.createElement("div",{className:"content"},this.getContent()))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class At extends n.a.Component{constructor(e){super(e),this.state={externalWindow:null,containerElement:null}}componentDidMount(){const e=window.open("","","width=800, height=500, left=200, top=200");let t=null;if(e){t=e.document.createElement("div"),t.className="dojo popout",e.document.body.appendChild(t),Array.from(document.styleSheets).forEach(t=>{const a=t;if(t.href){const a=document.createElement("link");a.rel="stylesheet",a.href=t.href,e.document.head.appendChild(a)}else if(a&&a.cssRules&&a.cssRules.length>0){const t=document.createElement("style");Array.from(a.cssRules).forEach(e=>{t.appendChild(document.createTextNode(e.cssText))}),e.document.head.appendChild(t)}}),e.document.title=this.props.title,e.addEventListener("beforeunload",()=>{this.props.closeWindow()})}this.setState({externalWindow:e,containerElement:t})}componentWillUnmount(){this.state.externalWindow&&this.state.externalWindow.close()}render(){try{return this.state.containerElement?i.a.createPortal(this.props.children,this.state.containerElement):null}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}(new K.a.Converter).setOption("tables",!0);class Ot extends n.a.Component{constructor(e){super(e),this.state={rightPanel:"selection",showDefeatedCombatants:!1,selectedItemIDs:[],addingToMapID:null,addingOverlay:!1,mapSize:30,playerView:{open:!1,showControls:!1,mapSize:30}}}componentDidMount(){window.addEventListener("beforeunload",()=>{this.setPlayerViewOpen(!1)})}setRightPanel(e){this.setState({rightPanel:e})}toggleShowDefeatedCombatants(){this.setState({showDefeatedCombatants:!this.state.showDefeatedCombatants})}setSelectedItemIDs(e){const t=e.length>0?"selection":this.state.rightPanel;this.setState({selectedItemIDs:e,rightPanel:t})}toggleItemSelection(e,t){if(e&&t){const t=this.state.selectedItemIDs;if(t.includes(e)){const a=t.indexOf(e);t.splice(a,1)}else t.push(e);this.setSelectedItemIDs(t)}else this.setSelectedItemIDs(e?[e]:[])}setAddingToMapID(e){this.setState({addingToMapID:e,addingOverlay:!1})}toggleAddingOverlay(){this.setState({addingOverlay:!this.state.addingOverlay,addingToMapID:null})}nudgeMapSize(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}setPlayerViewOpen(e){const t=this.state.playerView;t.open=e,this.setState({playerView:t})}setPlayerViewShowControls(e){const t=this.state.playerView;t.showControls=e,this.setState({playerView:t})}nudgePlayerViewMapSize(e){const t=this.state.playerView;t.mapSize=Math.max(t.mapSize+e,3),this.setState({playerView:t})}nextTurn(){const e=this.props.combat.combatants.find(e=>e.current);if(e)this.props.endTurn(e);else{const e=this.props.combat.combatants.filter(e=>"placeholder"!==e.type||N.combatHasLairActions(this.props.combat)).find(e=>e.active);e&&this.props.makeCurrent(e)}}defeatCombatants(e){const t=e.map(e=>e.id);this.setState({selectedItemIDs:this.state.selectedItemIDs.filter(e=>!t.includes(e))},()=>{this.props.makeDefeated(e)})}removeCombatants(e){const t=e.map(e=>e.id);this.setState({selectedItemIDs:this.state.selectedItemIDs.filter(e=>!t.includes(e))},()=>{this.props.removeCombatants(e)})}gridSquareClicked(e,t){if(this.state.addingToMapID){const a=this.props.combat.combatants.find(e=>e.id===this.state.addingToMapID);a&&this.props.mapAdd(a,e,t),this.setAddingToMapID(null)}if(this.state.addingOverlay){const a=g.createMapItem();a.type="overlay",a.x=e,a.y=t,a.width=1,a.height=1,a.color="#005080",a.opacity=127,a.style="square",this.props.addOverlay(a),this.setState({rightPanel:"selection",addingOverlay:!1,addingToMapID:null,selectedItemIDs:[a.id]})}}orderCombatants(e){const t=e.find(e=>e.current);if(!t)return e;const a=e.indexOf(t);return e.splice(a).concat(e)}getPlayerView(){if(!this.state.playerView.open)return null;const e=this.props.combat.combatants.filter(e=>"pc"===e.type||e.showOnMap).filter(e=>!e.pending&&e.active&&!e.defeated).filter(e=>"placeholder"!==e.type||N.combatHasLairActions(this.props.combat)),t=e.some(e=>e.current),a=e.length,s=this.orderCombatants(e).map(e=>this.createCombatantRow(e,!0));if(t&&(a>1&&s.splice(1,0,n.a.createElement("div",{key:"next1",className:"section centered init-separator"},"next up")),a>2&&s.splice(3,0,n.a.createElement("div",{key:"next2",className:"section centered init-separator"},"then"))),this.props.combat.map){let e=null;if(this.props.combat.map&&this.state.playerView.showControls){let t=this.props.combat.combatants.filter(e=>null!==this.props.combat.map&&this.props.combat.map.items.find(t=>t.id===e.id)).filter(e=>e.showOnMap).filter(e=>this.state.selectedItemIDs.includes(e.id));if(0===t.length&&(t=this.props.combat.combatants.filter(e=>null!==this.props.combat.map&&this.props.combat.map.items.find(t=>t.id===e.id)).filter(e=>e.showOnMap).filter(e=>e.current)),1===t.length){const a=t[0];e=n.a.createElement("div",null,n.a.createElement("div",{className:"heading lowercase"},a.displayName),n.a.createElement("div",{className:"section centered"},n.a.createElement(qe,{direction:"eight",click:e=>this.props.mapMove([a.id],e)})),n.a.createElement("div",{className:"divider"}),n.a.createElement(j,{key:"altitude",source:a,name:"altitude",label:"altitude",display:e=>e+" ft.",nudgeValue:e=>this.props.nudgeValue(a,"altitude",5*e)}),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"conc.",display:"button",checked:a.tags.includes("conc"),changeValue:e=>this.props.toggleTag([a],"conc")})),n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"bane",display:"button",checked:a.tags.includes("bane"),changeValue:e=>this.props.toggleTag([a],"bane")})),n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"bless",display:"button",checked:a.tags.includes("bless"),changeValue:e=>this.props.toggleTag([a],"bless")}))),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"prone",display:"button",checked:a.conditions.some(e=>"prone"===e.name),changeValue:e=>this.props.toggleCondition([a],"prone")})),n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"uncon.",display:"button",checked:a.conditions.some(e=>"unconscious"===e.name),changeValue:e=>this.props.toggleCondition([a],"unconscious")})),n.a.createElement(c.a,{span:8},n.a.createElement(k,{label:"hidden",display:"button",checked:!a.showOnMap,changeValue:e=>this.props.changeValue([a],"showOnMap",!e)}))))}t.length>1&&(e=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"multiple items selected")))}return n.a.createElement(At,{title:"Encounter",closeWindow:()=>this.setPlayerViewOpen(!1)},n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:24,sm:24,md:12,lg:16,xl:18,className:"scrollable both-ways"},n.a.createElement(he,{key:"map",map:this.props.combat.map,mode:"combat-player",size:this.state.playerView.mapSize,combatants:this.props.combat.combatants,selectedItemIDs:this.state.selectedItemIDs,itemSelected:(e,t)=>this.toggleItemSelection(e,t)})),n.a.createElement(c.a,{xs:24,sm:24,md:12,lg:8,xl:6,className:"scrollable"},e,n.a.createElement("div",{className:"heading fixed-top"},"initiative order"),s)))}return n.a.createElement(At,{title:"Encounter",closeWindow:()=>this.setPlayerViewOpen(!1)},n.a.createElement("div",{className:"scrollable"},n.a.createElement("div",{className:"heading"},"initiative order"),s))}getTools(){let e=!1;e=!!this.props.combat.encounter&&this.props.combat.encounter.waves.length>0;const t=[];this.props.combat.combatants.filter(e=>"pc"===e.type).forEach(e=>{const a=this.props.parties.find(t=>t.pcs.find(t=>t.id===e.id));a&&!t.includes(a)&&t.push(a)});const a=[];return t.forEach(e=>{e.pcs.forEach(t=>{this.props.combat.combatants.find(e=>e.id===t.id)||a.push(n.a.createElement("button",{key:t.id,onClick:()=>this.props.addPC(e.id,t.id)},t.name," (",e.name,")"))})}),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"encounter"),n.a.createElement("button",{onClick:()=>this.props.pauseCombat()},"pause combat"),n.a.createElement(w,{text:"end combat",callback:()=>this.props.endCombat()}),n.a.createElement("button",{onClick:()=>this.props.showLeaderboard()},"leaderboard"),n.a.createElement("div",{className:"subheading"},"combatants"),n.a.createElement(k,{label:"show defeated combatants",checked:this.state.showDefeatedCombatants,changeValue:()=>this.toggleShowDefeatedCombatants()}),n.a.createElement("button",{onClick:()=>this.props.addCombatants()},"add combatants"),a.length>0?n.a.createElement(G,{text:"add pcs"},a):null,n.a.createElement("button",{onClick:()=>this.props.addWave(),style:{display:e?"block":"none"}},"add wave"),n.a.createElement("button",{onClick:()=>this.props.addCompanion(null)},"add a companion"),n.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},n.a.createElement("div",{className:"subheading"},"map"),n.a.createElement("button",{onClick:()=>this.props.scatterCombatants("monster")},"scatter monsters"),n.a.createElement("button",{onClick:()=>this.props.scatterCombatants("pc")},"scatter pcs"),n.a.createElement(k,{label:this.state.addingOverlay?"click on the map to add the item, or click here to cancel":"add token / overlay",display:"button",checked:this.state.addingOverlay,changeValue:()=>this.toggleAddingOverlay()}),n.a.createElement(j,{source:this.state,name:"mapSize",display:()=>"zoom",nudgeValue:e=>this.nudgeMapSize(3*e)})),n.a.createElement("div",{className:"subheading"},"player view"),n.a.createElement(k,{label:"show player view",checked:this.state.playerView.open,changeValue:e=>this.setPlayerViewOpen(e)}),n.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},n.a.createElement(k,{label:"show map controls",checked:this.state.playerView.showControls,changeValue:e=>this.setPlayerViewShowControls(e)})),n.a.createElement("div",{style:{display:this.props.combat.map&&this.state.playerView.open?"block":"none"}},n.a.createElement(j,{source:this.state.playerView,name:"mapSize",display:()=>"zoom",nudgeValue:e=>this.nudgePlayerViewMapSize(3*e)})))}getSelectedCombatant(){const e=this.state.selectedItemIDs.map(e=>this.props.combat.combatants.find(t=>t.id===e)).filter(e=>!!e);u.sort(e,[{field:"displayName",dir:"asc"}]);const t=e.filter(e=>"placeholder"===e.type);if(t.length>0)return n.a.createElement("div",null,this.createCard(t[0]));if(e.length>0&&e.every(e=>e.current))return n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"you've selected the current initiative holder"));if(1===e.length)return n.a.createElement("div",null,this.createControls(e),this.createCard(e[0]));if(e.length>1)return n.a.createElement("div",null,this.createControls(e),n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"multiple combatants are selected:"),e.map(e=>n.a.createElement("div",{key:e.id,className:"multiple-combatant-row"},e.displayName,n.a.createElement(D.a,{style:{float:"right",padding:"2px 0",fontSize:"14px"},onClick:()=>this.toggleItemSelection(e.id,!0)})))));if(this.props.combat.map){const e=this.props.combat.map.items.find(e=>e.id===this.state.selectedItemIDs[0]);if(e)return n.a.createElement(xt,{item:e,note:y.getNote(this.props.combat.map,e),move:(e,t)=>this.props.mapMove([e.id],t),resize:(e,t,a)=>this.props.mapResize(e.id,t,a),remove:e=>this.props.mapRemove([e.id]),addNote:e=>this.props.mapAddNote(e),removeNote:e=>this.props.mapRemoveNote(e),changeValue:(e,t,a)=>this.props.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.props.nudgeValue(e,t,a)})}return n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"select a pc or monster from the ",n.a.createElement("b",null,"initiative order")," list to see its details here"))}createCombatantRow(e,t){let a=this.state.selectedItemIDs.includes(e.id);return t&&!this.props.combat.map&&(a=!1),n.a.createElement(Pt,{key:e.id,combatant:e,combat:this.props.combat,selected:a,minimal:t,select:(e,t)=>this.toggleItemSelection(e.id,t),addToMap:e=>this.setAddingToMapID(this.state.addingToMapID?null:e.id),nudgeValue:(e,t,a)=>this.props.nudgeValue(e,t,a),makeActive:e=>this.props.makeActive([e])})}createControls(e){return e.some(e=>"placeholder"===e.type)?null:n.a.createElement(Tt,{combatants:e,combat:this.props.combat,makeCurrent:e=>this.props.makeCurrent(e),makeActive:e=>this.props.makeActive(e),makeDefeated:e=>this.defeatCombatants(e),removeCombatants:e=>this.removeCombatants(e),changeHP:e=>this.props.changeHP(e),addCondition:e=>this.props.addCondition(e),editCondition:(e,t)=>this.props.editCondition(e,t),removeCondition:(e,t)=>this.props.removeCondition(e,t),nudgeConditionValue:(e,t,a)=>this.props.nudgeValue(e,t,a),mapAdd:e=>this.setAddingToMapID(this.state.addingToMapID?null:e.id),mapMove:(e,t)=>this.props.mapMove(e.map(e=>e.id),t),mapRemove:e=>this.props.mapRemove(e.map(e=>e.id)),toggleTag:(e,t)=>this.props.toggleTag(e,t),toggleCondition:(e,t)=>this.props.toggleCondition(e,t),toggleHidden:e=>this.props.toggleHidden(e),addCompanion:e=>this.props.addCompanion(e),changeValue:(e,t,a)=>this.props.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.props.nudgeValue(e,t,a)})}createCard(e){switch(e.type){case"pc":return n.a.createElement(ze,{pc:e,mode:"combat",changeValue:(e,t,a)=>this.props.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.props.nudgeValue(e,t,a)});case"monster":return n.a.createElement(ae,{monster:e,mode:"combat",useTrait:t=>this.props.useTrait(e,t),rechargeTrait:t=>this.props.rechargeTrait(e,t)});case"companion":return null;case"placeholder":const t=[];return this.props.combat.combatants.forEach(e=>{const a=e;a&&a.traits&&a.traits.some(e=>"lair"===e.type)&&t.push(n.a.createElement("div",{className:"card monster",key:"lair "+a.id},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},a.name)),n.a.createElement("div",{className:"card-content"},n.a.createElement($,{combatant:a,mode:"lair",useTrait:e=>this.props.useTrait(a,e),rechargeTrait:e=>this.props.rechargeTrait(a,e)}))))}),t}return null}render(){try{let e=null;const t=[],a=[];this.props.combat.combatants.forEach(s=>{s.pending?t.push(n.a.createElement(Pt,{key:s.id,combatant:s,combat:this.props.combat,selected:this.state.selectedItemIDs.includes(s.id),minimal:!1,select:(e,t)=>this.toggleItemSelection(e.id,t),addToMap:e=>this.setAddingToMapID(this.state.addingToMapID?null:e.id),nudgeValue:(e,t,a)=>this.props.nudgeValue(e,t,a),makeActive:e=>this.props.makeActive([e])})):(s.current&&(e=n.a.createElement("div",null,this.createControls([s]),this.createCard(s))),(s.active||s.defeated&&this.state.showDefeatedCombatants)&&a.push(s))}),0!==t.length&&t.unshift(n.a.createElement(Z,{key:"pending-help"},n.a.createElement("div",{className:"section"},"these combatants are not yet part of the encounter"),n.a.createElement("div",{className:"section"},"set initiative on each of them, then add them to the encounter")));const s=a.filter(e=>"placeholder"!==e.type||N.combatHasLairActions(this.props.combat)),r=s.length,i=this.orderCombatants(s).map(e=>this.createCombatantRow(e,!1));e&&(r>1&&i.splice(1,0,n.a.createElement("div",{key:"next1",className:"section centered init-separator"},"next up")),r>2&&i.splice(3,0,n.a.createElement("div",{key:"next2",className:"section centered init-separator"},"then"))),e||(i.unshift(n.a.createElement(Z,{key:"init-help"},n.a.createElement("div",{className:"section"},"these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)"),n.a.createElement("div",{className:"section"},"they are listed in initiative order (with the highest initiative score at the top of the list, and the lowest at the bottom)"),n.a.createElement("div",{className:"section"},"when you're ready to begin the encounter, press the ",n.a.createElement("b",null,"start combat")," button at the top left"))),e=n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"the current initiative holder will be displayed here")));let l=null;this.props.combat.notifications.length>0&&(l=n.a.createElement("div",{className:"notifications"},this.props.combat.notifications.map(e=>n.a.createElement(zt,{key:e.id,notification:e,close:(e,t)=>this.props.closeNotification(e,t)}))));let m=null;this.props.combat.map&&(m=n.a.createElement(he,{key:"map",map:this.props.combat.map,mode:"combat",size:this.state.mapSize,showOverlay:null!==this.state.addingToMapID||this.state.addingOverlay,combatants:this.props.combat.combatants,selectedItemIDs:this.state.selectedItemIDs,itemSelected:(e,t)=>this.toggleItemSelection(e,t),gridSquareEntered:(e,t)=>null,gridSquareClicked:(e,t)=>this.gridSquareClicked(e,t)}));const d=[];this.props.combat.combatants.filter(e=>!e.pending&&e.active&&!e.defeated).forEach(e=>{const t=e;t&&t.traits&&t.traits.some(e=>"legendary"===e.type)&&!t.current&&d.push(n.a.createElement("div",{className:"card monster",key:"leg "+t.id},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},t.name)),n.a.createElement("div",{className:"card-content"},n.a.createElement($,{combatant:t,mode:"legendary",useTrait:e=>this.props.useTrait(t,e),rechargeTrait:e=>this.props.rechargeTrait(t,e)}))))});const p=["selection","menu"].map(e=>({id:e,text:e}));let h=null,u=null;switch(this.state.rightPanel){case"selection":h="selected combatant",u=this.getSelectedCombatant();break;case"menu":h="menu",u=this.getTools()}return n.a.createElement("div",{className:"full-height"},n.a.createElement(o.a,{className:"combat-top-row"},n.a.createElement(c.a,{span:8,style:{padding:"0 10px"}},n.a.createElement("button",{onClick:()=>this.nextTurn()},this.props.combat.combatants.find(e=>e.current)?"next turn":"start combat")),n.a.createElement(c.a,{span:4},n.a.createElement("div",{className:"statistic"},"round ",this.props.combat.round)),n.a.createElement(c.a,{span:4},n.a.createElement("div",{className:"statistic"},N.getCombatXP(this.props.combat)," xp")),n.a.createElement(c.a,{span:8,style:{padding:"0 10px"}},n.a.createElement(se,{options:p,selectedID:this.state.rightPanel,select:e=>this.setRightPanel(e)}))),n.a.createElement(o.a,{className:"combat-main"},n.a.createElement(c.a,{span:8,className:"scrollable"},n.a.createElement("div",{className:"heading fixed-top"},"initiative holder"),e),n.a.createElement(c.a,{span:8,className:"scrollable"},l,n.a.createElement(Oe,{heading:"waiting for intiative",content:t,columns:1,showToggle:!0}),n.a.createElement(Oe,{heading:"legendary actions",content:d,columns:1,showToggle:!0}),n.a.createElement(Oe,{heading:"encounter map",content:[m],columns:1,showToggle:!0}),n.a.createElement(Oe,{heading:"initiative order",content:i,columns:1,showToggle:!0})),n.a.createElement(c.a,{span:8,className:"scrollable"},n.a.createElement("div",{className:"heading fixed-top"},h),u)),this.getPlayerView())}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class zt extends n.a.Component{success(){switch(this.props.notification.type){case"condition-save":case"condition-end":const e=this.props.notification.data;e.duration&&("saves"!==e.duration.type&&"rounds"!==e.duration.type||(e.duration.count-=1,0===e.duration.count?this.close(!0):this.close()));break;case"trait-recharge":this.props.notification.data.uses=0,this.close()}}close(e=!1){this.props.close(this.props.notification,e)}render(){try{const e=this.props.notification.combatant,t=this.props.notification.data,a=this.props.notification.data,s=e.displayName||e.name||"unnamed monster";switch(this.props.notification.type){case"condition-save":const e=t.duration;let r=e.saveType.toString();return"death"!==r&&(r=r.toUpperCase()),n.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},n.a.createElement("div",{className:"text"},s," must make a ",r," save against dc ",e.saveDC),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{key:"success",onClick:()=>this.success()},"success")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{key:"close",onClick:()=>this.close()},"close"))));case"condition-end":return n.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},n.a.createElement("div",{className:"text"},s," is no longer affected by condition ",t.name),n.a.createElement("button",{onClick:()=>this.close()},"close"));case"trait-recharge":return n.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},n.a.createElement("div",{className:"text"},s," can attempt to recharge ",a.name," (",a.usage,")"),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{key:"recharge",onClick:()=>this.success()},"recharge")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{key:"close",onClick:()=>this.close()},"close"))));default:return null}}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Lt extends n.a.Component{openStatBlock(e){const t=this.props.getMonster(e.monsterName,e.monsterGroupName);t&&this.props.openStatBlock(t)}render(){try{if(!this.props.hasMonsters)return n.a.createElement(o.a,{align:"middle",justify:"center",className:"scrollable"},n.a.createElement(c.a,{xs:20,sm:18,md:16,lg:12,xl:10},n.a.createElement(Nt,null,n.a.createElement("div",{className:"section"},"this screen is for building encounters, but before you can do that you need to do these things first:"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",n.a.createElement("button",{className:"link",onClick:()=>this.props.setView("library")},"monsters screen")),this.props.hasMonsters?n.a.createElement(ft.a,{title:"done",style:{marginLeft:"5px"}}):null)))));const e=this.props.encounters;u.sort(e);const t=e.map(e=>n.a.createElement(Gt,{key:e.id,encounter:e,parties:this.props.parties,edit:e=>this.props.editEncounter(e),delete:e=>this.props.deleteEncounter(e),run:(e,t)=>this.props.runEncounter(e,t),openStatBlock:e=>this.openStatBlock(e),getMonster:(e,t)=>this.props.getMonster(e,t)}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"on this page you can set up encounters"),n.a.createElement("div",{className:"section"},"when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs"),n.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can then run the encounter in the combat manager"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"on the right you will see a list of encounters that you have created"),n.a.createElement("div",{className:"section"},"select an encounter from the list to add monsters to it"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"to start building an encounter, press the ",n.a.createElement("b",null,"create a new encounter")," button")),n.a.createElement("button",{onClick:()=>this.props.addEncounter()},"create a new encounter")),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{heading:"encounters",content:t})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Gt extends n.a.Component{getText(e){let t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),n.a.createElement("div",{className:"name"},t)}getPortrait(e){const t=this.props.getMonster(e.monsterName,e.monsterGroupName);return t&&t.portrait?n.a.createElement(J,{source:t,inline:!0}):null}render(){try{const e=this.props.encounter.slots.map(e=>n.a.createElement("div",{key:e.id,className:"combatant-row"},this.getPortrait(e),this.getText(e),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(e)})));0===e.length&&e.push(n.a.createElement("div",{key:"empty",className:"section"},"no monsters")),this.props.encounter.waves.forEach(t=>{e.push(n.a.createElement("div",{key:"name "+t.id,className:"section subheading"},t.name||"unnamed wave")),t.slots.forEach(t=>{e.push(n.a.createElement("div",{key:t.id,className:"combatant-row"},this.getPortrait(t),this.getText(t),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(t)})))}),0===e.length&&e.push(n.a.createElement("div",{key:"empty "+t.id,className:"section"},"no monsters"))});let t=null;if(this.props.parties.length>0){const e=this.props.parties.map(e=>({id:e.id,text:e.name}));t=n.a.createElement(A,{options:e,placeholder:"run with...",select:e=>this.props.run(this.props.encounter,e)})}return n.a.createElement("div",{className:"card encounter"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.encounter.name||"unnamed encounter")),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"fixed-height"},n.a.createElement("div",{className:"subheading"},"monsters"),e,n.a.createElement("div",{className:"subheading"},"xp"),N.getEncounterXP(this.props.encounter,this.props.getMonster)),n.a.createElement("div",{className:"divider"}),t,n.a.createElement("button",{onClick:()=>this.props.edit(this.props.encounter)},"edit encounter"),n.a.createElement(w,{text:"delete encounter",callback:()=>this.props.delete(this.props.encounter)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Rt=a(257);class Bt extends n.a.Component{render(){try{const e=n.a.createElement(Rt.a,null,n.a.createElement("div",{key:"prologue"},n.a.createElement("p",{className:"heading"},"welcome to ",n.a.createElement("span",{className:"app-name"},"dojo")),n.a.createElement("p",null,n.a.createElement("span",{className:"app-name"},"dojo")," is an app for dms of ",n.a.createElement("a",{href:"https://www.wizards.com/dnd",target:"_blank",rel:"noopener noreferrer"},"dungeons and dragons fifth edition")),n.a.createElement("p",null,"with ",n.a.createElement("span",{className:"app-name"},"dojo")," you can...")),n.a.createElement("div",{key:"monster"},n.a.createElement("p",{className:"heading"},"build unique, challenging monsters"),n.a.createElement("ul",null,n.a.createElement("li",null,"watch the stat block change as you design your monster"),n.a.createElement("li",null,"see a list of similar monsters to help kickstart your creativity (or show you typical stat values for the type of monster you're creating)"),n.a.createElement("li",null,"build an entirely random monster with a single click"),n.a.createElement("li",null,"easily import any monster from ",n.a.createElement("a",{href:"https://dnd.wizards.com/articles/features/basicrules",target:"_blank",rel:"noopener noreferrer"},"the basic rules")," or from ",n.a.createElement("a",{href:"https://www.dndbeyond.com",target:"_blank",rel:"noopener noreferrer"},"d&d beyond")))),n.a.createElement("div",{key:"encounter"},n.a.createElement("p",{className:"heading"},"create encounters of just the right difficulty"),n.a.createElement("ul",null,n.a.createElement("li",null,"quickly add monsters to your encounter and see its xp value and difficulty level change"),n.a.createElement("li",null,"split your encounter into multiple waves"),n.a.createElement("li",null,"let ",n.a.createElement("span",{className:"app-name"},"dojo")," build a random encounter on the fly"))),n.a.createElement("div",{key:"map"},n.a.createElement("p",{className:"heading"},"design intricate tactical maps"),n.a.createElement("ul",null,n.a.createElement("li",null,"create a dungeon map by quickly adding rooms, doors, corridors, and stairs"),n.a.createElement("li",null,"for something a little more fancy, you can upload your own battlemap images - even animated images"),n.a.createElement("li",null,"generate an entire random dungeon map with one click"))),n.a.createElement("div",{key:"combat"},n.a.createElement("p",{className:"heading"},"run combat without the book-keeping"),n.a.createElement("ul",null,n.a.createElement("li",null,"see the initiative list at a glance - and share it with players in a separate window"),n.a.createElement("li",null,"track monster hit points and rechargable actions"),n.a.createElement("li",null,"track conditions, their durations, and the effects they impose"),n.a.createElement("li",null,"if you're using a tactical map, ",n.a.createElement("span",{className:"app-name"},"dojo")," keeps track of everyone's location"))),n.a.createElement("div",{key:"epilogue"},n.a.createElement("p",{className:"heading"},"to get started"),n.a.createElement("p",null,"use the buttons at the bottom of the screen to explore ",n.a.createElement("span",{className:"app-name"},"dojo"),"'s main features"),n.a.createElement("p",null,"or press the buttons at the top right for additional tools like a die roller, some useful random generators, and rules references")));return n.a.createElement(o.a,{align:"middle",justify:"center",className:"scrollable"},n.a.createElement(c.a,{span:24},n.a.createElement("div",{className:"section centered"},e)))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class jt extends n.a.Component{render(){try{const e=this.props.maps;u.sort(e);const t=e.map(e=>n.a.createElement(Ht,{key:e.id,map:e,editMap:e=>this.props.editMap(e),removeMap:e=>this.props.deleteMap(e)}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"on this page you can set up tactical maps"),n.a.createElement("div",{className:"section"},"when you have created a map you can use it in the combat manager"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"on the right you will see a list of maps"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"to start a new map, press the ",n.a.createElement("b",null,"create a new map")," button")),n.a.createElement("button",{onClick:()=>this.props.addMap()},"create a new map"),n.a.createElement(G,{text:"map generator"},n.a.createElement("button",{onClick:()=>this.props.generateMap("dungeon")},"create a new dungeon map"),n.a.createElement("button",{onClick:()=>this.props.generateMap("delve")},"create a new delve map"))),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{heading:"maps",content:t})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ht extends n.a.Component{render(){try{return n.a.createElement("div",{className:"card map"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.map.name||"unnamed map")),n.a.createElement("div",{className:"card-content"},n.a.createElement(o.a,{align:"middle",justify:"center",className:"fixed-height"},n.a.createElement(c.a,{span:24},n.a.createElement(he,{map:this.props.map,mode:"thumbnail",size:12}))),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.editMap(this.props.map)},"edit map"),n.a.createElement(w,{text:"delete map",callback:()=>this.props.removeMap(this.props.map)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var qt=a(267);class Ft extends n.a.Component{export(e){const t=e.name+".monster";u.saveFile(t,e)}render(){try{const e=[];return 0!==this.props.monsterGroup.monsters.length?this.props.monsterGroup.monsters.forEach(t=>{e.push(n.a.createElement(ae,{monster:t,mode:"editable",library:this.props.library,moveToGroup:(e,t)=>this.props.moveToGroup(e,t),removeMonster:e=>this.props.removeMonster(e),viewMonster:e=>this.props.viewMonster(e),editMonster:e=>this.props.editMonster(e),exportMonster:e=>this.export(e),cloneMonster:(e,t)=>this.props.cloneMonster(e,t)}))}):e.push(n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"there are no monsters in this group"))),n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Wt,{monsterGroup:this.props.monsterGroup,goBack:()=>this.props.goBack(),addMonster:()=>this.props.addMonster(),importMonster:()=>this.props.importMonster(),changeValue:(e,t)=>this.props.changeValue(this.props.monsterGroup,e,t),removeMonsterGroup:()=>this.props.removeMonsterGroup(),openDemographics:()=>this.props.openDemographics(this.props.monsterGroup)})),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{content:e,heading:this.props.monsterGroup.name||"unnamed group"})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Wt extends n.a.Component{getSummary(){if(0===this.props.monsterGroup.monsters.length)return n.a.createElement("div",{className:"section centered"},n.a.createElement("i",null,"no monsters"));const e={min:30,max:0};this.props.monsterGroup.monsters.forEach(t=>{e.min=Math.min(e.min,t.challenge),e.max=Math.max(e.max,t.challenge)});const t=e.min===e.max?u.challenge(e.min):u.challenge(e.min)+" - "+u.challenge(e.max);return n.a.createElement("div",{className:"group-panel"},n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"monsters")),n.a.createElement("div",{className:"section"},this.props.monsterGroup.monsters.length),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"challenge rating")),n.a.createElement("div",{className:"section"},t))}export(){const e=this.props.monsterGroup.name+".monstergroup";u.saveFile(e,this.props.monsterGroup)}render(){try{return n.a.createElement("div",null,n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"monster group name"),n.a.createElement(q,{text:this.props.monsterGroup.name,placeholder:"monster group name",onChange:e=>this.props.changeValue("name",e)})),n.a.createElement("div",{className:"divider"}),this.getSummary(),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("button",{onClick:()=>this.props.addMonster()},"add a new monster"),n.a.createElement("button",{onClick:()=>this.props.importMonster()},"import a monster"),n.a.createElement("button",{onClick:()=>this.props.openDemographics()},"show demographics"),n.a.createElement("button",{onClick:()=>this.export()},"export group"),n.a.createElement(w,{text:"delete group",callback:()=>this.props.removeMonsterGroup()}),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.goBack()},n.a.createElement(qt.a,{style:{fontSize:"10px"}})," back to the list")))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Yt extends n.a.Component{render(){try{if(!this.props.hasMonsters)return n.a.createElement(o.a,{align:"middle",justify:"center",className:"scrollable"},n.a.createElement(c.a,{xs:20,sm:18,md:16,lg:12,xl:10},n.a.createElement(Nt,null,n.a.createElement("div",{className:"section"},"to kickstart your monster collection, let's import all the monsters from the ",n.a.createElement("a",{href:"http://dnd.wizards.com/articles/features/systems-reference-document-srd",target:"_blank",rel:"noopener noreferrer"},"d&d system reference document")),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.addOpenGameContent()},"import monsters"))));const e=this.props.library;u.sort(e);const t=e.map(e=>n.a.createElement(Jt,{key:e.id,group:e,open:e=>this.props.selectMonsterGroup(e),delete:e=>this.props.deleteMonsterGroup(e),openStatBlock:e=>this.props.openStatBlock(e)}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"you can maintain your menagerie of monsters here"),n.a.createElement("div",{className:"section"},"you can then use these monsters to design combat encounters in the encounter builder"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"on the right you will see a list of monster groups"),n.a.createElement("div",{className:"section"},"select a monster group from the list to see stat blocks for monsters in that group"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"to start adding monsters, press the ",n.a.createElement("b",null,"create a new monster group")," button")),n.a.createElement("button",{onClick:()=>this.props.addMonsterGroup()},"create a new monster group"),n.a.createElement("button",{onClick:()=>this.props.importMonsterGroup()},"import a monster group"),n.a.createElement("button",{onClick:()=>this.props.openDemographics(null)},"show demographics")),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{heading:"monster groups",content:t})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Jt extends n.a.Component{getMonsters(){const e=this.props.group.monsters.map(e=>n.a.createElement("div",{key:e.id,className:"combatant-row"},n.a.createElement(J,{source:e,inline:!0}),n.a.createElement("div",{className:"name"},e.name||"unnamed monster"),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(e)})));return 0===e.length&&e.push(n.a.createElement("div",{key:"empty",className:"section"},"no monsters")),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"monsters"),e)}render(){try{return n.a.createElement("div",{className:"card monster"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.group.name||"unnamed group")),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"fixed-height"},this.getMonsters()),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.open(this.props.group)},"open group"),n.a.createElement(w,{text:"delete group",callback:()=>this.props.delete(this.props.group)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class _t extends n.a.Component{render(){try{const e=this.props.parties;u.sort(e);const t=e.map(e=>n.a.createElement(Xt,{key:e.id,party:e,open:e=>this.props.selectParty(e),delete:e=>this.props.deleteParty(e),openStatBlock:e=>this.props.openStatBlock(e)}));return n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"this page is where you can tell dojo all about your pcs"),n.a.createElement("div",{className:"section"},"you can add a party for each of your gaming groups"),n.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can run the encounter in the combat manager"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"on the right you will see a list of parties that you have created"),n.a.createElement("div",{className:"section"},"select a party from the list to see pc details"),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},"to start adding a party, press the ",n.a.createElement("b",null,"create a new party")," button")),n.a.createElement("button",{onClick:()=>this.props.addParty()},"create a new party"),n.a.createElement("button",{onClick:()=>this.props.importParty()},"import a party")),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{heading:"parties",content:t})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Xt extends n.a.Component{getText(e){let t=e.name||"unnamed pc";return e.player&&(t+=" ("+e.player+")"),t}render(){try{const e=this.props.party.pcs.filter(e=>e.active).map(e=>n.a.createElement("div",{key:e.id,className:"combatant-row"},n.a.createElement(J,{source:e,inline:!0}),n.a.createElement("div",{className:"name"},this.getText(e)),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(e)})));0===e.length&&e.push(n.a.createElement("div",{key:"empty",className:"section"},"no pcs"));const t=this.props.party.pcs.filter(e=>!e.active);return t.length>0&&(e.push(n.a.createElement("div",{key:"inactive",className:"subheading"},"inactive pcs")),t.forEach(t=>e.push(n.a.createElement("div",{key:t.id,className:"combatant-row"},n.a.createElement(J,{source:t,inline:!0}),n.a.createElement("div",{className:"name"},this.getText(t)),n.a.createElement(ht.a,{className:"info-icon",onClick:()=>this.props.openStatBlock(t)}))))),n.a.createElement("div",{className:"card pc"},n.a.createElement("div",{className:"heading"},n.a.createElement("div",{className:"title"},this.props.party.name||"unnamed party")),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"fixed-height"},n.a.createElement("div",{className:"subheading"},"pcs"),e),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.open(this.props.party)},"open party"),n.a.createElement(w,{text:"delete party",callback:()=>this.props.delete(this.props.party)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ut extends n.a.Component{export(e){const t=e.name+".pc";u.saveFile(t,e)}render(){try{const e=this.props.party.pcs.filter(e=>e.active),t=[];e.forEach(e=>{t.push(n.a.createElement(ze,{pc:e,mode:"edit",changeValue:(e,t,a)=>this.props.changeValue(e,t,a),editPC:e=>this.props.editPC(e),updatePC:e=>this.props.updatePC(e),exportPC:e=>this.export(e),removePC:e=>this.props.removePC(e)}))});const a=this.props.party.pcs.filter(e=>!e.active),s=[];return a.forEach(e=>{s.push(n.a.createElement(ze,{pc:e,mode:"edit",changeValue:(e,t,a)=>this.props.changeValue(e,t,a),editPC:e=>this.props.editPC(e),updatePC:e=>this.props.updatePC(e),exportPC:e=>this.export(e),removePC:e=>this.props.removePC(e)}))}),0===e.length&&t.push(n.a.createElement(Z,null,n.a.createElement("div",{className:"section"},"there are no pcs in this party"))),n.a.createElement(o.a,{className:"full-height"},n.a.createElement(c.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},n.a.createElement(Kt,{party:this.props.party,goBack:()=>this.props.goBack(),addPC:()=>this.props.addPC(),importPC:()=>this.props.importPC(),changeValue:(e,t)=>this.props.changeValue(this.props.party,e,t),removeParty:()=>this.props.removeParty()})),n.a.createElement(c.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},n.a.createElement(Oe,{content:t,heading:this.props.party.name||"unnamed party"}),n.a.createElement(Oe,{content:s,heading:"inactive pcs"})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Kt extends n.a.Component{getSummary(){const e=this.props.party.pcs.filter(e=>e.active);if(0===e.length)return n.a.createElement("div",{className:"section centered"},n.a.createElement("i",null,"no pcs"));let t="",a="-",s="-",r="-";t=e.map(e=>e.languages).join(", ").split(/[ ,;]+/).reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),[]).sort((e,t)=>"Common"===e?-1:"Common"===t?1:e.localeCompare(t)).join(", ");const i={min:null,max:null},o={min:null,max:null},c={min:null,max:null};return e.forEach(e=>{i.min=null===i.min?e.passiveInsight:Math.min(i.min,e.passiveInsight),i.max=null===i.max?e.passiveInsight:Math.max(i.max,e.passiveInsight),o.min=null===o.min?e.passiveInvestigation:Math.min(o.min,e.passiveInvestigation),o.max=null===o.max?e.passiveInvestigation:Math.max(o.max,e.passiveInvestigation),c.min=null===c.min?e.passivePerception:Math.min(c.min,e.passivePerception),c.max=null===c.max?e.passivePerception:Math.max(c.max,e.passivePerception)}),a=i.min===i.max?i.min.toString():i.min+" - "+i.max,s=o.min===o.max?o.min.toString():o.min+" - "+o.max,r=c.min===c.max?c.min.toString():c.min+" - "+c.max,n.a.createElement("div",{className:"group-panel"},n.a.createElement("div",{className:"section",style:{display:""!==t?"block":"none"}},n.a.createElement("div",{className:"subheading"},"party languages")),n.a.createElement("div",{className:"section"},t),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"party passive skills")),n.a.createElement("div",{className:"table"},n.a.createElement("div",null,n.a.createElement("div",{className:"cell three"},n.a.createElement("b",null,"insight")),n.a.createElement("div",{className:"cell three"},n.a.createElement("b",null,"invest.")),n.a.createElement("div",{className:"cell three"},n.a.createElement("b",null,"percep."))),n.a.createElement("div",null,n.a.createElement("div",{className:"cell three"},a),n.a.createElement("div",{className:"cell three"},s),n.a.createElement("div",{className:"cell three"},r))))}export(){const e=this.props.party.name+".party";u.saveFile(e,this.props.party)}render(){try{return n.a.createElement("div",null,n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"subheading"},"party name"),n.a.createElement(q,{text:this.props.party.name,placeholder:"party name",onChange:e=>this.props.changeValue("name",e)})),n.a.createElement("div",{className:"divider"}),this.getSummary(),n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"section"},n.a.createElement("button",{onClick:()=>this.props.addPC()},"add a new pc"),n.a.createElement("button",{onClick:()=>this.props.importPC()},"import a pc"),n.a.createElement("button",{onClick:()=>this.export()},"export party"),n.a.createElement(w,{text:"delete party",callback:()=>this.props.removeParty()}),n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.props.goBack()},n.a.createElement(qt.a,{style:{fontSize:"10px"}})," back to the list")))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Zt extends n.a.Component{constructor(e){super(e),this.state={description:"",physical:"",mental:"",speech:""}}generate(){this.setState({description:Xe.generateNPC(),physical:Xe.generateNPCPhysical(),mental:Xe.generateNPCMental(),speech:Xe.generateNPCSpeech()})}render(){try{return n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.generate()},"generate"),n.a.createElement("div",{className:"generated-item"},this.state.description),this.state.physical?n.a.createElement("div",{className:"generated-item"},"physical: ",this.state.physical):null,this.state.mental?n.a.createElement("div",{className:"generated-item"},"personality: ",this.state.mental):null,this.state.speech?n.a.createElement("div",{className:"generated-item"},"speech: ",this.state.speech):null)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var Qt=a(20),$t=a.n(Qt),ea=a(30),ta=a(297);class aa extends n.a.Component{constructor(e){super(e),this.state={source:null,values:[]}}fetchData(){var e=this;return Object(ea.a)($t.a.mark((function t(){var a,s;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/dojo/data/places.txt");case 2:return a=t.sent,t.next=5,a.text();case 5:s=t.sent,e.setState({source:s});case 7:case"end":return t.stop()}}),t)})))()}generate(){Xe.initModel([this.state.source]),this.setState({values:Xe.generate(10).map(e=>e.line)})}render(){try{this.state.source||this.fetchData();const e=[];for(let t=0;t!==this.state.values.length;++t)e.push(n.a.createElement(sa,{key:t,text:this.state.values[t]}));return n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.generate()},"generate"),n.a.createElement("div",{className:"language-output"},e))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class sa extends n.a.Component{copy(e){e.stopPropagation(),navigator.clipboard.writeText(this.props.text)}render(){try{return n.a.createElement("div",{className:"generated-item"},n.a.createElement("div",{className:"text-section"},this.props.text.toLowerCase()),n.a.createElement("div",{className:"icon-section"},n.a.createElement(ta.a,{title:"copy",onClick:e=>this.copy(e)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class na extends n.a.Component{constructor(e){super(e),this.state={values:[]}}generate(){const e=[];for(;e.length<10;){let t="";switch(this.props.type){case"book":t=Xe.generateBookTitle();break;case"name":t=Xe.generateName();break;case"potion":t=Xe.generatePotion();break;case"treasure":t=Xe.generateTreasure()}e.includes(t)||e.push(t)}e.sort(),this.setState({values:e})}render(){try{const e=[];for(let t=0;t!==this.state.values.length;++t)e.push(n.a.createElement(ra,{key:t,text:this.state.values[t]}));return n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.generate()},"generate"),e)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ra extends n.a.Component{copy(e){e.stopPropagation(),navigator.clipboard.writeText(this.props.text)}render(){try{return n.a.createElement("div",{className:"generated-item"},n.a.createElement("div",{className:"text-section"},this.props.text.toLowerCase()),n.a.createElement("div",{className:"icon-section"},n.a.createElement(ta.a,{title:"copy",onClick:e=>this.copy(e)})))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ia extends n.a.Component{constructor(e){super(e),this.state={view:"name"}}setView(e){this.setState({view:e})}render(){try{const e=[{id:"name",text:"names"},{id:"book",text:"book titles"},{id:"potion",text:"potions"},{id:"treasure",text:"treasures"},{id:"place",text:"place names"},{id:"npc",text:"npcs"}];let t=null;switch(this.state.view){case"name":t=n.a.createElement(na,{key:"name",type:"name"});break;case"book":t=n.a.createElement(na,{key:"book",type:"book"});break;case"potion":t=n.a.createElement(na,{key:"potion",type:"potion"});break;case"treasure":t=n.a.createElement(na,{key:"treasure",type:"treasure"});break;case"place":t=n.a.createElement(aa,null);break;case"npc":t=n.a.createElement(Zt,null)}return n.a.createElement("div",{className:"sidebar-container"},n.a.createElement("div",{className:"sidebar-header"},n.a.createElement("div",{className:"heading"},"generators"),n.a.createElement(se,{options:e,selectedID:this.state.view,itemsPerRow:3,select:e=>this.setView(e)})),n.a.createElement("div",{className:"sidebar-content"},t))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var oa=a(292),ca=a(258);const la=new K.a.Converter;la.setOption("tables",!0);class ma extends n.a.Component{constructor(e){super(e),this.state={view:"skills"}}setView(e){this.setState({view:e})}render(){try{const e=[{id:"skills",text:"skills"},{id:"conditions",text:"conditions"},{id:"actions",text:"actions"}];let t=null;switch(this.state.view){case"skills":t=n.a.createElement(da,{key:"skills",filename:"/dojo/data/skills.md"});break;case"conditions":t=n.a.createElement(da,{key:"conditions",filename:"/dojo/data/conditions.md"});break;case"actions":t=n.a.createElement(da,{key:"actions",filename:"/dojo/data/actions.md"})}return n.a.createElement("div",{className:"sidebar-container"},n.a.createElement("div",{className:"sidebar-header"},n.a.createElement("div",{className:"heading"},"reference"),n.a.createElement(se,{options:e,selectedID:this.state.view,itemsPerRow:3,select:e=>this.setView(e)})),n.a.createElement("div",{className:"sidebar-content"},t))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class da extends n.a.Component{constructor(e){super(e),this.state={source:null}}fetchData(){var e=this;return Object(ea.a)($t.a.mark((function t(){var a,s;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.props.filename);case 2:return a=t.sent,t.next=5,a.text();case 5:s=t.sent,e.setState({source:s});case 7:case"end":return t.stop()}}),t)})))()}render(){try{return this.state.source||this.fetchData(),n.a.createElement(ca.a,{spinning:null===this.state.source,indicator:n.a.createElement(oa.a,{style:{fontSize:20,marginTop:100}})},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:la.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class pa extends n.a.Component{constructor(e){super(e),this.state={text:""}}setSearchTerm(e){this.setState({text:e})}render(){try{const e=[];return this.state.text.length>2&&(this.props.parties.filter(e=>f.matchParty(this.state.text,e)).forEach(t=>{const a=[];t.pcs.filter(e=>f.matchPC(this.state.text,e)).forEach(e=>{const t=[];e.companions.filter(e=>f.matchCompanion(this.state.text,e)).forEach(e=>{t.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.name)))}),a.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.name),t))}),e.push(n.a.createElement("div",{key:t.id,className:"group-panel clickable",onClick:()=>this.props.openParty(t.id)},n.a.createElement("div",{className:"section"},t.name),a))}),this.props.library.filter(e=>f.matchGroup(this.state.text,e)).forEach(t=>{const a=[];t.monsters.filter(e=>f.matchMonster(this.state.text,e)).forEach(e=>{const t=[];e.traits.filter(e=>f.matchTrait(this.state.text,e)).forEach(e=>{t.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.name)))}),a.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.name),t))}),e.push(n.a.createElement("div",{key:t.id,className:"group-panel clickable",onClick:()=>this.props.openGroup(t.id)},n.a.createElement("div",{className:"section"},t.name),a))}),this.props.encounters.filter(e=>f.matchEncounter(this.state.text,e)).forEach(t=>{const a=[];t.slots.filter(e=>f.matchEncounterSlot(this.state.text,e)).forEach(e=>{a.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.monsterName)))});const s=[];t.waves.filter(e=>f.matchEncounterWave(this.state.text,e)).forEach(e=>{const t=[];e.slots.filter(e=>f.matchEncounterSlot(this.state.text,e)).forEach(e=>{t.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.monsterName)))}),s.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},e.name),t))}),e.push(n.a.createElement("div",{key:t.id,className:"group-panel clickable",onClick:()=>this.props.openEncounter(t.id)},n.a.createElement("div",{className:"section"},t.name),a,s))}),this.props.maps.filter(e=>f.matchMap(this.state.text,e)).forEach(t=>{const a=[];t.notes.filter(e=>f.matchMapNote(this.state.text,e)).forEach(e=>{a.push(n.a.createElement("div",{key:e.id,className:"group-panel"},n.a.createElement("div",{className:"section"},"map note")))}),e.push(n.a.createElement("div",{key:t.id,className:"group-panel clickable",onClick:()=>this.props.openMap(t.id)},n.a.createElement("div",{className:"section"},t.name),a))}),0===e.length&&e.push(n.a.createElement(Z,{key:"empty"},"nothing found"))),n.a.createElement("div",{className:"sidebar-container"},n.a.createElement("div",{className:"sidebar-header"},n.a.createElement("div",{className:"heading"},"search"),n.a.createElement(H.a.Search,{value:this.state.text,placeholder:"enter your search term here",allowClear:!0,onChange:e=>this.setSearchTerm(e.target.value),onSearch:e=>this.setSearchTerm(e)})),n.a.createElement("div",{className:"sidebar-content"},e))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ha extends n.a.Component{constructor(e){super(e),this.state={dice:"20",count:1,options:[],rolls:null,result:null}}setDice(e){this.setState({dice:e})}nudgeCount(e){this.setState({count:Math.max(1,this.state.count+e)})}toggleOption(e){if(this.state.options.includes(e)){const t=this.state.options.indexOf(e);this.state.options.splice(t,1)}else if(this.state.options.push(e),this.state.options.includes("advantage")&&this.state.options.includes("disadvantage")){const t=this.state.options.indexOf("advantage"===e?"disadvantage":"advantage");this.state.options.splice(t,1)}this.setState({options:this.state.options})}roll(){const e=parseInt(this.state.dice,10),t=[];let a=this.state.count;(this.state.options.includes("advantage")||this.state.options.includes("disadvantage"))&&(a=2);for(let n=0;n!==a;++n)t.push(u.dieRoll(e));t.sort((e,t)=>e-t);let s=0;1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("advantage")?s=Math.max(...t):1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("disadvantage")?s=Math.min(...t):(t.forEach(e=>s+=e),this.state.count>1&&this.state.options.includes("drop lowest")&&(s-=Math.min(...t)),this.state.count>1&&this.state.options.includes("drop highest")&&(s-=Math.max(...t))),this.setState({rolls:t,result:s})}render(){try{const e=[{id:"4",text:"d4"},{id:"6",text:"d6"},{id:"8",text:"d8"},{id:"10",text:"d10"},{id:"12",text:"d12"},{id:"20",text:"d20"},{id:"100",text:"d100"}];let t=null;"20"===this.state.dice&&1===this.state.count?t=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement(k,{label:"advantage",checked:this.state.options.includes("advantage"),changeValue:e=>this.toggleOption("advantage")})),n.a.createElement(c.a,{span:12},n.a.createElement(k,{label:"disadvantage",checked:this.state.options.includes("disadvantage"),changeValue:e=>this.toggleOption("disadvantage")}))):this.state.count>1&&(t=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement(k,{label:"drop lowest",checked:this.state.options.includes("drop lowest"),changeValue:e=>this.toggleOption("drop lowest")})),n.a.createElement(c.a,{span:12},n.a.createElement(k,{label:"drop highest",checked:this.state.options.includes("drop highest"),changeValue:e=>this.toggleOption("drop highest")}))));let a=null;null!==this.state.rolls&&this.state.rolls.length>1&&(a=n.a.createElement("div",{className:"section die-rolls"},this.state.rolls.join(", ")));let s=null;return null!==this.state.result&&(s=n.a.createElement("div",{className:"section die-result"},this.state.result)),n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"die type"),n.a.createElement(se,{options:e,selectedID:this.state.dice,select:e=>this.setDice(e)}),n.a.createElement("div",{className:"subheading"},"number of dice to roll"),n.a.createElement(j,{source:this.state,name:"count",display:e=>e+"d"+this.state.dice,nudgeValue:e=>this.nudgeCount(e)}),t?n.a.createElement("div",{className:"subheading"},"options"):null,t,n.a.createElement("div",{className:"divider"}),n.a.createElement("button",{onClick:()=>this.roll()},"roll dice"),a,s)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}var ua=a(298);class ga{static say(e,t){return Object(ea.a)($t.a.mark((function a(){var s;return $t.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return window.speechSynthesis.cancel(),s=new SpeechSynthesisUtterance(e),a.next=4,ga.chooseVoice(t);case 4:s.voice=a.sent,s.rate=ga.randomValue(.5,1.5),s.pitch=ga.randomValue(.5,1.5),window.speechSynthesis.speak(s);case 8:case"end":return a.stop()}}),a)})))()}static chooseVoice(e){return Object(ea.a)($t.a.mark((function t(){var a,s,n,r;return $t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ga.getVoices();case 2:return a=t.sent,s=e.map(e=>ga.getLanguageCode(e)),0===(n=a.filter(e=>s.includes(e.lang.substr(0,2)))).length&&(n=a.filter(e=>e.default)),0===n.length&&(n=a),r=Math.floor(Math.random()*n.length),t.abrupt("return",n[r]);case 9:case"end":return t.stop()}}),t)})))()}static getVoices(){return new Promise(e=>{let t=window.speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=()=>{t=window.speechSynthesis.getVoices(),e(t)}})}static getLanguageCode(e){switch(e){case"armenian":return"hy";case"basque":return"eu";case"bulgarian":return"bg";case"chichewa":return"ny";case"chinese":return"zh";case"croatian":return"hr";case"czech":return"cs";case"dutch":return"nl";case"german":return"de";case"greek":return"el";case"icelandic":return"is";case"irish":return"ga";case"kannada":return"kn";case"kazakh":return"kk";case"latvian":return"lv";case"lithuanian":return"lt";case"macedonian":return"mk";case"malay":return"ms";case"maltese":return"mt";case"maori":return"mi";case"polish":return"pl";case"portuguese":return"pt";case"punjabi":return"pa";case"samoan":return"sm";case"serbian":return"sr";case"shona":return"sn";case"spanish":return"es";case"swedish":return"sv";case"turkish":return"tr";case"welsh":return"cy";default:return e.substr(0,2)}}static randomValue(e,t){return e+(Math.random()+Math.random()+Math.random())/3*(t-e)}}class ba extends n.a.Component{constructor(e){super(e),this.state={sources:{},output:[]}}getLanguages(){return["afrikaans","amharic","armenian","basque","belarusian","bulgarian","chichewa","chinese","croatian","czech","danish","dutch","english","finnish","french","german","greek","hawaiian","hindi","hungarian","icelandic","irish","italian","japanese","kannada","kazakh","korean","kyrgyz","latvian","lithuanian","macedonian","malay","maltese","maori","myanmar","nepali","norwegian","polish","portuguese","punjabi","romanian","russian","samoan","serbian","shona","somali","spanish","swahili","swedish","thai","turkish","welsh","yiddish","zulu"]}getPresets(){return[{name:"draconic",languages:["armenian","irish","maltese"]},{name:"dwarvish",languages:["czech","german","yiddish"]},{name:"elvish",languages:["finnish","spanish","welsh"]},{name:"goblin",languages:["hawaiian","kyrgyz","somali"]},{name:"orc",languages:["macedonian","russian","turkish"]}]}addLanguage(e){var t=this;return Object(ea.a)($t.a.mark((function a(){var s;return $t.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("/dojo/data/langs/"+e+".txt");case 2:return s=a.sent,a.next=5,s.text();case 5:t.state.sources[e]=a.sent,t.setState({sources:t.state.sources});case 7:case"end":return a.stop()}}),a)})))()}removeLanguage(e){delete this.state.sources[e],this.setState({sources:this.state.sources})}usePreset(e){const t=this.getPresets().find(t=>t.name===e);t&&this.setState({sources:{},output:[]},()=>{t.languages.forEach(e=>{this.addLanguage(e)})})}random(){const e=this.getLanguages(),t=[];for(;3!==t.length;){const a=e[Math.floor(Math.random()*e.length)];t.includes(a)||t.push(a)}this.setState({sources:{},output:[]},()=>{t.forEach(e=>{this.addLanguage(e)})})}generate(){const e=[];Object.keys(this.state.sources).forEach(t=>{const a=this.state.sources[t];e.push(a)}),Xe.initModel(e),this.setState({output:Xe.generate(5).map(e=>e.line)})}reset(){this.setState({sources:{},output:[]})}render(){try{const e=this.getPresets().map(e=>({id:e.name,text:e.name}));let t="";this.getPresets().forEach(e=>{Object.keys(this.state.sources).sort().join(", ")===e.languages.sort().join(", ")&&(t=e.name)});let a=Object.keys(this.state.sources).sort().join(", ");""===a&&(a="none");const s=this.getLanguages().map(e=>{const t=Object.keys(this.state.sources).includes(e);return n.a.createElement(k,{key:e,label:e,checked:t,display:"button",changeValue:t=>t?this.addLanguage(e):this.removeLanguage(e)})}),r=Object.keys(this.state.sources).length>0,i=r||this.state.output.length>0,l=[];this.state.output.length>0&&l.push(n.a.createElement("div",{key:"div",className:"divider"}));for(let o=0;o!==this.state.output.length;++o)l.push(n.a.createElement(Ea,{key:o,text:this.state.output[o],languages:Object.keys(this.state.sources)}));return n.a.createElement("div",null,n.a.createElement("div",{className:"subheading"},"presets"),n.a.createElement(se,{options:e,selectedID:t,select:e=>this.usePreset(e)}),n.a.createElement("div",{className:"divider"}),n.a.createElement(G,{text:"selected languages: "+a},n.a.createElement("div",{className:"language-options"},n.a.createElement(Oe,{columns:3,content:s}))),n.a.createElement("div",{className:"divider"}),n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:8},n.a.createElement("button",{className:r?"":"disabled",onClick:()=>this.generate()},"generate text")),n.a.createElement(c.a,{span:8},n.a.createElement("button",{className:i?"":"disabled",onClick:()=>this.reset()},"reset")),n.a.createElement(c.a,{span:8},n.a.createElement("button",{onClick:()=>this.random()},"random sources"))),l)}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Ea extends n.a.Component{copy(e){e.stopPropagation(),navigator.clipboard.writeText(this.props.text)}say(e){e.stopPropagation(),ga.say(this.props.text,this.props.languages)}render(){try{return n.a.createElement("div",{className:"generated-item"},n.a.createElement("div",{className:"text-section"},this.props.text.toLowerCase()),n.a.createElement("div",{className:"icon-section"},n.a.createElement("div",null,n.a.createElement(ta.a,{title:"copy",onClick:e=>this.copy(e)})),n.a.createElement("div",null,n.a.createElement(ua.a,{title:"say",onClick:e=>this.say(e)}))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class va extends n.a.Component{constructor(e){super(e);const t=[this.createCard("ace of swords","breakthrough, clarity, sharp mind","confusion, brutality, chaos"),this.createCard("two of swords","difficult choices, indecision, stalemate","lesser of two evils, no right choice, confusion"),this.createCard("three of swords","heartbreak, suffering, grief","recovery, forgiveness, moving on"),this.createCard("four of swords","rest, restoration, contemplation","restlessness, burnout, stress"),this.createCard("five of swords","unbridled ambition, win at all costs, sneakiness","lingering resentment, desire to reconcile, forgiveness"),this.createCard("six of swords","transition, leaving behind, moving on","emotional baggage, unresolved issues, resisting transition"),this.createCard("seven of swords","deception, trickery, tactics and strategy","coming clean, rethinking approach, deception"),this.createCard("eight of swords","imprisonment, entrapment, self-victimization","self acceptance, new perspective, freedom"),this.createCard("nine of swords","anxiety, hopelessness, trauma","hope, reaching out, despair"),this.createCard("ten of swords","failure, collapse, defeat","can't get worse, only upwards, inevitable end"),this.createCard("page of swords","curiosity, restlessness, mental energy","deception, manipulation, all talk"),this.createCard("knight of swords","action, impulsiveness, defending beliefs","no direction, disregard for consequences, unpredictability"),this.createCard("queen of swords","complexity, perceptiveness, clear mindedness","cold hearted, cruel, bitterness"),this.createCard("king of swords","head over heart, discipline, truth","manipulative, cruel, weakness"),this.createCard("ace of wands","creation, willpower, inspiration, desire","lack of energy, lack of passion, boredom"),this.createCard("two of wands","planning, making decisions, leaving home","fear of change, playing safe, bad planning"),this.createCard("three of wands","looking ahead, expansion, rapid growth","obstacles, delays, frustration"),this.createCard("four of wands","community, home, celebration","lack of support, transience, home conflicts"),this.createCard("five of wands","competition, rivalry, conflict","avoiding conflict, respecting differences"),this.createCard("six of wands","victory, success, public reward","excess pride, lack of recognition, punishment"),this.createCard("seven of wands","perseverance, defensive, maintaining control","give up, destroyed confidence, overwhelmed"),this.createCard("eight of wands","rapid action, movement, quick decisions","panic, waiting, slowdown"),this.createCard("nine of wands","resilience, grit, last stand","exhaustion, fatigue, questioning motivations"),this.createCard("ten of wands","accomplishment, responsibility, burden","inability to delegate, overstressed, burnt out"),this.createCard("page of wands","exploration, excitement, freedom","lack of direction, procrastination, creating conflict"),this.createCard("knight of wands","action, adventure, fearlessness","anger, impulsiveness, recklessness"),this.createCard("queen of wands","courage, determination, joy","selfishness, jealousy, insecurities"),this.createCard("king of wands","big picture, leader, overcoming challenges","impulsive, overbearing, unachievable expectations"),this.createCard("ace of cups","new feelings, spirituality, intuition","emotional loss, blocked creativity, emptiness"),this.createCard("two of cups","unity, partnership, connection","imbalance, broken communication, tension"),this.createCard("three of cups","friendship, community, happiness","overindulgence, gossip, isolation"),this.createCard("four of cups","apathy, contemplation, disconnectedness","sudden awareness, choosing happiness, acceptance"),this.createCard("five of cups","loss, grief, self-pity","acceptance, moving on, finding peace"),this.createCard("six of cups","familiarity, happy memories, healing","moving forward, leaving home, independence"),this.createCard("seven of cups","searching for purpose, choices, daydreaming","lack of purpose, diversion, confusion"),this.createCard("eight of cups","walking away, disillusionment, leaving behind","avoidance, fear of change, fear of loss"),this.createCard("nine of cups","satisfaction, emotional stability, luxury","lack of inner joy, smugness, dissatisfaction"),this.createCard("ten of cups","inner happiness, fulfillment, dreams coming true","shattered dreams, broken family, domestic disharmony"),this.createCard("page of cups","happy surprise, dreamer, sensitivity","emotional immaturity, insecurity, disappointment"),this.createCard("knight of cups","following the heart, idealist, romantic","moodiness, disappointment"),this.createCard("queen of cups","compassion, calm, comfort","martyrdom, insecurity, dependence"),this.createCard("king of cups","compassion, control, balance","coldness, moodiness, bad advice"),this.createCard("ace of pentacles","opportunity, prosperity, new venture","lost opportunity, missed chance, bad investment"),this.createCard("two of pentacles","balancing decisions, priorities, adapting to change","loss of balance, disorganized, overwhelmed"),this.createCard("three of pentacles","teamwork, collaboration, building","lack of teamwork, disorganized, group conflict"),this.createCard("four of pentacles","conservation, frugality, security","greediness, stinginess, possessiveness"),this.createCard("five of pentacles","need, poverty, insecurity","recovery, charity, improvement"),this.createCard("six of pentacles","charity, generosity, sharing","strings attached, stinginess, power and domination"),this.createCard("seven of pentacles","hard work, perseverance, diligence","work without results, distractions, lack of rewards"),this.createCard("eight of pentacles","apprenticeship, passion, high standards","lack of passion, uninspired, no motivation"),this.createCard("nine of pentacles","fruits of labor, rewards, luxury","reckless spending, living beyond means, false success"),this.createCard("ten of pentacles","legacy, culmination, inheritance","fleeting success, lack of stability, lack of resources"),this.createCard("page of pentacles","ambition, desire, diligence","lack of commitment, greediness, laziness"),this.createCard("knight of pentacles","efficiency, hard work, responsibility","laziness, obsessiveness, work without reward"),this.createCard("queen of pentacles","practicality, creature comforts, financial security","self-centeredness, jealousy, smothering"),this.createCard("king of pentacles","abundance, prosperity, security","greed, indulgence, sensuality"),this.createCard("the fool","innocence, new beginnings, free spirit","recklessness, taken advantage of, inconsideration"),this.createCard("the magician","willpower, desire, creation, manifestation","trickery, illusions, out of touch"),this.createCard("the high priestess","intuitive, unconscious, inner voice","lack of center, lost inner voice, repressed feelings"),this.createCard("the empress","motherhood, fertility, nature","dependence, smothering, emptiness, nosiness"),this.createCard("the emperor","authority, structure, control, fatherhood","tyranny, rigidity, coldness"),this.createCard("the hierophant","tradition, conformity, morality, ethics","rebellion, subversiveness, new approaches"),this.createCard("the lovers","partnerships, duality, union","loss of balance, one-sidedness, disharmony"),this.createCard("the chariot","direction, control, willpower","lack of control, lack of direction, aggression"),this.createCard("strength","inner strength, bravery, compassion, focus","self doubt, weakness, insecurity"),this.createCard("the hermit","contemplation, search for truth, inner guidance","loneliness, isolation, lost your way"),this.createCard("the wheel of fortune","change, cycles, inevitable fate","no control, clinging to control, bad luck"),this.createCard("justice","cause and effect, clarity, truth","dishonesty, unaccountability, unfairness"),this.createCard("the hanged man","sacrifice, release, martyrdom","stalling, needless sacrifice, fear of sacrifice"),this.createCard("death","end of cycle, beginnings, change, metamorphosis","fear of change, holding on, stagnation, decay"),this.createCard("temperance","middle path, patience, finding meaning","extremes, excess, lack of balance"),this.createCard("the devil","addiction, materialism, playfulness","freedom, release, restoring control"),this.createCard("the tower","sudden upheaval, broken pride, disaster","disaster avoided, delayed disaster, fear of suffering"),this.createCard("the star","hope, faith, rejuvenation","faithlessness, discouragement, insecurity"),this.createCard("the moon","unconscious, illusions, intuition","confusion, fear, misinterpretation"),this.createCard("the sun","joy, success, celebration, positivity","negativity, depression, sadness"),this.createCard("judgement","reflection, reckoning, awakening","lack of self awareness, doubt, self loathing"),this.createCard("the world","fulfillment, harmony, completion","incompletion, no closure")];this.state={deck:t,draws:[]}}createCard(e,t,a){return{id:u.guid(),name:e,meanings:{upright:t,reversed:a}}}drawCards(e){const t=[];for(;t.length<e;){const e=u.randomNumber(this.state.deck.length),a=this.state.deck[e];t.find(e=>e.cardID===a.id)||t.push({id:u.guid(),cardID:a.id,reversed:u.randomBoolean()})}this.setState({draws:t})}render(){try{const e=this.state.draws.map(e=>{const t=this.state.deck.find(t=>t.id===e.cardID);return t?n.a.createElement(c.a,{span:8,key:e.id},n.a.createElement(ya,{card:t,reversed:e.reversed})):null});return n.a.createElement("div",null,n.a.createElement("button",{onClick:()=>this.drawCards(3)},"draw cards"),n.a.createElement(o.a,null,e))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ya extends n.a.Component{constructor(e){super(e),this.state={flipped:!1}}flip(){this.setState({flipped:!this.state.flipped})}render(){try{return n.a.createElement("div",{className:this.state.flipped?"oracle-card flipped":"oracle-card",onClick:()=>this.flip()},n.a.createElement("div",{className:"oracle-card-inner"},n.a.createElement("div",{className:"oracle-card-front"},"?"),n.a.createElement("div",{className:"oracle-card-back"},n.a.createElement("div",{className:"oracle-card-name"},this.props.card.name),n.a.createElement("div",{className:"oracle-card-reversed"},this.props.reversed?"(reversed)":""),n.a.createElement("div",{className:"oracle-card-meaning"},this.props.reversed?this.props.card.meanings.reversed:this.props.card.meanings.upright))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class fa extends n.a.Component{constructor(e){super(e),this.state={view:"die"}}setView(e){this.setState({view:e})}render(){try{const e=[{id:"die",text:"die roller"},{id:"language",text:"language blender"},{id:"oracle",text:"oracle"}];let t=null;switch(this.state.view){case"die":t=n.a.createElement(ha,null);break;case"language":t=n.a.createElement(ba,null);break;case"oracle":t=n.a.createElement(va,null)}return n.a.createElement("div",{className:"sidebar-container"},n.a.createElement("div",{className:"sidebar-header"},n.a.createElement("div",{className:"heading"},"tools"),n.a.createElement(se,{options:e,selectedID:this.state.view,itemsPerRow:3,select:e=>this.setView(e)})),n.a.createElement("div",{className:"sidebar-content"},t))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class Na extends n.a.Component{constructor(e){super(e),this.saveAfterDelay=u.debounce(()=>this.saveAll(),5e3);let t=[];try{const e=window.localStorage.getItem("data-parties");e&&(t=JSON.parse(e))}catch(i){console.error("Could not parse JSON: ",i)}let a=[];try{const e=window.localStorage.getItem("data-library");e&&(a=JSON.parse(e),a.forEach(e=>{e.monsters.forEach(e=>{if(void 0===e.legendaryActions){const t=e.traits.some(e=>"legendary"===e.type)?3:0;e.legendaryActions=t}})}))}catch(i){console.error("Could not parse JSON: ",i)}let s=[];try{const e=window.localStorage.getItem("data-encounters");e&&(s=JSON.parse(e))}catch(i){console.error("Could not parse JSON: ",i)}let n=[];try{const e=window.localStorage.getItem("data-maps");e&&(n=JSON.parse(e))}catch(i){console.error("Could not parse JSON: ",i)}let r=[];try{const e=window.localStorage.getItem("data-combats");e&&(r=JSON.parse(e),r.forEach(e=>{e.combatants.forEach(e=>{void 0===e.note&&(e.note="")}),e.map&&void 0===e.map.notes&&(e.map.notes=[]),void 0===e.report&&(e.report=[])}))}catch(i){console.error("Could not parse JSON: ",i)}this.state={view:"home",drawer:null,sidebar:null,parties:t,library:a,encounters:s,maps:n,combats:r,selectedPartyID:null,selectedMonsterGroupID:null,selectedCombatID:null}}componentDidUpdate(){this.saveAfterDelay()}setView(e){this.save(),this.setState({view:e})}setSidebar(e){this.setState({sidebar:e})}openToolsDrawer(e){this.setState({drawer:{type:e}})}closeDrawer(){this.setState({drawer:null})}selectParty(e){this.setState({selectedPartyID:e?e.id:null})}selectMonsterGroup(e){this.setState({selectedMonsterGroupID:e?e.id:null})}selectPartyByID(e){this.save(),this.setState({view:"parties",selectedPartyID:e})}selectMonsterGroupByID(e){this.save(),this.setState({view:"library",selectedMonsterGroupID:e})}selectEncounterByID(e){this.save(),this.setState({view:"encounters"})}selectMapByID(e){this.save(),this.setState({view:"maps"})}resetAll(){this.setState({parties:[],library:[],encounters:[],maps:[],combats:[],selectedPartyID:null,selectedMonsterGroupID:null,selectedCombatID:null},()=>this.saveAll())}getMonster(e,t){const a=this.state.library.find(e=>e.name===t);if(a){const t=a.monsters.find(t=>t.name===e);if(t)return t}return null}changeValue(e,t,a){switch(t){case"hpCurrent":a=Math.min(a,e.hpMax),a=Math.max(a,0);break;case"hpTemp":a=Math.max(a,0);break;case"level":a=Math.max(a,1),a=void 0!==e.player?Math.min(a,20):Math.min(a,6);break;case"count":case"hitDice":a=Math.max(a,1)}const s=t.split(".");let n=e;for(let r=0;r!==s.length;++r){const e=s[r];r===s.length-1?n[e]=a:n=n[e]}if(u.sort(this.state.parties),u.sort(this.state.library),u.sort(this.state.encounters),"initiative"===t&&!e.pending){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);N.sortCombatants(e)}this.setState({parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,combats:this.state.combats,selectedPartyID:this.state.selectedPartyID,selectedMonsterGroupID:this.state.selectedMonsterGroupID,selectedCombatID:this.state.selectedCombatID,drawer:this.state.drawer})}nudgeValue(e,t,a){const s=t.split(".");let n=e;for(let r=0;r!==s.length;++r){const i=s[r];if(r===s.length-1){let s=null;switch(i){case"challenge":s=u.nudgeChallenge(n[i],a);break;case"size":case"displaySize":s=u.nudgeSize(n[i],a);break;default:s=n[i]+a}this.changeValue(e,t,s)}else n=n[i]}}addParty(){const e=g.createParty();e.name="new party";const t=[].concat(this.state.parties,[e]);u.sort(t),this.setState({parties:t,selectedPartyID:e.id})}removeCurrentParty(){const e=this.state.parties.find(e=>e.id===this.state.selectedPartyID);e&&this.removeParty(e)}removeParty(e){const t=this.state.parties.indexOf(e);this.state.parties.splice(t,1),this.setState({parties:this.state.parties,selectedPartyID:null})}importParty(){this.setState({drawer:{type:"import-party",party:g.createParty()}})}acceptImportedParty(){this.state.parties.push(this.state.drawer.party),this.setState({parties:this.state.parties,drawer:null})}removePC(e){const t=this.state.parties.find(e=>e.id===this.state.selectedPartyID);if(t){const a=t.pcs.indexOf(e);t.pcs.splice(a,1),this.setState({parties:this.state.parties})}}editPC(e){e||((e=g.createPC()).name="new pc");const t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"pc",pc:t}})}importPC(){this.setState({drawer:{type:"import-pc",pc:g.createPC()}})}acceptImportedPC(){const e=this.state.parties.find(e=>e.id===this.state.selectedPartyID);e&&(e.pcs.push(this.state.drawer.pc),u.sort(e.pcs),this.setState({parties:this.state.parties,drawer:null}))}updatePC(e){const t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"update-pc",pc:t}})}savePC(){u.sort(this.state.drawer.pc.companions);const e=this.state.parties.find(e=>e.id===this.state.selectedPartyID);if(e){const t=e.pcs.find(e=>e.id===this.state.drawer.pc.id);if(t){const a=e.pcs.indexOf(t);e.pcs[a]=this.state.drawer.pc}else e.pcs.push(this.state.drawer.pc);u.sort(e.pcs),this.setState({parties:this.state.parties,drawer:null})}}addMonsterGroup(){const e=g.createMonsterGroup();e.name="new group";const t=[].concat(this.state.library,[e]);u.sort(t),this.setState({library:t,selectedMonsterGroupID:e.id})}importMonsterGroup(){this.setState({drawer:{type:"import-group",group:g.createMonsterGroup()}})}acceptImportedGroup(){this.state.library.push(this.state.drawer.group),this.setState({library:this.state.library,drawer:null})}removeCurrentMonsterGroup(){const e=this.state.library.find(e=>e.id===this.state.selectedMonsterGroupID);e&&this.removeMonsterGroup(e)}removeMonsterGroup(e){const t=this.state.library.indexOf(e);this.state.library.splice(t,1),this.setState({library:this.state.library,selectedMonsterGroupID:null})}removeMonster(e){const t=this.state.library.find(e=>e.id===this.state.selectedMonsterGroupID);if(t){const a=t.monsters.indexOf(e);t.monsters.splice(a,1),this.setState({library:this.state.library})}}importMonster(){this.setState({drawer:{type:"import-monster",monster:g.createMonster()}})}acceptImportedMonster(){const e=this.state.library.find(e=>e.id===this.state.selectedMonsterGroupID);e&&(e.monsters.push(this.state.drawer.monster),u.sort(e.monsters),this.setState({library:this.state.library,drawer:null}))}moveToGroup(e,t){const a=this.state.library.find(t=>t.monsters.includes(e));if(a){const s=a.monsters.indexOf(e);a.monsters.splice(s,1);const n=this.state.library.find(e=>e.id===t);n&&(n.monsters.push(e),u.sort(n.monsters),this.setState({library:this.state.library}))}}editMonster(e){e||((e=g.createMonster()).name="new monster");const t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"monster",monster:t,showSidebar:!1}})}saveMonster(){const e=this.state.library.find(e=>e.id===this.state.selectedMonsterGroupID);if(e){const t=e.monsters.find(e=>e.id===this.state.drawer.monster.id);if(t){const a=e.monsters.indexOf(t);e.monsters[a]=this.state.drawer.monster}else e.monsters.push(this.state.drawer.monster);u.sort(e.monsters),this.setState({library:this.state.library,drawer:null})}}toggleShowSidebar(){const e=this.state.drawer;e.showSidebar=!e.showSidebar,this.setState({drawer:e})}cloneMonster(e,t){const a=this.state.library.find(t=>t.monsters.includes(e));if(a){const s=h.clone(e,t);a.monsters.push(s),u.sort(a.monsters),this.setState({library:this.state.library})}}addOpenGameContent(){fetch("/dojo/data/monsters.json").then(e=>e.json()).then(e=>{e.forEach(e=>{try{if(e.name){const t=h.createFromJSON(e);let a=t.tag||t.category;0===a.indexOf("swarm")&&(a="swarm"),"any race"===a&&(a="npc");let s=this.state.library.find(e=>e.name===a);s||(s={id:u.guid(),name:a,monsters:[]},this.state.library.push(s)),s.monsters.push(t)}}catch(t){console.error(t)}}),u.sort(this.state.library),this.setState({library:this.state.library})})}openDemographics(e){this.setState({drawer:{type:"monster-demographics",group:e}})}editEncounter(e){e||((e=g.createEncounter()).name="new encounter");const t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"encounter",encounter:t}})}saveEncounter(){const e=this.state.encounters,t=this.state.encounters.find(e=>e.id===this.state.drawer.encounter.id);if(t){e[this.state.encounters.indexOf(t)]=this.state.drawer.encounter}else e.push(this.state.drawer.encounter);u.sort(e),this.setState({encounters:e,drawer:null})}removeEncounter(e){const t=this.state.encounters.indexOf(e);this.state.encounters.splice(t,1),this.setState({encounters:this.state.encounters})}generateMap(e){const t=g.createMap();t.name="new "+e,y.generate(e,t),this.state.maps.push(t),this.setState({maps:this.state.maps})}editMap(e){e||((e=g.createMap()).name="new map");const t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"map",map:t}})}saveMap(){const e=this.state.maps,t=this.state.maps.find(e=>e.id===this.state.drawer.map.id);if(t){e[this.state.maps.indexOf(t)]=this.state.drawer.map}else e.push(this.state.drawer.map);u.sort(e),this.setState({maps:e,drawer:null})}removeMap(e){const t=this.state.maps.indexOf(e);this.state.maps.splice(t,1),this.setState({maps:this.state.maps})}createCombat(e=null,t=null){let a=1===this.state.parties.length?this.state.parties[0]:null;if(t){const e=this.state.parties.find(e=>e.id===t);e&&(a=e)}let s=1===this.state.encounters.length?this.state.encounters[0]:null;e&&(s=e);const n=g.createCombatSetup();n.party=JSON.parse(JSON.stringify(a)),n.encounter=JSON.parse(JSON.stringify(e)),s&&(n.slotInfo=u.getCombatSlotData(s,this.state.library)),this.setState({drawer:{type:"combat-start",combatSetup:n}})}startCombat(){const e=this.state.drawer.combatSetup;if(e.party&&e.encounter){const t=e.party.name||"unnamed party",a=e.encounter.name||"unnamed encounter",s=g.createCombat();s.name=t+" vs "+a,s.encounter=JSON.parse(JSON.stringify(e.encounter));const n=g.createCombatReportEntry();n.type="combat-start",s.report.push(n),e.party.pcs.filter(e=>e.active).forEach(e=>{N.addPCToCombat(s,e)}),s.encounter.slots.forEach(t=>{const a=this.getMonster(t.monsterName,t.monsterGroupName),n=e.slotInfo.find(e=>e.id===t.id);a&&n?n.members.forEach(e=>{N.addMonsterToCombat(s,a,e.init,e.hp,e.name)}):s.issues.push("unknown monster: "+t.monsterName+" in group "+t.monsterGroupName)}),N.addPlaceholderToCombat(s),N.sortCombatants(s),e.map&&(s.map=JSON.parse(JSON.stringify(e.map))),this.setState({combats:[].concat(this.state.combats,[s]),selectedCombatID:s.id,drawer:null,view:"combat"})}}openAddWaveModal(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(e){const t=g.createCombatSetup();t.encounter=e.encounter,t.slotInfo=u.getCombatSlotData(e.encounter,this.state.library),this.setState({drawer:{type:"combat-wave",combatSetup:t}})}}addWaveToCombat(){const e=this.state.drawer.combatSetup,t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(e&&e.encounter&&t){const a=e.encounter.waves.find(t=>t.id===e.waveID);a&&(a.slots.forEach(a=>{const s=this.getMonster(a.monsterName,a.monsterGroupName);if(s){const n=parseInt(u.modifier(s.abilityScores.dex),10),r=u.dieRoll();for(let i=0;i!==a.count;++i){const o=JSON.parse(JSON.stringify(s));if(o.id=u.guid(),o.displayName=null,e.slotInfo){const t=e.slotInfo.find(e=>e.id===a.id);t&&(o.displayName=t.members[i].name)}o.displaySize=s.size,o.showOnMap=!0,o.current=!1,o.pending="manual"===this.state.drawer.combatSetup.encounterInitMode,o.active="manual"!==this.state.drawer.combatSetup.encounterInitMode,o.defeated=!1,o.initiative=n+r,o.hp=o.hpMax,o.conditions=[],o.tags=[],o.altitude=0,o.aura={radius:0,style:"rounded",color:"#005080"},t&&t.combatants.push(o)}}else if(t){const e="unknown monster: "+a.monsterName+" in group "+a.monsterGroupName;t.issues.push(e)}}),N.sortCombatants(t),this.setState({combats:this.state.combats,drawer:null}))}}openAddCombatantModal(){if(this.state.combats.find(e=>e.id===this.state.selectedCombatID)){const e=g.createCombatSetup();e.encounter=g.createEncounter(),e.slotInfo=u.getCombatSlotData(e.encounter,this.state.library),this.setState({drawer:{type:"combat-add-combatants",combatSetup:e}})}}addMonsterToAddCombatantsModal(e){const t=this.state.drawer.combatSetup;if(t&&t.encounter){const a=u.getMonsterGroup(e,this.state.library),s=g.createEncounterSlot();s.id=e.id,s.monsterName=e.name,s.monsterGroupName=a.name,t.encounter.slots.push(s),t.slotInfo=u.getCombatSlotData(t.encounter,this.state.library),this.setState({drawer:this.state.drawer})}}addCombatantsToCombat(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID),t=this.state.drawer.combatSetup;e&&t&&t.encounter&&(t.encounter.slots.forEach(a=>{const s=this.getMonster(a.monsterName,a.monsterGroupName),n=t.slotInfo.find(e=>e.id===a.id);s&&n?n.members.forEach(t=>{N.addMonsterToCombat(e,s,t.init,t.hp,t.name)}):e.issues.push("unknown monster: "+a.monsterName+" in group "+a.monsterGroupName)}),N.sortCombatants(e),this.setState({combats:this.state.combats,drawer:null}))}addPCToEncounter(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(a){const s=this.state.parties.find(t=>t.id===e);if(s){const e=s.pcs.find(e=>e.id===t);e&&(N.addPCToCombat(a,e),this.setState({combats:this.state.combats}))}}}addCompanionToEncounter(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&(N.addCompanionToCombat(t,e),this.setState({combats:this.state.combats}))}pauseCombat(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(e){const t=g.createCombatReportEntry();t.type="combat-pause",e.report.push(t),this.setState({selectedCombatID:null})}}resumeCombat(e){const t=g.createCombatReportEntry();t.type="combat-resume",e.report.push(t),this.setState({selectedCombatID:e.id})}endCombat(e=null){if(!e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&(e=t)}if(e){const t=g.createCombatReportEntry();t.type="combat-end",e.report.push(t);const a=this.state.combats.indexOf(e);this.state.combats.splice(a,1),this.setState({combats:this.state.combats,selectedCombatID:null})}}makeCurrent(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(a){if(a.combatants.filter(e=>e.conditions).forEach(t=>{t.conditions.forEach(s=>{if(s.duration)switch(s.duration.type){case"saves":e&&t.id===e.id&&"start"===s.duration.point&&a.notifications.push({id:u.guid(),type:"condition-save",data:s,combatant:t});break;case"combatant":if(e&&(s.duration.combatantID===e.id||null===s.duration.combatantID)&&"start"===s.duration.point){const e=t.conditions.indexOf(s);t.conditions.splice(e,1),a.notifications.push({id:u.guid(),type:"condition-end",data:s,combatant:t})}break;case"rounds":if(e&&t.id===e.id&&(s.duration.count-=1),0===s.duration.count){const e=t.conditions.indexOf(s);t.conditions.splice(e,1),a&&a.notifications.push({id:u.guid(),type:"condition-end",data:s,combatant:t})}}})}),e&&"monster"===e.type&&(e.traits.filter(e=>e.uses>0&&e.usage.toLowerCase().startsWith("recharge ")).forEach(t=>{a.notifications.push({id:u.guid(),type:"trait-recharge",data:t,combatant:e})}),e.traits.filter(e=>"legendary"===e.type).forEach(e=>{e.uses=0})),a.combatants.forEach(e=>{e.current=!1}),e&&(e.current=!0,"pc"===e.type)){const t=g.createCombatReportEntry();t.type="turn-start",t.combatantID=e.id,a.report.push(t)}t&&(a.round+=1),this.setState({combats:this.state.combats})}}makeActive(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t){const a=e.some(e=>e.pending);e.forEach(e=>{e.pending=!1,e.active=!0,e.defeated=!1}),a&&N.sortCombatants(t),this.setState({combats:this.state.combats})}}makeDefeated(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t){const a=t.combatants.find(e=>e.current);e.forEach(e=>{if(e.pending=!1,e.active=!1,e.defeated=!0,t.map&&(t.map.items=t.map.items.filter(t=>t.id!==e.id)),a&&"pc"===a.type&&"monster"===e.type){const e=g.createCombatReportEntry();e.type="kill",e.combatantID=a.id,t.report.push(e)}}),a&&e.find(e=>e.id===a.id)?this.endTurn(a):this.setState({combats:this.state.combats})}}useTrait(e,t){t.uses+=1,this.setState({combats:this.state.combats})}rechargeTrait(e,t){t.uses=0,this.setState({combats:this.state.combats})}removeCombatants(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&(e.forEach(e=>{const a=t.combatants.indexOf(e);if(t.combatants.splice(a,1),t.map){const a=t.map.items.find(t=>t.id===e.id);if(a){const e=t.map.items.indexOf(a);t.map.items.splice(e,1)}}}),this.setState({combats:this.state.combats}))}endTurn(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t){if("pc"===e.type){const a=g.createCombatReportEntry();a.type="turn-end",a.combatantID=e.id,t.report.push(a)}t.combatants.filter(e=>e.conditions).forEach(a=>{a.conditions.forEach(s=>{if(s.duration)switch(s.duration.type){case"saves":if(a.id===e.id&&"end"===s.duration.point){const e=g.createNotification();e.type="condition-save",e.data=s,e.combatant=a,t.notifications.push(e)}break;case"combatant":if((s.duration.combatantID===e.id||null===s.duration.combatantID)&&"end"===s.duration.point){const e=a.conditions.indexOf(s);a.conditions.splice(e,1);const n=g.createNotification();n.type="condition-end",n.data=s,n.combatant=a,t.notifications.push(n)}}})});const a=t.combatants.filter(e=>e.current||!e.pending&&e.active&&!e.defeated).filter(e=>"placeholder"!==e.type||N.combatHasLairActions(t));if(0===a.length)this.makeCurrent(null,!1);else if(1===a.length&&a[0].defeated)this.makeCurrent(null,!1);else{let t=a.indexOf(e)+1,s=!1;t>=a.length&&(t=0,s=!0),this.makeCurrent(a[t],s)}}}changeHP(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&(e.forEach(e=>{const a=t.combatants.find(t=>t.id===e.id);a&&(a.hpCurrent=e.hp,a.hpTemp=e.temp);const s=t.combatants.find(e=>e.current);if(s&&"pc"===s.type){const a=g.createCombatReportEntry();a.type="damage",a.combatantID=s.id,a.value=e.damage,t.report.push(a)}}),this.setState({combats:this.state.combats}))}toggleTag(e,t){e.forEach(e=>{e.tags.includes(t)?e.tags=e.tags.filter(e=>e!==t):e.tags.push(t)}),this.setState({combats:this.state.combats})}toggleCondition(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);a&&(e.forEach(e=>{const s=e.conditions.find(e=>e.name===t);if(s)this.removeCondition(e,s);else{const s=g.createCondition();s.name=t,e.conditions.push(s),e.conditions=u.sort(e.conditions,[{field:"name",dir:"asc"}]);const n=a.combatants.find(e=>e.current);if(n&&"pc"===n.type){const e=g.createCombatReportEntry();e.type="condition-add",e.combatantID=n.id,a.report.push(e)}}}),this.setState({combats:this.state.combats}))}toggleHidden(e){e.forEach(e=>{e.showOnMap=!e.showOnMap}),this.setState({combats:this.state.combats})}mapAdd(e,t,a){const s=g.createMapItem();s.id=e.id,s.type=e.type,s.x=t,s.y=a;let n=1;"monster"===e.type&&(n=u.miniSize(e.size)),s.height=n,s.width=n;const r=this.state.combats.find(e=>e.id===this.state.selectedCombatID);r&&r.map&&(r.map.items.push(s),this.setState({combats:this.state.combats}))}mapMove(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);a&&(e.forEach(e=>{if(a.map){const s=a.map.items.find(t=>t.id===e);if(s){switch(t){case"N":s.y-=1;break;case"NE":s.x+=1,s.y-=1;break;case"E":s.x+=1;break;case"SE":s.x+=1,s.y+=1;break;case"S":s.y+=1;break;case"SW":s.x-=1,s.y+=1;break;case"W":s.x-=1;break;case"NW":s.x-=1,s.y-=1}if("pc"===s.type){const e=g.createCombatReportEntry();e.type="movement",e.combatantID=s.id,a.report.push(e)}}}}),this.setState({combats:this.state.combats}))}mapResize(e,t,a){const s=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(s&&s.map){const n=s.map.items.find(t=>t.id===e);if(n){switch(a){case"in":switch(t){case"N":n.height>1&&(n.y+=1,n.height-=1);break;case"E":n.width>1&&(n.width-=1);break;case"S":n.height>1&&(n.height-=1);break;case"W":n.width>1&&(n.x+=1,n.width-=1)}break;case"out":switch(t){case"N":n.y-=1,n.height+=1;break;case"E":n.width+=1;break;case"S":n.height+=1;break;case"W":n.x-=1,n.width+=1}}this.setState({combats:this.state.combats})}}}mapRemove(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&(e.forEach(e=>{if(t.map){const a=t.map.items.find(t=>t.id===e);if(a){const e=t.map.items.indexOf(a);t.map.items.splice(e,1)}}}),this.setState({combats:this.state.combats}))}mapAddNote(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t&&t.map){const a=g.createMapNote();a.targetID=e,t.map.notes.push(a),this.setState({combats:this.state.combats})}}mapRemoveNote(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t&&t.map){const a=t.map.notes.findIndex(t=>t.targetID===e);t.map.notes.splice(a,1),this.setState({combats:this.state.combats})}}scatterCombatants(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&t.map&&(y.scatterCombatants(t,e),this.setState({combats:this.state.combats}))}rotateMap(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);e&&e.map&&(y.rotateMap(e.map),this.setState({combats:this.state.combats}))}addMapItem(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);t&&t.map&&(t.map.items.push(e),this.setState({combats:this.state.combats}))}addCondition(e){const t=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(t){const a=g.createCondition();a.name="blinded",this.setState({drawer:{type:"condition-add",condition:a,combatants:e,combat:t}})}}addConditionFromModal(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);e&&(this.state.drawer.combatants.forEach(t=>{const a=JSON.parse(JSON.stringify(this.state.drawer.condition));a.id=u.guid(),t.conditions.push(a),u.sort(t.conditions,[{field:"name",dir:"asc"}]);const s=e.combatants.find(e=>e.current);if(s&&"pc"===s.type){const t=g.createCombatReportEntry();t.type="condition-add",t.combatantID=s.id,e.report.push(t)}}),this.setState({combats:this.state.combats,drawer:null}))}editCondition(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);a&&this.setState({drawer:{type:"condition-edit",condition:t,combatants:[e],combat:a}})}editConditionFromModal(){this.state.drawer.combatants.forEach(e=>{const t=e.conditions.find(e=>e.id===this.state.drawer.condition.id);if(t){const a=e.conditions.indexOf(t);e.conditions[a]=this.state.drawer.condition,u.sort(e.conditions,[{field:"name",dir:"asc"}])}}),this.setState({combats:this.state.combats,drawer:null})}removeCondition(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(a){const s=e.conditions.indexOf(t);e.conditions.splice(s,1);const n=a.combatants.find(e=>e.current);if(n&&"pc"===n.type){const e=g.createCombatReportEntry();e.type="condition-remove",e.combatantID=n.id,a.report.push(e)}this.setState({combats:this.state.combats})}}closeNotification(e,t){const a=this.state.combats.find(e=>e.id===this.state.selectedCombatID);if(a){const s=a.notifications.indexOf(e);if(a.notifications.splice(s,1),t&&e.combatant&&e.data){const t=e.combatant.conditions.indexOf(e.data);e.combatant.conditions.splice(t,1)}this.setState({combats:this.state.combats})}}showLeaderboard(){const e=this.state.combats.find(e=>e.id===this.state.selectedCombatID);e&&this.setState({drawer:{type:"leaderboard",combat:e}})}save(){switch(this.state.view){case"parties":this.saveKey(this.state.parties,"data-parties");break;case"library":this.saveKey(this.state.library,"data-library");break;case"encounters":this.saveKey(this.state.encounters,"data-encounters");break;case"maps":this.saveKey(this.state.maps,"data-maps");break;case"combat":this.saveKey(this.state.combats,"data-combats")}}saveAll(){this.saveKey(this.state.parties,"data-parties"),this.saveKey(this.state.library,"data-library"),this.saveKey(this.state.encounters,"data-encounters"),this.saveKey(this.state.maps,"data-maps"),this.saveKey(this.state.combats,"data-combats")}saveKey(e,t){try{const a=JSON.stringify(e);console.info("Saving ("+t+"): "+u.toData(a.length)),window.localStorage.setItem(t,a)}catch(a){console.error("Could not stringify data: ",a)}}getContent(){let e=!1;this.state.parties.forEach(t=>e=e||t.pcs.length>0);let t=!1;switch(this.state.library.forEach(e=>t=t||e.monsters.length>0),this.state.view){case"home":return n.a.createElement(Bt,null);case"parties":return this.state.selectedPartyID?n.a.createElement(Ut,{party:this.state.parties.find(e=>e.id===this.state.selectedPartyID),goBack:()=>this.selectParty(null),removeParty:()=>this.removeCurrentParty(),addPC:()=>this.editPC(null),importPC:()=>this.importPC(),editPC:e=>this.editPC(e),updatePC:e=>this.updatePC(e),removePC:e=>this.removePC(e),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.nudgeValue(e,t,a)}):n.a.createElement(_t,{parties:this.state.parties,addParty:()=>this.addParty(),importParty:()=>this.importParty(),selectParty:e=>this.selectParty(e),deleteParty:e=>this.removeParty(e),openStatBlock:e=>this.setState({drawer:{type:"stat-block",source:e}})});case"library":return this.state.selectedMonsterGroupID?n.a.createElement(Ft,{monsterGroup:this.state.library.find(e=>e.id===this.state.selectedMonsterGroupID),library:this.state.library,goBack:()=>this.selectMonsterGroup(null),removeMonsterGroup:()=>this.removeCurrentMonsterGroup(),openDemographics:e=>this.openDemographics(e),addMonster:()=>this.editMonster(null),importMonster:()=>this.importMonster(),removeMonster:e=>this.removeMonster(e),changeValue:(e,t,a)=>this.changeValue(e,t,a),nudgeValue:(e,t,a)=>this.nudgeValue(e,t,a),viewMonster:e=>this.setState({drawer:{type:"stat-block",source:e}}),editMonster:e=>this.editMonster(e),cloneMonster:(e,t)=>this.cloneMonster(e,t),moveToGroup:(e,t)=>this.moveToGroup(e,t)}):n.a.createElement(Yt,{library:this.state.library,hasMonsters:t,addMonsterGroup:()=>this.addMonsterGroup(),importMonsterGroup:()=>this.importMonsterGroup(),selectMonsterGroup:e=>this.selectMonsterGroup(e),deleteMonsterGroup:e=>this.removeMonsterGroup(e),addOpenGameContent:()=>this.addOpenGameContent(),openStatBlock:e=>this.setState({drawer:{type:"stat-block",source:e}}),openDemographics:e=>this.openDemographics(e)});case"encounters":return n.a.createElement(Lt,{encounters:this.state.encounters,parties:this.state.parties,hasMonsters:t,addEncounter:()=>this.editEncounter(null),editEncounter:e=>this.editEncounter(e),deleteEncounter:e=>this.removeEncounter(e),runEncounter:(e,t)=>this.createCombat(e,t),getMonster:(e,t)=>this.getMonster(e,t),setView:e=>this.setView(e),openStatBlock:e=>this.setState({drawer:{type:"stat-block",source:e}})});case"maps":return n.a.createElement(jt,{maps:this.state.maps,addMap:()=>this.editMap(null),generateMap:e=>this.generateMap(e),editMap:e=>this.editMap(e),deleteMap:e=>this.removeMap(e)});case"combat":return this.state.selectedCombatID?n.a.createElement(Ot,{combat:this.state.combats.find(e=>e.id===this.state.selectedCombatID),parties:this.state.parties,encounters:this.state.encounters,pauseCombat:()=>this.pauseCombat(),endCombat:()=>this.endCombat(),nudgeValue:(e,t,a)=>this.nudgeValue(e,t,a),changeValue:(e,t,a)=>this.changeValue(e,t,a),makeCurrent:e=>this.makeCurrent(e,!1),makeActive:e=>this.makeActive(e),makeDefeated:e=>this.makeDefeated(e),useTrait:(e,t)=>this.useTrait(e,t),rechargeTrait:(e,t)=>this.rechargeTrait(e,t),removeCombatants:e=>this.removeCombatants(e),addCombatants:()=>this.openAddCombatantModal(),addCompanion:e=>this.addCompanionToEncounter(e),addPC:(e,t)=>this.addPCToEncounter(e,t),addWave:()=>this.openAddWaveModal(),addCondition:e=>this.addCondition(e),editCondition:(e,t)=>this.editCondition(e,t),removeCondition:(e,t)=>this.removeCondition(e,t),mapAdd:(e,t,a)=>this.mapAdd(e,t,a),mapResize:(e,t,a)=>this.mapResize(e,t,a),mapMove:(e,t)=>this.mapMove(e,t),mapRemove:e=>this.mapRemove(e),mapAddNote:e=>this.mapAddNote(e),mapRemoveNote:e=>this.mapRemoveNote(e),endTurn:e=>this.endTurn(e),changeHP:e=>this.changeHP(e),closeNotification:(e,t)=>this.closeNotification(e,t),toggleTag:(e,t)=>this.toggleTag(e,t),toggleCondition:(e,t)=>this.toggleCondition(e,t),toggleHidden:e=>this.toggleHidden(e),scatterCombatants:e=>this.scatterCombatants(e),rotateMap:()=>this.rotateMap(),addOverlay:e=>this.addMapItem(e),showLeaderboard:()=>this.showLeaderboard()}):n.a.createElement(kt,{combats:this.state.combats,hasPCs:e,hasMonsters:t,createCombat:()=>this.createCombat(),resumeCombat:e=>this.resumeCombat(e),deleteCombat:e=>this.endCombat(e),openStatBlock:e=>this.setState({drawer:{type:"stat-block",source:e}}),setView:e=>this.setView(e)})}return null}getSidebar(){if(!this.state.sidebar)return null;let e=null;switch(this.state.sidebar){case"search":e=n.a.createElement(pa,{parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,openParty:e=>this.selectPartyByID(e),openGroup:e=>this.selectMonsterGroupByID(e),openEncounter:e=>this.selectEncounterByID(e),openMap:e=>this.selectMapByID(e)});break;case"tools":e=n.a.createElement(fa,null);break;case"generators":e=n.a.createElement(ia,null);break;case"reference":e=n.a.createElement(ma,null)}return n.a.createElement("div",{className:"sidebar sidebar-right"},e)}getDrawer(){let e=null,t=null,a=null,s="50%",r=!1;if(this.state.drawer)switch(this.state.drawer.type){case"stat-block":e=n.a.createElement(Le,{source:this.state.drawer.source}),t="monster",r=!0;break;case"import-party":e=n.a.createElement(mt,{party:this.state.drawer.party}),t="import party",a=n.a.createElement("button",{onClick:()=>this.acceptImportedParty()},"accept party"),r=!0;break;case"pc":e=n.a.createElement(nt,{pc:this.state.drawer.pc}),t="pc editor",a=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.savePC()},"save changes")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.closeDrawer()},"discard changes")));break;case"import-pc":e=n.a.createElement(dt,{pc:this.state.drawer.pc}),t="import pc",a=n.a.createElement("button",{onClick:()=>this.acceptImportedPC()},"accept pc"),r=!0;break;case"update-pc":e=n.a.createElement(dt,{pc:this.state.drawer.pc}),t="update pc",a=n.a.createElement("button",{onClick:()=>this.savePC()},"accept pc"),r=!0;break;case"import-group":e=n.a.createElement(ot,{group:this.state.drawer.group}),t="import monster group",a=n.a.createElement("button",{onClick:()=>this.acceptImportedGroup()},"accept group"),r=!0;break;case"monster":e=n.a.createElement(Ze,{monster:this.state.drawer.monster,library:this.state.library,showSidebar:this.state.drawer.showSidebar}),t="monster editor",a=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:6},n.a.createElement("button",{onClick:()=>this.saveMonster()},"save changes")),n.a.createElement(c.a,{span:6},n.a.createElement("button",{onClick:()=>this.closeDrawer()},"discard changes")),n.a.createElement(c.a,{span:12},n.a.createElement(k,{label:"advanced tools",checked:this.state.drawer.showSidebar,changeValue:()=>this.toggleShowSidebar()}))),s="85%";break;case"import-monster":e=n.a.createElement(ct,{monster:this.state.drawer.monster}),t="import monster",a=n.a.createElement("button",{onClick:()=>this.acceptImportedMonster()},"accept monster"),r=!0;break;case"monster-demographics":e=n.a.createElement(Pe,{groups:this.state.drawer.group?[this.state.drawer.group]:this.state.library}),t="demographics",r=!0;break;case"encounter":e=n.a.createElement(Ge,{encounter:this.state.drawer.encounter,parties:this.state.parties,library:this.state.library,getMonster:(e,t)=>this.getMonster(e,t)}),t="encounter editor",a=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.saveEncounter()},"save changes")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.closeDrawer()},"discard changes"))),s="75%";break;case"map":e=n.a.createElement(We,{map:this.state.drawer.map}),t="map editor",a=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.saveMap()},"save changes")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.closeDrawer()},"discard changes"))),s="85%";break;case"combat-start":e=n.a.createElement(ve,{type:"start",combatSetup:this.state.drawer.combatSetup,parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,getMonster:(e,t)=>this.getMonster(e,t),notify:()=>this.setState({drawer:this.state.drawer})}),t="start combat",a=n.a.createElement("button",{className:this.state.drawer.combatSetup.party&&this.state.drawer.combatSetup.encounter?"":"disabled",onClick:()=>this.startCombat()},"start encounter"),s="75%",r=!0;break;case"combat-wave":e=n.a.createElement(ve,{type:"add-wave",combatSetup:this.state.drawer.combatSetup,library:this.state.library,getMonster:(e,t)=>this.getMonster(e,t),notify:()=>this.setState({drawer:this.state.drawer})}),t="add a wave",a=n.a.createElement("button",{className:null!==this.state.drawer.combatSetup.waveID?"":"disabled",onClick:()=>this.addWaveToCombat()},"add wave"),s="75%",r=!0;break;case"combat-add-combatants":e=n.a.createElement(ve,{type:"add-combatants",combatSetup:this.state.drawer.combatSetup,library:this.state.library,getMonster:(e,t)=>this.getMonster(e,t),addMonster:e=>this.addMonsterToAddCombatantsModal(e),notify:()=>this.setState({drawer:this.state.drawer})}),t="add combatants",a=n.a.createElement("button",{className:null!==this.state.drawer.combatSetup.encounter?"":"disabled",onClick:()=>this.addCombatantsToCombat()},"add combatants"),s="75%",r=!0;break;case"condition-add":e=n.a.createElement(Ve,{condition:this.state.drawer.condition,combatants:this.state.drawer.combatants,combat:this.state.drawer.combat}),t="add a condition",a=n.a.createElement("button",{onClick:()=>this.addConditionFromModal()},"add"),s="75%",r=!0;break;case"condition-edit":e=n.a.createElement(Ve,{condition:this.state.drawer.condition,combatants:this.state.drawer.combatants,combat:this.state.drawer.combat}),t="edit condition",a=n.a.createElement(o.a,{gutter:10},n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.editConditionFromModal()},"save changes")),n.a.createElement(c.a,{span:12},n.a.createElement("button",{onClick:()=>this.closeDrawer()},"discard changes"))),s="75%";break;case"leaderboard":e=n.a.createElement(pt,{combat:this.state.drawer.combat}),t="leaderboard",r=!0;break;case"about":e=n.a.createElement(C,{resetAll:()=>this.resetAll()}),t="about",r=!0}return{content:e,header:t,footer:a,width:s,closable:r}}render(){try{const e=this.getSidebar(),t=this.getDrawer();return n.a.createElement("div",{className:"dojo"},n.a.createElement(ka,null,n.a.createElement(yt,{sidebar:this.state.sidebar,setSidebar:e=>this.setSidebar(e)})),n.a.createElement("div",{className:"page-content"},n.a.createElement(ka,null,n.a.createElement("div",{className:"content"},this.getContent())),n.a.createElement(ka,null,e)),n.a.createElement(ka,null,n.a.createElement(ut,{view:this.state.view,setView:e=>this.setView(e),openDrawer:e=>this.openToolsDrawer(e)})),n.a.createElement(ka,null,n.a.createElement(l.a,{closable:!1,maskClosable:t.closable,width:t.width,visible:null!==t.content,onClose:()=>this.closeDrawer()},n.a.createElement("div",{className:"drawer-header"},n.a.createElement("div",{className:"app-title"},t.header)),n.a.createElement("div",{className:"drawer-content"},t.content),n.a.createElement("div",{className:"drawer-footer"},t.footer))))}catch(e){return console.error(e),n.a.createElement("div",{className:"render-error"})}}}class ka extends n.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error(e.name),console.error(e.message),console.error(e.stack),console.error(t.componentStack)}render(){return this.state.hasError?n.a.createElement("div",{className:"render-error"}):this.props.children}}i.a.render(n.a.createElement(Na,null),document.getElementById("root"))},72:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAJlQTFRF/////v7+/f399PT06enp4eHh3t7e3d3d8/Pz0dHRzc3NzMzM/Pz85+fn4+Pjzs7O6Ojo8fHx3Nzc0NDQ1tbW7e3t9fX12tra7u7u2NjY9vb2+Pj45ubm09PTz8/P29vb9/f34uLi0tLS5eXl+fn57+/v8vLy7Ozs1NTU8PDw1dXV5OTk6urq+vr619fX2dnZ+/v739/f4ODgwOjgmwAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAP8SURBVHja7d1tV6JAGIBhB6lGxzIDx8qyF61VN23r//+4/dBCGiCkCzQP9/Wxs5t77jMPBwZWWi0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMqkvIopV0t5bf/o+KRSx0d+23NxUemTTtdUrts50c4tr95px9Skc9pzrNVZ39Smf+ZULXVeYytj+ucuTeKgY2rVGTg0hBemZhfuDKIO6o4VaGdincbnDP2gUvGRsnvqzOH9OPo3h0NbqWEYffKxK4d4bxStq8uqP/oyWlsjV07ke1fRkeO66o++jo6WVz1iEYtYxCIWsX5oLNUbt7Vuj3vEyovl2ZvRbTCZBLd359eKWLti3T88xtdB3dvpjFiZsdRTuL0BfPWsiJUeS/1K7HHNF4pYqbEWKfuBc02stFj3y7Rtp6sZsZKxvKPU22LdG0WsRKx2xqb8fEysRKzfWfdEX4j1NVb8k4QTj1hfYt0/ZsVaror+1pnXkFh6khXrsei1tl5PvWbEWmTeoA7aBVstTX/aI1ahVqExZpK/thjDVkt/nNL2c2txgI9amfxJ5NRBf25X5E1i409K9eZlZc4kNv1yR29fgu+exIZfSOvwy9/ZOYlCtmjCtFivq2+uq7xJlLL597jP5p9O2wbbMYlStpWHiVrzgfruDOZNopgbFoP11nGr+7rfuto5iXJuhY2/eSsss1X2JEq8yTovcpM1YwZ3TqKsZx28mdXaroqcty93P+ueWquhD4bktMqYxGbG2jmD2ZPYyFi56ypjEpsYq1CrtElsYKwCM5gxic2LVXBdpU1i42J9o1ViEuXG+qMOmsG0SRQby45878B1lZhEqbHs2gS+OrjV9iQKjWXXxpjgRR00g4lJlBnLflQJtidxj3W1PYkiY9l19Ec2J3HPVsZMngXHilttTeJeM/ixtJ7kxrKbVeJJ3HtdiY61sa42JvGAVoJjfWn1bxL3n0HJsWyySuB7h6wrubES68oYY4KHg1pJjZXaypgDvzxKZiwbmjKIjJWxroiVEqusVhJjlTSDImOVtq4ExiqxlbhY5c2gvFhlritpscptJSvWfbmtZMVa9IlVONYTsYhFLGIRi1jEIhaxiEUsYsmM9bycl2op6Skab1Yy0c9nlYVYxCIWsYhVTSxb9Udb52J5d/E3zVT8jhL1Ej27dOfMm/ve4m/Hmg4rNY2/O+LNlVYt//MbCfqV+vxc35lYtub3qhnTsc7E8t7rjvXu0MtG7bzeVnN3FlarpYa1vocuGDr1Wlbl11gr5b8x/vBal8u6Wi0v3Xub9HgaTip/N3J3Ek7HLQep1cC/qZg/WDn7knIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9dffijal8TIpWcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMTAtMjBUMDM6MDY6MzErMDA6MDA219rQAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTEwLTIwVDAzOjA2OjMxKzAwOjAwR4pibAAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAASUVORK5CYII="}},[[137,1,2]]]);