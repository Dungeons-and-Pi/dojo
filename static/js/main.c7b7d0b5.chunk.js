(this.webpackJsonpdojo=this.webpackJsonpdojo||[]).push([[0],{114:function(e){e.exports=JSON.parse('{"name":"dojo","version":"8.7.2","license":"MIT","repository":"https://github.com/andyaiken/dojo.git","homepage":"https://andyaiken.github.io/dojo/","dependencies":{"@ant-design/icons":"^4.0.2","antd":"^4.0.3","react":"^16.13.0","react-dom":"^16.13.0","react-movable":"^2.4.2","showdown":"^1.9.1"},"devDependencies":{"@types/node":"^12.12.30","@types/react":"^16.9.23","@types/react-dom":"^16.9.5","@types/showdown":"^1.9.3","gh-pages":"^2.2.0","node-sass":"^4.13.1","react-scripts":"^3.4.0","tslint":"^5.20.1","tslint-react":"^3.6.0","typescript":"^3.8.3"},"scripts":{"update":"npm update && npm update --save-dev","start":"react-scripts start --display-error-details","lint":"tslint --config tslint.json --format verbose \'src/**/*.{ts,tsx}\'","predeploy":"react-scripts build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":["eslint-recommended","react-app"]},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},133:function(e,t,a){e.exports=a(233)},138:function(e,t,a){},139:function(e,t,a){},233:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(12),i=a.n(s),o=(a(138),a(139),a(1)),c=a(2),l=a(4),u=a(3),m=a(5),d=a(240),p=a(255),h=a(239),f=a(70),v=["tiny","small","medium","large","huge","gargantuan"],g=["aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","humanoid","monstrosity","ooze","plant","undead"],b=["trait","action","bonus","reaction","legendary","lair"],y=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getTypicalHP",value:function(e){var t=(E.hitDieType(e.size)+1)/2+E.modifierValue(e.abilityScores.con);return Math.floor(e.hitDice*t)}},{key:"getTypicalHPString",value:function(e){var t=E.hitDieType(e.size),a=E.modifierValue(e.abilityScores.con)*e.hitDice,n="";return a>0&&(n=" +"+a),a<0&&(n=" "+a),e.hitDice+"d"+t+n}},{key:"nudgeValue",value:function(t,a,n){var r,s=t,i=null,o=a.split(".");switch(o.forEach((function(e){e===o[o.length-1]?i=s[e]:s=s[e]})),a){case"challenge":r=E.nudgeChallenge(i,n);break;case"size":r=E.nudgeSize(i,n);break;default:r=(i||0)+n}r=Math.max(r,0),e.changeValue(t,a,r)}},{key:"changeValue",value:function(e,t,a){var n=e,r=t.split(".");r.forEach((function(e){e===r[r.length-1]?n[e]=a:n=n[e]}))}},{key:"clear",value:function(e){e.name="",e.size="medium",e.category="beast",e.tag="",e.alignment="",e.challenge=1,e.abilityScores.str=10,e.abilityScores.dex=10,e.abilityScores.con=10,e.abilityScores.int=10,e.abilityScores.wis=10,e.abilityScores.cha=10,e.ac=10,e.hitDice=1,e.damage.resist="",e.damage.vulnerable="",e.damage.immune="",e.savingThrows="",e.speed="",e.skills="",e.senses="",e.languages="",e.equipment="",e.traits=[],e.conditionImmunities="",e.portrait=""}},{key:"clone",value:function(e,t){return{id:E.guid(),type:"monster",name:t||e.name+" copy",size:e.size,category:e.category,tag:e.tag,alignment:e.alignment,challenge:e.challenge,abilityScores:{str:e.abilityScores.str,dex:e.abilityScores.dex,con:e.abilityScores.con,int:e.abilityScores.int,wis:e.abilityScores.wis,cha:e.abilityScores.cha},ac:e.ac,hitDice:e.hitDice,damage:{resist:e.damage.resist,vulnerable:e.damage.vulnerable,immune:e.damage.immune},savingThrows:e.savingThrows,speed:e.speed,skills:e.skills,senses:e.senses,languages:e.languages,equipment:e.equipment,traits:e.traits.map((function(e){return{id:E.guid(),name:e.name,usage:e.usage,type:e.type,text:e.text,uses:0}})),conditionImmunities:e.conditionImmunities,portrait:e.portrait,legendaryActions:0}}},{key:"createFromJSON",value:function(e){var t=this,a=k.createMonster();a.type="monster",a.name=e.name,a.size=e.size.toLowerCase(),a.category=e.type,a.tag=e.subtype,a.alignment=e.alignment,a.challenge=E.parseChallenge(e.challenge_rating),a.ac=e.armor_class,a.speed=e.speed,a.senses=e.senses,a.languages=e.languages;var n=e.hit_dice.indexOf("d");a.hitDice=parseInt(e.hit_dice.substring(0,n),10),a.abilityScores.str=e.strength,a.abilityScores.dex=e.dexterity,a.abilityScores.con=e.constitution,a.abilityScores.int=e.intelligence,a.abilityScores.wis=e.wisdom,a.abilityScores.cha=e.charisma,a.damage.resist=e.damage_resistances,a.damage.vulnerable=e.damage_vulnerabilities,a.damage.immune=e.damage_immunities,a.conditionImmunities=e.condition_immunities;[{field:"strength_save",text:"Strength"},{field:"dexterity_save",text:"Dexterity"},{field:"constitution_save",text:"Constitution"},{field:"intelligence_save",text:"Intelligence"},{field:"wisdom_save",text:"Wisdom"},{field:"charisma_save",text:"Charisma"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.savingThrows+=""===a.savingThrows?n:", "+n}}));return[{field:"acrobatics",text:"Acrobatics"},{field:"animal_handling",text:"Animal handling"},{field:"arcana",text:"Arcana"},{field:"athletics",text:"Athletics"},{field:"deception",text:"Deception"},{field:"history",text:"History"},{field:"insight",text:"Insight"},{field:"intimidation",text:"Intimidation"},{field:"investigation",text:"Investigation"},{field:"medicine",text:"Medicine"},{field:"nature",text:"Nature"},{field:"perception",text:"Perception"},{field:"performance",text:"Performance"},{field:"persuasion",text:"Persuasion"},{field:"religion",text:"Religion"},{field:"sleight_of_hand",text:"Sleight of hand"},{field:"stealth",text:"Stealth"},{field:"survival",text:"Survival"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.skills+=""===a.skills?n:", "+n}})),e.special_abilities&&e.special_abilities.forEach((function(e){var n=t.buildTrait(e,"trait");a.traits.push(n)})),e.actions&&e.actions.forEach((function(e){var n=t.buildTrait(e,"action");a.traits.push(n)})),e.reactions&&e.reactions.forEach((function(e){var n=t.buildTrait(e,"reaction");a.traits.push(n)})),e.legendary_actions&&e.legendary_actions.forEach((function(e){var n=t.buildTrait(e,"legendary");a.traits.push(n)})),a}},{key:"buildTrait",value:function(e,t){var a="",n="",r=e.name.indexOf("(");if(-1===r)a=e.name;else{var s=e.name.indexOf(")");a=e.name.substring(0,r-1),n=e.name.substring(r+1,s).toLowerCase()}var i=e.desc.replace(/\u2022/g,"*"),o=t;return"Lair Actions"===a&&(o="lair"),0===i.indexOf("As a bonus action")&&(o="bonus"),{id:E.guid(),type:o,name:a,usage:n,text:i,uses:0}}},{key:"import",value:function(t,a){e.clear(a);var n=(new DOMParser).parseFromString(t,"text/html");try{a.name=n.getElementsByClassName("mon-stat-block__name")[0].innerText.trim();var r=n.getElementsByClassName("mon-stat-block__meta")[0].innerText.toLowerCase().trim(),s=r.indexOf(" ");a.size=r.substring(0,s).trim();var i=(r=r.substring(s+1).trim()).indexOf(",");a.alignment=r.substring(i+1).trim();var o=(r=r.substring(0,i).trim()).indexOf("("),c=r.indexOf(")");-1!==o&&-1!==c&&(a.tag=r.substring(o+1,c).trim(),r=r.substring(0,o).trim()),a.category=r}catch(H){console.error(H)}try{for(var l=n.getElementsByClassName("mon-stat-block__attribute"),u=0;u!==l.length;++u){var m=l[u],d=m.getElementsByClassName("mon-stat-block__attribute-label")[0].innerText.toLowerCase().trim(),p=m.getElementsByClassName("mon-stat-block__attribute-data-value")[0].innerText.toLowerCase().trim();switch(d){case"armor class":a.ac=Number.parseInt(p,10);break;case"hit points":var h=m.getElementsByClassName("mon-stat-block__attribute-data-extra")[0].innerText.toLowerCase().trim();a.hitDice=Number.parseInt(h.substring(1,h.indexOf("d")),10);break;case"speed":a.speed=p}}}catch(H){console.error(H)}try{for(var f=n.getElementsByClassName("ability-block__stat"),v=0;v!==f.length;++v){var g=f[v],b=g.getElementsByClassName("ability-block__heading")[0].innerText.toLowerCase().trim(),y=g.getElementsByClassName("ability-block__score")[0].innerText.toLowerCase().trim(),E=Number.parseInt(y,10);a.abilityScores[b]=E}}catch(H){console.error(H)}try{for(var N=n.getElementsByClassName("mon-stat-block__tidbit"),w=0;w!==N.length;++w){var x=N[w],C=x.getElementsByClassName("mon-stat-block__tidbit-label")[0].innerText.toLowerCase().trim(),S=x.getElementsByClassName("mon-stat-block__tidbit-data")[0].innerText.toLowerCase().trim();switch(C){case"saving throws":a.savingThrows=S;break;case"skills":a.skills=S;break;case"damage vulnerabilities":a.damage.vulnerable=S;break;case"damage resistances":a.damage.resist=S;break;case"damage immunities":a.damage.immune=S;break;case"condition immunities":a.conditionImmunities=S;break;case"senses":a.senses=S;break;case"languages":a.languages=S;break;case"challenge":var O=S.indexOf(" ");a.challenge=Number.parseInt(S.substring(0,O),10)}}}catch(H){console.error(H)}try{for(var M=n.getElementsByClassName("mon-stat-block__description-block"),j=0;j!==M.length;++j){var I=M[j],T="trait",D=I.getElementsByClassName("mon-stat-block__description-block-heading");if(D.length>0)switch(D[0].innerText.toLowerCase().trim()){case"actions":T="action";break;case"bonus actions":T="bonus";break;case"reactions":T="reaction";break;case"legendary actions":T="legendary";break;case"lair actions":T="lair"}for(var V=I.getElementsByTagName("p"),A=0;A!==V.length;++A){var P=V[A].innerText.trim(),z=k.createTrait();z.type=T;var L=P.indexOf(".");z.text=P.substring(L+1).trim();var G=(P=P.substring(0,L)).indexOf("("),R=P.indexOf(")");if(-1!==G&&-1!==R&&(z.usage=P.substring(G+1,R).trim(),P=P.substring(0,G).trim()),z.name=P,z.name)a.traits.push(z);else{var B=a.traits[a.traits.length-1];B.text+="\n",B.text+=z.text}}}}catch(H){console.error(H)}}},{key:"copyTrait",value:function(e,t){var a=JSON.parse(JSON.stringify(t));a.id=E.guid(),e.traits.push(a)}},{key:"addTrait",value:function(e,t){var a=k.createTrait();a.type=t,a.name="New "+E.traitType(t,!1).toLowerCase(),e.traits.push(a)}},{key:"moveTrait",value:function(e,t,a){var n,r=e.traits.splice(t,1);(n=e.traits).splice.apply(n,[a,0].concat(Object(f.a)(r)))}},{key:"removeTrait",value:function(e,t){var a=e.traits.indexOf(t);e.traits.splice(a,1)}},{key:"swapTraits",value:function(e,t,a){var n=e.traits.indexOf(t),r=e.traits.indexOf(a);e.traits[r]=t,e.traits[n]=a}},{key:"spliceMonsters",value:function(e,t){var a=this;["size","category","tag","alignment","challenge","speed","senses","languages","equipment","abilityScores.str","abilityScores.dex","abilityScores.con","abilityScores.int","abilityScores.wis","abilityScores.cha","savingThrows","skills","ac","hitDice","damage.resist","damage.vulnerable","damage.immune","conditionImmunities"].forEach((function(n){a.setRandomValue(e,n,t)})),e.traits=[],b.forEach((function(n){var r=[];t.forEach((function(e){e.traits.filter((function(e){return e.type===n})).forEach((function(e){return r.push(e)}))}));var s=[];r.forEach((function(e){var t=s.find((function(t){return t.trait.name===e.name}));t?t.count+=1:s.push({trait:e,count:1})}));var i=[];s.filter((function(e){return e.count===t.length})).forEach((function(t){a.copyTrait(e,t.trait),i.push(t.trait.id)})),i.forEach((function(e){var t=s.findIndex((function(t){return t.trait.id===e}));s.splice(t,1)}));for(var o=r.length/t.length;e.traits.filter((function(e){return e.type===n})).length<o;){var c=Math.floor(Math.random()*s.length),l=s[c].trait;a.copyTrait(e,l),s.splice(c,1)}}))}},{key:"setRandomValue",value:function(e,t,a){var n=a[Math.floor(Math.random()*a.length)],r=null,s=t.split(".");s.forEach((function(e){e===s[s.length-1]?r=n[e]:n=n[e]})),this.changeValue(e,t,r)}},{key:"addRandomTrait",value:function(e,t,a){var n=[];a.forEach((function(e){e.traits.filter((function(e){return e.type===t})).forEach((function(e){n.push(e)}))}));var r=Math.floor(Math.random()*n.length),s=n[r];this.copyTrait(e,s)}}]),e}(),E=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getMonsterGroup",value:function(e,t){var a=this.monsterIdToGroup[e.id];if(!a){var n=t.find((function(t){return t.monsters.includes(e)}));n&&(a=n,this.monsterIdToGroup[e.id]=a)}return a}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"sort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===t.length&&(t=[{field:"name",dir:"asc"}]);var a=function(e,t,a){if(void 0!==e[a]&&void 0!==t[a]){if(e[a]<t[a])return-1;if(e[a]>t[a])return 1}return 0};return e.sort((function(e,n){var r=0;return t.forEach((function(t){0===r&&(r=a(e,n,t.field)*("asc"===t.dir?1:-1))})),r})),e}},{key:"debounce",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){clearTimeout(t),t=setTimeout(e,a)}}},{key:"toData",value:function(e){var t=e/1073741824;if(t>=1)return t.toFixed(2)+" GB";var a=e/1048576;if(a>=1)return a.toFixed(2)+" MB";var n=e/1024;return n>=1?n.toFixed(2)+" KB":e+" B"}},{key:"modifierValue",value:function(e){return Math.floor((e-10)/2)}},{key:"modifier",value:function(e){var t=this.modifierValue(e),a=t.toString();return t>=0&&(a="+"+a),a}},{key:"randomNumber",value:function(e){return Math.floor(Math.random()*e)}},{key:"randomBoolean",value:function(){return 0===e.randomNumber(2)}},{key:"dieRoll",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=0;r!==a;++r)n+=e.randomNumber(t)+1;return n}},{key:"miniSize",value:function(e){switch(e){case"tiny":return.4;case"small":return.6;case"medium":return 1;case"large":return 2;case"huge":return 3;case"gargantuan":return 4;default:return 1}}},{key:"hitDieType",value:function(e){switch(e){case"tiny":return 4;case"small":return 6;case"medium":return 8;case"large":return 10;case"huge":return 12;case"gargantuan":return 20;default:return 8}}},{key:"proficiency",value:function(e){return e<5?2:e<9?3:e<13?4:e<17?5:6}},{key:"challenge",value:function(e){switch(e){case.125:return"1/8";case.25:return"1/4";case.5:return"1/2";default:return e.toString()}}},{key:"parseChallenge",value:function(e){switch(e){case"1/8":return.125;case"1/4":return.25;case"1/2":return.5;default:return parseInt(e,10)}}},{key:"challengeDetails",value:function(){return[{cr:0,ac:13,hpMin:1,hpMax:6,attack:3,dmgMin:0,dmgMax:1,save:13},{cr:.125,ac:13,hpMin:7,hpMax:35,attack:3,dmgMin:2,dmgMax:3,save:13},{cr:.25,ac:13,hpMin:36,hpMax:49,attack:3,dmgMin:4,dmgMax:5,save:13},{cr:.5,ac:13,hpMin:50,hpMax:70,attack:3,dmgMin:6,dmgMax:8,save:13},{cr:1,ac:13,hpMin:71,hpMax:85,attack:3,dmgMin:9,dmgMax:14,save:13},{cr:2,ac:13,hpMin:86,hpMax:100,attack:3,dmgMin:15,dmgMax:20,save:13},{cr:3,ac:13,hpMin:101,hpMax:115,attack:4,dmgMin:21,dmgMax:26,save:13},{cr:4,ac:14,hpMin:116,hpMax:130,attack:5,dmgMin:27,dmgMax:32,save:14},{cr:5,ac:15,hpMin:131,hpMax:145,attack:6,dmgMin:33,dmgMax:38,save:15},{cr:6,ac:15,hpMin:146,hpMax:160,attack:6,dmgMin:39,dmgMax:44,save:15},{cr:7,ac:15,hpMin:161,hpMax:175,attack:6,dmgMin:45,dmgMax:50,save:15},{cr:8,ac:16,hpMin:176,hpMax:190,attack:7,dmgMin:51,dmgMax:56,save:16},{cr:9,ac:16,hpMin:191,hpMax:205,attack:7,dmgMin:57,dmgMax:62,save:16},{cr:10,ac:17,hpMin:206,hpMax:220,attack:7,dmgMin:63,dmgMax:68,save:16},{cr:11,ac:17,hpMin:221,hpMax:235,attack:8,dmgMin:69,dmgMax:74,save:17},{cr:12,ac:17,hpMin:236,hpMax:250,attack:8,dmgMin:75,dmgMax:80,save:17},{cr:13,ac:18,hpMin:251,hpMax:265,attack:8,dmgMin:81,dmgMax:86,save:18},{cr:14,ac:18,hpMin:266,hpMax:280,attack:8,dmgMin:87,dmgMax:92,save:18},{cr:15,ac:18,hpMin:281,hpMax:295,attack:8,dmgMin:93,dmgMax:98,save:18},{cr:16,ac:18,hpMin:296,hpMax:310,attack:9,dmgMin:99,dmgMax:104,save:18},{cr:17,ac:19,hpMin:311,hpMax:325,attack:10,dmgMin:105,dmgMax:110,save:19},{cr:18,ac:19,hpMin:326,hpMax:340,attack:10,dmgMin:111,dmgMax:116,save:19},{cr:19,ac:19,hpMin:341,hpMax:355,attack:10,dmgMin:117,dmgMax:122,save:19},{cr:20,ac:19,hpMin:356,hpMax:400,attack:10,dmgMin:123,dmgMax:140,save:19},{cr:21,ac:19,hpMin:401,hpMax:445,attack:11,dmgMin:141,dmgMax:158,save:20},{cr:22,ac:19,hpMin:446,hpMax:490,attack:11,dmgMin:159,dmgMax:176,save:20},{cr:23,ac:19,hpMin:491,hpMax:535,attack:11,dmgMin:177,dmgMax:194,save:20},{cr:24,ac:19,hpMin:536,hpMax:580,attack:12,dmgMin:195,dmgMax:212,save:21},{cr:25,ac:19,hpMin:581,hpMax:625,attack:12,dmgMin:213,dmgMax:230,save:21},{cr:26,ac:19,hpMin:626,hpMax:670,attack:12,dmgMin:231,dmgMax:248,save:21},{cr:27,ac:19,hpMin:671,hpMax:715,attack:13,dmgMin:249,dmgMax:266,save:22},{cr:28,ac:19,hpMin:716,hpMax:760,attack:13,dmgMin:267,dmgMax:284,save:22},{cr:29,ac:19,hpMin:761,hpMax:805,attack:13,dmgMin:285,dmgMax:302,save:22},{cr:30,ac:19,hpMin:806,hpMax:850,attack:14,dmgMin:303,dmgMax:320,save:23}]}},{key:"experience",value:function(e){switch(e){case 0:return 10;case.125:return 25;case.25:return 50;case.5:return 100;case 1:return 200;case 2:return 450;case 3:return 700;case 4:return 1100;case 5:return 1800;case 6:return 2300;case 7:return 2900;case 8:return 3900;case 9:return 5e3;case 10:return 5900;case 11:return 7200;case 12:return 8400;case 13:return 1e4;case 14:return 11500;case 15:return 13e3;case 16:return 15e3;case 17:return 18e3;case 18:return 2e4;case 19:return 22e3;case 20:return 25e3;case 21:return 33e3;case 22:return 41e3;case 23:return 5e4;case 24:return 62e3;case 30:return 155e3;default:return 0}}},{key:"experienceFactor",value:function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 1.5;case 3:case 4:case 5:case 6:return 2;case 7:case 8:case 9:case 10:return 2.5;case 11:case 12:case 13:case 14:return 3;default:return 4}}},{key:"pcExperience",value:function(e,t){switch(t){case"easy":switch(e){case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 125;case 5:return 250;case 6:return 300;case 7:return 350;case 8:return 450;case 9:return 550;case 10:return 600;case 11:return 800;case 12:return 1e3;case 13:return 1100;case 14:return 1250;case 15:return 1400;case 16:return 1600;case 17:return 2e3;case 18:return 2100;case 19:return 2400;case 20:return 2800;default:return 0}case"medium":switch(e){case 1:return 50;case 2:return 100;case 3:return 150;case 4:return 250;case 5:return 500;case 6:return 600;case 7:return 750;case 8:return 900;case 9:return 1100;case 10:return 1200;case 11:return 1600;case 12:return 2e3;case 13:return 2200;case 14:return 2500;case 15:return 2800;case 16:return 3200;case 17:return 3900;case 18:return 4200;case 19:return 4900;case 20:return 5700;default:return 0}case"hard":switch(e){case 1:return 75;case 2:return 150;case 3:return 225;case 4:return 375;case 5:return 750;case 6:return 900;case 7:return 1100;case 8:return 1400;case 9:return 1600;case 10:return 1900;case 11:return 2400;case 12:return 3e3;case 13:return 3400;case 14:return 3800;case 15:return 4300;case 16:return 4800;case 17:return 5900;case 18:return 6300;case 19:return 7300;case 20:return 8500;default:return 0}case"deadly":switch(e){case 1:return 100;case 2:return 200;case 3:return 400;case 4:return 500;case 5:return 1100;case 6:return 1400;case 7:return 1700;case 8:return 2100;case 9:return 2400;case 10:return 2800;case 11:return 3600;case 12:return 4500;case 13:return 5100;case 14:return 5700;case 15:return 6400;case 16:return 7200;case 17:return 8800;case 18:return 9500;case 19:return 10900;case 20:return 12700;default:return 0}default:return 0}}},{key:"traitType",value:function(e,t){var a="";switch(e){case"trait":a="trait";break;case"action":a="action";break;case"bonus":a="bonus action";break;case"reaction":a="reaction";break;case"legendary":a="legendary action";break;case"lair":a="lair action"}return t&&(a+="s"),a}},{key:"nudgeChallenge",value:function(e,t){var a=0;switch(e){case 0:-1===t&&(a=0),1===t&&(a=.125);break;case.125:-1===t&&(a=0),1===t&&(a=.25);break;case.25:-1===t&&(a=.125),1===t&&(a=.5);break;case.5:-1===t&&(a=.25),1===t&&(a=1);break;case 1:-1===t&&(a=.5),1===t&&(a=2);break;default:a=e+t}return a}},{key:"nudgeSize",value:function(e,t){var a=["tiny","small","medium","large","huge","gargantuan"],n=a.indexOf(e)+t;return n<0&&(n=0),n>=a.length&&(n=a.length-1),a[n]}},{key:"conditionText",value:function(e){switch(e.name){case"blinded":return["a blinded creature can\u2019t see and automatically fails any ability check that requires sight","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage"];case"charmed":return["a charmed creature can\u2019t attack the charmer or target the charmer with harmful abilities or magical effects","the charmer has advantage on any ability check to interact socially with the creature"];case"deafened":return["a deafened creature can\u2019t hear and automatically fails any ability check that requires hearing."];case"exhaustion":switch(e.level){case 1:return["disadvantage on ability checks"];case 2:return["disadvantage on ability checks","speed halved"];case 3:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws"];case 4:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved"];case 5:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0"];case 6:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0","death"];default:return[]}case"frightened":return["a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight","the creature can\u2019t willingly move closer to the source of its fear"];case"grappled":return["a grappled creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","the condition ends if the grappler is incapacitated","the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect"];case"incapacitated":return["an incapacitated creature can\u2019t take actions or reactions","being incapacitated breaks concentration"];case"invisible":return["an invisible creature is impossible to see without the aid of magic or a special sense","for the purpose of hiding, the creature is heavily obscured","the creature\u2019s location can be detected by any noise it makes or any tracks it leaves","attack rolls against the creature have disadvantage, and the creature\u2019s attack rolls have advantage"];case"paralyzed":return["a paralyzed creature is incapacitated (can\u2019t take actions or reactions) and can\u2019t move or speak","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"petrified":return["a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)","its weight increases by a factor of ten, and it ceases aging","the creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","attack rolls against the creature have advantage","the creature automatically fails strength and dexterity saving throws","the creature has resistance to all damage","the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized"];case"poisoned":return["a poisoned creature has disadvantage on attack rolls and ability checks"];case"prone":return["a prone creature\u2019s only movement option is to crawl, unless it stands up (using half its speed) and thereby ends the condition","the creature has disadvantage on attack rolls","an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage"];case"restrained":return["a restrained creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage","the creature has disadvantage on dexterity saving throws"];case"stunned":return["a stunned creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move, and can speak only falteringly","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage"];case"unconscious":return["an unconscious creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","the creature drops whatever its holding and falls prone","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];default:return[]}}},{key:"conditionDurationText",value:function(e,t){if(null!==e.duration)switch(e.duration.type){case"saves":var a=e.duration,n=a.saveType.toString();"death"!==n&&(n=n.toUpperCase());var r=a.count>1?"saves":"save";return"until you make "+a.count+" "+n+" "+r+" at dc "+a.saveDC;case"combatant":var s=e.duration,i=s.point,o=t.combatants.find((function(e){return e.id===s.combatantID}));return"until the "+i+" of "+(o?(o.displayName||o.name||"unnamed monster")+"'s":"their")+" next turn";case"rounds":var c=e.duration,l=c.count>1?"rounds":"round";return"for "+c.count+" "+l;default:return null}return null}},{key:"getCombatSlotData",value:function(t,a){var n=[];return t&&t.slots.forEach((function(t){var r=a.find((function(e){return e.name===t.monsterGroupName}));if(r){var s=r.monsters.find((function(e){return e.name===t.monsterName}));if(s){var i=k.createCombatSlotInfo();i.id=t.id,i.init=e.dieRoll()+e.modifierValue(s.abilityScores.dex),i.hp=y.getTypicalHP(s);for(var o=0;o!==t.count;++o){var c=k.createCombatSlotMember();c.init=i.init,c.hp=i.hp,c.name=t.monsterName,i.members.push(c)}if(t.count>1)for(var l=0;l!==t.count;++l)i.members[l].name=t.monsterName+" "+(l+1);n.push(i)}}})),n}},{key:"getTagTitle",value:function(e){if(e.startsWith("engaged"))return"engaged";switch(e){case"conc":return"concentrating";case"bane":return"affected by bane";case"bless":return"affected by bless";default:return e}}},{key:"getTagDescription",value:function(e){if(e.startsWith("engaged"))return e.split(":")[1];switch(e){case"conc":return"if damaged, must make con save (dc is half damage taken or 10, whichever is higher) or lose concentration";case"bane":return"subtract d4 from attack rolls and saving throws";case"bless":return"add d4 to attack rolls and saving throws";default:return e}}}]),e}();E.monsterIdToGroup={};var k=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"createParty",value:function(){return{id:E.guid(),name:"",pcs:[]}}},{key:"createPC",value:function(){return{id:E.guid(),type:"pc",active:!0,player:"",name:"",size:"medium",race:"",classes:"",level:1,languages:"Common",passiveInsight:10,passiveInvestigation:10,passivePerception:10,portrait:"",url:"",companions:[]}}},{key:"createCompanion",value:function(){return{id:E.guid(),name:""}}},{key:"createMonsterGroup",value:function(){return{id:E.guid(),name:"",monsters:[]}}},{key:"createMonster",value:function(){return{id:E.guid(),type:"monster",name:"",size:"medium",category:"humanoid",tag:"",alignment:"",challenge:1,abilityScores:{str:10,dex:10,con:10,int:10,wis:10,cha:10},ac:10,hitDice:1,damage:{resist:"",vulnerable:"",immune:""},savingThrows:"",speed:"",skills:"",senses:"",languages:"",equipment:"",traits:[],conditionImmunities:"",portrait:"",legendaryActions:0}}},{key:"createTrait",value:function(){return{id:E.guid(),name:"",usage:"",type:"action",text:"",uses:0}}},{key:"createEncounter",value:function(){return{id:E.guid(),name:"",slots:[],waves:[]}}},{key:"createEncounterSlot",value:function(){return{id:E.guid(),monsterGroupName:"",monsterName:"",count:1}}},{key:"createEncounterWave",value:function(){return{id:E.guid(),name:"",slots:[]}}},{key:"createMonsterFilter",value:function(){return{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}}},{key:"createMap",value:function(){return{id:E.guid(),name:"",items:[],notes:[]}}},{key:"createMapItem",value:function(){return{id:E.guid(),type:"tile",x:0,y:0,width:4,height:4,terrain:"",customBackground:"",content:null,size:"medium",color:"",opacity:255,style:null}}},{key:"createMapNote",value:function(){return{id:E.guid(),targetID:"",text:""}}},{key:"createCombatSetup",value:function(){return{party:null,encounter:null,waveID:null,map:null,slotInfo:[]}}},{key:"createCombatSlotInfo",value:function(){return{id:"",useGroupHP:!0,useGroupInit:!0,hp:0,init:0,members:[]}}},{key:"createCombatSlotMember",value:function(){return{id:E.guid(),name:"",hp:0,init:0}}},{key:"createCombat",value:function(){return{id:E.guid(),name:"",encounter:e.createEncounter(),combatants:[],map:null,round:1,notifications:[],issues:[],report:[]}}},{key:"createNotification",value:function(){return{id:E.guid(),type:"condition-save",data:null,combatant:null}}},{key:"createCombatReportEntry",value:function(){return{id:E.guid(),type:"combat-start",timestamp:Date.now(),combatantID:"",value:0}}},{key:"createCondition",value:function(){return{id:E.guid(),name:"",level:1,text:"",duration:null}}},{key:"createConditionDurationSaves",value:function(){return{type:"saves",count:1,saveType:"str",saveDC:10,point:"start"}}},{key:"createConditionDurationCombatant",value:function(){return{type:"combatant",point:"start",combatantID:null}}},{key:"createConditionDurationRounds",value:function(){return{type:"rounds",count:1}}}]),e}(),N=["default","cavern","dirt","flagstone","floorboard","grassland","pit","sand","snow","water","custom"],w=["single","double","arch","bars"],x=["stairs","spiral","ladder"],C=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"scatterCombatants",value:function(t,a){if(t.map&&(t.map.items=t.map.items.filter((function(e){return e.type!==a})),t.map.items.filter((function(e){return"tile"===e.type})).length>0)){var n=e.mapDimensions(t.map);if(n)t.combatants.filter((function(e){return e.type===a})).forEach((function(r){for(var s=[],i=n.minX;i<=n.maxX;++i)for(var o=n.minY;o<=n.maxY;++o){e.canAddMonsterHere(t.map,r,i,o)&&s.push({x:i,y:o})}if(s.length>0&&t.map){var c=s[Math.floor(Math.random()*s.length)],l=E.miniSize(r.displaySize),u=k.createMapItem();u.id=r.id,u.type=a,u.x=c.x,u.y=c.y,u.height=l,u.width=l,t.map.items.push(u)}}))}}},{key:"mapDimensions",value:function(e){var t=e.items.filter((function(e){return"tile"===e.type}));if(t.length>0){var a=t[0].x,n=t[0].y,r=t[0].x+t[0].width-1,s=t[0].y+t[0].height-1;return t.forEach((function(e){a=Math.min(a,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x+e.width-1),s=Math.max(s,e.y+e.height-1)})),{minX:a,minY:n,maxX:r,maxY:s}}return null}},{key:"canAddTileHere",value:function(t,a,n,r,s,i){for(var o=[],c=n-s,l=r-i,u=n+(a.width-1)+s,m=r+(a.height-1)+i,d=c;d<=u;++d)for(var p=l;p<=m;++p){var h=e.itemsAt(t,d,p).every((function(e){return"tile"!==e.type}));o.push(h)}return o.every((function(e){return e}))}},{key:"canAddMonsterHere",value:function(t,a,n,r){for(var s=[],i=E.miniSize(a.displaySize),o=n+Math.max(1,i)-1,c=r+Math.max(1,i)-1,l=n;l<=o;++l)for(var u=r;u<=c;++u){var m=e.itemsAt(t,l,u),d=m.length>0&&m.every((function(e){return"tile"===e.type}));s.push(d)}return s.every((function(e){return e}))}},{key:"itemsAt",value:function(e,t,a){return e.items.filter((function(e){var n=e.x,r=e.x+e.width-1,s=e.y,i=e.y+e.height-1;return t>=n&&t<=r&&a>=s&&a<=i}))}},{key:"rotateMap",value:function(e){e.items.forEach((function(e){var t=-1*(e.y+e.height-1),a=e.x,n=e.height,r=e.width;e.x=t,e.y=a,e.width=n,e.height=r,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal")}))}},{key:"mapSize",value:function(t){return t.items.filter((function(e){return"tile"===e.type})).reduce((function(t,a){return t+e.mapTileSize(a)}),0)}},{key:"mapTileSize",value:function(e){return"tile"===e.type?e.width*e.height:0}},{key:"getNote",value:function(e,t){return e.notes.find((function(e){return e.targetID===t.id}))||null}},{key:"generate",value:function(t,a){switch(t){case"dungeon":for(var n=0;n<10;)e.addRoom(a)&&(n+=1);break;case"delve":for(var r=0;r<3;)e.addRoom(a)&&(r+=1);break;case"room":for(var s=!1;!s;)s=e.addRoom(a)}}},{key:"addRoom",value:function(t){var a=k.createMapItem();a.type="tile",a.terrain="default",a.style="square",a.width=E.dieRoll(4,2)+2,a.height=E.dieRoll(4,2)+2;var n=e.mapDimensions(t);if(n){n.minX-=a.width+2,n.minY-=a.height+2,n.maxX+=2,n.maxY+=2;for(var r=[],s=n.minX;s!==n.maxX;++s)for(var i=n.minY;i!==n.maxY;++i){e.canAddTileHere(t,a,s,i,1,1)&&r.push({x:s,y:i})}if(!(r.length>0))return!1;var o=Math.floor(Math.random()*r.length);a.x=r[o].x,a.y=r[o].y;var c=[];if(t.items.filter((function(e){return"tile"===e.type})).forEach((function(n){var r=Math.max(a.x,n.x),s=Math.min(a.x+a.width-1,n.x+n.width-1);if(s-r+1>=2)for(var i=Math.min(a.y+a.height-1,n.y+n.height-1)+1,o=Math.max(a.y,n.y)-1,l=r;l<=s-1;++l){var u=k.createMapItem();u.type="tile",u.terrain="default",u.style="square",u.x=l,u.y=i,u.width=2,u.height=o-i+1,e.canAddTileHere(t,u,u.x,u.y,1,0)&&c.push({tile:u,horizontal:!1})}var m=Math.max(a.y,n.y),d=Math.min(a.y+a.height-1,n.y+n.height-1);if(d-m+1>=2)for(var p=Math.min(a.x+a.width-1,n.x+n.width-1)+1,h=Math.max(a.x,n.x)-1,f=m;f<=d-1;++f){var v=k.createMapItem();v.type="tile",v.terrain="default",v.style="square",v.x=p,v.y=f,v.width=h-p+1,v.height=2,e.canAddTileHere(t,v,v.x,v.y,0,1)&&c.push({tile:v,horizontal:!0})}})),!(c.length>0))return!1;var l=Math.floor(Math.random()*c.length),u=c[l];if(!u.horizontal&&1===u.tile.height||u.horizontal&&1===u.tile.width)2===E.dieRoll(2)&&(u.tile.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:u.horizontal?"vertical":"horizontal"});else{if(!u.horizontal&&u.tile.height>=4||u.horizontal&&u.tile.width>=4){if(2===E.dieRoll(2)){var m=k.createMapItem();m.type="tile",m.terrain="default",m.style="square",m.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:""},u.horizontal?(m.x=u.tile.x,m.y=u.tile.y,m.width=1,m.height=2,m.content.orientation="vertical",u.tile.x+=1,u.tile.width-=1):(m.x=u.tile.x,m.y=u.tile.y,m.width=2,m.height=1,m.content.orientation="horizontal",u.tile.y+=1,u.tile.height-=1),t.items.push(m)}if(2===E.dieRoll(2)){var d=k.createMapItem();d.type="tile",d.terrain="default",d.style="square",d.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:""},u.horizontal?(d.x=u.tile.x+u.tile.width-1,d.y=u.tile.y,d.width=1,d.height=2,d.content.orientation="vertical",u.tile.width-=1):(d.x=u.tile.x,d.y=u.tile.y+u.tile.height-1,d.width=2,d.height=1,d.content.orientation="horizontal",u.tile.height-=1),t.items.push(d)}}(!u.horizontal&&u.tile.height<=4||u.horizontal&&u.tile.width<=4)&&3===E.dieRoll(3)&&(u.tile.content={type:"stairway",style:"stairs",orientation:u.horizontal?"vertical":"horizontal"})}t.items.push(u.tile),t.items.push(a)}else t.items.push(a);return!0}},{key:"getRandomDoorwayStyle",value:function(){var e=Math.floor(Math.random()*w.length);return w[e]}}]),e}(),S=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"matchParty",value:function(t,a){return!!e.match(t,a.name)||a.pcs.some((function(a){return e.matchPC(t,a)}))}},{key:"matchPC",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.player)||(!!e.match(t,a.race)||(!!e.match(t,a.classes)||a.companions.some((function(a){return e.matchCompanion(t,a)})))))}},{key:"matchCompanion",value:function(t,a){return!!e.match(t,a.name)}},{key:"matchGroup",value:function(t,a){return!!e.match(t,a.name)||a.monsters.some((function(a){return e.matchMonster(t,a)}))}},{key:"matchMonster",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.category)||(!!e.match(t,a.tag)||(!!e.match(t,a.senses)||(!!e.match(t,a.languages)||(!!e.match(t,a.equipment)||a.traits.some((function(a){return e.matchTrait(t,a)})))))))}},{key:"matchTrait",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.usage)||!!e.match(t,a.text))}},{key:"matchEncounter",value:function(t,a){return!!e.match(t,a.name)||(!!a.waves.some((function(a){return e.matchEncounterWave(t,a)}))||a.slots.some((function(a){return e.matchEncounterSlot(t,a)})))}},{key:"matchEncounterWave",value:function(t,a){return!!e.match(t,a.name)||a.slots.some((function(a){return e.matchEncounterSlot(t,a)}))}},{key:"matchEncounterSlot",value:function(t,a){return!!e.match(t,a.monsterName)}},{key:"matchMap",value:function(t,a){return!!e.match(t,a.name)||a.notes.some((function(a){return e.matchMapNote(t,a)}))}},{key:"matchMapNote",value:function(t,a){return!!e.match(t,a.text)}},{key:"match",value:function(e,t){if(!e)return!0;var a=!0;return e.toLowerCase().split(" ").forEach((function(e){-1===t.toLowerCase().indexOf(e)&&(a=!1)})),a}}]),e}(),O=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getMonsterCount",value:function(e){var t=0,a=[];return a=a.concat(e.slots),e.waves.forEach((function(e){a=a.concat(e.slots)})),a.forEach((function(e){t+=e.count})),t}},{key:"getEncounterXP",value:function(e,t){var a=0,n=[];return n=n.concat(e.slots),e.waves.forEach((function(e){n=n.concat(e.slots)})),n.forEach((function(e){var n=t(e.monsterName,e.monsterGroupName);n&&(a+=E.experience(n.challenge)*e.count)})),a}},{key:"getAdjustedEncounterXP",value:function(e,t){var a=0,n=0,r=[];return r=r.concat(e.slots),e.waves.forEach((function(e){r=r.concat(e.slots)})),r.forEach((function(e){a+=e.count;var r=t(e.monsterName,e.monsterGroupName);r&&(n+=E.experience(r.challenge)*e.count)})),n*E.experienceFactor(a)}},{key:"getCombatXP",value:function(e){var t=0;return e.combatants.filter((function(e){return"monster"===e.type})).forEach((function(e){var a=e;t+=E.experience(a.challenge)})),t}},{key:"getFilterDescription",value:function(e){var t="";"all sizes"!==e.size&&(t+=t?" "+e.size:e.size),"all types"!==e.category&&(t+=t?" "+e.category:e.category);var a=E.challenge(e.challengeMin),n=E.challenge(e.challengeMax);return t+=" monsters of cr "+(e.challengeMin===e.challengeMax?a:a+" to "+n)}},{key:"buildEncounter",value:function(t,a,n,r,s){for(;e.getAdjustedEncounterXP(t,(function(e,t){return s(e,t)}))<=a;)if(t.slots.length>0&&E.dieRoll(3)>1){var i=Math.floor(Math.random()*t.slots.length);t.slots[i].count+=1}else{if("break"===function(){var a=[];if(r.forEach((function(r){r.monsters.filter((function(t){return e.matchMonster(t,n)})).filter((function(e){return!t.slots.find((function(t){return t.monsterGroupName===r.name&&t.monsterName===e.name}))})).forEach((function(e){return a.push({groupName:r.name,monsterName:e.name})}))})),a.length>0){var s=Math.floor(Math.random()*a.length),i=k.createEncounterSlot();i.monsterGroupName=a[s].groupName,i.monsterName=a[s].monsterName,t.slots.push(i)}else if(0===t.slots.length)return"break"}())break}for(var o=function(){var e=Math.floor(Math.random()*t.slots.length),a=t.slots[e];t.slots=t.slots.filter((function(e){return e.id!==a.id}));var n=k.createEncounterWave();n.name="wave "+(t.waves.length+2),n.slots.push(a),t.waves.push(n)};t.slots.length>1&&10===E.dieRoll(10);)o()}},{key:"matchMonster",value:function(e,t){return!(e.challenge<t.challengeMin)&&(!(e.challenge>t.challengeMax)&&(!(""!==t.name&&!S.match(t.name,e.name))&&(("all types"===t.category||e.category===t.category)&&("all sizes"===t.size||e.size===t.size))))}},{key:"sortCombatants",value:function(e){e.combatants.sort((function(e,t){return e.initiative&&t.initiative&&e.initiative<t.initiative?1:e.initiative&&t.initiative&&e.initiative>t.initiative||e.displayName<t.displayName?-1:e.displayName>t.displayName?1:0}))}},{key:"combatHasLairActions",value:function(e){var t=!1;return e.combatants.filter((function(e){return!e.pending&&e.active&&!e.defeated})).forEach((function(e){var a=e;a&&a.traits&&a.traits.some((function(e){return"lair"===e.type}))&&(t=!0)})),t}},{key:"addPCToCombat",value:function(e,t){var a=JSON.parse(JSON.stringify(t));a.current=!1,a.pending=!0,a.active=!1,a.defeated=!1,a.displayName=t.name,a.displaySize=t.size,a.showOnMap=!0,a.initiative=10,a.hpMax=null,a.hpCurrent=null,a.hpTemp=null,a.conditions=[],a.tags=[],a.note="",a.altitude=0,a.aura={radius:0,style:"rounded",color:"#005080"},e.combatants.push(a)}},{key:"addMonsterToCombat",value:function(e,t,a,n,r){var s=JSON.parse(JSON.stringify(t));s.id=E.guid(),s.current=!1,s.pending=!1,s.active=!0,s.defeated=!1,s.displayName=r,s.displaySize=t.size,s.showOnMap=!0,s.initiative=a,s.hpMax=n,s.hpCurrent=n,s.hpTemp=0,s.conditions=[],s.tags=[],s.note="",s.altitude=0,s.aura={radius:0,style:"rounded",color:"#005080"},e.combatants.push(s)}},{key:"addCompanionToCombat",value:function(e,t){var a={id:t?t.id:E.guid(),type:"companion",current:!1,pending:!0,active:!1,defeated:!1,displayName:t?t.name:"companion",displaySize:"medium",showOnMap:!0,initiative:10,hpMax:null,hpCurrent:null,hpTemp:null,conditions:[],tags:[],note:"",altitude:0,aura:{radius:0,style:"rounded",color:"#005080"}};e.combatants.push(a)}},{key:"addPlaceholderToCombat",value:function(e){var t={id:E.guid(),type:"placeholder",current:!1,pending:!1,active:!0,defeated:!1,displayName:"lair actions",displaySize:"medium",showOnMap:!0,initiative:20,hpMax:null,hpCurrent:null,hpTemp:null,conditions:[],tags:[],note:"",altitude:0,aura:{radius:0,style:"rounded",color:"#005080"}};e.combatants.push(t)}}]),e}(),M=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.changeValue(!this.props.checked)}},{key:"render",value:function(){var e=this;try{var t="checkbox "+this.props.display;this.props.checked&&(t+=" checked"),this.props.disabled&&(t+=" disabled");var a=null;return"switch"===this.props.display&&(a=r.a.createElement("div",{className:"toggle-container"},r.a.createElement("div",{className:"toggle"}))),r.a.createElement("div",{className:t,onClick:function(t){return e.click(t)}},r.a.createElement("div",{className:"checkbox-label"},this.props.label),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);M.defaultProps={display:"switch",disabled:!1};var j=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pressed:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(e){e.stopPropagation(),this.setState({pressed:!this.state.pressed})}},{key:"perform",value:function(){var e=this;this.setState({pressed:!1},(function(){e.props.callback()}))}},{key:"render",value:function(){var e=this;try{var t=null;return this.state.pressed&&(t=r.a.createElement("div",{className:"confirm",onClick:function(){return e.perform()}},"confirm")),r.a.createElement("button",{className:this.props.disabled?"danger disabled":"danger",onClick:function(t){return e.toggle(t)}},r.a.createElement("div",null,this.props.text),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);j.defaultProps={disabled:!1};var I=a(114),T=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=0,a=0,n=0;n!==localStorage.length;++n){var s=localStorage.key(n);if(s){var i=localStorage.getItem(s);i&&(s.startsWith("data")&&(t+=i.length),s.startsWith("image")&&(a+=i.length))}}return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement("div",{className:"section"},"designed by ",r.a.createElement("a",{href:"mailto:andy.aiken@live.co.uk"},"andy aiken")),r.a.createElement("div",{className:"section"},"version ",r.a.createElement("b",null,I.version)),r.a.createElement("div",{className:"section"},"if you would like to raise a bug or request a new feature, you can do so ",r.a.createElement("a",{href:"https://github.com/andyaiken/dojo",target:"_blank",rel:"noopener noreferrer"},"here")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"open game license"),r.a.createElement("div",{className:"section"},"The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved."),r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement("b",null,"Definitions"),": (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement."),r.a.createElement("li",null,r.a.createElement("b",null,"The License"),": This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Offer and Acceptance"),": By Using the Open Game Content You indicate Your acceptance of the terms of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Grant and Consideration"),": In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content."),r.a.createElement("li",null,r.a.createElement("b",null,"Representation of Authority to Contribute"),": If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Notice of License Copyright"),": You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute."),r.a.createElement("li",null,r.a.createElement("b",null,"Use of Product Identity"),": You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity."),r.a.createElement("li",null,r.a.createElement("b",null,"Identification"),": If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content."),r.a.createElement("li",null,r.a.createElement("b",null,"Updating the License"),": Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Copy of this License"),": You MUST include a copy of this License with every copy of the Open Game Content You Distribute."),r.a.createElement("li",null,r.a.createElement("b",null,"Use of Contributor Credits"),": You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so."),r.a.createElement("li",null,r.a.createElement("b",null,"Inability to Comply"),": If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected."),r.a.createElement("li",null,r.a.createElement("b",null,"Termination"),": This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Reformation"),": If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable."),r.a.createElement("li",null,r.a.createElement("b",null,"COPYRIGHT NOTICE")," Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"options"),r.a.createElement("div",{className:"section"},"this will reset the entire app and cannot be undone"),r.a.createElement("div",{className:"section"},"use it at your own risk"),r.a.createElement(j,{text:"clear all data",callback:function(){return e.props.resetAll()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"data"),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"total"),r.a.createElement(p.a,{span:8,className:"statistic-value"},E.toData(t+a))),r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"data"),r.a.createElement(p.a,{span:8,className:"statistic-value"},E.toData(t))),r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"images"),r.a.createElement(p.a,{span:8,className:"statistic-value"},E.toData(a)))))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),D=a(260),V=a(236),A=a(256),P=a(254),z=a(241),L=a(257),G=a(270),R=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={open:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleOpen",value:function(e){e.stopPropagation(),this.setState({open:!this.state.open})}},{key:"select",value:function(e){this.setState({open:!1}),this.props.select(e)}},{key:"clear",value:function(e){e.stopPropagation(),this.props.clear()}},{key:"render",value:function(){var e=this;try{if(0===this.props.options.length)return null;var t,a=this.props.disabled?"dropdown disabled":"dropdown",n=[];this.props.selectedID&&(t=this.props.options.find((function(t){return t.id===e.props.selectedID})));var s=t&&this.props.clear;if(n.push(r.a.createElement("div",{key:"selection",className:"dropdown-top",title:t?t.text:this.props.placeholder},r.a.createElement("div",{className:"item-text"},t?t.text:this.props.placeholder),s?r.a.createElement(L.a,{onClick:function(t){return e.clear(t)}}):r.a.createElement(G.a,null))),this.state.open){a+=" open";var i=this.props.options.map((function(t){return null===t.text?r.a.createElement("div",{key:t.id,className:"divider"}):r.a.createElement(B,{key:t.id,option:t,selected:t.id===e.props.selectedID,select:function(t){return e.select(t)}})}));n.push(r.a.createElement("div",{key:"options",className:"dropdown-options"},i))}return r.a.createElement("div",{className:a,onClick:function(t){return e.toggleOpen(t)}},n)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);R.defaultProps={selectedID:null,placeholder:"select...",disabled:!1,clear:null};var B=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="dropdown-option";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),H=a(250),q=a(237),W=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e="expander";return this.props.disabled&&(e+=" disabled"),r.a.createElement(q.a,{className:e,bordered:!1,defaultActiveKey:[],expandIcon:function(e){return r.a.createElement(H.a,{rotate:e.isActive?-180:0})},expandIconPosition:"right"},r.a.createElement(q.a.Panel,{key:"one",header:r.a.createElement("div",{className:"collapse-header-text"},this.props.text)},this.props.children))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);W.defaultProps={disabled:!1};var Y=a(269),F=a(248),J=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){e.stopPropagation(),this.props.nudgeValue(t)}},{key:"touchEnd",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.props.nudgeValue(t)}},{key:"render",value:function(){var e=this;try{var t="info-value",a=this.props.source[this.props.name];0===a&&(t+=" dimmed"),this.props.display&&(a=this.props.display(a));var n=[],s=[],i=this.props.factors||[1];return i.forEach((function(t){n.push(r.a.createElement("div",{key:"minus"+t,className:1===t?"spin-button":"spin-button multiple",onTouchEnd:function(a){return e.touchEnd(a,-1*t)},onClick:function(a){return e.click(a,-1*t)}},1===t?r.a.createElement(Y.a,null):r.a.createElement("div",null,t))),s.push(r.a.createElement("div",{key:"plus"+t,className:1===t?"spin-button":"spin-button multiple",onTouchEnd:function(a){return e.touchEnd(a,1*t)},onClick:function(a){return e.click(a,1*t)}},1===t?r.a.createElement(F.a,null):r.a.createElement("div",null,t)))})),n.reverse(),r.a.createElement("div",{className:this.props.disabled?"number-spin disabled":"number-spin"},r.a.createElement("div",{className:"minus"},n),r.a.createElement("div",{className:"info",style:{width:"calc(100% - "+60*i.length+"px)"}},r.a.createElement("div",{className:"info-label"},this.props.label),r.a.createElement("div",{className:t},a)),r.a.createElement("div",{className:"plus"},s))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);J.defaultProps={label:null,disabled:!1,factors:null,display:null};var _=a(235),X=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="textbox";return this.props.disabled&&(t+=" disabled"),this.props.maxLines>1?r.a.createElement(_.a.TextArea,{className:t,value:this.props.text,placeholder:this.props.placeholder,autoSize:{minRows:this.props.minLines,maxRows:this.props.maxLines},onChange:function(t){return e.props.onChange(t.target.value)}}):r.a.createElement(_.a,{className:t,value:this.props.text,placeholder:this.props.placeholder,allowClear:!0,onChange:function(t){return e.props.onChange(t.target.value)}})}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);X.defaultProps={placeholder:"",minLines:1,maxLines:1,disabled:!1};var K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showAbilityScores:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleAbilityScores",value:function(){this.setState({showAbilityScores:!this.state.showAbilityScores})}},{key:"render",value:function(){var e=this;try{return this.props.edit?r.a.createElement("div",null,r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"str",label:"strength",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.str",t)}}),r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"dex",label:"dexterity",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.dex",t)}}),r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"con",label:"constitution",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.con",t)}}),r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"int",label:"intelligence",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.int",t)}}),r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"wis",label:"wisdom",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.wis",t)}}),r.a.createElement(J,{source:this.props.combatant.abilityScores,name:"cha",label:"charisma",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.cha",t)}})):r.a.createElement("div",{className:"ability-scores",onClick:function(){return e.toggleAbilityScores()}},r.a.createElement("div",{className:"ability-score-group"},r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"str"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.str:E.modifier(this.props.combatant.abilityScores.str))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"dex"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.dex:E.modifier(this.props.combatant.abilityScores.dex))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"con"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.con:E.modifier(this.props.combatant.abilityScores.con)))),r.a.createElement("div",{className:"ability-score-group"},r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"int"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.int:E.modifier(this.props.combatant.abilityScores.int))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"wis"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.wis:E.modifier(this.props.combatant.abilityScores.wis))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"cha"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.cha:E.modifier(this.props.combatant.abilityScores.cha)))))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);K.defaultProps={edit:null,nudgeValue:null};var U=a(65),Z=a.n(U),Q=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getEditor",value:function(){var e=this,t=null;this.props.source.portrait&&(t=r.a.createElement(L.a,{onClick:function(){return e.props.clear()}}));var a=Z.a,n=localStorage.getItem("image-"+this.props.source.portrait);n&&(a=JSON.parse(n).data);return r.a.createElement("div",{className:"portrait editing"},r.a.createElement("div",{className:"section centered"},r.a.createElement("img",{src:a,alt:"portrait",onClick:function(){return e.props.edit()}}),t))}},{key:"getDisplay",value:function(){if(!this.props.source.portrait)return null;var e=localStorage.getItem("image-"+this.props.source.portrait);if(!e)return null;var t=JSON.parse(e);if(!t.data)return null;var a="portrait";return this.props.inline?a+=" inline":a+=" section centered",r.a.createElement("div",{className:a},r.a.createElement("img",{src:t.data,alt:"portrait"}))}},{key:"render",value:function(){try{return this.props.edit?this.getEditor():this.getDisplay()}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Q.defaultProps={inline:!1,edit:null,clear:null};var $=a(262),ee=a(261),te=a(23),ae=a.n(te),ne=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e="descriptive";return this.props.white&&(e+=" white"),r.a.createElement("div",{className:e},this.props.children)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ne.defaultProps={white:!1};var re=new ae.a.Converter,se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"createSection",value:function(e,t){var a=e[t];if(0===a.length)return null;var n=null;if("legendary"===this.props.mode||"lair"===this.props.mode)switch(t){case"legendary":var s=null,i=null;if(this.props.combatant.legendaryActions>0&&(s=r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,this.props.combatant.legendaryActions)," legendary actions per round"),r.a.createElement("div",{className:"divider"})),"legendary"===this.props.mode)){var o=0;this.props.combatant.traits.filter((function(e){return"legendary"===e.type&&e.uses>0})).forEach((function(e){var t=1;if(e.usage){var a=e.usage.toLowerCase().match(/\D*(\d*)\D*/);a&&(t=parseInt(a[1],10))}o+=t})),o=Math.min(o,this.props.combatant.legendaryActions);for(var c=Math.max(this.props.combatant.legendaryActions-o,0),l=[],u=0;u!==o;++u)l.push(r.a.createElement($.a,{key:"used "+u}));for(var m=0;m!==c;++m)l.push(r.a.createElement(ee.a,{key:"unused "+m}));i=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section centered legendary-usage"},l))}n=r.a.createElement(ne,{white:!0},s,"one legendary action can be used at the end of each other combatant's turn; spent actions are refreshed at the start of the monster's turn",i);break;case"lair":n=r.a.createElement(ne,{white:!0},"one lair action can be taken each round on initiative 20")}else"legendary"===t&&(n=r.a.createElement(ne,{white:!0},r.a.createElement("b",null,this.props.combatant.legendaryActions)," legendary actions per round"));return r.a.createElement("div",null,r.a.createElement("div",{className:"section subheading"},E.traitType(t,!0)),n,a)}},{key:"render",value:function(){var e=this;try{var t={};return b.forEach((function(a){t[a]=e.props.combatant.traits.filter((function(e){return e.type===a})).map((function(t){return r.a.createElement(ie,{key:t.id,trait:t,mode:e.props.mode,copyTrait:function(t){return e.props.copyTrait(t)},useTrait:function(t){return e.props.useTrait(t)},rechargeTrait:function(t){return e.props.rechargeTrait(t)}})}))})),0===this.props.combatant.traits.length?r.a.createElement("div",null,r.a.createElement("i",null,"no traits or actions")):"combat"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction")):"legendary"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"legendary")):"lair"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"lair")):r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction"),this.createSection(t,"legendary"),this.createSection(t,"lair"))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);se.defaultProps={mode:"view",copyTrait:null,useTrait:null,rechargeTrait:null};var ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=0,a=this.props.trait.name||"unnamed "+E.traitType(this.props.trait.type,!1);if(this.props.trait.usage){var n="";this.props.trait.usage.toLowerCase().startsWith("recharge ")&&(t=1,this.props.trait.uses>0&&(n="; used"));var s=this.props.trait.usage.toLowerCase().match(/(\d+)\s*\/\s*day/);s&&(t=parseInt(s[1],10),this.props.trait.uses>0&&(n="; used "+this.props.trait.uses)),a+=" *("+this.props.trait.usage+n+")*"}"legendary"===this.props.trait.type&&(t=1,this.props.trait.uses>0&&(a+=" *(used)*"));var i="**"+a+"** "+this.props.trait.text;switch(this.props.mode){case"view":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:re.makeHtml(i)}}));case"template":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait trait-template",onClick:function(){return e.props.copyTrait(e.props.trait)}},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:re.makeHtml(i)}}));case"combat":case"legendary":case"lair":var o="",c=null;return t>0&&(this.props.trait.uses>=t?(o="strikethrough",c=r.a.createElement("button",{onClick:function(){return e.props.rechargeTrait(e.props.trait)}},"recharge")):c=r.a.createElement("button",{onClick:function(){return e.props.useTrait(e.props.trait)}},"use")),r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{className:o,dangerouslySetInnerHTML:{__html:re.makeHtml(i)}}),c)}}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"card"},this.props.heading,r.a.createElement("div",{className:"card-content"},this.props.children))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);oe.defaultProps={heading:null};var ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={cloneName:e.monster.name+" copy"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCloneName",value:function(e){this.setState({cloneName:e})}},{key:"canSelect",value:function(){return-1!==this.props.mode.indexOf("template")||-1!==this.props.mode.indexOf("candidate")}},{key:"monsterIsInWave",value:function(e){var t=this;return e.slots.some((function(e){var a=t.props.library.find((function(e){return e.monsters.includes(t.props.monster)}));return!!a&&e.monsterGroupName===a.name&&e.monsterName===t.props.monster.name}))}},{key:"getHP",value:function(){var e=this.props.monster;if(void 0!==e.hpCurrent){var t,a,n=(null!==(t=e.hpCurrent)&&void 0!==t?t:0).toString();return(null!==(a=e.hpTemp)&&void 0!==a?a:0)>0&&(n+="+"+e.hpTemp),n}return y.getTypicalHP(this.props.monster)+" ("+y.getTypicalHPString(this.props.monster)+")"}},{key:"statSection",value:function(e,t){return t?r.a.createElement("div",{className:"section"},r.a.createElement("b",null,e)," ",t):null}},{key:"getTags",value:function(){var e=[],t=this.props.monster.size,a=this.props.monster;a&&(t=a.displaySize||t);var n=(t+" "+this.props.monster.category).toLowerCase();return this.props.monster.tag&&(n+=" ("+this.props.monster.tag.toLowerCase()+")"),e.push(r.a.createElement(z.a,{key:"tag-main"},n)),this.props.monster.alignment&&e.push(r.a.createElement(z.a,{key:"tag-align"},this.props.monster.alignment.toLowerCase())),e.push(r.a.createElement(z.a,{key:"tag-cr"},"cr ",E.challenge(this.props.monster.challenge))),e}},{key:"getButtons",value:function(){var e=this,t=[];if(-1!==this.props.mode.indexOf("editable")){t.push(r.a.createElement("button",{key:"view",onClick:function(){return e.props.viewMonster(e.props.monster)}},"view monster")),t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editMonster(e.props.monster)}},"edit monster")),t.push(r.a.createElement(W,{key:"clone",text:"clone monster"},r.a.createElement(X,{text:this.state.cloneName,placeholder:"monster name",onChange:function(t){return e.setCloneName(t)}}),r.a.createElement("button",{onClick:function(){return e.props.cloneMonster(e.props.monster,e.state.cloneName)}},"create copy")));var a=[];this.props.library.forEach((function(t){-1===t.monsters.indexOf(e.props.monster)&&a.push({id:t.id,text:t.name})})),t.push(r.a.createElement(R,{key:"move",options:a,placeholder:"move to group...",select:function(t){return e.props.moveToGroup(e.props.monster,t)}})),t.push(r.a.createElement(j,{key:"remove",text:"delete monster",callback:function(){return e.props.removeMonster(e.props.monster)}}))}if(-1!==this.props.mode.indexOf("encounter"))if(this.props.slot){var n=[];if(this.props.library.forEach((function(t){t.monsters.filter((function(t){return t.challenge===e.props.monster.challenge})).filter((function(t){return t.id!==e.props.monster.id})).forEach((function(e){return n.push({id:e.id,text:e.name,group:t.name})}))})),E.sort(n,[{field:"text",dir:"asc"}]),n.length>0&&t.push(r.a.createElement(R,{key:"replace",placeholder:"replace with...",options:n,select:function(t){var a=n.find((function(e){return e.id===t}));a&&e.props.swapEncounterSlot(e.props.slot,a.group,a.text)}})),this.props.encounter.waves.length>0){var s=this.props.encounter.slots,i=[];this.props.encounter.slots.includes(this.props.slot)||i.push({id:"",text:"main encounter"}),this.props.encounter.waves.forEach((function(t){t.slots.includes(e.props.slot)?s=t.slots:i.push({id:t.id,text:t.name})})),t.push(r.a.createElement(R,{key:"move",placeholder:"move to...",options:i,select:function(t){return e.props.moveToWave(e.props.slot,s,t)}}))}t.push(r.a.createElement("button",{key:"remove",onClick:function(){return e.props.removeEncounterSlot(e.props.slot)}},"remove"))}else this.monsterIsInWave(this.props.encounter)||t.push(r.a.createElement("button",{key:"add encounter",onClick:function(){return e.props.addEncounterSlot(e.props.monster,null)}},"add to encounter")),this.props.encounter.waves.forEach((function(a){e.monsterIsInWave(a)||t.push(r.a.createElement("button",{key:"add "+a.id,onClick:function(){return e.props.addEncounterSlot(e.props.monster,a.id)}},"add to ",a.name))}));return t}},{key:"getStats",value:function(){var e=this,t=null;if(-1===this.props.mode.indexOf("template")){var a=null;this.props.slot&&(a=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement(J,{source:this.props.slot,name:"count",label:"count",nudgeValue:function(t){return e.props.nudgeValue(e.props.slot,"count",t)}})));var n=null;-1===this.props.mode.indexOf("full")&&-1===this.props.mode.indexOf("combat")||(n=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(K,{combatant:this.props.monster})),this.statSection("ac",this.props.monster.ac.toString()),this.statSection("hp",this.getHP()),this.statSection("saving throws",this.props.monster.savingThrows),this.statSection("skills",this.props.monster.skills),this.statSection("speed",this.props.monster.speed),this.statSection("senses",this.props.monster.senses),this.statSection("damage resistances",this.props.monster.damage.resist),this.statSection("damage vulnerabilities",this.props.monster.damage.vulnerable),this.statSection("damage immunities",this.props.monster.damage.immune),this.statSection("condition immunities",this.props.monster.conditionImmunities),this.statSection("languages",this.props.monster.languages),this.statSection("equipment",this.props.monster.equipment),r.a.createElement("div",{className:"divider"}),r.a.createElement(se,{combatant:this.props.monster,mode:-1!==this.props.mode.indexOf("combat")?"combat":"view",useTrait:function(t){return e.props.useTrait(t)},rechargeTrait:function(t){return e.props.rechargeTrait(t)}}))),t=r.a.createElement("div",{className:"stats"},r.a.createElement(Q,{source:this.props.monster}),r.a.createElement("div",{className:"section centered"},this.getTags()),a,n)}else-1!==this.props.mode.indexOf("overview")&&(t=r.a.createElement("div",{className:"stats"},r.a.createElement(Q,{source:this.props.monster}),r.a.createElement("div",{className:"section centered"},this.getTags()),r.a.createElement("div",{className:"divider"}),this.statSection("speed",this.props.monster.speed),this.statSection("senses",this.props.monster.senses),this.statSection("languages",this.props.monster.languages),this.statSection("equipment",this.props.monster.equipment))),-1!==this.props.mode.indexOf("abilities")&&(t=r.a.createElement("div",{className:"stats"},r.a.createElement("div",{className:"section"},r.a.createElement(K,{combatant:this.props.monster})),this.statSection("saving throws",this.props.monster.savingThrows),this.statSection("skills",this.props.monster.skills))),-1!==this.props.mode.indexOf("cbt-stats")&&(t=r.a.createElement("div",{className:"stats"},this.statSection("ac",this.props.monster.ac.toString()),this.statSection("hp",this.getHP()),this.statSection("damage resistances",this.props.monster.damage.resist),this.statSection("damage vulnerabilities",this.props.monster.damage.vulnerable),this.statSection("damage immunities",this.props.monster.damage.immune),this.statSection("condition immunities",this.props.monster.conditionImmunities))),-1!==this.props.mode.indexOf("actions")&&(t=r.a.createElement(se,{combatant:this.props.monster,mode:"template",copyTrait:function(t){return e.props.copyTrait(t)}}));return t}},{key:"getIcon",value:function(){var e=this;return this.canSelect()?-1!==this.props.mode.indexOf("selected")?r.a.createElement(A.a,{onClick:function(){return e.props.deselectMonster(e.props.monster)}}):r.a.createElement(P.a,{onClick:function(){return e.props.selectMonster(e.props.monster)}}):null}},{key:"render",value:function(){try{var e=this.getButtons();if(0===e.length&&-1!==this.props.mode.indexOf("encounter"))return r.a.createElement(oe,{heading:r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.monster.name))},r.a.createElement("div",{className:"section"},r.a.createElement("i",null,"this monster is already part of this encounter")));var t=(this.props.monster?this.props.monster.displayName:null)||this.props.monster.name||"unnamed monster";return r.a.createElement("div",{className:"card monster"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},t),this.getIcon()),r.a.createElement("div",{className:"card-content"},this.getStats(),r.a.createElement("div",{style:{display:e.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},e))))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ce.defaultProps={mode:"full",library:null,nudgeValue:null,viewMonster:null,editMonster:null,removeMonster:null,cloneMonster:null,moveToGroup:null,copyTrait:null,selectMonster:null,deselectMonster:null,encounter:null,slot:null,addEncounterSlot:null,removeEncounterSlot:null,swapEncounterSlot:null,moveToWave:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,changeHP:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null,toggleTag:null,toggleCondition:null,useTrait:null,rechargeTrait:null};var le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=this.props.itemsPerRow?this.props.itemsPerRow:this.props.options.length,a=Math.ceil(this.props.options.length/t),n=[],s=0;s!==a;++s)n.push([]);this.props.options.forEach((function(a){var s=e.props.options.indexOf(a),i=Math.floor(s/t);n[i].push(r.a.createElement(ue,{key:a.id,option:a,selected:a.id===e.props.selectedID,count:t,select:function(t){return e.props.select(t)}}))}));var i=n.map((function(e){var t=n.indexOf(e);return r.a.createElement("div",{key:t,className:"selector-row"},e)}));return r.a.createElement("div",{className:this.props.disabled?"selector disabled":"selector"},i)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);le.defaultProps={disabled:!1,itemsPerRow:null};var ue=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="option";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),r.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={selectedPartyID:e.party?e.party.id:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectParty",value:function(e){this.setState({selectedPartyID:e})}},{key:"render",value:function(){var e=this;try{var t,a,n=O.getMonsterCount(this.props.encounter),s=O.getEncounterXP(this.props.encounter,this.props.getMonster),i=O.getAdjustedEncounterXP(this.props.encounter,this.props.getMonster),o=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"xp for this encounter"),r.a.createElement(p.a,{span:8,className:"statistic-value"},s," xp"))),r.a.createElement("div",{className:"section",style:{display:i===s?"none":""}},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"effective xp for ",n," monster(s)"),r.a.createElement(p.a,{span:8,className:"statistic-value"},i," xp")))),c=this.props.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(c){var l=0,u=0,m=0,h=0,f=c.pcs.filter((function(e){return e.active}));f.forEach((function(e){l+=E.pcExperience(e.level,"easy"),u+=E.pcExperience(e.level,"medium"),m+=E.pcExperience(e.level,"hard"),h+=E.pcExperience(e.level,"deadly")}));var v="trivial",g="trivial";if(i>0&&(i>=l&&(v="easy",g="easy"),i>=u&&(v="medium",g="medium"),i>=m&&(v="hard",g="hard"),i>=h&&(v="deadly",g="deadly"),h>0&&i>=10*h&&(v="tpk",g="tpk"),h>0&&i>=100*h&&(v="dm with a grudge",g="dm with a grudge"),h>0&&i>=1e3*h&&(v="now you're just being silly",g="now you're just being silly"),f.length<3||f.length>5)){var b=f.length<3;switch(v){case"trivial":g=b?"easy":"trivial";break;case"easy":g=b?"medium":"trivial";break;case"medium":g=b?"hard":"easy";break;case"hard":g=b?"deadly":"medium";break;case"deadly":g=b?"deadly":"hard";break;default:g=""}}t=r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell four easy"},r.a.createElement("b",null,"easy")),r.a.createElement("div",{className:"cell four medium"},r.a.createElement("b",null,"medium")),r.a.createElement("div",{className:"cell four hard"},r.a.createElement("b",null,"hard")),r.a.createElement("div",{className:"cell four deadly"},r.a.createElement("b",null,"deadly"))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell four"},l," xp"),r.a.createElement("div",{className:"cell four"},u," xp"),r.a.createElement("div",{className:"cell four"},m," xp"),r.a.createElement("div",{className:"cell four"},h," xp")));var y=function(e){return 100*e/Math.max(i,1.2*h)},k=function(e){return 100-y(e)};a=r.a.createElement("div",null,r.a.createElement("div",{className:"difficulty-gauge"},r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar trivial",style:{left:"0",right:k(l)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar easy",style:{left:y(l)+"%",right:k(u)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar medium",style:{left:y(u)+"%",right:k(m)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar hard",style:{left:y(m)+"%",right:k(h)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar deadly",style:{left:y(h)+"%",right:"0"}})),r.a.createElement("div",{className:"encounter-container"},r.a.createElement("div",{className:"encounter",style:{left:y(i)-.5+"%"}}))),o,r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"difficulty for this party"),r.a.createElement(p.a,{span:8,className:"statistic-value"},v))),r.a.createElement("div",{className:"section",style:{display:g===v?"none":""}},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"effective difficulty for ",f.length," pc(s)"),r.a.createElement(p.a,{span:8,className:"statistic-value"},g))))}else a=o;var N=null;if(!this.props.party){var w=[];if(this.props.parties)for(var x=0;x!==this.props.parties.length;++x){var C=this.props.parties[x];w.push({id:C.id,text:C.name})}N=r.a.createElement(R,{options:w,placeholder:"select party...",selectedID:this.state.selectedPartyID?this.state.selectedPartyID:void 0,select:function(t){return e.selectParty(t)},clear:function(){return e.selectParty(null)}})}return N?r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"subheading"},"difficulty"),N,t,a):r.a.createElement("div",null,t,a)}catch(S){return console.error(S),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);me.defaultProps={party:null};var de=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=["all sizes"].concat(v).map((function(e){return{id:e,text:e}})),a=["all types"].concat(g).map((function(e){return{id:e,text:e}})),n=a.find((function(e){return"aberration"===e.id}));n&&(n.text="aberr.");var s=a.find((function(e){return"celestial"===e.id}));s&&(s.text="celest.");var i=a.find((function(e){return"construct"===e.id}));i&&(i.text="const.");var o=a.find((function(e){return"elemental"===e.id}));o&&(o.text="elem.");var c=a.find((function(e){return"humanoid"===e.id}));c&&(c.text="human.");var l=a.find((function(e){return"monstrosity"===e.id}));return l&&(l.text="monst."),r.a.createElement("div",{style:{marginTop:"-5px"}},r.a.createElement(X,{text:this.props.filter.name,placeholder:"name",onChange:function(t){return e.props.changeValue("name",t)}}),r.a.createElement(W,{text:"showing "+O.getFilterDescription(this.props.filter)},r.a.createElement(V.a,{range:!0,min:0,max:35,value:[this.props.filter.challengeMin,this.props.filter.challengeMax],onChange:function(t){return e.props.changeValue("challenge",t)}}),r.a.createElement(R,{options:t,placeholder:"filter by size...",selectedID:this.props.filter.size,select:function(t){return e.props.changeValue("size",t)}}),r.a.createElement(le,{options:a,selectedID:this.props.filter.category,itemsPerRow:3,select:function(t){return e.props.changeValue("category",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.resetFilter()}},"clear filter"))))}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),pe=a(265),he=a(264),fe=a(263),ve=a(129),ge=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=this.props.combatant.hpCurrent||0,t=this.props.combatant.hpMax||0,a=this.props.combatant.hpTemp||0,n=t/2,s=100*Math.max(e,0)/(t+a),i="";i=e>=t?"bar unhurt":e<=n?"bar bloodied":"bar injured";var o=null;if(null!==this.props.combatant.hpTemp&&this.props.combatant.hpTemp>0){var c=100*Math.max(this.props.combatant.hpTemp,0)/(t+a);o=r.a.createElement("div",{className:"bar temp",style:{width:c+"%"}})}return r.a.createElement("div",{className:"hp-gauge"},r.a.createElement("div",{className:i,style:{width:s+"%"}}),o)}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),be=new ae.a.Converter;be.setOption("tables",!0);var ye=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getMapDimensions",value:function(e){var t=this,a=null;if(this.props.map.items.filter((function(e){return"edit"!==t.props.mode||"tile"===e.type})).forEach((function(e){a?(a.minX=Math.min(a.minX,e.x),a.maxX=Math.max(a.maxX,e.x+e.width-1),a.minY=Math.min(a.minY,e.y),a.maxY=Math.max(a.maxY,e.y+e.height-1)):a={minX:e.x,maxX:e.x+e.width-1,minY:e.y,maxY:e.y+e.height-1}})),this.props.combatants&&this.props.combatants.filter((function(e){return e.aura.radius>0})).forEach((function(e){var n=t.props.map.items.find((function(t){return t.id===e.id}));if(n){var r=e.aura.radius/5,s=1,i=e;i&&(s=E.miniSize(i.size));var o=n.x-r,c=n.x+(s-1)+r,l=n.y-r,u=n.y+(s-1)+r;a&&(a.minX=Math.min(a.minX,o),a.maxX=Math.max(a.maxX,c),a.minY=Math.min(a.minY,l),a.maxY=Math.max(a.maxY,u))}})),!a){if("thumbnail"===this.props.mode)return null;a={minX:0,maxX:0,minY:0,maxY:0}}return a.minX-=e,a.maxX+=e,a.minY-=e,a.maxY+=e,a}},{key:"getStyle",value:function(e,t,a,n,r,s){var i=0,o=0;a<1&&(i=(1-a)/2),n<1&&(o=(1-n)/2);var c="0";switch(r){case"rounded":c=this.props.size+"px";break;case"circle":c="50%"}return{left:"calc("+this.props.size+"px * "+(e+i-s.minX)+")",top:"calc("+this.props.size+"px * "+(t+o-s.minY)+")",width:"calc(("+this.props.size+"px * "+a+") + 1px)",height:"calc(("+this.props.size+"px * "+n+") + 1px)",borderRadius:c,backgroundSize:this.props.size+"px"}}},{key:"render",value:function(){var e=this;try{var t="edit"===this.props.mode?4:0,a=this.getMapDimensions(t);if(!a)return r.a.createElement("div",{className:"section centered"},"(blank map)");var n=[];n=n.concat(this.props.map.items),this.props.floatingItem&&n.push(this.props.floatingItem);var s=n.filter((function(e){return"tile"===e.type})).map((function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,t.style,a);return r.a.createElement(ke,{key:t.id,tile:t,note:"combat-player"!==e.props.mode?C.getNote(e.props.map,t):null,style:n,selectable:"edit"===e.props.mode,selected:e.props.selectedItemIDs.includes(t.id),select:function(t,a){return"edit"===e.props.mode?e.props.itemSelected(t,a):null}})})),i=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(i=n.filter((function(e){return"overlay"===e.type})).map((function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,t.style,a);return n.backgroundColor=t.color+t.opacity.toString(16),r.a.createElement(Ne,{key:t.id,overlay:t,note:"combat-player"!==e.props.mode?C.getNote(e.props.map,t):null,style:n,selected:e.props.selectedItemIDs.includes(t.id),select:function(t,a){return e.props.itemSelected(t,a)}})})));var o=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(o=this.props.combatants.filter((function(e){return e.aura.radius>0})).filter((function(t){return t.showOnMap||"combat-player"!==e.props.mode})).map((function(t){var s=n.find((function(e){return e.id===t.id}));if(s){var i=t.aura.radius/5,o=2*i+E.miniSize(t.displaySize),c=e.getStyle(s.x-i,s.y-i,o,o,t.aura.style,a);return c.backgroundColor=t.aura.color,r.a.createElement("div",{key:t.id+" aura",className:"aura",style:c})}return null})).filter((function(e){return null!==e})));var c=[];"edit"!==this.props.mode&&(c=n.filter((function(e){return"monster"===e.type||"pc"===e.type||"companion"===e.type||"token"===e.type})).map((function(t){var n=E.miniSize(t.size),s=C.getNote(e.props.map,t),i=!1,o=e.props.combatants.find((function(e){return e.id===t.id}));o&&(n=E.miniSize(o.displaySize),!s&&o.note&&((s=k.createMapNote()).targetID=o.id,s.text=o.note),i="pc"===o.type);var c=e.getStyle(t.x,t.y,n,n,"circle",a);return r.a.createElement(we,{key:t.id,token:t,note:"combat-player"!==e.props.mode?s:null,combatant:o||null,style:c,simple:"thumbnail"===e.props.mode,showGauge:"combat"===e.props.mode,showHidden:"combat"===e.props.mode||i,selectable:"combat"===e.props.mode||"combat-player"===e.props.mode,selected:e.props.selectedItemIDs.includes(t.id),select:function(t,a){return e.props.itemSelected(t,a)}})})).filter((function(e){return null!==e})));var l=[];if(this.props.showOverlay)for(var u=a.minY;u!==a.maxY+1;++u)for(var m=a.minX;m!==a.maxX+1;++m){var d=this.getStyle(m,u,1,1,"square",a);l.push(r.a.createElement(Ee,{key:m+","+u,x:m,y:u,style:d,overlay:!0,onMouseEnter:function(t,a){return e.props.gridSquareEntered(t,a)},onClick:function(t,a){return e.props.gridSquareClicked(t,a)}}))}var p="map-panel "+this.props.mode,h=1+a.maxX-a.minX,f=1+a.maxY-a.minY;return r.a.createElement("div",{className:p,onClick:function(){return e.props.itemSelected(null,!1)}},r.a.createElement("div",{className:"grid",style:{width:this.props.size*h+2+"px",height:this.props.size*f+2+"px"}},s,i,o,c,l))}catch(v){return console.error(v),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ye.defaultProps={floatingItem:null,combatants:null,showOverlay:!1,selectedItemIDs:[],itemSelected:null,gridSquareEntered:null,gridSquareClicked:null};var Ee=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"mouseEnter",value:function(e){e.stopPropagation(),this.props.onMouseEnter(this.props.x,this.props.y)}},{key:"click",value:function(e,t){e.stopPropagation(),"single"===t&&this.props.onClick&&this.props.onClick(this.props.x,this.props.y),"double"===t&&this.props.onDoubleClick&&this.props.onDoubleClick(this.props.x,this.props.y)}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.props.overlay?"grid-square grid-overlay":"grid-square",style:this.props.style,onMouseEnter:function(t){return e.mouseEnter(t)},onClick:function(t){return e.click(t,"single")},onDoubleClick:function(t){return e.click(t,"double")}})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Ee.defaultProps={overlay:!1,onDoubleClick:null};var ke=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.tile.id,e.ctrlKey))}},{key:"getNoteText",value:function(){return this.props.note?this.props.note.text.trim():""}},{key:"render",value:function(){var e=this;try{var t="tile "+this.props.tile.terrain;this.props.selected&&(t+=" selected");var a=null;if("custom"===this.props.tile.terrain){var n=Z.a,s=localStorage.getItem("image-"+this.props.tile.customBackground);if(s)n=JSON.parse(s).data;a=r.a.createElement("img",{className:"custom-image",alt:"map tile",src:n})}var i=null;if(this.props.tile.content)switch(this.props.tile.content.type){case"doorway":switch(this.props.tile.content.style){case"single":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}))}break;case"double":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"25%",x2:"50%",y2:"75%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}),r.a.createElement("line",{className:"thin",x1:"25%",y1:"50%",x2:"75%",y2:"50%"}))}break;case"arch":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"20%",y2:"50%"}),r.a.createElement("line",{className:"thick",x1:"80%",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"20%",y2:"80%"}),r.a.createElement("line",{className:"medium",x1:"80%",y1:"20%",x2:"80%",y2:"80%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"20%"}),r.a.createElement("line",{className:"thick",x1:"50%",y1:"80%",x2:"50%",y2:"100%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"80%",y2:"20%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"80%",x2:"80%",y2:"80%"}))}break;case"bars":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"10%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"30%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"70%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"90%",cy:"50%",r:"5%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"10%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"30%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"70%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"90%",r:"5%"}))}}break;case"stairway":switch(this.props.tile.content.style){case"stairs":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thin",x1:"0",y1:"12.5%",x2:"100%",y2:"12.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"25%",x2:"100%",y2:"25%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"37.5%",x2:"100%",y2:"37.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"62.5%",x2:"100%",y2:"62.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"75%",x2:"100%",y2:"75%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"87.5%",x2:"100%",y2:"87.5%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thin",x1:"12.5%",y1:"0",x2:"12.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"25%",y1:"0",x2:"25%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"37.5%",y1:"0",x2:"37.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"62.5%",y1:"0",x2:"62.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"75%",y1:"0",x2:"75%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"87.5%",y1:"0",x2:"87.5%",y2:"100%"}))}break;case"spiral":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("ellipse",{className:"thin outline",cx:"50%",cy:"50%",rx:"40%",ry:"40%"}),r.a.createElement("ellipse",{className:"thin filled",cx:"50%",cy:"50%",rx:"10%",ry:"10%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"10%",x2:"50%",y2:"90%"}),r.a.createElement("line",{className:"thin",x1:"10%",y1:"50%",x2:"90%",y2:"50%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"20%",x2:"80%",y2:"80%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"80%",x2:"80%",y2:"20%"}));break;case"ladder":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"20%",cy:"50%",r:"7%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"50%",x2:"80%",y2:"50%"}),r.a.createElement("circle",{className:"thin filled",cx:"80%",cy:"50%",r:"7%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"20%",r:"7%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"20%",x2:"50%",y2:"80%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"80%",r:"7%"}))}}}var o=r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}},a,i),c=this.getNoteText();return c?r.a.createElement(ve.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:be.makeHtml(c)}})},o):o}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ne=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){e.stopPropagation(),this.props.select(this.props.overlay.id,e.ctrlKey)}},{key:"getNoteText",value:function(){return this.props.note?this.props.note.text.trim():""}},{key:"render",value:function(){var e=this;try{var t="overlay";this.props.selected&&(t+=" selected");var a=r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}}),n=this.getNoteText();return n?r.a.createElement(ve.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:be.makeHtml(n)}})},a):a}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),we=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.token.id,e.ctrlKey))}},{key:"getNoteText",value:function(){var e=this.props.combatant?"**"+this.props.combatant.displayName+"**":"";return this.props.combatant&&(this.props.combatant.showOnMap||(e+="\n\n",e+="**hidden**"),this.props.combatant.tags.forEach((function(t){e+="\n\n",e+="**"+E.getTagTitle(t)+"**",e+="\n\n",e+="* "+E.getTagDescription(t)})),this.props.combatant.conditions.forEach((function(t){e+="\n\n",e+="**"+t.name+"**",E.conditionText(t).forEach((function(t){e+="\n\n",e+="* "+t}))}))),this.props.note&&this.props.note.text&&(e+="\n\n",e+=this.props.note.text),e.trim()}},{key:"render",value:function(){var e=this;try{var t="token",a="token";if(this.props.selected&&(a+=" selected"),this.props.combatant&&(t=this.props.combatant.displayName||"combatant",a+=" "+this.props.combatant.type,this.props.combatant.current&&(a+=" current"),!this.props.combatant.showOnMap)){if(!this.props.showHidden)return null;a+=" hidden"}var n=null,s=null,i=null,o=null;if(this.props.combatant&&!this.props.simple){var c="",l=this.props.combatant;if(l&&l.portrait){var u=localStorage.getItem("image-"+l.portrait);if(u)c=JSON.parse(u).data}if(n=c?r.a.createElement("img",{className:"portrait",src:c,alt:t}):r.a.createElement("div",{className:"initials"},t.split(" ").map((function(e){return e[0]}))),"monster"===this.props.combatant.type&&this.props.showGauge)(this.props.combatant.hpCurrent||0)<(this.props.combatant.hpMax||0)&&(s=r.a.createElement(ge,{combatant:this.props.combatant}));this.props.combatant.altitude>0&&(i=r.a.createElement("div",{className:"badge"},r.a.createElement(pe.a,{twoToneColor:"#3c78dc"}))),this.props.combatant.altitude<0&&(i=r.a.createElement("div",{className:"badge"},r.a.createElement(he.a,{twoToneColor:"#3c78dc"})));var m=0;this.props.combatant.conditions&&(m+=this.props.combatant.conditions.length),this.props.combatant.tags&&(m+=this.props.combatant.tags.filter((function(e){return!e.startsWith("engaged")})).length),m>0&&(o=r.a.createElement("div",{className:"conditions"},r.a.createElement(fe.a,{twoToneColor:"#3c78dc"})))}var d=r.a.createElement("div",{className:a,style:this.props.style,onClick:function(t){return e.select(t)}},n,s,i,o),p=this.getNoteText();return p?r.a.createElement(ve.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:be.makeHtml(p)}})},d):d}catch(h){return console.error(h),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={combatSetup:e.combatSetup},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setPartyID",value:function(e){var t=this,a=this.state.combatSetup,n=this.props.parties.find((function(t){return t.id===e}));a.party=n?JSON.parse(JSON.stringify(n)):null,this.setState({combatSetup:a},(function(){return t.props.notify()}))}},{key:"setEncounterID",value:function(e){var t=this,a=this.state.combatSetup,n=this.props.encounters.find((function(t){return t.id===e}));a.encounter=n?JSON.parse(JSON.stringify(n)):null,a.slotInfo=E.getCombatSlotData(a.encounter,this.props.library),this.setState({combatSetup:a},(function(){return t.props.notify()}))}},{key:"setMapID",value:function(e){var t=this.props.maps.find((function(t){return t.id===e})),a=this.state.combatSetup;a.map=t||null,this.setState({combatSetup:a})}},{key:"setWaveID",value:function(e){var t=this,a=this.state.combatSetup;if(a.waveID=e,a.encounter){var n=a.encounter.waves.find((function(t){return t.id===e}));n&&(a.slotInfo=E.getCombatSlotData(n,this.props.library))}this.setState({combatSetup:a},(function(){return t.props.notify()}))}},{key:"generateEncounter",value:function(e){var t=this,a=k.createEncounter();a.name="new encounter";var n=k.createMonsterFilter(),r=0,s=0;if(this.state.combatSetup.party){var i=this.state.combatSetup.party.pcs.filter((function(e){return e.active}));i.forEach((function(t){r+=E.pcExperience(t.level,e),s+=t.level}));var o=s/i.length;n.challengeMax=Math.max(o,5)}O.buildEncounter(a,r,n,this.props.library,this.props.getMonster);var c=this.state.combatSetup;c.encounter=a,c.slotInfo=E.getCombatSlotData(a,this.props.library),this.setState({combatSetup:c},(function(){return t.props.notify()}))}},{key:"generateMap",value:function(e){var t=this,a=k.createMap();a.name="new map",C.generate(e,a);var n=this.state.combatSetup;n.map=a,this.setState({combatSetup:n},(function(){return t.props.notify()}))}},{key:"changeValue",value:function(e,t,a){e[t]=a;var n=e;n.members&&("init"===t&&n.members.forEach((function(e){return e.init=a})),"hp"===t&&n.members.forEach((function(e){return e.hp=a}))),this.setState({combatSetup:this.state.combatSetup})}},{key:"nudgeCount",value:function(e,t){var a=this.state.combatSetup;if(a.encounter){var n=a.encounter.slots.find((function(t){return t.id===e}));n&&(n.count=Math.max(0,n.count+t),a.slotInfo=E.getCombatSlotData(a.encounter,this.props.library),this.setState({combatSetup:a}))}}},{key:"render",value:function(){var e=this;try{var t=null,a=null;switch(this.props.type){case"start":t=r.a.createElement("div",null,r.a.createElement(Ce,{combatSetup:this.state.combatSetup,parties:this.props.parties,setPartyID:function(t){return e.setPartyID(t)}}),r.a.createElement(Se,{combatSetup:this.state.combatSetup,encounters:this.props.encounters,setEncounterID:function(t){return e.setEncounterID(t)},generateEncounter:function(t){return e.generateEncounter(t)}}),r.a.createElement(Oe,{combatSetup:this.state.combatSetup,maps:this.props.maps,setMapID:function(t){return e.setMapID(t)},generateMap:function(t){return e.generateMap(t)}})),a=r.a.createElement("div",null,r.a.createElement(Ie,{combatSetup:this.state.combatSetup,parties:this.props.parties,encounters:this.props.encounters,getMonster:function(t,a){return e.props.getMonster(t,a)}}),r.a.createElement(Te,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeCount:function(t,a){return e.nudgeCount(t,a)}}));break;case"add-wave":t=r.a.createElement("div",null,r.a.createElement(Me,{combatSetup:this.state.combatSetup,setWaveID:function(t){return e.setWaveID(t)}})),a=r.a.createElement("div",null,r.a.createElement(Te,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeCount:function(t,a){return e.nudgeCount(t,a)}}));break;case"add-combatants":t=r.a.createElement("div",null,r.a.createElement(je,{combatSetup:this.state.combatSetup,library:this.props.library,addMonster:function(t){return e.props.addMonster(t)}})),a=r.a.createElement("div",null,r.a.createElement(Te,{type:this.props.type,combatSetup:this.state.combatSetup,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeCount:function(t,a){return e.nudgeCount(t,a)}}))}return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},t),r.a.createElement(p.a,{span:12,className:"scrollable"},a))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);xe.defaultProps={parties:null,encounters:null,maps:null,addMonster:null};var Ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;if(0===this.props.parties.length)return r.a.createElement("div",{className:"section"},"you have not defined any parties");var t=this.props.parties.map((function(e){return{id:e.id,text:e.name||"unnamed party"}})),a=null;if(this.props.combatSetup.party){var n=this.props.combatSetup.party.pcs.filter((function(e){return e.active})).map((function(e){return r.a.createElement("div",{key:e.id,className:"group-panel"},e.name||"unnamed pc"," (level ",e.level,")")}));0===n.length&&n.push(r.a.createElement(ne,{key:"empty"},"no pcs")),a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"pcs"),n)}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"party"),r.a.createElement(R,{options:t,placeholder:"select a party",selectedID:this.props.combatSetup.party?this.props.combatSetup.party.id:void 0,select:function(t){return e.props.setPartyID(t)},clear:function(){return e.props.setPartyID(null)}}),a)}}]),t}(r.a.Component),Se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=null;if(this.props.combatSetup.encounter)t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.setEncounterID(null)}},"choose a different encounter"));else{var a=null;if(this.props.encounters.length>0){var n=this.props.encounters.map((function(e){return{id:e.id,text:e.name||"unnamed encounter"}}));a=r.a.createElement(R,{options:n,placeholder:"select an encounter",select:function(t){return e.props.setEncounterID(t)}})}var s=null;this.props.combatSetup.party&&(s=r.a.createElement("button",{onClick:function(){return e.props.generateEncounter("medium")}},"generate a random encounter")),t=r.a.createElement("div",null,a,s)}var i=null;if(this.props.combatSetup.encounter){var o=this.props.combatSetup.encounter.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("div",{key:e.id,className:"group-panel"},t)}));0===o.length&&o.push(r.a.createElement(ne,{key:"empty"},"no monsters"));var c=this.props.combatSetup.encounter.waves.map((function(e){if(0===e.slots.length)return null;var t=e.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" x"+e.count),r.a.createElement("div",{key:e.id,className:"group-panel"},t)}));return r.a.createElement("div",{key:e.id},r.a.createElement("div",{className:"subheading"},e.name||"unnamed wave"),t)}));i=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),o,c)}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter"),t,i)}}]),t}(r.a.Component),Oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=null;if(this.props.combatSetup.map)t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.setMapID(null)}},"choose a different map"));else{var a=null;if(this.props.maps.length>0){var n=this.props.maps.map((function(e){return{id:e.id,text:e.name||"unnamed map"}}));a=r.a.createElement(R,{options:n,placeholder:"select a map",select:function(t){return e.props.setMapID(t)}})}t=r.a.createElement("div",null,a,r.a.createElement("button",{onClick:function(){return e.props.generateMap("delve")}},"generate a random delve"))}var s=null;return this.props.combatSetup.map&&(s=r.a.createElement(ye,{map:this.props.combatSetup.map,mode:"thumbnail",size:12})),r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"map"),t,s)}}]),t}(r.a.Component),Me=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;if(null===this.props.combatSetup.encounter)return r.a.createElement("div",{className:"section"},"you have not selected an encounter");if(0===this.props.combatSetup.encounter.waves.length)return r.a.createElement("div",{className:"section"},"you have not defined any waves");var t=this.props.combatSetup.encounter.waves.map((function(e){return{id:e.id,text:e.name||"unnamed wave"}})),a=null;if(this.props.combatSetup.waveID){var n=this.props.combatSetup.encounter.waves.find((function(t){return t.id===e.props.combatSetup.waveID}));if(n){var s=n.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("div",{key:e.id,className:"group-panel"},t)}));0===s.length&&s.push(r.a.createElement(ne,{key:"empty"},"no monsters")),a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),s)}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"wave"),r.a.createElement(R,{options:t,placeholder:"select wave",selectedID:this.props.combatSetup.waveID?this.props.combatSetup.waveID:void 0,select:function(t){return e.props.setWaveID(t)},clear:function(){return e.props.setWaveID(null)}}),a)}}]),t}(r.a.Component),je=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={filter:k.createMonsterFilter()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"changeFilterValue",value:function(e,t){var a=this.state.filter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({filter:a})}},{key:"resetFilter",value:function(){this.setState({filter:k.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return O.matchMonster(e,this.state.filter)}},{key:"render",value:function(){var e=this,t=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){e.matchMonster(a)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var a=this.props.combatSetup.slotInfo.map((function(e){return e.id})),n=t.filter((function(e){return!a.includes(e.id)})).map((function(t){return r.a.createElement(ce,{key:t.id,monster:t,mode:"candidate",selectMonster:function(t){return e.props.addMonster(t)}})}));return 0===n.length&&(n=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"there are no monsters that match the above criteria (or you have already selected them all)"))),r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement(de,{filter:this.state.filter,changeValue:function(t,a){return e.changeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),n)}}]),t}(r.a.Component),Ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return this.props.combatSetup.party&&this.props.combatSetup.encounter?r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement(me,{parties:this.props.parties,party:this.props.combatSetup.party,encounter:this.props.combatSetup.encounter,getMonster:function(t,a){return e.props.getMonster(t,a)}})):r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement("div",{className:"section"},"select a party and an encounter on the left to see difficulty information."))}}]),t}(r.a.Component),Te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"init"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e,t=this;if("start"===this.props.type&&!this.props.combatSetup.encounter)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select an encounter to see monster information here."));if("add-wave"===this.props.type&&!this.props.combatSetup.waveID)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select a wave to see monster information here."));if("add-combatants"===this.props.type&&0===(null===(e=this.props.combatSetup.encounter)||void 0===e?void 0:e.slots.length))return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"add monsters to see their information here."));if(this.props.combatSetup.encounter){var a=this.props.combatSetup.encounter;if(this.props.combatSetup.waveID){var n=this.props.combatSetup.encounter.waves.find((function(e){return e.id===t.props.combatSetup.waveID}));n&&(a=n)}if(0===a.slots.length)return null;var s=["init","hit points","names","count"].map((function(e){return{id:e,text:e}})),i=this.props.combatSetup.slotInfo.map((function(e){var n=a.slots.find((function(t){return t.id===e.id}));if(!n)return null;var s=t.props.getMonster(n.monsterName,n.monsterGroupName);return s?r.a.createElement(De,{key:e.id,slotInfo:e,encounterSlot:n,monster:s,view:t.state.view,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeCount:function(e,a){return t.props.nudgeCount(e,a)}}):null}));return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement(le,{options:s,selectedID:this.state.view,select:function(e){return t.setView(e)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",null,i))}return null}}]),t}(r.a.Component),De=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"rollInit",value:function(e){var t=E.dieRoll(),a=E.modifierValue(this.props.monster.abilityScores.dex);this.props.changeValue(null!==e&&void 0!==e?e:this.props.slotInfo,"init",t+a)}},{key:"rollHP",value:function(e){var t=E.hitDieType(this.props.monster.size),a=E.dieRoll(t,this.props.monster.hitDice),n=E.modifierValue(this.props.monster.abilityScores.con)*this.props.monster.hitDice;this.props.changeValue(null!==e&&void 0!==e?e:this.props.slotInfo,"hp",a+n)}},{key:"getValueSection",value:function(e,t,a,n,s){var i=this;return r.a.createElement(d.a,{align:"middle"},r.a.createElement(p.a,{span:20},r.a.createElement(V.a,{min:e,max:t,value:a[n],onChange:function(e){return i.props.changeValue(a,n,e)}})),r.a.createElement(p.a,{span:4},r.a.createElement("div",{className:"combatant-value"},a[n],r.a.createElement(D.a,{onClick:function(){return s()}}))))}},{key:"getInitSection",value:function(){var e=this,t=null;this.props.encounterSlot.count>1&&(t=r.a.createElement(M,{label:"roll initiative once for this group",checked:this.props.slotInfo.useGroupInit,changeValue:function(t){return e.props.changeValue(e.props.slotInfo,"useGroupInit",t)}}));var a=E.modifierValue(this.props.monster.abilityScores.dex),n=1+a,s=20+a,i=[];return this.props.slotInfo.useGroupInit?i.push(r.a.createElement("div",{key:"init"},this.getValueSection(n,s,this.props.slotInfo,"init",(function(){return e.rollInit(null)})))):this.props.slotInfo.members.forEach((function(t){i.push(r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"combatant-name"},t.name),e.getValueSection(n,s,t,"init",(function(){return e.rollInit(t)}))))})),r.a.createElement("div",null,t,i)}},{key:"getHPSection",value:function(){var e=this,t=null;this.props.encounterSlot.count>1&&(t=r.a.createElement(M,{label:"roll hit points once for this group",checked:this.props.slotInfo.useGroupHP,changeValue:function(t){return e.props.changeValue(e.props.slotInfo,"useGroupHP",t)}}));var a=y.getTypicalHP(this.props.monster),n=E.modifierValue(this.props.monster.abilityScores.con)*this.props.monster.hitDice,s=this.props.monster.hitDice+n,i=this.props.monster.hitDice*E.hitDieType(this.props.monster.size)+n,o=[];return this.props.slotInfo.useGroupHP?o.push(r.a.createElement("div",{key:"hp"},this.getValueSection(s,i,this.props.slotInfo,"hp",(function(){return e.rollHP(null)})),r.a.createElement("button",{className:this.props.slotInfo.hp!==a?"":"disabled",onClick:function(){return e.props.changeValue(e.props.slotInfo,"hp",a)}},"reset to average hp"))):this.props.slotInfo.members.forEach((function(t){o.push(r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"combatant-name"},t.name),e.getValueSection(s,i,t,"hp",(function(){return e.rollHP(t)})),r.a.createElement("button",{className:t.hp!==a?"":"disabled",onClick:function(){return e.props.changeValue(t,"hp",a)}},"reset to average hp")))})),r.a.createElement("div",null,t,o)}},{key:"getNameSection",value:function(){var e=this;return this.props.slotInfo.members.map((function(t){return r.a.createElement(X,{key:t.id,text:t.name,onChange:function(a){return e.props.changeValue(t,"name",a)}})}))}},{key:"getCountSection",value:function(){var e=this;return r.a.createElement(J,{source:this.props.encounterSlot,name:"count",nudgeValue:function(t){return e.props.nudgeCount(e.props.encounterSlot.id,t)}})}},{key:"render",value:function(){var e=this.props.encounterSlot.monsterName,t=null;switch(this.props.view){case"init":e+=" (1d20 "+E.modifier(this.props.monster.abilityScores.dex)+")",t=this.getInitSection();break;case"hit points":e+=" ("+y.getTypicalHPString(this.props.monster)+")",t=this.getHPSection();break;case"names":t=this.getNameSection();break;case"count":t=this.getCountSection()}return r.a.createElement("div",{className:"group-panel combatant-setup"},r.a.createElement("div",{className:"subheading"},e),r.a.createElement("div",{className:"divider"}),t)}}]),t}(r.a.Component),Ve=["blinded","charmed","deafened","exhaustion","frightened","grappled","incapacitated","invisible","paralyzed","petrified","poisoned","prone","restrained","stunned","unconscious"],Ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.items.map((function(t){return r.a.createElement(Pe,{key:t.id,item:t,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.select(t)}})}));return r.a.createElement("div",{className:"radio-group"},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Ae.defaultProps={};var Pe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="radio-item",a=null;return this.props.selected&&(t+=" selected",this.props.item.details&&(a=r.a.createElement("div",{className:"radio-item-details"},this.props.item.details))),this.props.item.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,onClick:function(){return e.props.select(e.props.item.id)}},r.a.createElement("div",{className:"radio-item-text"},this.props.item.text),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ze=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={condition:e.condition},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCondition",value:function(e){if(this.state.condition.name!==e){var t=this.state.condition;t.name=e,t.level=1,t.text="",this.setState({condition:t})}}},{key:"setDuration",value:function(e){var t=null;switch(e){case"saves":t=k.createConditionDurationSaves();break;case"combatant":t=k.createConditionDurationCombatant();break;case"rounds":t=k.createConditionDurationRounds()}var a=this.state.condition;a.duration=t,this.setState({condition:a})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({condition:this.state.condition})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t]+a;"level"===t&&(n=Math.max(n,1),n=Math.min(n,6)),"count"===t&&(n=Math.max(n,1)),"saveDC"===t&&(n=Math.max(n,0)),e[t]=n,this.setState({condition:this.state.condition})}},{key:"render",value:function(){var e=this;try{var t=Ve.map((function(t){var a=[],n=[];if(t===e.state.condition.name){"exhaustion"===t&&a.push(r.a.createElement(J,{key:"exhaustion-spin",source:e.props.condition,name:"level",label:"exhaustion",nudgeValue:function(t){return e.nudgeValue(e.props.condition,"level",t)}}));for(var s=E.conditionText(e.state.condition),i=0;i!==s.length;++i)n.push(r.a.createElement("li",{key:i,className:"section"},s[i]))}var o=e.props.combatants.filter((function(e){return"monster"===e.type})).some((function(e){return!!e&&-1!==e.conditionImmunities.indexOf(t)}));return{id:t,text:t,details:r.a.createElement("div",{key:t},a,r.a.createElement("ul",null,n)),disabled:o}})),a=["str","dex","con","int","wis","cha","death"].map((function(e){return{id:e,text:e}})),n=[{id:"start",text:"start of turn"},{id:"end",text:"end of turn"}],s=this.props.combat.combatants.map((function(e){var t=e;return{id:t.id,text:t.displayName||t.name||"unnamed monster"}})),i=[{id:"none",text:"until removed (default)",details:r.a.createElement("div",{className:"section"},r.a.createElement("div",null,"the condition persists until it is manually removed"))},{id:"saves",text:"until a successful save",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of saves required"),r.a.createElement(J,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"save dc"),r.a.createElement(J,{source:this.props.condition.duration,name:"saveDC",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"saveDC",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"type of save"),r.a.createElement(le,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.saveType:null,select:function(t){return e.changeValue(e.props.condition.duration,"saveType",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"make the save at the start or end of the turn"),r.a.createElement(le,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"combatant",text:"until someone's next turn",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"start or end of the turn"),r.a.createElement(le,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"combatant"),r.a.createElement(R,{options:s,selectedID:this.props.condition.duration&&this.props.condition.duration.combatantID||void 0,select:function(t){return e.changeValue(e.props.condition.duration,"combatantID",t)}})))},{id:"rounds",text:"for a number of rounds",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of rounds"),r.a.createElement(J,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})))}];return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"condition"),r.a.createElement(Ae,{items:t,selectedItemID:this.state.condition.name,select:function(t){return e.setCondition(t)}})),r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"duration"),r.a.createElement(Ae,{items:i,selectedItemID:this.state.condition.duration?this.state.condition.duration.type:"none",select:function(t){return e.setDuration(t)}})))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{if(0===this.props.data.length)return null;var t,a=Math.max.apply(Math,Object(f.a)(this.props.data.map((function(e){return e.value}))));if(this.props.collapse)t=this.props.data.filter((function(e){return e.value>0}));else{var n=this.props.data.find((function(e){return e.value>0}));this.props.data.reverse();var s=this.props.data.find((function(e){return e.value>0}));this.props.data.reverse();var i=n?this.props.data.indexOf(n):0,o=s?this.props.data.indexOf(s):this.props.data.length-1;t=this.props.data.slice(i,o+1)}var c=t.map((function(t){return r.a.createElement("div",{key:t.text,className:"bar-container"},r.a.createElement("div",{className:"bar",style:{width:"calc((100% - 1px) * "+t.value+" / "+a+")"}},r.a.createElement("div",{className:"label"},t.text,": ",e.props.display(t.value))))}));return r.a.createElement("div",{className:"plot"},c)}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Le.defaultProps={collapse:!1,display:function(e){return e.toString()}};var Ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={chart:"challenge"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectChart",value:function(e){this.setState({chart:e})}},{key:"render",value:function(){var e=this;try{var t=[];if(this.props.groups.forEach((function(e){return e.monsters.forEach((function(e){return t.push(e)}))})),0===t.length)return null;var a=[];switch(this.state.chart){case"challenge":a=[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].map((function(e){return{text:"cr "+E.challenge(e),value:t.filter((function(t){return t.challenge===e})).length}}));break;case"size":a=v.map((function(e){return{text:e,value:t.filter((function(t){return t.size===e})).length}}));break;case"type":a=g.map((function(e){return{text:e,value:t.filter((function(t){return t.category===e})).length}}))}return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement(le,{options:[{id:"challenge",text:"challenge rating"},{id:"size",text:"size"},{id:"type",text:"type"}],selectedID:this.state.chart,select:function(t){return e.selectChart(t)}}),r.a.createElement(Le,{data:a}))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Re=a(238),Be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showContent:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleContentVisible",value:function(){this.setState({showContent:!this.state.showContent})}},{key:"render",value:function(){var e=this;try{var t=this.props.content.filter((function(e){return!!e}));if(0===t.length)return null;var a=null;if(this.props.heading){var n=null;if(this.props.showToggle){var s=this.state.showContent?"rotate":"";n=r.a.createElement(H.a,{className:s,onClick:function(){return e.toggleContentVisible()}})}a=r.a.createElement("div",{className:"heading fixed-top"},r.a.createElement("div",{className:"title"},this.props.heading),n)}var i=null;if(this.state.showContent){var o={xs:24,sm:24,md:12,lg:8,xl:6};switch(this.props.columns){case 1:o={xs:24,sm:24,md:24,lg:24,xl:24};break;case 2:o={xs:24,sm:24,md:12,lg:12,xl:12};break;case 3:o={xs:24,sm:24,md:8,lg:8,xl:8}}i=r.a.createElement(d.a,{align:"top"},t.map((function(e){return r.a.createElement(p.a,{key:t.indexOf(e),xs:o.xs,sm:o.sm,md:o.md,lg:o.lg,xl:o.xl},e)})))}return r.a.createElement("div",{className:"grid-panel"},a,i)}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Be.defaultProps={columns:0,heading:null,showToggle:!1};var He=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={encounter:e.encounter,filter:k.createMonsterFilter(),randomEncounterXP:1e3},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setRandomEncounterXP",value:function(e){this.setState({randomEncounterXP:Math.max(0,e)})}},{key:"addWave",value:function(){var e=k.createEncounterWave();e.name="wave "+(this.state.encounter.waves.length+2),this.state.encounter.waves.push(e),this.setState({encounter:this.state.encounter})}},{key:"removeWave",value:function(e){var t=this.state.encounter.waves.indexOf(e);this.state.encounter.waves.splice(t,1),this.setState({encounter:this.state.encounter})}},{key:"buildEncounter",value:function(){var e=this,t=this.state.encounter;t.slots=[],t.waves=[],O.buildEncounter(t,this.state.randomEncounterXP,this.state.filter,this.props.library,this.props.getMonster),this.sortEncounterSlots(t),t.waves.forEach((function(t){return e.sortEncounterSlots(t)})),this.setState({encounter:t})}},{key:"clearEncounter",value:function(){var e=this.state.encounter;e.slots=[],e.waves=[],this.setState({encounter:e})}},{key:"addEncounterSlot",value:function(e,t){var a=this.props.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=k.createEncounterSlot();if(n.monsterGroupName=a.name,n.monsterName=e.name,null!==t){var r=this.state.encounter.waves.find((function(e){return e.id===t}));r&&(r.slots.push(n),this.sortEncounterSlots(r))}else this.state.encounter.slots.push(n),this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}}},{key:"sortEncounterSlots",value:function(e){var t=[];e.slots.forEach((function(e){var a=t.find((function(t){return t.monsterGroupName===e.monsterGroupName&&t.monsterName===e.monsterName}));a?a.count+=e.count:(a=e,t.push(e))})),e.slots=t,e.slots.sort((function(e,t){var a=e.monsterName.toLowerCase(),n=t.monsterName.toLowerCase();return a<n?-1:a>n?1:0}))}},{key:"removeEncounterSlot",value:function(e,t){if(t){var a=this.state.encounter.waves.find((function(e){return e.id===t}));if(a){var n=a.slots.indexOf(e);a.slots.splice(n,1)}}else{var r=this.state.encounter.slots.indexOf(e);this.state.encounter.slots.splice(r,1)}this.setState({encounter:this.state.encounter})}},{key:"swapEncounterSlot",value:function(e,t,a,n){if(e.monsterGroupName=a,e.monsterName=n,t){var r=this.state.encounter.waves.find((function(e){return e.id===t}));r&&this.sortEncounterSlots(r)}else this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}},{key:"moveToWave",value:function(e,t,a){var n=t.indexOf(e);if(t.splice(n,1),a){var r=this.state.encounter.waves.find((function(e){return e.id===a}));r&&(r.slots.push(e),this.sortEncounterSlots(r))}else this.state.encounter.slots.push(e),this.sortEncounterSlots(this.state.encounter);this.setState({encounter:this.state.encounter})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({encounter:this.state.encounter})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t];n+=a,this.changeValue(e,t,n)}},{key:"changeFilterValue",value:function(e,t){var a=this.state.filter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({filter:a})}},{key:"resetFilter",value:function(){this.setState({filter:k.createMonsterFilter()})}},{key:"getMonsterCards",value:function(e,t){var a=this,n=[];return e.forEach((function(e){var s=a.props.getMonster(e.monsterName,e.monsterGroupName);s?n.push(r.a.createElement(ce,{monster:s,slot:e,encounter:a.props.encounter,mode:"encounter",library:a.props.library,nudgeValue:function(e,t,n){return a.nudgeValue(e,t,n)},removeEncounterSlot:function(e){return a.removeEncounterSlot(e,t)},swapEncounterSlot:function(e,n,r){return a.swapEncounterSlot(e,t,n,r)},moveToWave:function(e,t,n){return a.moveToWave(e,t,n)}})):n.push(r.a.createElement("div",{className:"card error"},r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"subheading"},"unknown monster"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"could not find a monster called '",r.a.createElement("b",null,e.monsterName),"' in a group called '",r.a.createElement("b",null,e.monsterGroupName,"'")),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return a.removeEncounterSlot(e,t)}},"remove"))))})),0===e.length&&(t?n.push(r.a.createElement(ne,null,"there are no monsters in this wave")):n.push(r.a.createElement(ne,null,r.a.createElement("p",null,"there are no monsters in this encounter"),r.a.createElement("p",null,"you can add monsters from the list below, or try 'build a random encounter'")))),n}},{key:"getLibrarySection",value:function(){var e=this,t=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){O.matchMonster(a,e.state.filter)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var a=t.map((function(t){return r.a.createElement(ce,{key:t.id,monster:t,encounter:e.props.encounter,library:e.props.library,mode:"encounter",addEncounterSlot:function(t,a){return e.addEncounterSlot(t,a)}})}));return 0===a.length&&a.push(r.a.createElement(ne,null,r.a.createElement("p",null,"there are no monsters that meet the criteria ",r.a.createElement("i",null,O.getFilterDescription(this.state.filter))))),r.a.createElement(Be,{heading:"monster library",content:a,columns:3,showToggle:!0})}},{key:"render",value:function(){var e=this;try{var t=this.props.encounter.waves.map((function(t){return r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement(X,{text:t.name,placeholder:"wave name",onChange:function(a){return e.changeValue(t,"name",a)}}),r.a.createElement(j,{text:"delete wave",callback:function(){return e.removeWave(t)}}))})),a=this.props.encounter.waves.map((function(t){return r.a.createElement(Be,{key:t.id,heading:t.name||"unnamed wave",content:e.getMonsterCards(t.slots,t.id),columns:3})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:8,className:"scrollable"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"encounter name"),r.a.createElement(X,{text:this.props.encounter.name,placeholder:"encounter name",onChange:function(t){return e.changeValue(e.props.encounter,"name",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"waves"),t,r.a.createElement("button",{onClick:function(){return e.addWave()}},"add a new wave")),r.a.createElement("div",{className:"divider"}),r.a.createElement(me,{encounter:this.props.encounter,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(de,{filter:this.state.filter,changeValue:function(t,a){return e.changeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(W,{text:"build a random encounter"},r.a.createElement("p",null,"add random monsters to this encounter until its (effective)) xp value is at least the following value"),r.a.createElement(Re.a,{value:this.state.randomEncounterXP,min:0,step:1e3,onChange:function(t){return e.setRandomEncounterXP(t||0)}}),r.a.createElement("button",{onClick:function(){return e.buildEncounter()}},"build encounter")),r.a.createElement(j,{text:"clear encounter",callback:function(){return e.clearEncounter()}}))),r.a.createElement(p.a,{span:16,className:"scrollable"},r.a.createElement(Be,{columns:3,content:this.getMonsterCards(this.props.encounter.slots,null),heading:"encounter"}),a,this.getLibrarySection()))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),qe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getKillsChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"kill"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=E.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"kills"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t}))}},{key:"getDamageChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"damage"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=a.value}})),t=E.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"damage dealt"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t}))}},{key:"getMobilityChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"movement"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=E.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"mobility"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t}))}},{key:"getConditionsAddedChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"condition-add"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=E.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"conditions added"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t}))}},{key:"getConditionsRemovedChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"condition-remove"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=E.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"conditions removed"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t}))}},{key:"getTurnLengthChart",value:function(){var e=this,t=[],a=null,n=[];return this.props.combat.report.forEach((function(r){switch(r.type){case"turn-start":a=r.timestamp;break;case"turn-end":if(null!==a){var s=e.props.combat.combatants.find((function(e){return e.id===r.combatantID}));if(s&&"pc"===s.type){var i=t.find((function(e){return e.text===s.displayName}));void 0===i&&(i={text:s.displayName,value:0},t.push(i));var o=r.timestamp-a;n.forEach((function(e){if(e.start&&e.end){var t=e.end-e.start;o-=t}})),i.value+=o}a=null,n=[]}break;case"combat-pause":n.push({start:r.timestamp,end:null});break;case"combat-resume":if(n.length>0)n[n.length-1].end=r.timestamp}})),t=E.sort(t,[{field:"value",dir:"asc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"turn length"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(Le,{data:t,display:function(e){var t=new Date(e);return t.getMinutes()+"m "+t.getSeconds()+"s"}}))}},{key:"render",value:function(){try{return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},this.getKillsChart(),this.getDamageChart(),this.getMobilityChart(),this.getConditionsAddedChart(),this.getConditionsRemovedChart(),this.getTurnLengthChart())}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),We=a(242),Ye=a(268),Fe=a(267),Je=a(266),_e=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.stopPropagation(),this.props.click(t,a)}},{key:"render",value:function(){var e=this;try{var t="radial "+(this.props.direction||"out");this.props.disabled&&(t+=" disabled");var a="out"===this.props.direction||"both"===this.props.direction||"eight"===this.props.direction,n="in"===this.props.direction||"both"===this.props.direction,s="eight"===this.props.direction;return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NW")}},r.a.createElement(We.a,{rotate:-45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"N","out")}},r.a.createElement(We.a,null)),r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"N","in")}},r.a.createElement(Ye.a,null))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NE")}},r.a.createElement(We.a,{rotate:45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"W","out")}},r.a.createElement(Fe.a,null)),r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"W","in")}},r.a.createElement(Je.a,null))),r.a.createElement("div",{className:"cell"}),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"E","in")}},r.a.createElement(Fe.a,null)),r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"E","out")}},r.a.createElement(Je.a,null))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SW")}},r.a.createElement(Ye.a,{rotate:45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"S","in")}},r.a.createElement(We.a,null)),r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"S","out")}},r.a.createElement(Ye.a,null))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SE","out")}},r.a.createElement(Ye.a,{rotate:-45}))))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);_e.defaultProps={direction:"out",disabled:!1};var Xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={images:a.listImages(),filter:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"listImages",value:function(){for(var e=[],t=0;t!==localStorage.length;++t){var a=localStorage.key(t);if(a&&a.startsWith("image-")){var n=localStorage.getItem(a);if(n){var r=JSON.parse(n);e.push({id:r.id,name:r.name,data:r.data})}}}return E.sort(e,[{field:"name",dir:"asc"}])}},{key:"setFilter",value:function(e){this.setState({filter:e})}},{key:"onFileSelected",value:function(e){var t=this;if(e.target.files){var a=new FileReader;a.onload=function(e){if(e.target){var a=e.target.result,r={id:E.guid(),name:n.name,data:a},s=JSON.stringify(r);localStorage.setItem("image-"+r.id,s),t.setState({images:t.listImages()})}};var n=e.target.files[0];a.readAsDataURL(n)}}},{key:"delete",value:function(e){localStorage.removeItem("image-"+e),this.setState({images:this.listImages()})}},{key:"render",value:function(){var e=this;try{var t=this.state.images.filter((function(t){return S.match(e.state.filter,t.name)})).map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"subheading"},t.name),r.a.createElement("img",{className:"selectable-image",src:t.data,alt:t.name,onClick:function(){return e.props.select(t.id)}}),r.a.createElement("button",{onClick:function(){return e.delete(t.id)}},"delete this image"))}));return 0===t.length&&t.push(r.a.createElement(ne,{key:"empty"},"no images")),this.state.images.length>0&&t.unshift(r.a.createElement(_.a.Search,{key:"search",placeholder:"search for an image",allowClear:!0,onChange:function(t){return e.setFilter(t.target.value)},onSearch:function(t){return e.setFilter(t)}})),r.a.createElement("div",{className:"full-height"},r.a.createElement("div",{className:"drawer-header"},r.a.createElement("div",{className:"app-title"},"select image")),r.a.createElement("div",{className:"drawer-content"},r.a.createElement("div",{className:"scrollable"},r.a.createElement("button",{onClick:function(){return document.getElementById("file-upload").click()}},"add a new image"),r.a.createElement("input",{type:"file",id:"file-upload",accept:"image/*",style:{display:"none"},onChange:function(t){return e.onFileSelected(t)}}),t)),r.a.createElement("div",{className:"drawer-footer"},r.a.createElement("button",{onClick:function(){return e.props.cancel()}},"cancel")))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={map:e.map,selectedTileID:null,addingTile:null,mapSize:30,showImageSelection:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSelectedTileID",value:function(e){this.setState({selectedTileID:e})}},{key:"setAddingTile",value:function(e){var t=null;switch(e){case"room":(t=k.createMapItem()).terrain="default",t.width=6,t.height=6,t.style="square";break;case"corridor":(t=k.createMapItem()).terrain="default",t.width=6,t.height=2,t.style="square";break;case"door":(t=k.createMapItem()).terrain="default",t.width=2,t.height=1,t.style="square",t.content={type:"doorway",style:"single",orientation:"horizontal"};break;case"stairs":(t=k.createMapItem()).terrain="default",t.width=4,t.height=2,t.style="square",t.content={type:"stairway",style:"stairs",orientation:"vertical"}}t&&0===this.state.map.items.length?(t.x=0,t.y=0,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})):this.setState({addingTile:t})}},{key:"moveAddedTile",value:function(e,t){var a=this.state.addingTile;a&&(a.x=e,a.y=t,this.setState({addingTile:a}))}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}},{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addMapTile",value:function(e,t){if(this.state.addingTile){var a=this.state.addingTile;a.x=e,a.y=t,this.state.map.items.push(a),this.setState({map:this.state.map,selectedTileID:a.id,addingTile:null})}}},{key:"moveMapItem",value:function(e,t){switch(t){case"N":e.y-=1;break;case"NE":e.x+=1,e.y-=1;break;case"E":e.x+=1;break;case"SE":e.x+=1,e.y+=1;break;case"S":e.y+=1;break;case"SW":e.x-=1,e.y+=1;break;case"W":e.x-=1;break;case"NW":e.x-=1,e.y-=1}this.setState({map:this.state.map})}},{key:"bigMapItem",value:function(e,t){switch(t){case"N":e.y-=1,e.height+=1;break;case"E":e.width+=1;break;case"S":e.height+=1;break;case"W":e.x-=1,e.width+=1}this.setState({map:this.state.map})}},{key:"smallMapItem",value:function(e,t){switch(t){case"N":e.height>1&&(e.y+=1,e.height-=1);break;case"E":e.width>1&&(e.width-=1);break;case"S":e.height>1&&(e.height-=1);break;case"W":e.width>1&&(e.x+=1,e.width-=1)}this.setState({map:this.state.map})}},{key:"resizeMapItem",value:function(e,t,a){switch(a){case"in":this.smallMapItem(e,t);break;case"out":this.bigMapItem(e,t)}}},{key:"rotateMapItem",value:function(e){var t=e.width;e.width=e.height,e.height=t;var a=Math.floor((e.width-e.height)/2);e.x-=a,e.y+=a,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal"),this.setState({map:this.state.map,addingTile:this.state.addingTile})}},{key:"sendToBack",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.unshift(e),this.setState({map:this.state.map})}},{key:"bringToFront",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.push(e),this.setState({map:this.state.map})}},{key:"cloneMapItem",value:function(e){var t=JSON.parse(JSON.stringify(e));t.id=E.guid(),t.x+=1,t.y+=1,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})}},{key:"pickUpMapItem",value:function(e){var t=this.state.map,a=t.items.indexOf(e);t.items.splice(a,1),this.setState({map:t,selectedTileID:null,addingTile:e})}},{key:"removeMapItem",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.setState({map:this.state.map,selectedTileID:null})}},{key:"setCustomImage",value:function(e){var t=this,a=this.state.map.items.find((function(e){return e.id===t.state.selectedTileID}));a&&this.changeValue(a,"customBackground",e)}},{key:"rotateMap",value:function(){C.rotateMap(this.state.map),this.setState({map:this.state.map})}},{key:"clearMap",value:function(){var e=this.state.map;e.items=[],this.setState({map:e,selectedTileID:null})}},{key:"generate",value:function(e){C.generate(e,this.state.map),this.setState({map:this.state.map})}},{key:"addNote",value:function(e){var t=k.createMapNote();t.targetID=e,this.state.map.notes.push(t),this.setState({map:this.state.map})}},{key:"removeNote",value:function(e){var t=this.state.map.notes.findIndex((function(t){return t.targetID===e}));this.state.map.notes.splice(t,1),this.setState({map:this.state.map})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({map:this.state.map,showImageSelection:!1})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t];n+=a,"width"!==t&&"height"!==t||(n=Math.max(n,1)),this.changeValue(e,t,n)}},{key:"render",value:function(){var e=this;try{var t=null;if(this.state.selectedTileID){var a=this.state.map.items.find((function(t){return t.id===e.state.selectedTileID}));if(a){var n=C.getNote(this.state.map,a);t=r.a.createElement(Ue,{tile:a,note:n,toggleImageSelection:function(){return e.toggleImageSelection()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},move:function(t,a){return e.moveMapItem(t,a)},resize:function(t,a,n){return e.resizeMapItem(t,a,n)},clone:function(t){return e.cloneMapItem(t)},pickUp:function(t){return e.pickUpMapItem(t)},remove:function(t){return e.removeMapItem(t)},rotate:function(t){return e.rotateMapItem(t)},sendToBack:function(t){return e.sendToBack(t)},bringToFront:function(t){return e.bringToFront(t)},addNote:function(t){return e.addNote(t)},removeNote:function(t){return e.removeNote(t)}})}}else t=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"map name"),r.a.createElement(X,{text:this.state.map.name,placeholder:"map name",onChange:function(t){return e.changeValue(e.state.map,"name",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement(ne,null,r.a.createElement("p",null,"to add a new tile to the map, click on one of the buttons below"),r.a.createElement("p",null,"to edit an existing tile, click on it to select it")),r.a.createElement("div",{className:"divider"}),this.state.addingTile?r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.setAddingTile(null)}},"click somewhere on the map to lock the tile in place, or click here to remove it from the map"),r.a.createElement("button",{onClick:function(){return e.rotateMapItem(e.state.addingTile)}},"rotate tile")):r.a.createElement("div",null,r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("button",{className:"image-button",onClick:function(){return e.setAddingTile("room")}},"add a room")),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("button",{className:"image-button",onClick:function(){return e.setAddingTile("corridor")}},"add a corridor")),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("button",{className:"image-button",onClick:function(){return e.setAddingTile("door")}},"add a door")),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("button",{className:"image-button",onClick:function(){return e.setAddingTile("stairs")}},"add stairs"))),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.generate("room")}},"add a random room"),r.a.createElement("button",{onClick:function(){return e.rotateMap()}},"rotate the map"),r.a.createElement(j,{text:"clear all tiles",callback:function(){return e.clearMap()}})));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:8,className:"scrollable"},t),r.a.createElement(p.a,{span:16,className:"scrollable both-ways"},r.a.createElement(J,{source:this.state,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(t){return e.nudgeMapSize(3*t)}}),r.a.createElement(ye,{map:this.state.map,mode:"edit",size:this.state.mapSize,selectedItemIDs:this.state.selectedTileID?[this.state.selectedTileID]:[],showOverlay:!!this.state.addingTile,floatingItem:this.state.addingTile,itemSelected:function(t,a){return e.setSelectedTileID(t)},gridSquareEntered:function(t,a){return e.moveAddedTile(t,a)},gridSquareClicked:function(t,a){return e.addMapTile(t,a)}})),r.a.createElement(h.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Xe,{select:function(t){return e.setCustomImage(t)},cancel:function(){return e.toggleImageSelection()}})))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"position"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"getPositionSection",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"move"),r.a.createElement("div",{className:"section centered"},r.a.createElement(_e,{direction:"eight",click:function(t){return e.props.move(e.props.tile,t)}})),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement("div",{className:"section"},5*this.props.tile.width," ft x ",5*this.props.tile.height," ft"),r.a.createElement("div",{className:"section"},r.a.createElement(J,{source:this.props.tile,name:"width",label:"width",display:function(e){return e+" sq"},nudgeValue:function(t){return e.props.nudgeValue(e.props.tile,"width",t)}}),r.a.createElement(J,{source:this.props.tile,name:"height",label:"height",display:function(e){return e+" sq"},nudgeValue:function(t){return e.props.nudgeValue(e.props.tile,"height",t)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.sendToBack(e.props.tile)}},"send to back"),r.a.createElement("button",{onClick:function(){return e.props.bringToFront(e.props.tile)}},"bring to front"))}},{key:"getStyleSection",value:function(){var e=this,t=N.map((function(e){return{id:e,text:e}})),a=null;"custom"===this.props.tile.terrain&&(a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"custom image"),r.a.createElement("button",{onClick:function(){return e.props.toggleImageSelection()}},"select image"),r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.tile,"customBackground","")}},"clear image")));var n=["square","rounded","circle"].map((function(e){return{id:e,text:e}}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"terrain"),r.a.createElement(R,{options:t,placeholder:"select terrain",selectedID:this.props.tile.terrain?this.props.tile.terrain:void 0,select:function(t){return e.props.changeValue(e.props.tile,"terrain",t)}}),a,r.a.createElement("div",{className:"subheading"},"shape"),r.a.createElement(le,{options:n,selectedID:this.props.tile.style,select:function(t){return e.props.changeValue(e.props.tile,"style",t)}}),r.a.createElement("div",{className:"subheading"},"content"),r.a.createElement(Ae,{items:[{id:"none",text:"none"},{id:"doorway",text:"doorway",details:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,"style")),r.a.createElement(le,{options:w.map((function(e){return{id:e,text:e}})),itemsPerRow:2,selectedID:this.props.tile.content?this.props.tile.content.style:null,select:function(t){return e.props.changeValue(e.props.tile.content,"style",t)}}),r.a.createElement("div",null,r.a.createElement("b",null,"orientation")),r.a.createElement(le,{options:["horizontal","vertical"].map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:function(t){return e.props.changeValue(e.props.tile.content,"orientation",t)}}))},{id:"stairway",text:"stairway",details:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,"style")),r.a.createElement(le,{options:x.map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.style:null,select:function(t){return e.props.changeValue(e.props.tile.content,"style",t)}}),r.a.createElement("div",null,r.a.createElement("b",null,"orientation")),r.a.createElement(le,{options:["horizontal","vertical"].map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:function(t){return e.props.changeValue(e.props.tile.content,"orientation",t)}}))}],selectedItemID:this.props.tile.content?this.props.tile.content.type:"none",select:function(t){var a=null;if("none"!==t){var n="";switch(t){case"doorway":n=w[0];break;case"stairway":n=x[0]}a={type:t,orientation:"horizontal",style:n}}e.props.changeValue(e.props.tile,"content",a)}}))}},{key:"getNotesSection",value:function(){var e=this;return this.props.note?r.a.createElement("div",null,r.a.createElement(X,{text:this.props.note.text,placeholder:"details",minLines:5,maxLines:10,onChange:function(t){return e.props.changeValue(e.props.note,"text",t)}}),r.a.createElement("button",{onClick:function(){return e.props.removeNote(e.props.tile.id)}},"remove note from this tile")):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addNote(e.props.tile.id)}},"add a note to this tile"))}},{key:"render",value:function(){var e=this;try{var t=["position","style","notes"].map((function(e){return{id:e,text:e}})),a=null;switch(this.state.view){case"position":a=this.getPositionSection();break;case"style":a=this.getStyleSection();break;case"notes":a=this.getNotesSection()}return r.a.createElement("div",{className:"card map"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},"map tile")),r.a.createElement("div",{className:"card-content"},r.a.createElement(le,{options:t,selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.rotate(e.props.tile)}},"rotate tile"),r.a.createElement("button",{onClick:function(){return e.props.clone(e.props.tile)}},"clone tile"),r.a.createElement("button",{onClick:function(){return e.props.pickUp(e.props.tile)}},"pick up tile"),r.a.createElement("button",{onClick:function(){return e.props.remove(e.props.tile)}},"remove tile"))))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ze=a(249),Qe=a(126),$e=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"initModel",value:function(t){var a=[],n=0;t.forEach((function(t){t.split(/\r?\n/).forEach((function(t){t&&(e.addLineToModel(t,a),n=Math.max(n,t.length))}))})),e.model=a,e.maxLength=n}},{key:"addLineToModel",value:function(e,t){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);for(var a=function(a){var n=e.substr(a-2,2),r=e.substr(a,1),s=t.find((function(e){return e.prev===n}));s||(s={prev:n,freq:[]},t.push(s));var i=s.freq.find((function(e){return e.char===r}));i||(i={char:r,count:0},s.freq.push(i)),i.count+=1},n=2;n!==e.length;++n)a(n)}},{key:"generate",value:function(t){for(var a=[],n=0;a.length<t&&n<100;){var r=e.extractLine();if(r&&!a.map((function(e){return e.line})).includes(r)&&r.length<=e.maxLength){var s=e.fit(r);a.push({line:r,fit:s})}else n+=1}return a}},{key:"extractLine",value:function(){for(var t=String.fromCharCode(0,1),a=function(){var a=t.substr(t.length-2,2),n=e.model.find((function(e){return e.prev===a}));if(!n)return{v:null};var r="";n.freq.forEach((function(e){r+=e.char.repeat(e.count)}));var s=Math.floor(Math.random()*r.length),i=r[s];if(i===String.fromCharCode(2))return{v:t=t.substr(2)};if(1===E.dieRoll()){["bdg","ptk","sz","aeiouy","lr","ckq","vf"].forEach((function(e){if(e.includes(i)){var t=Math.floor(Math.random()*e.length);i=e[t]}}))}t+=i};;){var n=a();if("object"===typeof n)return n.v}}},{key:"fit",value:function(t){t=String.fromCharCode(0,1)+t+String.fromCharCode(2);for(var a=[],n=function(n){var r=t.substr(n-2,2),s=t[n],i=e.model.find((function(e){return e.prev===r}));if(i){var o=i.freq.find((function(e){return e.char===s}));if(o){var c=i.freq.reduce((function(e,t){return Math.max(e,t.count)}),0),l=o.count/c;a.push(l)}else a.push(0)}},r=2;r!==t.length;++r)n(r);return a.reduce((function(e,t){return e+t}),0)/a.length}},{key:"startsWithVowel",value:function(e){var t=!1;return["a","e","i","o","u"].forEach((function(a){e.toLowerCase().startsWith(a)&&(t=!0)})),t}},{key:"getMultipleValues",value:function(e){for(var t=[];0!==E.randomNumber(3);)t.push(e[E.randomNumber(e.length)]);return t.join(", ")}},{key:"generateName",value:function(){var e=["As Has Khe Zash Gl Ig Iv Kos Miv Pav Ser Dar Even Gor Rand Sto Tam Barer Keth Mum","Mar Burg Al Hel Wrayt S Eag Eath Joan Answ L Ot Ced At Tal Ham Jasm Mail Yash Row","Adr Alber Ba Bar Gar Kildr Kath Dies Eld Gurd Har Morg Or Rur Mar Vis Jen Torg Tak Thor End Ris Em Gunn","Ad All Aram Berri Car Enial Gann Im Per Sorvi Var Adr An Beth Bir Jelen Key Lesh Mer Mia Naiv Quel Sar Shan","Al An C Cor Eld Er Finn Gar Lin Mer Os Per Ros An Cal Cor Kith Lav Ned Pae Seraph T V Chen","Are Bala Bhar Don Gh Hesk Med Meh Nad Pand Patr Sham Shed Ak Bir Farid Fla Ka Ko Mish Thav Uad Eder Hener","Alu Stos Fa Ravay Leo Stok Vic El Yeng Car Ric Ar Guir Es My Pey"].join(" ").toLowerCase().split(" "),t=["Eir Eid Eed El Ar An Or Ef Al Vin Orn Dur Stag Elm Ur Us","Ik Ich Ern End Tor Nor In Rak Gen Sik Gran Linn Vok Brek Dal Gar","An Ar Il Rian Ric Is Dan Arai Meral Cian En Rion Ialis Ior Nan Kas","Ton Der Ade Rin Don Rich Nan Ret Al Born Coe By Fire Yas Dal Yle","Han Asar Ash Aar Esch An Rash En Arr Jed Rin Gar Ash Dinn Hun Rek","Orel Aadi Ahn Aver Eiros Kain Retor Lannan Pet Ikos","Er Ey A E Il Elia Ya Ed Eue Ild Oane Yne Orna Ie Ala Erri Ea Ia","Ber Tin Hild Dryn A Eth Runn Ellen Loda Dis Ja Lin Ra Tyrd De Rasa","Rie Aea Striana Inua Rynna Ilia Na Neth Leth Iel Lee Qui Astra Ia Ania Ynn","Dry Ree Lie Ora Emia Ian Ri Inia Ina Aena Ani Erna Lyse La Da Aela","Ra Ir Eh Ann Ilar Rinn Ann La Ra A Ina Va Hit Ederei Ere Eila","Ina Ceryn Vyn Ella Aella Vyre"].join(" ").toLowerCase().split(" "),a=Math.floor(Math.random()*e.length),n=Math.floor(Math.random()*t.length),r="";if(1===E.dieRoll(10)){var s=["-","'"];r=s[Math.floor(Math.random()*s.length)]}return e[a]+r+t[n]}},{key:"generatePotion",value:function(){var t="",a=e.potionColour(!0),n=e.potionLiquid(),r=e.potionAdjective(),s=e.potionFeature();switch(E.randomNumber(5)){case 0:t=a+" "+n;break;case 1:t=a+" "+n+" "+s;break;case 2:t=r+" "+a+" "+n;break;case 3:t=r+" "+a+" "+n+" "+s;break;case 4:t=r+" "+n+", "+a+" "+s}switch(t=(e.startsWithVowel(t)?"an":"a")+" "+t+" in "+e.potionContainer(),E.randomNumber(6)){case 0:t+="; it smells "+e.potionSmell();break;case 1:t+="; it tastes "+e.potionSmell();break;case 2:t+="; it smells "+e.potionSmell()+" but tastes "+e.potionSmell();break;case 3:t+="; it smells and tastes "+e.potionSmell()}return t}},{key:"generateBookTitle",value:function(){var t="",a=e.bookNounPhrase(E.randomBoolean(),E.randomBoolean());switch(E.randomNumber(5)){case 0:t=a+"'s "+e.bookNounPhrase(E.randomBoolean(),!1);break;case 1:t=a+" "+e.bookPreposition()+" "+e.bookNounPhrase(E.randomBoolean(),!0);break;case 2:t=e.bookGerund()+" "+e.bookNounPhrase(E.randomBoolean(),!0);break;case 3:t=e.bookAbout()+" "+a;break;case 4:t=a}if(0===E.randomNumber(10)&&(t+=": "+e.bookAbout()+" "+e.bookNounPhrase(E.randomBoolean(),E.randomBoolean())),0===E.randomNumber(10)){var n="";switch(E.randomNumber(3)){case 0:n="volume";break;case 1:n="part";break;case 2:n="book"}switch(E.randomNumber(5)){case 0:t+=", "+n+" one";break;case 1:t+=", "+n+" two";break;case 2:t+=", "+n+" three";break;case 3:t+=", "+n+" four";break;case 4:t+=", "+n+" five"}}return t}},{key:"generateNPC",value:function(){var t=["elderly","middle-aged","teenage","youthful","young","old"],a=t[E.randomNumber(t.length)],n=["apothecary","architect","armourer","arrowsmith","astrologer","baker","barber","lawyer","beggar","bellfounder","blacksmith","bookbinder","brewer","bricklayer","butcher","carpenter","carter","cartwright","chandler","peddler","clerk","clockmaker","cobbler","cook","cooper","merchant","embroiderer","engraver","fisherman","fishmonger","forester","furrier","gardener","gemcutter","glassblower","goldsmith","grocer","haberdasher","stableman","courtier","herbalist","innkeeper","ironmonger","labourer","painter","locksmith","mason","messenger","miller","miner","minstrel","ploughman","farmer","porter","sailor","scribe","seamstress","shepherd","shipwright","soapmaker","tailor","tinker","vintner","weaver"],r=n[E.randomNumber(n.length)],s="";switch(E.randomNumber(3)){case 0:case 1:s=r;break;case 2:s=a+" "+r}s=(e.startsWithVowel(s)?"an":"a")+" "+s;var i=["gangly","gigantic","hulking","lanky","short","small","stumpy","tall","tiny","willowy"],o=i[E.randomNumber(i.length)],c=["broad-shouldered","fat","gaunt","obese","plump","pot-bellied","rotund","skinny","slender","slim","statuesque","stout","thin"],l=c[E.randomNumber(c.length)],u="";switch(E.randomNumber(4)){case 0:case 1:u=o+" and "+l;break;case 2:u=o;break;case 3:u=l}var m=["short","cropped","long","braided","dreadlocked","shoulder-length","wiry","balding","receeding","curly","tightly-curled","straight","greasy","limp","sparse","thinning","wavy"],d=["black","brown","dark brown","light brown","red","ginger","strawberry blonde","blonde","ash blonde","graying","silver","white","gray","auburn"],p=m[E.randomNumber(m.length)]+" "+d[E.randomNumber(d.length)],h="";switch(E.randomNumber(4)){case 0:case 1:h=s+", "+u+" with "+p+" hair";break;case 2:h=s+" with "+p+" hair";break;case 3:h=s+", "+u}return h}},{key:"generateNPCPhysical",value:function(){return e.getMultipleValues(["bearded","buck-toothed","chiselled","doe-eyed","fine-featured","florid","gap-toothed","goggle-eyed","grizzled","jowly","jug-eared","pock-marked","broken nose","red-cheeked","scarred","squinting","thin-lipped","toothless","weather-beaten","wrinkled"])}},{key:"generateNPCMental",value:function(){return e.getMultipleValues(["hot-tempered","overbearing","antagonistic","haughty","elitist","proud","rude","aloof","mischievous","impulsive","lusty","irreverent","madcap","thoughtless","absent-minded","insensitive","brave","craven","shy","fearless","obsequious","inquisitive","prying","intellectual","perceptive","keen","perfectionist","stern","harsh","punctual","driven","trusting","kind-hearted","forgiving","easy-going","compassionate","miserly","hard-hearted","covetous","avaricious","thrifty","wastrel","spendthrift","extravagant","kind","charitable","gloomy","morose","compulsive","irritable","vengeful","honest","truthful","innocent","gullible","bigoted","biased","narrow-minded","cheerful","happy","diplomatic","pleasant","foolhardy","affable","fatalistic","depressing","cynical","sarcastic","realistic","secretive","retiring","practical","level-headed","dull","reverent","scheming","paranoid","cautious","deceitful","nervous","uncultured","boorish","barbaric","graceless","crude","cruel","sadistic","immoral","jealous","belligerent","argumentative","arrogant","careless","curious","exacting","friendly","greedy","generous","moody","naive","opinionated","optimistic","pessimistic","quiet","sober","suspicious","uncivilised","violent","peaceful"])}},{key:"generateNPCSpeech",value:function(){return e.getMultipleValues(["accented","articulate","garrulous","breathless","crisp","gutteral","high-pitched","lisping","loud","nasal","slow","fast","squeaky","stuttering","wheezy","whiny","whispery","soft-spoken","laconic","blustering"])}},{key:"generateTreasure",value:function(){var t="",a=["diamond","ruby","sapphire","emerald","amethyst","garnet","topaz","pearl","black pearl","opal","fire opal","amber","coral","agate","carnelian","jade","peridot","moonstone","alexandrite","aquamarine","jacinth","marble"];switch(E.randomNumber(12)){case 0:case 1:case 2:var n=a[E.randomNumber(a.length)];switch(E.randomBoolean()){case!0:n+=" gemstone";break;case!1:n="piece of "+n}switch(E.randomNumber(12)){case 0:n="well cut "+n;break;case 1:n="rough-cut "+n;break;case 2:n="poorly cut "+n;break;case 3:n="small "+n;break;case 4:n="large "+n;break;case 5:n="oddly shaped "+n;break;case 6:n="highly polished "+n}t=n;break;case 3:case 4:case 5:var r=["medal","statuette","sculpture","idol","chalice","goblet","dish","bowl"],s=r[E.randomNumber(r.length)],i=["small","large","light","heavy","delicate","fragile","masterwork","elegant"];t=i[E.randomNumber(i.length)]+" "+s;break;case 6:case 7:case 8:var o=["ring","necklace","crown","circlet","bracelet","anklet","torc","brooch","pendant","locket","diadem","tiara","earring"],c=o[E.randomNumber(o.length)],l=["gold","silver","bronze","platinum","electrum","mithral","orium","adamantine"];switch(t=l[E.randomNumber(l.length)]+" "+c,E.randomNumber(5)){case 0:t=(E.randomBoolean()?"enamelled":"laquered")+" "+t;break;case 1:t=l[E.randomNumber(l.length)]+"-"+(E.randomBoolean()?"plated":"filigreed")+" "+t}switch(E.randomNumber(10)){case 0:t="delicate "+t;break;case 1:t="intricate "+t;break;case 2:t="elegant "+t;break;case 3:t="simple "+t;break;case 4:t="plain "+t}break;case 9:case 10:var u="";switch(E.randomBoolean()){case!0:switch(u="painting",E.randomBoolean()){case!0:u="oil "+u;break;case!1:u="watercolour "+u}break;case!1:switch(u="drawing",E.randomNumber(3)){case 0:u="pencil "+u;break;case 1:u="charcoal "+u;break;case 2:u="pastel "+u}}var m=["small","large","delicate","fragile","elegant","detailed"],d=["canvas","paper","parchment","wood panels","fabric"];t=m[E.randomNumber(m.length)]+" "+u+" on "+d[E.randomNumber(d.length)];break;case 11:var p=["lute","lyre","mandolin","violin","drum","flute","clarinet","accordion","banjo","bodhran","ocarina","zither","djembe","shawm"],h=p[E.randomNumber(p.length)],f=["small","large","light","heavy","delicate","fragile","masterwork","elegant"];t=f[E.randomNumber(f.length)]+" "+h}switch(E.randomNumber(5)){case 0:var v=["feywild","shadowfell","elemental chaos","astral plane","abyss","distant north","distant east","distant west","distant south"];t+=" from the "+v[E.randomNumber(v.length)];break;case 1:var g=["decorated with","inscribed with","engraved with","embossed with","carved with"],b=["indecipherable","ancient","curious","unusual","dwarven","eladrin","elven","draconic","gith"],y=["script","designs","sigils","runes","glyphs","patterns"];t+=" "+g[E.randomNumber(g.length)]+" "+b[E.randomNumber(b.length)]+" "+y[E.randomNumber(y.length)];break;case 2:var k=["glowing with","suffused with","infused with","humming with","pulsing with"],N=["arcane","divine","primal","psionic","dark","shadow","elemental","ethereal","unknown"],w=["energy","power","magic"];t+=" "+k[E.randomNumber(k.length)]+" "+N[E.randomNumber(N.length)]+" "+w[E.randomNumber(w.length)];break;case 4:var x=a[E.randomNumber(a.length)];E.randomBoolean()?x+="s":x="a single "+x;var C=["set with","inlaid with","studded with","with shards of"];t+=" "+C[E.randomNumber(C.length)]+" "+x}return(e.startsWithVowel(t)?"an ":"a ")+t}},{key:"generateRoomName",value:function(){var e=["antechamber","arena","armoury","aviary","audience chamber","banquet hall","bath chamber","barracks","bedroom","boudoir","bestiary","burial chamber","cells","chamber","chantry","chapel","classroom","closet","court","crypt","dining room","dormitory","dressing room","dumping ground","entrance hall","gallery","game room","great hall","guard post","hall","harem","hoard","infirmary","kennels","kitchens","laboratory","lair","library","mausoleum","meditation room","museum","nursery","observatory","office","pantry","prison","quarters","reception room","refectory","ritual chamber","shrine","smithy","stable","storeroom","study","temple","throne room","torture chamber","trophy room","training area","treasury","waiting room","workroom","workshop","vault","vestibule"];return e[E.randomNumber(e.length)]}},{key:"potionColour",value:function(e){var t=["red","scarlet","crimson","carmine","vermillion","pink","blue","royal blue","sky blue","light blue","dark blue","midnight blue","indigo","yellow","lemon yellow","amber","green","light green","dark green","sea green","turquoise","aquamarine","emerald","purple","lavender","lilac","mauve","orange","brown","maroon","ochre","black","dark grey","grey","light grey","off-white","white","golden","silver"];return e&&(t=t.concat(["blood red","cherry red","ruby-coloured","rose-coloured","sapphire-coloured","straw-coloured","olive-coloured","plum-coloured","mud-coloured","cream-coloured","ivory-coloured","bronze-coloured","colourless","clear","transparent"])),t[E.randomNumber(t.length)]}},{key:"potionAdjective",value:function(){var e=["watery","syrupy","thick","viscous","gloopy","thin","runny","translucent","effervescent","fizzing","bubbling","foaming","volatile","smoking","fuming","vaporous","steaming","cold","icy cold","hot","sparkling","iridescent","cloudy","opalescent","luminous","phosphorescent","glowing"];return e[E.randomNumber(e.length)]}},{key:"potionFeature",value:function(){switch(E.randomNumber(5)){case 0:return"with "+this.potionColour(!0)+" specks";case 1:return"with flecks of "+this.potionColour(!1);case 2:var t=this.potionColour(!0);return"with "+(e.startsWithVowel(t)?"an":"a")+" "+t+" suspension";case 3:return"with a floating "+this.potionColour(!0)+" layer";case 4:return"with a ribbon of "+this.potionColour(!1)}return""}},{key:"potionLiquid",value:function(){var e=["liquid","solution","draught","oil","elixir","potion"];return e[E.randomNumber(e.length)]}},{key:"potionContainer",value:function(){var t=["small","rounded","tall","square","irregularly-shaped","long-necked","cylindrical","round-bottomed"],a=["glass","metal","ceramic","crystal"],n=["vial","jar","bottle","flask"],r=t[E.randomNumber(t.length)],s=a[E.randomNumber(a.length)],i=n[E.randomNumber(n.length)];0===E.randomNumber(3)&&(s=this.potionColour(!0)+" "+s);var o="";switch(E.randomBoolean()){case!0:o=s+" "+i;break;case!1:o=r+" "+s+" "+i}return(e.startsWithVowel(o)?"an":"a")+" "+o}},{key:"potionSmell",value:function(){var e=["acidic","acrid","of ammonia","of apples","bitter","brackish","buttery","of cherries","delicious","earthy","of earwax","of fish","floral","of lavender","lemony","of honey","fruity","meaty","metallic","musty","of onions","of oranges","peppery","of perfume","rotten","salty","sickly sweet","starchy","sugary","smokey","sour","spicy","of sweat","sweet","unpleasant","vile","vinegary"];return e[E.randomNumber(e.length)]}},{key:"bookNounPhrase",value:function(t,a){var n=e.bookNoun(t),r=!1;(t&&0===E.randomNumber(5)&&(n+="s",r=!0),0===E.randomNumber(3))&&(n=e.bookAdjective()+" "+n);if(a&&E.randomBoolean())switch(E.randomBoolean()){case!0:n="the "+n;break;case!1:if(r)switch(E.randomNumber(6)){case 0:n="two "+n;break;case 1:n="three "+n;break;case 2:n="four "+n;break;case 3:n="five "+n;break;case 4:n="six "+n;break;case 5:n="seven "+n}else switch(E.randomBoolean()){case!0:n=(e.startsWithVowel(n)?"an":"a")+" "+n;break;case!1:n="one "+n}}return n}},{key:"bookNoun",value:function(e){var t=["elf","halfling","dwarf","gnome","tiefling","dragonborn","goliath","changeling","drow","minotaur","beast","orc","goblin","hobgoblin","dragon","demon","devil","angel","god","gith","night","day","eclipse","shadow","sky","sun","moon","star","void","battle","war","brawl","fist","blade","arrow","spell","prayer","eye","wing","army","legion","brigade","galleon","warship","frigate","potion","jewel","ring","amulet","cloak","sword","spear","helm","wizard","king","queen","prince","princess","warlock","barbarian","sorcerer","thief","mage","child","wayfarer","adventurer","pirate","spy","sage","assassin","mountain","forest","peak","cave","cavern","lake","swamp","marshland","island","shore","city","town","village","tower","arena","castle","citadel","bridge","game","wager","quest","challenge","rose","lily","thorn","leaf","word","snake","serpent","song","lament","dirge","elegy","storm","tempest"];return e||(t=t.concat(["darkness","light","dusk","twilight","revenge","vengeance","blood","earth","water","ice","wood","metal","lightning","thunder","mist","snow","flame","fire","wind","stone","destruction","life","death","time","end","danger","luck","chaos","truth","untruth","lie","deception","music","sound","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"])),t[E.randomNumber(t.length)]}},{key:"bookAdjective",value:function(){var e=["dark","bright","tyrannous","devout","noble","eldritch","mystical","magical","sorcerous","savage","silent","lonely","violent","peaceful","black","white","gold","silver","red","pale","dying","living","ascending","defiled","mythical","legendary","heroic","empty","mighty","despairing","spellbound","enchanted","soaring","falling","visionary","bold","perilous"];return e[E.randomNumber(e.length)]}},{key:"bookGerund",value:function(){var e=["killing","murdering","watching","examining","enchanting","destroying","defying","betraying","protecting","silencing","bearing","fighting"];return e[E.randomNumber(e.length)]}},{key:"bookPreposition",value:function(){var e=["and","in","of","with","against","for","to","towards"];return e[E.randomNumber(e.length)]}},{key:"bookAbout",value:function(){var t=["treatise","essay","monograph","discourse","dissertation","primer","history","enchiridion"],a=t[E.randomNumber(t.length)];E.randomBoolean()?a=(e.startsWithVowel(a)?"an ":"a ")+a:a+="s";var n=["about","on","concerning","regarding","on the subject of"];return a+" "+n[E.randomNumber(n.length)]}}]),e}();$e.model=[],$e.maxLength=0;var et=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.options.map((function(t){return r.a.createElement(tt,{key:t.id,option:t,selected:t.id===e.props.selectedID,count:e.props.options.length,select:function(t){return e.props.select(t)}})}));return r.a.createElement("div",{className:this.props.disabled?"tabs disabled":"tabs"},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);et.defaultProps={disabled:!1};var tt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="tab";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),r.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),at=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={monster:e.monster,page:"overview",showFilter:!1,helpSection:"speed",sidebar:"similar",similarFilter:{size:!0,type:!0,subtype:!1,alignment:!1,challenge:!0},scratchpadFilter:k.createMonsterFilter(),scratchpadList:[],showImageSelection:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setPage",value:function(e){var t=this.getHelpOptionsForPage(e);this.setState({page:e,helpSection:t[0]})}},{key:"setHelpSection",value:function(e){this.setState({helpSection:e})}},{key:"toggleMatch",value:function(e){var t=this.state.similarFilter;t[e]=!t[e],this.setState({similarFilter:t})}},{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addToScratchpad",value:function(e){var t=this.state.scratchpadList;t.push(e),E.sort(t),this.setState({scratchpadList:t})}},{key:"removeFromScratchpad",value:function(e){var t=this.state.scratchpadList.indexOf(e);this.state.scratchpadList.splice(t,1),this.setState({scratchpadList:this.state.scratchpadList})}},{key:"addAllToScratchpad",value:function(e){var t=this.state.scratchpadList;e.forEach((function(e){return t.push(e)})),E.sort(t),this.setState({scratchpadList:t})}},{key:"clearScratchpad",value:function(){this.setState({scratchpadList:[]})}},{key:"getHelpOptionsForPage",value:function(e){switch(e){case"overview":return["speed","senses","languages","equipment"];case"abilities":return["str","dex","con","int","wis","cha","saves","skills"];case"cbt-stats":return["armor class","hit dice","resist","vulnerable","immune","conditions"];case"actions":return["actions"];default:return[]}}},{key:"getSimilarMonsters",value:function(){var e=this,t=[];return this.props.library.forEach((function(a){a.monsters.forEach((function(a){var n=!0;e.state.monster.id===a.id&&(n=!1),e.state.similarFilter.size&&e.state.monster.size!==a.size&&(n=!1),e.state.similarFilter.type&&e.state.monster.category!==a.category&&(n=!1),e.state.similarFilter.subtype&&e.state.monster.tag!==a.tag&&(n=!1),e.state.similarFilter.alignment&&e.state.monster.alignment!==a.alignment&&(n=!1),e.state.similarFilter.challenge&&e.state.monster.challenge!==a.challenge&&(n=!1),n&&t.push(a)}))})),t}},{key:"setRandomValue",value:function(e,t){y.setRandomValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"spliceMonsters",value:function(e){y.spliceMonsters(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addTrait",value:function(e){y.addTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addRandomTrait",value:function(e,t){y.addRandomTrait(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"moveTrait",value:function(e,t){var a=this.state.monster.traits.indexOf(e),n=this.state.monster.traits.indexOf(t);y.moveTrait(this.state.monster,a,n),this.setState({monster:this.state.monster})}},{key:"removeTrait",value:function(e){y.removeTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"copyTrait",value:function(e){y.copyTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"changeTrait",value:function(e,t,a){e[t]=a,this.setState({monster:this.state.monster})}},{key:"nudgeValue",value:function(e,t){y.nudgeValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"changeValue",value:function(e,t){y.changeValue(this.state.monster,e,t),this.setState({monster:this.state.monster,showImageSelection:!1})}},{key:"changeFilterValue",value:function(e,t){var a=this.state.scratchpadFilter;"challenge"===e?(a.challengeMin=t[0],a.challengeMax=t[1]):a[e]=t,this.setState({scratchpadFilter:a})}},{key:"resetFilter",value:function(){this.setState({scratchpadFilter:k.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return O.matchMonster(e,this.state.scratchpadFilter)}},{key:"getHelpSection",value:function(e){switch(this.state.helpSection){case"speed":return this.getValueSection("speed","text",e);case"senses":return this.getValueSection("senses","text",e);case"languages":return this.getValueSection("languages","text",e);case"equipment":return this.getValueSection("equipment","text",e);case"str":return this.getValueSection("abilityScores.str","number",e);case"dex":return this.getValueSection("abilityScores.dex","number",e);case"con":return this.getValueSection("abilityScores.con","number",e);case"int":return this.getValueSection("abilityScores.int","number",e);case"wis":return this.getValueSection("abilityScores.wis","number",e);case"cha":return this.getValueSection("abilityScores.cha","number",e);case"saves":return this.getValueSection("savingThrows","text",e);case"skills":return this.getValueSection("skills","text",e);case"armor class":return this.getValueSection("ac","number",e);case"hit dice":return this.getValueSection("hitDice","number",e);case"resist":return this.getValueSection("damage.resist","text",e);case"vulnerable":return this.getValueSection("damage.vulnerable","text",e);case"immune":return this.getValueSection("damage.immune","text",e);case"conditions":return this.getValueSection("conditionImmunities","text",e);case"actions":return this.getActionsSection(e);default:return null}}},{key:"getValueSection",value:function(e,t,a){var n=this,s=a.map((function(a){var n=e.split("."),r=a,s=null;return n.forEach((function(e){e===n[n.length-1]?s=r[e]:r=r[e]})),"text"===t&&""===s&&(s=null),s})).filter((function(e){return null!==e})),i=[];if("number"===t){var o=null,c=null;if(s.forEach((function(e){(null===o||e<o)&&(o=e),(null===c||e>c)&&(c=e)})),null!==o&&null!==c)for(var l=o;l<=c;++l)i.push({value:l,count:0})}switch(s.forEach((function(e){var t=i.find((function(t){return t.value===e}));t?t.count+=1:i.push({value:e,count:1})})),t){case"number":E.sort(i,[{field:"value",dir:"asc"}]);break;case"text":E.sort(i,[{field:"count",dir:"desc"},{field:"value",dir:"asc"}])}"text"===t&&(0!==a.length-s.length&&i.push({value:"",count:a.length-s.length}));var u=i.map((function(t){var s=100*t.count/a.length;return r.a.createElement(d.a,{gutter:10,className:"value-list",key:i.indexOf(t)},r.a.createElement(p.a,{span:8,className:"text-container"},t.value||"(none specified)"),r.a.createElement(p.a,{span:8,className:"bar-container"},r.a.createElement("div",{className:"bar",style:{width:s+"%"}})),r.a.createElement(p.a,{span:8},r.a.createElement("button",{onClick:function(){return n.changeValue(e,t.value)}},"use this value")))}));return r.a.createElement("div",null,u,r.a.createElement("button",{onClick:function(){return n.setRandomValue(e,a)}},"select random value"))}},{key:"getActionsSection",value:function(e){var t=this,a=[];return a.push(r.a.createElement(d.a,{gutter:10,className:"value-list",key:"header"},r.a.createElement(p.a,{span:8,className:"text-container"},r.a.createElement("b",null,"type")),r.a.createElement(p.a,{span:4,className:"text-container number"},r.a.createElement("b",null,"avg")),r.a.createElement(p.a,{span:4,className:"text-container number"},r.a.createElement("b",null,"min - max")))),b.forEach((function(n){var s=null,i=null,o=0;e.forEach((function(e){var t=e.traits.filter((function(e){return e.type===n})).length;(null===s||t<s)&&(s=t),(null===i||t>i)&&(i=t),o+=t}));var c=Math.round(o/e.length);a.push(r.a.createElement(d.a,{gutter:10,className:"value-list",key:n},r.a.createElement(p.a,{span:8,className:0===o?"text-container disabled":"text-container"},E.traitType(n,!0)),r.a.createElement(p.a,{span:4,className:0===o?"text-container number disabled":"text-container number"},c),r.a.createElement(p.a,{span:4,className:0===o?"text-container number disabled":"text-container number"},s," - ",i),r.a.createElement(p.a,{span:8},r.a.createElement("button",{className:0===o?"disabled":"",onClick:function(){return t.addRandomTrait(n,e)}},"add random"))))})),r.a.createElement("div",null,a)}},{key:"getSidebar",value:function(){var e=this,t=null;if(this.props.showSidebar){var a=[];if(this.props.showSidebar)switch(this.state.sidebar){case"similar":a=this.getSimilarMonsters();break;case"all":this.props.library.forEach((function(t){t.monsters.forEach((function(t){!a.includes(t)&&e.matchMonster(t)&&a.push(t)}))}))}a=a.filter((function(t){return!e.state.scratchpadList.find((function(e){return e.id===t.id}))})),E.sort(a);var n=null;switch(this.state.sidebar){case"similar":n=r.a.createElement(W,{text:"similarity criteria"},r.a.createElement(M,{label:"size "+this.state.monster.size,checked:this.state.similarFilter.size,changeValue:function(t){return e.toggleMatch("size")}}),r.a.createElement(M,{label:"type "+this.state.monster.category,checked:this.state.similarFilter.type,changeValue:function(t){return e.toggleMatch("type")}}),r.a.createElement(M,{label:this.state.monster.tag?"subtype "+this.state.monster.tag:"subtype",checked:this.state.similarFilter.subtype,disabled:!this.state.monster.tag,changeValue:function(t){return e.toggleMatch("subtype")}}),r.a.createElement(M,{label:this.state.monster.alignment?"alignment "+this.state.monster.alignment:"alignment",checked:this.state.similarFilter.alignment,disabled:!this.state.monster.alignment,changeValue:function(t){return e.toggleMatch("alignment")}}),r.a.createElement(M,{label:"challenge rating "+E.challenge(this.state.monster.challenge),checked:this.state.similarFilter.challenge,changeValue:function(t){return e.toggleMatch("challenge")}}));break;case"all":n=r.a.createElement(de,{filter:this.state.scratchpadFilter,changeValue:function(t,a){return e.changeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}})}var s=null;0===this.state.scratchpadList.length&&(s=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"this is your ",r.a.createElement("b",null,"scratchpad")," list; you can add monsters to it from the list to the right"),r.a.createElement("div",{className:"section"},"you might find this useful if you're creating a monster and want it to have similar abilities to other monsters"),r.a.createElement("div",{className:"section"},"when there are monsters in this list, their combined stats will be shown on the left"),r.a.createElement("div",{className:"section"},"you can also quickly blend together all the monters in this list to create a new monster by clicking the ",r.a.createElement("b",null,"generate hybrid monster")," button above")));var i=null;0===a.length&&(i=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"there are no monsters in your library which match the above criteria (or they are all in your scratchpad already)"))),t=r.a.createElement(p.a,{span:12,className:"scrollable sidebar sidebar-right"},r.a.createElement(d.a,{gutter:5},r.a.createElement(p.a,{span:12},r.a.createElement(et,{options:[{id:"scratch",text:"scratchpad"}],selectedID:"scratch",select:function(){return null}}),r.a.createElement("button",{className:this.state.scratchpadList.length<2?"disabled":"",onClick:function(){return e.spliceMonsters(e.state.scratchpadList)}},"generate hybrid monster"),r.a.createElement("button",{className:0===a.length?"disabled":"",onClick:function(){return e.addAllToScratchpad(a)}},"add all from right"),r.a.createElement("button",{className:0===this.state.scratchpadList.length?"disabled":"",onClick:function(){return e.clearScratchpad()}},"clear scratchpad"),r.a.createElement("div",{className:"divider"}),this.getMonsterCards(this.state.scratchpadList,!0),s),r.a.createElement(p.a,{span:12},r.a.createElement(et,{options:[{id:"similar",text:"similar"},{id:"all",text:"all"}],selectedID:this.state.sidebar,select:function(t){return e.setState({sidebar:t})}}),n,r.a.createElement("div",{className:"divider"}),this.getMonsterCards(a,!1),i)))}else{var o=null,c=E.challengeDetails().find((function(t){return t.cr===e.state.monster.challenge}));c&&(o=r.a.createElement(W,{text:"suggested stats"},r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"challenge"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.cr))),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"armor class"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.ac))),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"hit points"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.hpMin," - ",c.hpMax))),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"attack bonus"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.attack))),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"damage / rnd"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.dmgMin," - ",c.dmgMax))),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(p.a,{span:16},"save dc"),r.a.createElement(p.a,{span:8,className:"statistic-value"},c.save))))),t=r.a.createElement(p.a,{span:12,className:"scrollable sidebar sidebar-right",style:{padding:"5px"}},o,o?r.a.createElement("div",{className:"divider"}):null,r.a.createElement(ce,{monster:this.state.monster}))}return t}},{key:"getMonsterCards",value:function(e,t){var a=this;return E.sort(e).map((function(e){return r.a.createElement("div",{className:"section",key:e.id},r.a.createElement(ce,{monster:e,mode:"template "+a.state.page+(t?" selected":""),copyTrait:function(e){return a.copyTrait(e)},selectMonster:function(e){return a.addToScratchpad(e)},deselectMonster:function(e){return a.removeFromScratchpad(e)}}))})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.page){case"overview":t=r.a.createElement(nt,{monster:this.state.monster,toggleImageSelection:function(){return e.toggleImageSelection()},changeValue:function(t,a){return e.changeValue(t,a)},nudgeValue:function(t,a){return e.nudgeValue(t,a)}});break;case"abilities":t=r.a.createElement(rt,{monster:this.state.monster,changeValue:function(t,a){return e.changeValue(t,a)},nudgeValue:function(t,a){return e.nudgeValue(t,a)}});break;case"cbt-stats":t=r.a.createElement(st,{monster:this.state.monster,changeValue:function(t,a){return e.changeValue(t,a)},nudgeValue:function(t,a){return e.nudgeValue(t,a)}});break;case"actions":t=r.a.createElement(it,{monster:this.state.monster,addTrait:function(t){return e.addTrait(t)},moveTrait:function(t,a){return e.moveTrait(t,a)},removeTrait:function(t){return e.removeTrait(t)},changeValue:function(t,a,n){return e.changeTrait(t,a,n)}})}var a=null;if(this.props.showSidebar&&this.state.scratchpadList.length>0){var n=null;if(this.getHelpOptionsForPage(this.state.page).length>1){var s=this.getHelpOptionsForPage(this.state.page).map((function(e){return{id:e,text:e}}));n=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"fields"),r.a.createElement(le,{options:s,selectedID:this.state.helpSection,select:function(t){return e.setHelpSection(t)}}),r.a.createElement("div",{className:"subheading"},"values"))}a=r.a.createElement("div",{className:"monster-help group-panel"},r.a.createElement("div",{className:"heading"},"information from scratchpad monsters"),n,this.getHelpSection(this.state.scratchpadList))}return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(et,{options:[{id:"overview",text:"overview"},{id:"abilities",text:"abilities"},{id:"cbt-stats",text:"combat"},{id:"actions",text:"actions"}],selectedID:this.state.page,select:function(t){return e.setPage(t)}}),t,a),this.getSidebar(),r.a.createElement(h.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Xe,{select:function(t){return e.changeValue("portrait",t)},cancel:function(){return e.toggleImageSelection()}})))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),nt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"randomName",value:function(){var e=$e.generateName();e=e[0].toUpperCase()+e.substr(1),this.props.changeValue("name",e)}},{key:"render",value:function(){var e=this;try{var t=g.map((function(e){return{id:e,text:e}}));return r.a.createElement(d.a,{gutter:10,key:"overview"},r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"name"),r.a.createElement(X,{text:this.props.monster.name,onChange:function(t){return e.props.changeValue("name",t)}}),r.a.createElement("button",{onClick:function(){return e.randomName()}},"generate a random name"),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(J,{source:this.props.monster,name:"size",nudgeValue:function(t){return e.props.nudgeValue("size",t)}}),r.a.createElement("div",{className:"subheading"},"type"),r.a.createElement(R,{options:t,selectedID:this.props.monster.category,select:function(t){return e.props.changeValue("category",t)}}),r.a.createElement("div",{className:"subheading"},"subtype"),r.a.createElement(X,{text:this.props.monster.tag,onChange:function(t){return e.props.changeValue("tag",t)}}),r.a.createElement("div",{className:"subheading"},"alignment"),r.a.createElement(X,{text:this.props.monster.alignment,onChange:function(t){return e.props.changeValue("alignment",t)}}),r.a.createElement("div",{className:"subheading"},"challenge rating"),r.a.createElement(J,{source:this.props.monster,name:"challenge",display:function(e){return E.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challenge",t)}})),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"speed"),r.a.createElement(X,{text:this.props.monster.speed,onChange:function(t){return e.props.changeValue("speed",t)}}),r.a.createElement("div",{className:"subheading"},"senses"),r.a.createElement(X,{text:this.props.monster.senses,onChange:function(t){return e.props.changeValue("senses",t)}}),r.a.createElement("div",{className:"subheading"},"languages"),r.a.createElement(X,{text:this.props.monster.languages,onChange:function(t){return e.props.changeValue("languages",t)}}),r.a.createElement("div",{className:"subheading"},"equipment"),r.a.createElement(X,{text:this.props.monster.equipment,onChange:function(t){return e.props.changeValue("equipment",t)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(Q,{source:this.props.monster,edit:function(){return e.props.toggleImageSelection()},clear:function(){return e.props.changeValue("portrait","")}})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),rt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{gutter:10,key:"abilities"},r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"ability scores"),r.a.createElement(K,{edit:!0,combatant:this.props.monster,nudgeValue:function(t,a,n){return e.props.nudgeValue(a,n)}})),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"saving throws"),r.a.createElement(X,{text:this.props.monster.savingThrows,onChange:function(t){return e.props.changeValue("savingThrows",t)}}),r.a.createElement("div",{className:"subheading"},"skills"),r.a.createElement(X,{text:this.props.monster.skills,onChange:function(t){return e.props.changeValue("skills",t)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),st=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{gutter:10,key:"cbt-stats"},r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"armor class"),r.a.createElement(J,{source:this.props.monster,name:"ac",nudgeValue:function(t){return e.props.nudgeValue("ac",t)}}),r.a.createElement("div",{className:"subheading"},"hit dice"),r.a.createElement(J,{source:this.props.monster,name:"hitDice",display:function(t){return t+"d"+E.hitDieType(e.props.monster.size)},nudgeValue:function(t){return e.props.nudgeValue("hitDice",t)}}),r.a.createElement("div",{className:"subheading"},"hit points"),r.a.createElement("div",{className:"hp-value"},y.getTypicalHP(this.props.monster)," hp"),r.a.createElement("div",{className:"subheading"},"legendary actions"),r.a.createElement(J,{source:this.props.monster,name:"legendaryActions",nudgeValue:function(t){return e.props.nudgeValue("legendaryActions",t)}})),r.a.createElement(p.a,{xs:24,sm:24,md:24,lg:12,xl:12},r.a.createElement("div",{className:"subheading"},"damage resistances"),r.a.createElement(X,{text:this.props.monster.damage.resist,onChange:function(t){return e.props.changeValue("damage.resist",t)}}),r.a.createElement("div",{className:"subheading"},"damage vulnerabilities"),r.a.createElement(X,{text:this.props.monster.damage.vulnerable,onChange:function(t){return e.props.changeValue("damage.vulnerable",t)}}),r.a.createElement("div",{className:"subheading"},"damage immunities"),r.a.createElement(X,{text:this.props.monster.damage.immune,onChange:function(t){return e.props.changeValue("damage.immune",t)}}),r.a.createElement("div",{className:"subheading"},"condition immunities"),r.a.createElement(X,{text:this.props.monster.conditionImmunities,onChange:function(t){return e.props.changeValue("conditionImmunities",t)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),it=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={selectedTraitID:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSelectedTraitID",value:function(e){this.setState({selectedTraitID:e})}},{key:"createTraitBar",value:function(e){var t=this;return r.a.createElement(ot,{key:e.id,trait:e,isSelected:e.id===this.state.selectedTraitID,select:function(e){return t.setSelectedTraitID(e)}})}},{key:"moveTrait",value:function(e,t){this.props.moveTrait(e,t)}},{key:"createSection",value:function(e,t){var a=this,n=e[t];return r.a.createElement("div",null,r.a.createElement("div",{className:"section subheading"},E.traitType(t,!0)),r.a.createElement(Qe.List,{values:n,lockVertically:!0,onChange:function(e){var t=e.oldIndex,r=e.newIndex;return a.moveTrait(n[t],n[r])},renderList:function(e){var t=e.children,a=e.props;return r.a.createElement("div",a,t)},renderItem:function(e){var t=e.value,n=e.props,s=e.isDragged;return r.a.createElement("div",Object.assign({},n,{className:s?"dragged":""}),a.createTraitBar(t))}}),r.a.createElement("button",{onClick:function(){return a.props.addTrait(t)}},"add a new ",t))}},{key:"render",value:function(){var e=this;try{var t=[],a={};b.forEach((function(n){t.push({id:n,text:E.traitType(n,!1)}),a[n]=e.props.monster.traits.filter((function(e){return e.type===n}))}));var n=this.props.monster.traits.find((function(t){return t.id===e.state.selectedTraitID})),s=null;return s=n?r.a.createElement(ct,{trait:n,removeTrait:function(t){return e.props.removeTrait(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}):r.a.createElement(ne,null,"select one of the traits or actions from the column to the left to edit its details here"),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:10},this.createSection(a,"trait"),this.createSection(a,"action"),this.createSection(a,"bonus"),this.createSection(a,"reaction"),this.createSection(a,"legendary"),this.createSection(a,"lair")),r.a.createElement(p.a,{span:14},s))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);it.defaultProps={addTrait:null,copyTrait:null,removeTrait:null,changeValue:null,swapTraits:null};var ot=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.props.isSelected?"trait-bar selected":"trait-bar",onClick:function(){return e.props.select(e.props.trait.id)}},r.a.createElement(Ze.a,{className:"grabber small","data-movable-handle":!0}),r.a.createElement("div",{className:"name"},this.props.trait.name||"unnamed "+E.traitType(this.props.trait.type,!1)))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ct=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{key:this.props.trait.id,className:"section"},r.a.createElement("div",{className:"subheading"},"trait name"),r.a.createElement(X,{text:this.props.trait.name,onChange:function(t){return e.props.changeValue(e.props.trait,"name",t)}}),r.a.createElement("div",{className:"subheading"},"usage"),r.a.createElement(X,{text:this.props.trait.usage,onChange:function(t){return e.props.changeValue(e.props.trait,"usage",t)}}),r.a.createElement("div",{className:"subheading"},"details"),r.a.createElement(X,{text:this.props.trait.text,placeholder:"details",minLines:10,maxLines:20,onChange:function(t){return e.props.changeValue(e.props.trait,"text",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.removeTrait(e.props.trait)}},"remove this trait"))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),lt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:"",monster:e.monster},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){y.import(this.state.source,this.state.monster),this.setState({monster:this.state.monster})}},{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(ne,null,r.a.createElement("div",null,"go to the following link to find the monster you want to import"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.dndbeyond.com/monsters",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/monsters")),r.a.createElement("div",null,"then right-click on the page and select ",r.a.createElement("b",null,"view page source")),r.a.createElement("div",null,"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(X,{text:this.state.source,placeholder:"paste page source here",minLines:10,maxLines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(p.a,{span:12,className:"scrollable",style:{padding:"5px"}},r.a.createElement(ce,{monster:this.state.monster})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ut=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"importParty",value:function(t,a){a.name="",a.pcs=[];var n=(new DOMParser).parseFromString(t,"text/html");try{a.name=n.getElementsByClassName("page-title")[0].innerText.trim()}catch(u){console.error(u)}try{for(var r=n.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-active")[0].getElementsByClassName("ddb-campaigns-character-card"),s=0;s!==r.length;++s){var i=r[s];a.pcs.push(e.getCharacter(i,!0))}}catch(u){console.error(u)}try{for(var o=n.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-inactive")[0].getElementsByClassName("ddb-campaigns-character-card"),c=0;c!==o.length;++c){var l=o[c];a.pcs.push(e.getCharacter(l,!1))}}catch(u){console.error(u)}}},{key:"getCharacter",value:function(e,t){var a=k.createPC();a.name=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-primary")[0].innerText.trim(),a.player=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[1].innerText.trim().substring(8),a.active=t;var n=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[0].innerText.trim().split("|");a.level=Number.parseInt(n[0].substring(4).trim(),10),a.race=n[1].trim(),a.classes=n[2].trim();var r=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-details-link")[0];return a.url="https://www.dndbeyond.com"+r.getAttribute("href"),a}},{key:"importPC",value:function(e,t){try{var a=JSON.parse(e);t.name=a.character.name,t.size=a.character.race.size,t.race=a.character.race.fullName;var n=0,r="";a.character.classes.forEach((function(e){n+=e.level,""!==r&&(r+=" / "),r+=e.definition.name,e.subclassDefinition&&(r+=" ("+e.subclassDefinition.name+")")})),t.classes=r,t.level=n;var s=[].concat(a.character.modifiers.race).concat(a.character.modifiers.class).concat(a.character.modifiers.background).concat(a.character.modifiers.item).concat(a.character.modifiers.feat).concat(a.character.modifiers.condition),i=s.filter((function(e){return"language"===e.type})).map((function(e){return e.friendlySubtypeName}));t.languages=i.join(", ");var o=E.proficiency(n),c=a.character.stats[3].value,l=a.character.stats[4].value;s.filter((function(e){return"bonus"===e.type&&"intelligence-score"===e.subType})).forEach((function(e){return c+=e.value})),s.filter((function(e){return"bonus"===e.type&&"wisdom-score"===e.subType})).forEach((function(e){return l+=e.value}));var u=0,m=0,d=0,p=s.filter((function(e){return"insight"===e.subType||"wisdom-ability-checks"===e.subType})).map((function(e){return e.type}));p.includes("expertise")?u=2:p.includes("proficiency")?u=1:p.includes("half-proficiency-round-up")&&(u=.5);var h=s.filter((function(e){return"investigation"===e.subType||"intelligence-ability-checks"===e.subType})).map((function(e){return e.type}));h.includes("expertise")?m=2:h.includes("proficiency")?m=1:p.includes("half-proficiency-round-up")&&(m=.5);var f=s.filter((function(e){return"perception"===e.subType||"wisdom-ability-checks"===e.subType})).map((function(e){return e.type}));f.includes("expertise")?d=2:f.includes("proficiency")?d=1:p.includes("half-proficiency-round-up")&&(d=.5),t.passiveInsight=10+E.modifierValue(l)+Math.floor(o*u),t.passiveInvestigation=10+E.modifierValue(c)+Math.floor(o*m),t.passivePerception=10+E.modifierValue(l)+Math.floor(o*d),t.companions=[],a.character.creatures.forEach((function(e){var a=k.createCompanion();a.name=e.name,t.companions.push(a)}))}catch(v){console.error(v)}}}]),e}(),mt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];-1!==this.props.mode.indexOf("edit")&&(t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editPC(e.props.pc)}},"edit pc")),this.props.pc.url&&t.push(r.a.createElement("button",{key:"import",onClick:function(){return e.props.importPC(e.props.pc)}},"update pc from d&d beyond")),this.props.pc.active?t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.pc,"active",!1)}},"mark pc as inactive")):t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.pc,"active",!0)}},"mark pc as active")),t.push(r.a.createElement(j,{key:"remove",text:"delete pc",callback:function(){return e.props.removePC(e.props.pc)}})));var a=null;this.props.pc.companions.length>0&&(a=this.props.pc.companions.map((function(e){return r.a.createElement("div",{key:e.id},e.name)})));var n=(this.props.pc?this.props.pc.displayName:null)||this.props.pc.name||"unnamed pc";return r.a.createElement("div",{className:"card pc"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},n)),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"stats"},r.a.createElement(Q,{source:this.props.pc}),r.a.createElement("div",{className:"section centered lowercase"},r.a.createElement(z.a,null,this.props.pc.race||"unknown race"),r.a.createElement(z.a,null,this.props.pc.classes||"unknown class"),r.a.createElement(z.a,null,"level "+this.props.pc.level)),r.a.createElement("div",{className:"section centered",style:{display:this.props.pc.url?"":"none"}},r.a.createElement("a",{href:this.props.pc.url,target:"_blank",rel:"noopener noreferrer"},"d&d beyond sheet")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section subheading"},"languages"),r.a.createElement("div",{className:"section"},this.props.pc.languages||"-"),r.a.createElement("div",{className:"section subheading"},"passive skills"),r.a.createElement("div",{className:"section"},r.a.createElement("div",null,r.a.createElement("b",null,"insight")," ",this.props.pc.passiveInsight),r.a.createElement("div",null,r.a.createElement("b",null,"investigation")," ",this.props.pc.passiveInvestigation),r.a.createElement("div",null,r.a.createElement("b",null,"perception")," ",this.props.pc.passivePerception))),r.a.createElement("div",{style:{display:this.props.pc.companions.length>0?"":"none"}},r.a.createElement("div",{className:"section subheading"},"companions"),r.a.createElement("div",{className:"section"},a)),r.a.createElement("div",{style:{display:t.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},t))))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);mt.defaultProps={changeValue:null,nudgeValue:null,removePC:null,editPC:null,importPC:null};var dt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:"",party:e.party},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){ut.importParty(this.state.source,this.state.party),this.setState({party:this.state.party})}},{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(ne,null,r.a.createElement("div",null,"go to the following link to find the party you want to import"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.dndbeyond.com/my-campaigns",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/my-campaigns")),r.a.createElement("div",null,"then right-click on the page and select ",r.a.createElement("b",null,"view page source")),r.a.createElement("div",null,"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(X,{text:this.state.source,placeholder:"paste page source here",minLines:10,maxLines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(Be,{heading:this.props.party.name,columns:1,content:this.props.party.pcs.map((function(e){return r.a.createElement(mt,{key:e.id,pc:e,mode:"view"})}))})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),pt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pc:e.pc,showImageSelection:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addCompanion",value:function(){var e=k.createCompanion();e.name="new companion",this.state.pc.companions.push(e),this.setState({pc:this.state.pc})}},{key:"removeCompanion",value:function(e){var t=this.state.pc;t.companions=this.state.pc.companions.filter((function(t){return t.id!==e})),this.setState({pc:t})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({pc:this.state.pc,showImageSelection:!1})}},{key:"nudgeValue",value:function(e,t,a){var n,r=e[t];switch(t){case"size":n=E.nudgeSize(r,a);break;default:n=(r||0)+a}this.changeValue(e,t,n)}},{key:"render",value:function(){var e=this;try{var t=this.state.pc.companions.map((function(t){return r.a.createElement(d.a,{gutter:10,className:"companion",key:t.id},r.a.createElement(p.a,{span:16},r.a.createElement(X,{text:t.name,onChange:function(a){return e.changeValue(t,"name",a)}})),r.a.createElement(p.a,{span:8},r.a.createElement("button",{onClick:function(){return e.removeCompanion(t.id)}},"delete")))}));return 0===t.length&&t.push(r.a.createElement("div",{className:"section",key:"empty"},r.a.createElement("i",null,"no companions (pets, retainers, mounts, etc)"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"character name:"),r.a.createElement(X,{text:this.state.pc.name,onChange:function(t){return e.changeValue(e.state.pc,"name",t)}}),r.a.createElement("div",{className:"subheading"},"player name:"),r.a.createElement(X,{text:this.state.pc.player,onChange:function(t){return e.changeValue(e.state.pc,"player",t)}}),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(J,{source:this.state.pc,name:"size",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"size",t)}}),r.a.createElement("div",{className:"subheading"},"race:"),r.a.createElement(X,{text:this.state.pc.race,onChange:function(t){return e.changeValue(e.state.pc,"race",t)}}),r.a.createElement("div",{className:"subheading"},"class:"),r.a.createElement(X,{text:this.state.pc.classes,onChange:function(t){return e.changeValue(e.state.pc,"classes",t)}}),r.a.createElement("div",{className:"subheading"},"level:"),r.a.createElement(J,{source:this.state.pc,name:"level",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"level",t)}}),r.a.createElement("div",{className:"subheading"},"passive skills"),r.a.createElement(J,{source:this.state.pc,name:"passiveInsight",label:"insight",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInsight",t)}}),r.a.createElement(J,{source:this.state.pc,name:"passiveInvestigation",label:"investigation",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInvestigation",t)}}),r.a.createElement(J,{source:this.state.pc,name:"passivePerception",label:"perception",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passivePerception",t)}})),r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"languages:"),r.a.createElement(X,{text:this.state.pc.languages,onChange:function(t){return e.changeValue(e.state.pc,"languages",t)}}),r.a.createElement("div",{className:"subheading"},"d&d beyond link:"),r.a.createElement(X,{text:this.state.pc.url,placeholder:"https://ddb.ac/characters/...",onChange:function(t){return e.changeValue(e.state.pc,"url",t)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(Q,{source:this.state.pc,edit:function(){return e.toggleImageSelection()},clear:function(){return e.changeValue(e.state.pc,"portrait","")}}),r.a.createElement("div",{className:"subheading"},"companions:"),t,r.a.createElement("button",{onClick:function(){return e.addCompanion()}},"add a new companion")),r.a.createElement(h.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Xe,{select:function(t){return e.changeValue(e.state.pc,"portrait",t)},cancel:function(){return e.toggleImageSelection()}})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ht=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:"",pc:e.pc},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){ut.importPC(this.state.source,this.state.pc),this.setState({pc:this.state.pc})}},{key:"render",value:function(){var e=this;try{var t=this.state.pc.url;return t.endsWith("/")||(t+="/"),t+="json",r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(ne,null,r.a.createElement("div",null,"go to the following link"),r.a.createElement("div",null,r.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},t)),r.a.createElement("div",null,"copy the data into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(X,{text:this.state.source,placeholder:"paste data here",minLines:10,maxLines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(p.a,{span:12,className:"scrollable"},r.a.createElement(mt,{pc:this.state.pc,mode:"view"})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ft=a(18),vt=a.n(ft),gt=a(27),bt=a(251),yt=a(234),Et=new ae.a.Converter;Et.setOption("tables",!0);var kt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(gt.a)(vt.a.mark((function e(){var t,a;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/dojo/data/actions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(yt.a,{spinning:null===this.state.source,indicator:r.a.createElement(bt.a,{style:{fontSize:20,marginTop:100}})},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Et.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Nt=new ae.a.Converter;Nt.setOption("tables",!0);var wt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(gt.a)(vt.a.mark((function e(){var t,a;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/dojo/data/conditions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(yt.a,{spinning:null===this.state.source,indicator:r.a.createElement(bt.a,{style:{fontSize:20,marginTop:100}})},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Nt.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),xt=new ae.a.Converter;xt.setOption("tables",!0);var Ct=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(gt.a)(vt.a.mark((function e(){var t,a;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/dojo/data/skills.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(yt.a,{spinning:null===this.state.source,indicator:r.a.createElement(bt.a,{style:{fontSize:20,marginTop:100}})},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:xt.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),St=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"skills"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"skills":t=r.a.createElement(Ct,null);break;case"conditions":t=r.a.createElement(wt,null);break;case"actions":t=r.a.createElement(kt,null)}return r.a.createElement("div",{className:"tools scrollable",style:{padding:"10px"}},r.a.createElement(le,{options:[{id:"skills",text:"skills"},{id:"conditions",text:"conditions"},{id:"actions",text:"actions"}],selectedID:this.state.view,itemsPerRow:3,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).allowSearch=E.debounce((function(){a.setState({canSearch:!0})})),a.state={text:"",canSearch:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSearchTerm",value:function(e){var t=this;this.setState({text:e,canSearch:!1},(function(){return t.allowSearch()}))}},{key:"render",value:function(){var e=this;try{var t=[];return this.state.canSearch?this.state.text.length>2?(this.props.parties.filter((function(t){return S.matchParty(e.state.text,t)})).forEach((function(a){var n=[];a.pcs.filter((function(t){return S.matchPC(e.state.text,t)})).forEach((function(t){var a=[];t.companions.filter((function(t){return S.matchCompanion(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.name)))})),n.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openParty(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),this.props.library.filter((function(t){return S.matchGroup(e.state.text,t)})).forEach((function(a){var n=[];a.monsters.filter((function(t){return S.matchMonster(e.state.text,t)})).forEach((function(t){var a=[];t.traits.filter((function(t){return S.matchTrait(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.name)))})),n.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openGroup(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),this.props.encounters.filter((function(t){return S.matchEncounter(e.state.text,t)})).forEach((function(a){var n=[];a.slots.filter((function(t){return S.matchEncounterSlot(e.state.text,t)})).forEach((function(e){n.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.monsterName)))}));var s=[];a.waves.filter((function(t){return S.matchEncounterWave(e.state.text,t)})).forEach((function(t){var a=[];t.slots.filter((function(t){return S.matchEncounterSlot(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.monsterName)))})),s.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openEncounter(a.id)}},r.a.createElement("div",{className:"section"},a.name),n,s))})),this.props.maps.filter((function(t){return S.matchMap(e.state.text,t)})).forEach((function(a){var n=[];a.notes.filter((function(t){return S.matchMapNote(e.state.text,t)})).forEach((function(e){n.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},"map note")))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openMap(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),0===t.length&&t.push(r.a.createElement(ne,{key:"empty"},"nothing found"))):t.push(r.a.createElement(ne,{key:"empty"},"enter your search term above")):t.push(r.a.createElement(ne,{key:"pending"},"searching...")),r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement(_.a.Search,{placeholder:"search",allowClear:!0,onChange:function(t){return e.setSearchTerm(t.target.value)},onSearch:function(t){return e.setSearchTerm(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Mt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;switch(this.props.source.type){case"pc":e=r.a.createElement(mt,{pc:this.props.source,mode:"view"});break;case"monster":e=r.a.createElement(ce,{monster:this.props.source,mode:"full"})}return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},e)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),jt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={values:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){for(var e=[];e.length<10;){var t=$e.generateBookTitle();e.includes(t)||e.push(t)}e.sort(),this.setState({values:e})}},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.values.length;++a)t.push(r.a.createElement("div",{key:a,className:"section large"},this.state.values[a].toLowerCase()));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"book titles"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),t)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),It=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={dice:"20",count:1,options:[],rolls:null,result:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setDice",value:function(e){this.setState({dice:e})}},{key:"nudgeCount",value:function(e){this.setState({count:Math.max(1,this.state.count+e)})}},{key:"toggleOption",value:function(e){if(this.state.options.includes(e)){var t=this.state.options.indexOf(e);this.state.options.splice(t,1)}else if(this.state.options.push(e),this.state.options.includes("advantage")&&this.state.options.includes("disadvantage")){var a=this.state.options.indexOf("advantage"===e?"disadvantage":"advantage");this.state.options.splice(a,1)}this.setState({options:this.state.options})}},{key:"roll",value:function(){var e=parseInt(this.state.dice,10),t=[],a=this.state.count;(this.state.options.includes("advantage")||this.state.options.includes("disadvantage"))&&(a=2);for(var n=0;n!==a;++n)t.push(E.dieRoll(e));t.sort((function(e,t){return e-t}));var r=0;1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("advantage")?r=Math.max.apply(Math,t):1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("disadvantage")?r=Math.min.apply(Math,t):(t.forEach((function(e){return r+=e})),this.state.count>1&&this.state.options.includes("drop lowest")&&(r-=Math.min.apply(Math,t)),this.state.count>1&&this.state.options.includes("drop highest")&&(r-=Math.max.apply(Math,t))),this.setState({rolls:t,result:r})}},{key:"render",value:function(){var e=this;try{var t=null;"20"===this.state.dice&&1===this.state.count?t=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement(M,{label:"advantage",checked:this.state.options.includes("advantage"),changeValue:function(t){return e.toggleOption("advantage")}})),r.a.createElement(p.a,{span:12},r.a.createElement(M,{label:"disadvantage",checked:this.state.options.includes("disadvantage"),changeValue:function(t){return e.toggleOption("disadvantage")}}))):this.state.count>1&&(t=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement(M,{label:"drop lowest",checked:this.state.options.includes("drop lowest"),changeValue:function(t){return e.toggleOption("drop lowest")}})),r.a.createElement(p.a,{span:12},r.a.createElement(M,{label:"drop highest",checked:this.state.options.includes("drop highest"),changeValue:function(t){return e.toggleOption("drop highest")}}))));var a=null;null!==this.state.rolls&&this.state.rolls.length>1&&(a=r.a.createElement("div",{className:"section die-rolls"},this.state.rolls.join(", ")));var n=null;return null!==this.state.result&&(n=r.a.createElement("div",{className:"section die-result"},this.state.result)),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"die type"),r.a.createElement(le,{options:[{id:"4",text:"d4"},{id:"6",text:"d6"},{id:"8",text:"d8"},{id:"10",text:"d10"},{id:"12",text:"d12"},{id:"20",text:"d20"},{id:"100",text:"d100"}],selectedID:this.state.dice,select:function(t){return e.setDice(t)}}),r.a.createElement("div",{className:"subheading"},"number of dice to roll"),r.a.createElement(J,{source:this.state,name:"count",display:function(t){return t+"d"+e.state.dice},nudgeValue:function(t){return e.nudgeCount(t)}}),t?r.a.createElement("div",{className:"subheading"},"options"):null,t,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.roll()}},"roll dice"),a,n)}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Tt=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"say",value:function(){var t=Object(gt.a)(vt.a.mark((function t(a,n){var r;return vt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.speechSynthesis.cancel(),r=new SpeechSynthesisUtterance(a),t.next=4,e.chooseVoice(n);case 4:r.voice=t.sent,r.rate=e.randomValue(.5,1.5),r.pitch=e.randomValue(.5,1.5),window.speechSynthesis.speak(r);case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"chooseVoice",value:function(){var t=Object(gt.a)(vt.a.mark((function t(a){var n,r,s,i;return vt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getVoices();case 2:return n=t.sent,r=a.map((function(t){return e.getLanguageCode(t)})),0===(s=n.filter((function(e){return r.includes(e.lang.substr(0,2))}))).length&&(s=n.filter((function(e){return e.default}))),0===s.length&&(s=n),i=Math.floor(Math.random()*s.length),t.abrupt("return",s[i]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getVoices",value:function(){return new Promise((function(e){var t=window.speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=function(){t=window.speechSynthesis.getVoices(),e(t)}}))}},{key:"getLanguageCode",value:function(e){switch(e){case"armenian":return"hy";case"basque":return"eu";case"bulgarian":return"bg";case"chichewa":return"ny";case"chinese":return"zh";case"croatian":return"hr";case"czech":return"cs";case"dutch":return"nl";case"german":return"de";case"greek":return"el";case"icelandic":return"is";case"irish":return"ga";case"kannada":return"kn";case"kazakh":return"kk";case"latvian":return"lv";case"lithuanian":return"lt";case"macedonian":return"mk";case"malay":return"ms";case"maltese":return"mt";case"maori":return"mi";case"polish":return"pl";case"portuguese":return"pt";case"punjabi":return"pa";case"samoan":return"sm";case"serbian":return"sr";case"shona":return"sn";case"spanish":return"es";case"swedish":return"sv";case"turkish":return"tr";case"welsh":return"cy";default:return e.substr(0,2)}}},{key:"randomValue",value:function(e,t){return e+(Math.random()+Math.random()+Math.random())/3*(t-e)}}]),e}(),Dt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={sources:{},output:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLanguages",value:function(){return["afrikaans","amharic","armenian","basque","belarusian","bulgarian","chichewa","chinese","croatian","czech","danish","dutch","english","finnish","french","german","greek","hawaiian","hindi","hungarian","icelandic","irish","italian","japanese","kannada","kazakh","korean","kyrgyz","latvian","lithuanian","macedonian","malay","maltese","maori","myanmar","nepali","norwegian","polish","portuguese","punjabi","romanian","russian","samoan","serbian","shona","somali","spanish","swahili","swedish","thai","turkish","welsh","yiddish","zulu"]}},{key:"getPresets",value:function(){return[{name:"draconic",languages:["armenian","irish","maltese"]},{name:"dwarvish",languages:["czech","german","yiddish"]},{name:"elvish",languages:["finnish","spanish","welsh"]},{name:"goblin",languages:["hawaiian","kyrgyz","somali"]},{name:"orc",languages:["macedonian","russian","turkish"]}]}},{key:"addLanguage",value:function(){var e=Object(gt.a)(vt.a.mark((function e(t){var a;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/dojo/data/langs/"+t+".txt");case 2:return a=e.sent,e.next=5,a.text();case 5:this.state.sources[t]=e.sent,this.setState({sources:this.state.sources});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeLanguage",value:function(e){delete this.state.sources[e],this.setState({sources:this.state.sources})}},{key:"usePreset",value:function(e){var t=this,a=this.getPresets().find((function(t){return t.name===e}));a&&this.setState({sources:{},output:[]},(function(){a.languages.forEach((function(e){t.addLanguage(e)}))}))}},{key:"random",value:function(){for(var e=this,t=this.getLanguages(),a=[];3!==a.length;){var n=t[Math.floor(Math.random()*t.length)];a.includes(n)||a.push(n)}this.setState({sources:{},output:[]},(function(){a.forEach((function(t){e.addLanguage(t)}))}))}},{key:"generate",value:function(){var e=this,t=[];Object.keys(this.state.sources).forEach((function(a){var n=e.state.sources[a];t.push(n)})),$e.initModel(t),this.setState({output:$e.generate(5).map((function(e){return e.line}))})}},{key:"reset",value:function(){this.setState({sources:{},output:[]})}},{key:"render",value:function(){var e=this;try{var t=this.getPresets().map((function(e){return{id:e.name,text:e.name}})),a="";this.getPresets().forEach((function(t){Object.keys(e.state.sources).sort().join(", ")===t.languages.sort().join(", ")&&(a=t.name)}));var n=Object.keys(this.state.sources).sort().join(", ");""===n&&(n="none");var s=this.getLanguages().map((function(t){var a=Object.keys(e.state.sources).includes(t);return r.a.createElement(M,{key:t,label:t,checked:a,changeValue:function(a){return a?e.addLanguage(t):e.removeLanguage(t)}})})),i=Object.keys(this.state.sources).length>0,o=i||this.state.output.length>0,c=[];this.state.output.length>0&&c.push(r.a.createElement("div",{key:"div",className:"divider"}));for(var l=0;l!==this.state.output.length;++l)c.push(r.a.createElement(Vt,{key:l,text:this.state.output[l],languages:Object.keys(this.state.sources)}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"presets"),r.a.createElement(le,{options:t,selectedID:a,select:function(t){return e.usePreset(t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement(W,{text:"selected languages: "+n},r.a.createElement(Be,{content:s})),r.a.createElement("div",{className:"divider"}),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:8},r.a.createElement("button",{className:i?"":"disabled",onClick:function(){return e.generate()}},"generate text")),r.a.createElement(p.a,{span:8},r.a.createElement("button",{className:o?"":"disabled",onClick:function(){return e.reset()}},"reset")),r.a.createElement(p.a,{span:8},r.a.createElement("button",{onClick:function(){return e.random()}},"random sources"))),r.a.createElement("div",{className:"language-output"},c))}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Vt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"copy",value:function(e){e.preventDefault(),navigator.clipboard.writeText(this.props.text)}},{key:"say",value:function(e){e.preventDefault(),Tt.say(this.props.text,this.props.languages)}},{key:"render",value:function(){var e=this;try{return r.a.createElement(W,{text:this.props.text.toLowerCase()},r.a.createElement("button",{onClick:function(t){return e.copy(t)}},"copy to clipboard"),r.a.createElement("button",{onClick:function(t){return e.say(t)}},"say"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"note:")," speech may not work consistently on all platforms"))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),At=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={values:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){for(var e=[];e.length<10;){var t=$e.generateName();e.includes(t)||e.push(t)}e.sort(),this.setState({values:e})}},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.values.length;++a)t.push(r.a.createElement("div",{key:a,className:"section large"},this.state.values[a].toLowerCase()));return r.a.createElement("div",{className:"name-output"},r.a.createElement("div",{className:"subheading"},"names"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),t)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Pt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={description:$e.generateNPC(),physical:$e.generateNPCPhysical(),mental:$e.generateNPCMental(),speech:$e.generateNPCSpeech()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){this.setState({description:$e.generateNPC(),physical:$e.generateNPCPhysical(),mental:$e.generateNPCMental(),speech:$e.generateNPCSpeech()})}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"npc description"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),r.a.createElement("div",{className:"section large"},this.state.description),this.state.physical?r.a.createElement("div",{className:"section large"},"physical: ",this.state.physical):null,this.state.mental?r.a.createElement("div",{className:"section large"},"personality: ",this.state.mental):null,this.state.speech?r.a.createElement("div",{className:"section large"},"speech: ",this.state.speech):null)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),zt=function(e){function t(e){var a;Object(o.a)(this,t);var n=[(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).createCard("ace of swords","breakthrough, clarity, sharp mind","confusion, brutality, chaos"),a.createCard("two of swords","difficult choices, indecision, stalemate","lesser of two evils, no right choice, confusion"),a.createCard("three of swords","heartbreak, suffering, grief","recovery, forgiveness, moving on"),a.createCard("four of swords","rest, restoration, contemplation","restlessness, burnout, stress"),a.createCard("five of swords","unbridled ambition, win at all costs, sneakiness","lingering resentment, desire to reconcile, forgiveness"),a.createCard("six of swords","transition, leaving behind, moving on","emotional baggage, unresolved issues, resisting transition"),a.createCard("seven of swords","deception, trickery, tactics and strategy","coming clean, rethinking approach, deception"),a.createCard("eight of swords","imprisonment, entrapment, self-victimization","self acceptance, new perspective, freedom"),a.createCard("nine of swords","anxiety, hopelessness, trauma","hope, reaching out, despair"),a.createCard("ten of swords","failure, collapse, defeat","can't get worse, only upwards, inevitable end"),a.createCard("page of swords","curiosity, restlessness, mental energy","deception, manipulation, all talk"),a.createCard("knight of swords","action, impulsiveness, defending beliefs","no direction, disregard for consequences, unpredictability"),a.createCard("queen of swords","complexity, perceptiveness, clear mindedness","cold hearted, cruel, bitterness"),a.createCard("king of swords","head over heart, discipline, truth","manipulative, cruel, weakness"),a.createCard("ace of wands","creation, willpower, inspiration, desire","lack of energy, lack of passion, boredom"),a.createCard("two of wands","planning, making decisions, leaving home","fear of change, playing safe, bad planning"),a.createCard("three of wands","looking ahead, expansion, rapid growth","obstacles, delays, frustration"),a.createCard("four of wands","community, home, celebration","lack of support, transience, home conflicts"),a.createCard("five of wands","competition, rivalry, conflict","avoiding conflict, respecting differences"),a.createCard("six of wands","victory, success, public reward","excess pride, lack of recognition, punishment"),a.createCard("seven of wands","perseverance, defensive, maintaining control","give up, destroyed confidence, overwhelmed"),a.createCard("eight of wands","rapid action, movement, quick decisions","panic, waiting, slowdown"),a.createCard("nine of wands","resilience, grit, last stand","exhaustion, fatigue, questioning motivations"),a.createCard("ten of wands","accomplishment, responsibility, burden","inability to delegate, overstressed, burnt out"),a.createCard("page of wands","exploration, excitement, freedom","lack of direction, procrastination, creating conflict"),a.createCard("knight of wands","action, adventure, fearlessness","anger, impulsiveness, recklessness"),a.createCard("queen of wands","courage, determination, joy","selfishness, jealousy, insecurities"),a.createCard("king of wands","big picture, leader, overcoming challenges","impulsive, overbearing, unachievable expectations"),a.createCard("ace of cups","new feelings, spirituality, intuition","emotional loss, blocked creativity, emptiness"),a.createCard("two of cups","unity, partnership, connection","imbalance, broken communication, tension"),a.createCard("three of cups","friendship, community, happiness","overindulgence, gossip, isolation"),a.createCard("four of cups","apathy, contemplation, disconnectedness","sudden awareness, choosing happiness, acceptance"),a.createCard("five of cups","loss, grief, self-pity","acceptance, moving on, finding peace"),a.createCard("six of cups","familiarity, happy memories, healing","moving forward, leaving home, independence"),a.createCard("seven of cups","searching for purpose, choices, daydreaming","lack of purpose, diversion, confusion"),a.createCard("eight of cups","walking away, disillusionment, leaving behind","avoidance, fear of change, fear of loss"),a.createCard("nine of cups","satisfaction, emotional stability, luxury","lack of inner joy, smugness, dissatisfaction"),a.createCard("ten of cups","inner happiness, fulfillment, dreams coming true","shattered dreams, broken family, domestic disharmony"),a.createCard("page of cups","happy surprise, dreamer, sensitivity","emotional immaturity, insecurity, disappointment"),a.createCard("knight of cups","following the heart, idealist, romantic","moodiness, disappointment"),a.createCard("queen of cups","compassion, calm, comfort","martyrdom, insecurity, dependence"),a.createCard("king of cups","compassion, control, balance","coldness, moodiness, bad advice"),a.createCard("ace of pentacles","opportunity, prosperity, new venture","lost opportunity, missed chance, bad investment"),a.createCard("two of pentacles","balancing decisions, priorities, adapting to change","loss of balance, disorganized, overwhelmed"),a.createCard("three of pentacles","teamwork, collaboration, building","lack of teamwork, disorganized, group conflict"),a.createCard("four of pentacles","conservation, frugality, security","greediness, stinginess, possessiveness"),a.createCard("five of pentacles","need, poverty, insecurity","recovery, charity, improvement"),a.createCard("six of pentacles","charity, generosity, sharing","strings attached, stinginess, power and domination"),a.createCard("seven of pentacles","hard work, perseverance, diligence","work without results, distractions, lack of rewards"),a.createCard("eight of pentacles","apprenticeship, passion, high standards","lack of passion, uninspired, no motivation"),a.createCard("nine of pentacles","fruits of labor, rewards, luxury","reckless spending, living beyond means, false success"),a.createCard("ten of pentacles","legacy, culmination, inheritance","fleeting success, lack of stability, lack of resources"),a.createCard("page of pentacles","ambition, desire, diligence","lack of commitment, greediness, laziness"),a.createCard("knight of pentacles","efficiency, hard work, responsibility","laziness, obsessiveness, work without reward"),a.createCard("queen of pentacles","practicality, creature comforts, financial security","self-centeredness, jealousy, smothering"),a.createCard("king of pentacles","abundance, prosperity, security","greed, indulgence, sensuality"),a.createCard("the fool","innocence, new beginnings, free spirit","recklessness, taken advantage of, inconsideration"),a.createCard("the magician","willpower, desire, creation, manifestation","trickery, illusions, out of touch"),a.createCard("the high priestess","intuitive, unconscious, inner voice","lack of center, lost inner voice, repressed feelings"),a.createCard("the empress","motherhood, fertility, nature","dependence, smothering, emptiness, nosiness"),a.createCard("the emperor","authority, structure, control, fatherhood","tyranny, rigidity, coldness"),a.createCard("the hierophant","tradition, conformity, morality, ethics","rebellion, subversiveness, new approaches"),a.createCard("the lovers","partnerships, duality, union","loss of balance, one-sidedness, disharmony"),a.createCard("the chariot","direction, control, willpower","lack of control, lack of direction, aggression"),a.createCard("strength","inner strength, bravery, compassion, focus","self doubt, weakness, insecurity"),a.createCard("the hermit","contemplation, search for truth, inner guidance","loneliness, isolation, lost your way"),a.createCard("the wheel of fortune","change, cycles, inevitable fate","no control, clinging to control, bad luck"),a.createCard("justice","cause and effect, clarity, truth","dishonesty, unaccountability, unfairness"),a.createCard("the hanged man","sacrifice, release, martyrdom","stalling, needless sacrifice, fear of sacrifice"),a.createCard("death","end of cycle, beginnings, change, metamorphosis","fear of change, holding on, stagnation, decay"),a.createCard("temperance","middle path, patience, finding meaning","extremes, excess, lack of balance"),a.createCard("the devil","addiction, materialism, playfulness","freedom, release, restoring control"),a.createCard("the tower","sudden upheaval, broken pride, disaster","disaster avoided, delayed disaster, fear of suffering"),a.createCard("the star","hope, faith, rejuvenation","faithlessness, discouragement, insecurity"),a.createCard("the moon","unconscious, illusions, intuition","confusion, fear, misinterpretation"),a.createCard("the sun","joy, success, celebration, positivity","negativity, depression, sadness"),a.createCard("judgement","reflection, reckoning, awakening","lack of self awareness, doubt, self loathing"),a.createCard("the world","fulfillment, harmony, completion","incompletion, no closure")];return a.state={deck:n,draws:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"createCard",value:function(e,t,a){return{id:E.guid(),name:e,meanings:{upright:t,reversed:a}}}},{key:"drawCards",value:function(e){for(var t=this,a=[],n=function(){var e=E.randomNumber(t.state.deck.length),n=t.state.deck[e];a.find((function(e){return e.cardID===n.id}))||a.push({id:E.guid(),cardID:n.id,reversed:E.randomBoolean()})};a.length<e;)n();this.setState({draws:a})}},{key:"render",value:function(){var e=this;try{var t=this.state.draws.map((function(t){var a=e.state.deck.find((function(e){return e.id===t.cardID}));return a?r.a.createElement(p.a,{span:8,key:t.id},r.a.createElement(Lt,{card:a,reversed:t.reversed})):null}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"oracle"),r.a.createElement("button",{onClick:function(){return e.drawCards(3)}},"draw cards"),r.a.createElement(d.a,null,t))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Lt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={flipped:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"flip",value:function(){this.setState({flipped:!this.state.flipped})}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.state.flipped?"oracle-card flipped":"oracle-card",onClick:function(){return e.flip()}},r.a.createElement("div",{className:"oracle-card-inner"},r.a.createElement("div",{className:"oracle-card-front"},"?"),r.a.createElement("div",{className:"oracle-card-back"},r.a.createElement("div",{className:"oracle-card-name"},this.props.card.name),r.a.createElement("div",{className:"oracle-card-reversed"},this.props.reversed?"(reversed)":""),r.a.createElement("div",{className:"oracle-card-meaning"},this.props.reversed?this.props.card.meanings.reversed:this.props.card.meanings.upright))))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null,output:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(gt.a)(vt.a.mark((function e(){var t,a;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/dojo/data/places.txt");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generate",value:function(){$e.initModel([this.state.source]),this.setState({output:$e.generate(10).map((function(e){return e.line}))})}},{key:"render",value:function(){var e=this;try{this.state.source||this.fetchData();for(var t=[],a=0;a!==this.state.output.length;++a)t.push(r.a.createElement("div",{key:a,className:"section large"},this.state.output[a]));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"place names"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),r.a.createElement("div",{className:"language-output"},t))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Rt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={values:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){for(var e=[];e.length<10;){var t=$e.generatePotion();e.includes(t)||e.push(t)}e.sort(),this.setState({values:e})}},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.values.length;++a)t.push(r.a.createElement("div",{key:a,className:"section large"},this.state.values[a].toLowerCase()));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"potion description"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),t)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Bt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={values:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){for(var e=[];e.length<10;){var t=$e.generateTreasure();e.includes(t)||e.push(t)}e.sort(),this.setState({values:e})}},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.values.length;++a)t.push(r.a.createElement("div",{key:a,className:"section large"},this.state.values[a].toLowerCase()));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"treasure"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),t)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ht=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"die"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"die":t=r.a.createElement(It,null);break;case"language":t=r.a.createElement(Dt,null);break;case"name":t=r.a.createElement(At,null);break;case"book":t=r.a.createElement(jt,null);break;case"potion":t=r.a.createElement(Rt,null);break;case"treasure":t=r.a.createElement(Bt,null);break;case"place":t=r.a.createElement(Gt,null);break;case"npc":t=r.a.createElement(Pt,null);break;case"oracle":t=r.a.createElement(zt,null)}return r.a.createElement("div",{className:"tools scrollable",style:{padding:"10px"}},r.a.createElement(le,{options:[{id:"die",text:"die roller"},{id:"language",text:"language generator"},{id:"name",text:"name generator"},{id:"book",text:"book title generator"},{id:"potion",text:"potion generator"},{id:"treasure",text:"treasure generator"},{id:"place",text:"place name generator"},{id:"npc",text:"npc generator"},{id:"oracle",text:"oracle"}],selectedID:this.state.view,itemsPerRow:3,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),qt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="parties"===this.props.view?"navigator-item pcs selected":"navigator-item pcs",a="library"===this.props.view?"navigator-item monsters selected":"navigator-item monsters",n="encounters"===this.props.view?"navigator-item encounters selected":"navigator-item encounters",s="maps"===this.props.view?"navigator-item maps selected":"navigator-item maps",i="combat"===this.props.view?"navigator-item combat selected":"navigator-item combat";return r.a.createElement("div",{className:"page-footer"},r.a.createElement("div",{className:t,onClick:function(){return e.props.setView("parties")}},"pcs"),r.a.createElement("div",{className:a,onClick:function(){return e.props.setView("library")}},"monsters"),r.a.createElement("div",{className:n,onClick:function(){return e.props.setView("encounters")}},"encounters"),r.a.createElement("div",{className:s,onClick:function(){return e.props.setView("maps")}},"maps"),r.a.createElement("div",{className:i,onClick:function(){return e.props.setView("combat")}},"combat"))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Wt=a(258),Yt=a(253),Ft=a(252),Jt=a(247),_t=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"page-header"},r.a.createElement("div",{className:"app-title app-name"},"dojo"),r.a.createElement("div",{className:"drawer-icons"},r.a.createElement(Wt.a,{className:"title-bar-icon",onClick:function(){return e.props.openDrawer("search")},title:"search"}),r.a.createElement(Yt.a,{className:"title-bar-icon",onClick:function(){return e.props.openDrawer("tools")},title:"dm tools"}),r.a.createElement(Ft.a,{className:"title-bar-icon",onClick:function(){return e.props.openDrawer("reference")},title:"reference"}),r.a.createElement(Jt.a,{className:"title-bar-icon",onClick:function(){return e.props.openDrawer("about")},title:"about"})))}}]),t}(r.a.Component),Xt=a(244),Kt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"readaloud"},this.props.children)}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ut=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{if(!this.props.hasPCs||!this.props.hasMonsters)return r.a.createElement(d.a,{align:"middle",justify:"center",className:"scrollable"},r.a.createElement(p.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Kt,null,r.a.createElement("div",{className:"section"},"this screen is for running combat encounters, but before you can do that you need to do these things first:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasPCs?"strikethrough":""},"define a party of pcs in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("parties")}},"pcs screen")),this.props.hasPCs?r.a.createElement(Xt.a,{title:"done",style:{marginLeft:"5px"}}):null),r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("library")}},"monsters screen")),this.props.hasMonsters?r.a.createElement(Xt.a,{title:"done",style:{marginLeft:"5px"}}):null)),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"you probably want to design your encounter in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("encounters")}},"encounters screen"),", but you don't have to (you can generate a random encounter here instead)"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"if you want to use a tactical map, you can either build one in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("maps")}},"maps screen"),", or you can generate a random one here"))));var t=this.props.combats;E.sort(t);var a=t.map((function(t){return r.a.createElement(Zt,{key:t.id,combat:t,resume:function(t){return e.props.resumeCombat(t)},delete:function(t){return e.props.deleteCombat(t)},openStatBlock:function(t){return e.props.openStatBlock(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"here you can run a combat encounter by specifying a party and an encounter, and optionally a tactical map"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of combats that you have paused"),r.a.createElement("div",{className:"section"},"you can resume a paused combat by selecting it"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start a combat encounter, press the ",r.a.createElement("b",null,"start a new combat")," button")),r.a.createElement("button",{onClick:function(){return e.props.createCombat()}},"start a new combat")),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{heading:"combats",content:a})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Zt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;this.props.combat.map&&(t=r.a.createElement("div",{className:"section"},r.a.createElement(ye,{map:this.props.combat.map,mode:"thumbnail",size:12,combatants:this.props.combat.combatants})));var a=this.props.combat.combatants.filter((function(e){return e.active})).filter((function(e){return"placeholder"!==e.type})).map((function(t){return r.a.createElement("div",{key:t.id,className:"combatant-row"},r.a.createElement(Q,{source:t,inline:!0}),r.a.createElement("div",{className:"name"},t.displayName),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(t)}}))}));return r.a.createElement("div",{className:"card combat"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.combat.name||"unnamed combat")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"section"},"paused at round ",this.props.combat.round),t,r.a.createElement("div",{className:"subheading"},"initiative order"),a),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.resume(e.props.combat)}},"resume combat"),r.a.createElement(j,{text:"delete combat",callback:function(){return e.props.delete(e.props.combat)}})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Qt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"position"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"getPositionSection",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"move"),r.a.createElement("div",{className:"section centered"},r.a.createElement(_e,{direction:"eight",click:function(t){return e.props.move(e.props.item,t)}})),r.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"resize"),r.a.createElement("div",{className:"section centered"},r.a.createElement(_e,{direction:"both",click:function(t,a){return e.props.resize(e.props.item,t,a)}}))))}},{key:"getStyleSection",value:function(){var e=this,t=["overlay","token"].map((function(e){return{id:e,text:e}})),a=["square","rounded","circle"].map((function(e){return{id:e,text:e}}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"type"),r.a.createElement(le,{options:t,selectedID:this.props.item.type,select:function(t){return e.props.changeValue(e.props.item,"type",t)}}),r.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"shape"),r.a.createElement(le,{options:a,selectedID:this.props.item.style,select:function(t){return e.props.changeValue(e.props.item,"style",t)}}),r.a.createElement("div",{className:"subheading"},"color"),r.a.createElement("input",{type:"color",value:this.props.item.color,onChange:function(t){return e.props.changeValue(e.props.item,"color",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"opacity"),r.a.createElement(V.a,{min:0,max:255,value:this.props.item.opacity,tooltipVisible:!1,onChange:function(t){return e.props.changeValue(e.props.item,"opacity",t)}})),r.a.createElement("div",{style:{display:"token"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(J,{source:this.props.item,name:"size",nudgeValue:function(t){return e.props.nudgeValue(e.props.item,"size",t)}})))}},{key:"getNotesSection",value:function(){var e=this;return this.props.note?r.a.createElement("div",null,r.a.createElement(X,{text:this.props.note.text,placeholder:"details",minLines:5,maxLines:10,onChange:function(t){return e.props.changeValue(e.props.note,"text",t)}}),r.a.createElement("button",{onClick:function(){return e.props.removeNote(e.props.item.id)}},"remove note")):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addNote(e.props.item.id)}},"add a note"))}},{key:"render",value:function(){var e=this;try{var t=["position","style","notes"].map((function(e){return{id:e,text:e}})),a=null;switch(this.state.view){case"position":a=this.getPositionSection();break;case"style":a=this.getStyleSection();break;case"notes":a=this.getNotesSection()}return r.a.createElement("div",{className:"card map",key:"selected"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},"map item")),r.a.createElement("div",{className:"card-content"},r.a.createElement(le,{options:t,selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.remove(e.props.item)}},"remove from the map"))))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),$t=a(245),ea=a(243),ta=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];return this.props.combatants.forEach((function(a){a.conditions.forEach((function(n){t.push(r.a.createElement(aa,{key:n.id,condition:n,combatant:a,combat:e.props.combat,showCombatantName:e.props.combatants.length>1,nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)},editCondition:function(t){return e.props.editCondition(a,t)},removeCondition:function(t){return e.props.removeCondition(a,t)}}))}))})),r.a.createElement("div",{className:"section"},t,r.a.createElement("button",{onClick:function(){return e.props.addCondition()}},"add a condition"))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),aa=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.condition.name||"condition";"exhaustion"===this.props.condition.name&&(t+=" ("+this.props.condition.level+")"),this.props.showCombatantName&&(t=this.props.combatant.displayName+": "+t);var a=null;null!==this.props.condition.duration&&(a=r.a.createElement("div",{className:"section"},r.a.createElement("i",null,E.conditionDurationText(this.props.condition,this.props.combat))));var n=[];"exhaustion"===this.props.condition.name&&n.push(r.a.createElement("div",{key:"level",className:"section"},r.a.createElement(J,{source:this.props.condition,name:"level",label:"level",nudgeValue:function(t){return e.props.nudgeConditionValue(e.props.condition,"level",t)}})));for(var s=E.conditionText(this.props.condition),i=0;i!==s.length;++i)n.push(r.a.createElement("div",{key:i,className:"section"},s[i]));return r.a.createElement("div",{className:"group-panel condition-panel"},r.a.createElement("div",{className:"condition-name"},t),r.a.createElement("div",{className:"condition-buttons"},r.a.createElement($t.a,{title:"edit",onClick:function(){return e.props.editCondition(e.props.condition)}}),r.a.createElement(ea.a,{title:"remove",onClick:function(){return e.props.removeCondition(e.props.condition)}})),a,n)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),na=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"main",damageOrHealing:0,damageMultipliers:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setDamage",value:function(e){this.setState({damageOrHealing:e})}},{key:"nudgeDamage",value:function(e){this.setState({damageOrHealing:Math.max(this.state.damageOrHealing+e,0)})}},{key:"setView",value:function(e){this.setState({view:e})}},{key:"setDamageMultiplier",value:function(e,t){var a=this.state.damageMultipliers;a[e]=t,this.setState({damageMultipliers:a})}},{key:"heal",value:function(){var e=this,t=this.state.damageOrHealing;this.setState({damageOrHealing:0},(function(){var a=[];e.props.combatants.forEach((function(e){var n,r,s,i=null!==(n=e.hpMax)&&void 0!==n?n:0,o=(null!==(r=e.hpCurrent)&&void 0!==r?r:0)+t;o=Math.min(o,i),a.push({id:e.id,hp:o,temp:null!==(s=e.hpTemp)&&void 0!==s?s:0,damage:0})})),e.props.changeHP(a)}))}},{key:"damage",value:function(){var e=this,t=this.state.damageOrHealing;this.setState({damageOrHealing:0},(function(){var a=[];e.props.combatants.forEach((function(n){var r,s,i,o=null!==(r=e.state.damageMultipliers[n.id])&&void 0!==r?r:1,c=null!==(s=n.hpCurrent)&&void 0!==s?s:0,l=null!==(i=n.hpTemp)&&void 0!==i?i:0,u=Math.floor(t*o),m=u,d=Math.min(m,l);l-=d,c-=m-=d,c=Math.max(c,0),a.push({id:n.id,hp:c,temp:l,damage:u})})),e.props.changeHP(a)}))}},{key:"getMainSection",value:function(){var e=this;if(this.props.combatants.every((function(e){return e.pending})))return r.a.createElement("div",{className:"section"},"pending initiative entry");if(this.props.combatants.every((function(e){return e.active}))){var t=[];this.props.combatants.every((function(e){return e.current}))?t.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(e.props.combatants)}},"mark as defeated and end turn")):(1===this.props.combatants.length&&t.push(r.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(e.props.combatants[0])}},"start turn")),t.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(e.props.combatants)}},"mark as defeated")));var a=[];if(this.props.combatants.every((function(e){return"pc"!==e.type})))this.props.combat.combatants.filter((function(e){return"pc"===e.type})).forEach((function(t){var n="engaged:"+t.displayName;a.push(r.a.createElement(z.a.CheckableTag,{key:t.id,checked:e.props.combatants.every((function(e){return e.tags.includes(n)})),onChange:function(){return e.props.toggleTag(e.props.combatants,n)}},t.displayName))}));return r.a.createElement("div",null,t,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"quick tags: "),r.a.createElement(z.a.CheckableTag,{checked:this.props.combatants.every((function(e){return e.tags.includes("conc")})),onChange:function(){return e.props.toggleTag(e.props.combatants,"conc")}},"concentrating"),r.a.createElement(z.a.CheckableTag,{checked:this.props.combatants.every((function(e){return e.tags.includes("bane")})),onChange:function(){return e.props.toggleTag(e.props.combatants,"bane")}},"bane"),r.a.createElement(z.a.CheckableTag,{checked:this.props.combatants.every((function(e){return e.tags.includes("bless")})),onChange:function(){return e.props.toggleTag(e.props.combatants,"bless")}},"bless"),r.a.createElement(z.a.CheckableTag,{checked:this.props.combatants.every((function(e){return e.conditions.some((function(e){return"prone"===e.name}))})),onChange:function(){return e.props.toggleCondition(e.props.combatants,"prone")}},"prone"),r.a.createElement(z.a.CheckableTag,{checked:this.props.combatants.every((function(e){return e.conditions.some((function(e){return"unconscious"===e.name}))})),onChange:function(){return e.props.toggleCondition(e.props.combatants,"unconscious")}},"unconscious"),r.a.createElement(z.a.CheckableTag,{checked:!this.props.combatants.every((function(e){return e.showOnMap})),onChange:function(){return e.props.toggleHidden(e.props.combatants)}},"hidden")),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"engaged with: "),a))}return this.props.combatants.every((function(e){return e.defeated}))?r.a.createElement("button",{onClick:function(){return e.props.makeActive(e.props.combatants)}},"mark as active"):r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"multiple combatants are selected"))}},{key:"getHPSection",value:function(){var e=this;if(!this.props.combatants.every((function(e){return"monster"===e.type})))return null;var t=null;if(1===this.props.combatants.length){var a=this.props.combatants[0];t=r.a.createElement("div",null,r.a.createElement(J,{source:a,name:"hpCurrent",label:"hit points",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(a,"hpCurrent",t)}}),r.a.createElement(J,{source:a,name:"hpTemp",label:"temp hp",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(a,"hpTemp",t)}}),r.a.createElement("div",{className:"divider"}))}var n=this.props.combatants.map((function(t){var a=t,n=null,s=null,i=null,o=null;return a.damage.resist&&(n=r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage resistances")," ",a.damage.resist," ",e.props.combatants.length>1?r.a.createElement("i",null," - ",t.displayName):null)),a.damage.vulnerable&&(s=r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage vulnerabilities")," ",a.damage.vulnerable," ",e.props.combatants.length>1?r.a.createElement("i",null," - ",t.displayName):null)),a.damage.immune&&(i=r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage immunities")," ",a.damage.immune," ",e.props.combatants.length>1?r.a.createElement("i",null," - ",t.displayName):null)),a.tags.includes("conc")&&(o=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},a.displayName," is ",r.a.createElement("b",null,"concentrating"),", and will need to make a check if they take damage"))),n||s||i||o?r.a.createElement("div",{key:t.id},n,s,i,o):null})),s=[{id:"half",text:"half"},{id:"normal",text:"normal"},{id:"double",text:"double"}],i=this.props.combatants.map((function(t){var a,n="normal",i=null!==(a=e.state.damageMultipliers[t.id])&&void 0!==a?a:1;i<1&&(n="half"),i>1&&(n="double");var o=r.a.createElement(le,{options:s,selectedID:n,disabled:0===e.state.damageOrHealing,select:function(a){var n=1;"half"===a&&(n=.5),"double"===a&&(n=2),e.setDamageMultiplier(t.id,n)}});return 1===e.props.combatants.length?r.a.createElement("div",{key:t.id},o):r.a.createElement(d.a,{key:t.id,align:"middle",justify:"center"},r.a.createElement(p.a,{span:8},r.a.createElement("div",null,t.displayName)),r.a.createElement(p.a,{span:16},o))})),o=null,c=this.props.combatants.filter((function(e){return null!=e.hpCurrent&&e.hpCurrent<=0}));if(c.length>0){var l=1===c.length&&c[0].current?"mark as defeated and end turn":"mark as defeated",u=null;this.props.combatants.length>1&&(u=r.a.createElement("ul",null,c.map((function(e){return r.a.createElement("li",{key:e.id},e.displayName)})))),o=r.a.createElement("button",{onClick:function(){return e.props.makeDefeated(c)}},l,u)}return r.a.createElement("div",null,t,n,r.a.createElement(J,{source:this.state,name:"damageOrHealing",factors:[1,10],nudgeValue:function(t){return e.nudgeDamage(t)}}),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{xs:24,sm:24,md:8,lg:8,xl:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.heal()}},"heal")),r.a.createElement(p.a,{xs:24,sm:24,md:8,lg:8,xl:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.setDamage(0)}},"reset")),r.a.createElement(p.a,{xs:24,sm:24,md:8,lg:8,xl:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.damage()}},"damage"))),i,o)}},{key:"getConditionSection",value:function(){var e=this,t=this.props.combatants.map((function(t){if("monster"!==t.type)return null;var a=t;return a.conditionImmunities?r.a.createElement("div",{key:t.id,className:"section"},r.a.createElement("b",null,"condition immunities")," ",a.conditionImmunities," ",e.props.combatants.length>1?r.a.createElement("i",null," - ",t.displayName):null):null})),a=r.a.createElement(ta,{combatants:this.props.combatants,combat:this.props.combat,addCondition:function(){return e.props.addCondition(e.props.combatants)},editCondition:function(t,a){return e.props.editCondition(t,a)},removeCondition:function(t,a){return e.props.removeCondition(t,a)},nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)}});return r.a.createElement("div",null,t,a)}},{key:"getMapSection",value:function(){var e=this;if(!this.props.combat.map)return null;if(this.props.combatants.every((function(t){return e.props.combat.map&&e.props.combat.map.items.find((function(e){return e.id===t.id}))}))){var t=null,a=null;if(1===this.props.combatants.length){var n=this.props.combatants[0];t=r.a.createElement(J,{source:n,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(n,"altitude",5*t)}});var s=null;if(n.aura.radius>0){s=r.a.createElement("div",null,r.a.createElement(le,{options:[{id:"square",text:"square"},{id:"rounded",text:"rounded"},{id:"circle",text:"circle"}],selectedID:n.aura.style,select:function(t){return e.props.changeValue(n.aura,"style",t)}}),r.a.createElement("input",{type:"color",value:n.aura.color,onChange:function(t){return e.props.changeValue(n.aura,"color",t.target.value)}}))}a=r.a.createElement(W,{text:"aura"},r.a.createElement(J,{source:n.aura,name:"radius",label:"size",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(n.aura,"radius",5*t)}}),s)}return r.a.createElement("div",null,r.a.createElement("div",{className:"section centered"},r.a.createElement(_e,{direction:"eight",click:function(t){return e.props.mapMove(e.props.combatants,t)}})),r.a.createElement("div",{className:"divider"}),t,a,r.a.createElement("button",{onClick:function(){return e.props.mapRemove(e.props.combatants)}},"remove from map"))}return 1===this.props.combatants.length?r.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(e.props.combatants[0])}},"add to map"):null}},{key:"getAdvancedSection",value:function(){var e=this,t=null;this.props.combatants.every((function(e){return!e.current}))&&(t=r.a.createElement(j,{text:"remove from encounter",callback:function(){return e.props.removeCombatants(e.props.combatants)}}));var a=null,n=null,s=null;if(1===this.props.combatants.length){var i=this.props.combatants[0];a=r.a.createElement(W,{text:"change name"},r.a.createElement(X,{text:i.displayName,onChange:function(t){return e.props.changeValue(i,"displayName",t)}})),n=r.a.createElement(W,{text:"change size"},r.a.createElement(J,{source:i,name:"displaySize",label:"size",nudgeValue:function(t){return e.props.nudgeValue(i,"displaySize",t)}})),i.pending||(s=r.a.createElement(W,{text:"change initiative score"},r.a.createElement(J,{source:i,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(i,"initiative",t)}})))}var o=[];this.props.combatants.filter((function(e){return"pc"===e.type})).forEach((function(t){t.companions.filter((function(t){return!e.props.combat.combatants.find((function(e){return e.id===t.id}))})).forEach((function(t){o.push(r.a.createElement("button",{key:t.id,onClick:function(){return e.props.addCompanion(t)}},"add ",t.name))}))}));var c=null;if(1===this.props.combatants.length){var l=this.props.combatants[0];c=r.a.createElement(X,{text:l.note,placeholder:"notes",minLines:3,maxLines:10,onChange:function(t){return e.props.changeValue(l,"note",t)}})}return r.a.createElement("div",null,t,a,n,s,o,c)}},{key:"render",value:function(){var e=this;try{var t=["main","hp","cond","map","adv"].map((function(e){return{id:e,text:e}}));this.props.combat.map||t.splice(3,1),this.props.combatants.every((function(e){return"monster"===e.type}))||t.splice(1,1);var a=this.state.view;t.find((function(e){return e.id===a}))||(a="main");var n=null;switch(a){case"main":n=this.getMainSection();break;case"hp":n=this.getHPSection();break;case"cond":n=this.getConditionSection();break;case"map":n=this.getMapSection();break;case"adv":n=this.getAdvancedSection()}var s=1===this.props.combatants.length?this.props.combatants[0].displayName:"multiple combatants";return r.a.createElement("div",{className:"group-panel combat-controls"},r.a.createElement("div",{className:"subheading"},s),r.a.createElement(le,{options:t,selectedID:a,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),n)}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ra=a(259),sa=new ae.a.Converter;sa.setOption("tables",!0);var ia=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationTag",value:function(){return this.props.combatant.current?r.a.createElement(z.a,{className:"info"},"current turn"):this.props.selected?r.a.createElement(z.a,{className:"info"},"selected"):null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.select&&this.props.select(this.props.combatant,e.ctrlKey)}},{key:"getContent",value:function(){var e=this;if(this.props.combatant.pending)return r.a.createElement("div",null,r.a.createElement(J,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}),r.a.createElement("button",{onClick:function(t){t.stopPropagation(),e.props.makeActive(e.props.combatant)}},"add to encounter"));var t=[];if("pc"===this.props.combatant.type){var a=this.props.combatant;a.player&&t.push(r.a.createElement("div",{key:"player",className:"section"},a.player))}if("monster"===this.props.combatant.type&&!this.props.minimal){var n,s,i=this.props.combatant,o=(null!==(n=this.props.combatant.hpCurrent)&&void 0!==n?n:0).toString();(null!==(s=this.props.combatant.hpTemp)&&void 0!==s?s:0)>0&&(o+="+"+this.props.combatant.hpTemp),t.push(r.a.createElement("div",{key:"stats"},r.a.createElement("div",{className:"section key-stats"},r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-label"},"ac"),r.a.createElement("div",{className:"stat-value"},i.ac)),r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-value"},o),r.a.createElement("div",{className:"stat-label"},"hp"))),r.a.createElement(ge,{combatant:this.props.combatant})))}var c=[];return this.props.combatant.tags.filter((function(e){return e.startsWith("engaged")})).forEach((function(e){c.push(E.getTagDescription(e))})),c.length>0&&t.push(r.a.createElement(ne,{key:"engaged"},r.a.createElement("div",null,"engaged with: ",c.join(", ")))),this.props.combatant.tags.filter((function(e){return!e.startsWith("engaged")})).forEach((function(e){t.push(r.a.createElement(ne,{key:e},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},E.getTagTitle(e)),E.getTagDescription(e))))})),this.props.combat.map&&!this.props.combat.map.items.find((function(t){return t.id===e.props.combatant.id}))&&t.push(r.a.createElement(ne,{key:"not-on-map"},r.a.createElement("span",null,"not on the map"),r.a.createElement(ra.a,{className:"icon-button",onClick:function(){return e.props.addToMap(e.props.combatant)}}))),this.props.combatant.showOnMap||t.push(r.a.createElement(ne,{key:"hidden"},"hidden")),this.props.combatant.conditions&&this.props.combatant.conditions.forEach((function(a){var n=a.name;"exhaustion"===a.name&&(n+=" ("+a.level+")"),a.duration&&(n+=" "+E.conditionDurationText(a,e.props.combat));for(var s=[],i=E.conditionText(a),o=0;o!==i.length;++o)s.push(r.a.createElement("div",{key:o,className:"condition-text"},i[o]));t.push(r.a.createElement(ne,{key:a.id},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},n),s)))})),this.props.combatant.note&&t.push(r.a.createElement(ne,{key:"text"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:sa.makeHtml(this.props.combatant.note)}}))),t}},{key:"render",value:function(){var e=this;try{var t="initiative-list-item "+this.props.combatant.type;this.props.combatant.current&&(t+=" current"),this.props.selected&&(t+=" highlight"),this.props.combatant.defeated&&(t+=" defeated");var a=null,n=this.props.combatant;return n.portrait&&(a=r.a.createElement(Q,{source:n,inline:!0})),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"header"},a,r.a.createElement("div",{className:"name"},this.props.combatant.displayName||"combatant"),this.getInformationTag()),r.a.createElement("div",{className:"content"},this.getContent()))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),oa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={externalWindow:null,containerElement:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.open("","","width=800, height=500, left=200, top=200"),a=null;t&&((a=t.document.createElement("div")).className="dojo popout",t.document.body.appendChild(a),Array.from(document.styleSheets).forEach((function(e){var a=e;if(e.href){var n=document.createElement("link");n.rel="stylesheet",n.href=e.href,t.document.head.appendChild(n)}else if(a&&a.cssRules&&a.cssRules.length>0){var r=document.createElement("style");Array.from(a.cssRules).forEach((function(e){r.appendChild(document.createTextNode(e.cssText))})),t.document.head.appendChild(r)}})),t.document.title=this.props.title,t.addEventListener("beforeunload",(function(){e.props.closeWindow()})));this.setState({externalWindow:t,containerElement:a})}},{key:"componentWillUnmount",value:function(){this.state.externalWindow&&this.state.externalWindow.close()}},{key:"render",value:function(){try{return this.state.containerElement?i.a.createPortal(this.props.children,this.state.containerElement):null}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);(new ae.a.Converter).setOption("tables",!0);var ca=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={rightPanel:"selection",showDefeatedCombatants:!1,selectedItemIDs:[],addingToMapID:null,addingOverlay:!1,mapSize:30,playerView:{open:!1,showControls:!1,mapSize:30}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(){e.setPlayerViewOpen(!1)}))}},{key:"setRightPanel",value:function(e){this.setState({rightPanel:e})}},{key:"toggleShowDefeatedCombatants",value:function(){this.setState({showDefeatedCombatants:!this.state.showDefeatedCombatants})}},{key:"setSelectedItemIDs",value:function(e){var t=e.length>0?"selection":this.state.rightPanel;this.setState({selectedItemIDs:e,rightPanel:t})}},{key:"toggleItemSelection",value:function(e,t){if(e&&t){var a=this.state.selectedItemIDs;if(a.includes(e)){var n=a.indexOf(e);a.splice(n,1)}else a.push(e);this.setSelectedItemIDs(a)}else this.setSelectedItemIDs(e?[e]:[])}},{key:"setAddingToMapID",value:function(e){this.setState({addingToMapID:e,addingOverlay:!1})}},{key:"toggleAddingOverlay",value:function(){this.setState({addingOverlay:!this.state.addingOverlay,addingToMapID:null})}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}},{key:"setPlayerViewOpen",value:function(e){var t=this.state.playerView;t.open=e,this.setState({playerView:t})}},{key:"setPlayerViewShowControls",value:function(e){var t=this.state.playerView;t.showControls=e,this.setState({playerView:t})}},{key:"nudgePlayerViewMapSize",value:function(e){var t=this.state.playerView;t.mapSize=Math.max(t.mapSize+e,3),this.setState({playerView:t})}},{key:"nextTurn",value:function(){var e=this,t=this.props.combat.combatants.find((function(e){return e.current}));if(t)this.props.endTurn(t);else{var a=this.props.combat.combatants.filter((function(t){return"placeholder"!==t.type||O.combatHasLairActions(e.props.combat)})).find((function(e){return e.active}));a&&this.props.makeCurrent(a)}}},{key:"defeatCombatants",value:function(e){var t=this,a=e.map((function(e){return e.id}));this.setState({selectedItemIDs:this.state.selectedItemIDs.filter((function(e){return!a.includes(e)}))},(function(){t.props.makeDefeated(e)}))}},{key:"removeCombatants",value:function(e){var t=this,a=e.map((function(e){return e.id}));this.setState({selectedItemIDs:this.state.selectedItemIDs.filter((function(e){return!a.includes(e)}))},(function(){t.props.removeCombatants(e)}))}},{key:"gridSquareClicked",value:function(e,t){var a=this;if(this.state.addingToMapID){var n=this.props.combat.combatants.find((function(e){return e.id===a.state.addingToMapID}));n&&this.props.mapAdd(n,e,t),this.setAddingToMapID(null)}if(this.state.addingOverlay){var r=k.createMapItem();r.type="overlay",r.x=e,r.y=t,r.width=1,r.height=1,r.color="#005080",r.opacity=127,r.style="square",this.props.addOverlay(r),this.setState({rightPanel:"selection",addingOverlay:!1,addingToMapID:null,selectedItemIDs:[r.id]})}}},{key:"orderCombatants",value:function(e){var t=e.find((function(e){return e.current}));if(!t)return e;var a=e.indexOf(t);return e.splice(a).concat(e)}},{key:"getPlayerView",value:function(){var e=this;if(!this.state.playerView.open)return null;var t=this.props.combat.combatants.filter((function(e){return"pc"===e.type||e.showOnMap})).filter((function(e){return!e.pending&&e.active&&!e.defeated})).filter((function(t){return"placeholder"!==t.type||O.combatHasLairActions(e.props.combat)})),a=t.some((function(e){return e.current})),n=t.length,s=this.orderCombatants(t).map((function(t){return e.createCombatantRow(t,!0)}));if(a&&(n>1&&s.splice(1,0,r.a.createElement("div",{key:"next1",className:"section centered init-separator"},"next up")),n>2&&s.splice(3,0,r.a.createElement("div",{key:"next2",className:"section centered init-separator"},"then"))),this.props.combat.map){var i=null;if(this.props.combat.map&&this.state.playerView.showControls){var o=this.props.combat.combatants.filter((function(t){return null!==e.props.combat.map&&e.props.combat.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).filter((function(t){return e.state.selectedItemIDs.includes(t.id)}));if(0===o.length&&(o=this.props.combat.combatants.filter((function(t){return null!==e.props.combat.map&&e.props.combat.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).filter((function(e){return e.current}))),1===o.length){var c=o[0];i=r.a.createElement("div",null,r.a.createElement("div",{className:"heading lowercase"},c.displayName),r.a.createElement("div",{className:"section centered"},r.a.createElement(_e,{direction:"eight",click:function(t){return e.props.mapMove([c.id],t)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement(J,{key:"altitude",source:c,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(c,"altitude",5*t)}}),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"conc.",display:"button",checked:c.tags.includes("conc"),changeValue:function(t){return e.props.toggleTag([c],"conc")}})),r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"bane",display:"button",checked:c.tags.includes("bane"),changeValue:function(t){return e.props.toggleTag([c],"bane")}})),r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"bless",display:"button",checked:c.tags.includes("bless"),changeValue:function(t){return e.props.toggleTag([c],"bless")}}))),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"prone",display:"button",checked:c.conditions.some((function(e){return"prone"===e.name})),changeValue:function(t){return e.props.toggleCondition([c],"prone")}})),r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"uncon.",display:"button",checked:c.conditions.some((function(e){return"unconscious"===e.name})),changeValue:function(t){return e.props.toggleCondition([c],"unconscious")}})),r.a.createElement(p.a,{span:8},r.a.createElement(M,{label:"hidden",display:"button",checked:!c.showOnMap,changeValue:function(t){return e.props.changeValue([c],"showOnMap",!t)}}))))}o.length>1&&(i=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"multiple items selected")))}return r.a.createElement(oa,{title:"Encounter",closeWindow:function(){return e.setPlayerViewOpen(!1)}},r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:24,sm:24,md:12,lg:16,xl:18,className:"scrollable both-ways"},r.a.createElement(ye,{key:"map",map:this.props.combat.map,mode:"combat-player",size:this.state.playerView.mapSize,combatants:this.props.combat.combatants,selectedItemIDs:this.state.selectedItemIDs,itemSelected:function(t,a){return e.toggleItemSelection(t,a)}})),r.a.createElement(p.a,{xs:24,sm:24,md:12,lg:8,xl:6,className:"scrollable"},i,r.a.createElement("div",{className:"heading fixed-top"},"initiative order"),s)))}return r.a.createElement(oa,{title:"Encounter",closeWindow:function(){return e.setPlayerViewOpen(!1)}},r.a.createElement("div",{className:"scrollable"},r.a.createElement("div",{className:"heading"},"initiative order"),s))}},{key:"getTools",value:function(){var e,t=this;e=!!this.props.combat.encounter&&this.props.combat.encounter.waves.length>0;var a=[];this.props.combat.combatants.filter((function(e){return"pc"===e.type})).forEach((function(e){var n=t.props.parties.find((function(t){return t.pcs.find((function(t){return t.id===e.id}))}));n&&!a.includes(n)&&a.push(n)}));var n=[];return a.forEach((function(e){e.pcs.forEach((function(a){t.props.combat.combatants.find((function(e){return e.id===a.id}))||n.push(r.a.createElement("button",{key:a.id,onClick:function(){return t.props.addPC(e.id,a.id)}},a.name," (",e.name,")"))}))})),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"encounter"),r.a.createElement("button",{onClick:function(){return t.props.pauseCombat()}},"pause combat"),r.a.createElement(j,{text:"end combat",callback:function(){return t.props.endCombat()}}),r.a.createElement("button",{onClick:function(){return t.props.showLeaderboard()}},"leaderboard"),r.a.createElement("div",{className:"subheading"},"combatants"),r.a.createElement(M,{label:"show defeated combatants",checked:this.state.showDefeatedCombatants,changeValue:function(){return t.toggleShowDefeatedCombatants()}}),r.a.createElement("button",{onClick:function(){return t.props.addCombatants()}},"add combatants"),n.length>0?r.a.createElement(W,{text:"add pcs"},n):null,r.a.createElement("button",{onClick:function(){return t.props.addWave()},style:{display:e?"block":"none"}},"add wave"),r.a.createElement("button",{onClick:function(){return t.props.addCompanion(null)}},"add a companion"),r.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},r.a.createElement("div",{className:"subheading"},"map"),r.a.createElement("button",{onClick:function(){return t.props.scatterCombatants("monster")}},"scatter monsters"),r.a.createElement("button",{onClick:function(){return t.props.scatterCombatants("pc")}},"scatter pcs"),r.a.createElement(M,{label:this.state.addingOverlay?"click on the map to add the item, or click here to cancel":"add token / overlay",display:"button",checked:this.state.addingOverlay,changeValue:function(){return t.toggleAddingOverlay()}}),r.a.createElement(J,{source:this.state,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(e){return t.nudgeMapSize(3*e)}})),r.a.createElement("div",{className:"subheading"},"player view"),r.a.createElement(M,{label:"show player view",checked:this.state.playerView.open,changeValue:function(e){return t.setPlayerViewOpen(e)}}),r.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},r.a.createElement(M,{label:"show map controls",checked:this.state.playerView.showControls,changeValue:function(e){return t.setPlayerViewShowControls(e)}})),r.a.createElement("div",{style:{display:this.props.combat.map&&this.state.playerView.open?"block":"none"}},r.a.createElement(J,{source:this.state.playerView,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(e){return t.nudgePlayerViewMapSize(3*e)}})))}},{key:"getSelectedCombatant",value:function(){var e=this,t=this.state.selectedItemIDs.map((function(t){return e.props.combat.combatants.find((function(e){return e.id===t}))})).filter((function(e){return!!e&&!e.current}));E.sort(t,[{field:"displayName",dir:"asc"}]);var a=t.filter((function(e){return"placeholder"===e.type}));if(a.length>0)return r.a.createElement("div",null,this.createCard(a[0]));if(1===t.length)return r.a.createElement("div",null,this.createControls(t),this.createCard(t[0]));if(t.length>1)return r.a.createElement("div",null,this.createControls(t),r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"multiple combatants are selected:"),t.map((function(t){return r.a.createElement("div",{key:t.id,className:"multiple-combatant-row"},t.displayName,r.a.createElement(L.a,{style:{float:"right",padding:"2px 0",fontSize:"14px"},onClick:function(){return e.toggleItemSelection(t.id,!0)}}))}))));if(this.props.combat.map){var n=this.props.combat.map.items.find((function(t){return t.id===e.state.selectedItemIDs[0]}));if(n)return r.a.createElement(Qt,{item:n,note:C.getNote(this.props.combat.map,n),move:function(t,a){return e.props.mapMove([t.id],a)},resize:function(t,a,n){return e.props.mapResize(t.id,a,n)},remove:function(t){return e.props.mapRemove([t.id])},addNote:function(t){return e.props.mapAddNote(t)},removeNote:function(t){return e.props.mapRemoveNote(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)}})}return r.a.createElement(ne,{key:"selected"},r.a.createElement("div",{className:"section"},"select a pc or monster from the ",r.a.createElement("b",null,"initiative order")," list to see its details here"))}},{key:"createCombatantRow",value:function(e,t){var a=this,n=this.state.selectedItemIDs.includes(e.id);return t&&!this.props.combat.map&&(n=!1),r.a.createElement(ia,{key:e.id,combatant:e,combat:this.props.combat,selected:n,minimal:t,select:function(e,t){return a.toggleItemSelection(e.id,t)},addToMap:function(e){return a.setAddingToMapID(a.state.addingToMapID?null:e.id)},nudgeValue:function(e,t,n){return a.props.nudgeValue(e,t,n)},makeActive:function(e){return a.props.makeActive([e])}})}},{key:"createControls",value:function(e){var t=this;return e.some((function(e){return"placeholder"===e.type}))?null:r.a.createElement(na,{combatants:e,combat:this.props.combat,makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.defeatCombatants(e)},removeCombatants:function(e){return t.removeCombatants(e)},changeHP:function(e){return t.props.changeHP(e)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(t.state.addingToMapID?null:e.id)},mapMove:function(e,a){return t.props.mapMove(e.map((function(e){return e.id})),a)},mapRemove:function(e){return t.props.mapRemove(e.map((function(e){return e.id})))},toggleTag:function(e,a){return t.props.toggleTag(e,a)},toggleCondition:function(e,a){return t.props.toggleCondition(e,a)},toggleHidden:function(e){return t.props.toggleHidden(e)},addCompanion:function(e){return t.props.addCompanion(e)},changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}})}},{key:"createCard",value:function(e){var t=this;switch(e.type){case"pc":return r.a.createElement(mt,{pc:e,mode:"combat",changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}});case"monster":return r.a.createElement(ce,{monster:e,mode:"combat",useTrait:function(a){return t.props.useTrait(e,a)},rechargeTrait:function(a){return t.props.rechargeTrait(e,a)}});case"companion":return null;case"placeholder":var a=[];return this.props.combat.combatants.forEach((function(e){var n=e;n&&n.traits&&n.traits.some((function(e){return"lair"===e.type}))&&a.push(r.a.createElement("div",{className:"card monster",key:"lair "+n.id},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},n.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement(se,{combatant:n,mode:"lair",useTrait:function(e){return t.props.useTrait(n,e)},rechargeTrait:function(e){return t.props.rechargeTrait(n,e)}}))))})),a}return null}},{key:"render",value:function(){var e=this;try{var t=null,a=[],n=[];this.props.combat.combatants.forEach((function(s){s.pending?a.push(r.a.createElement(ia,{key:s.id,combatant:s,combat:e.props.combat,selected:e.state.selectedItemIDs.includes(s.id),minimal:!1,select:function(t,a){return e.toggleItemSelection(t.id,a)},addToMap:function(t){return e.setAddingToMapID(e.state.addingToMapID?null:t.id)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},makeActive:function(t){return e.props.makeActive([t])}})):(s.current&&(t=r.a.createElement("div",null,e.createControls([s]),e.createCard(s))),(s.active||s.defeated&&e.state.showDefeatedCombatants)&&n.push(s))})),0!==a.length&&a.unshift(r.a.createElement(ne,{key:"pending-help"},r.a.createElement("div",{className:"section"},"these combatants are not yet part of the encounter"),r.a.createElement("div",{className:"section"},"set initiative on each of them, then add them to the encounter")));var s=n.filter((function(t){return"placeholder"!==t.type||O.combatHasLairActions(e.props.combat)})),i=s.length,o=this.orderCombatants(s).map((function(t){return e.createCombatantRow(t,!1)}));t&&(i>1&&o.splice(1,0,r.a.createElement("div",{key:"next1",className:"section centered init-separator"},"next up")),i>2&&o.splice(3,0,r.a.createElement("div",{key:"next2",className:"section centered init-separator"},"then"))),t||(o.unshift(r.a.createElement(ne,{key:"init-help"},r.a.createElement("div",{className:"section"},"these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)"),r.a.createElement("div",{className:"section"},"they are listed in initiative order (with the highest initiative score at the top of the list, and the lowest at the bottom)"),r.a.createElement("div",{className:"section"},"when you're ready to begin the encounter, press the ",r.a.createElement("b",null,"start combat")," button at the top left"))),t=r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"the current initiative holder will be displayed here")));var c=null;this.props.combat.notifications.length>0&&(c=r.a.createElement("div",{className:"notifications"},this.props.combat.notifications.map((function(t){return r.a.createElement(la,{key:t.id,notification:t,close:function(t,a){return e.props.closeNotification(t,a)}})}))));var l=null;this.props.combat.map&&(l=r.a.createElement(ye,{key:"map",map:this.props.combat.map,mode:"combat",size:this.state.mapSize,showOverlay:null!==this.state.addingToMapID||this.state.addingOverlay,combatants:this.props.combat.combatants,selectedItemIDs:this.state.selectedItemIDs,itemSelected:function(t,a){return e.toggleItemSelection(t,a)},gridSquareEntered:function(e,t){return null},gridSquareClicked:function(t,a){return e.gridSquareClicked(t,a)}}));var u=[];this.props.combat.combatants.filter((function(e){return!e.pending&&e.active&&!e.defeated})).forEach((function(t){var a=t;a&&a.traits&&a.traits.some((function(e){return"legendary"===e.type}))&&!a.current&&u.push(r.a.createElement("div",{className:"card monster",key:"leg "+a.id},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},a.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement(se,{combatant:a,mode:"legendary",useTrait:function(t){return e.props.useTrait(a,t)},rechargeTrait:function(t){return e.props.rechargeTrait(a,t)}}))))}));var m=["selection","tools"].map((function(e){return{id:e,text:e}})),h=null,f=null;switch(this.state.rightPanel){case"selection":h="selected combatant",f=this.getSelectedCombatant();break;case"tools":h="tools",f=this.getTools()}return r.a.createElement("div",{className:"full-height"},r.a.createElement(d.a,{className:"combat-top-row"},r.a.createElement(p.a,{span:8,style:{padding:"0 10px"}},r.a.createElement("button",{onClick:function(){return e.nextTurn()}},this.props.combat.combatants.find((function(e){return e.current}))?"next turn":"start combat")),r.a.createElement(p.a,{span:4},r.a.createElement("div",{className:"statistic"},"round ",this.props.combat.round)),r.a.createElement(p.a,{span:4},r.a.createElement("div",{className:"statistic"},O.getCombatXP(this.props.combat)," xp")),r.a.createElement(p.a,{span:8,style:{padding:"0 10px"}},r.a.createElement(le,{options:m,selectedID:this.state.rightPanel,select:function(t){return e.setRightPanel(t)}}))),r.a.createElement(d.a,{className:"combat-main"},r.a.createElement(p.a,{span:8,className:"scrollable"},r.a.createElement("div",{className:"heading fixed-top"},"initiative holder"),t),r.a.createElement(p.a,{span:8,className:"scrollable"},c,r.a.createElement(Be,{heading:"waiting for intiative",content:a,columns:1,showToggle:!0}),r.a.createElement(Be,{heading:"legendary actions",content:u,columns:1,showToggle:!0}),r.a.createElement(Be,{heading:"encounter map",content:[l],columns:1,showToggle:!0}),r.a.createElement(Be,{heading:"initiative order",content:o,columns:1,showToggle:!0})),r.a.createElement(p.a,{span:8,className:"scrollable"},r.a.createElement("div",{className:"heading fixed-top"},h),f)),this.getPlayerView())}catch(v){return console.error(v),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),la=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"success",value:function(){switch(this.props.notification.type){case"condition-save":case"condition-end":var e=this.props.notification.data;e.duration&&("saves"!==e.duration.type&&"rounds"!==e.duration.type||(e.duration.count-=1,0===e.duration.count?this.close(!0):this.close()));break;case"trait-recharge":this.props.notification.data.uses=0,this.close()}}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.close(this.props.notification,e)}},{key:"render",value:function(){var e=this;try{var t=this.props.notification.combatant,a=this.props.notification.data,n=this.props.notification.data,s=t.displayName||t.name||"unnamed monster";switch(this.props.notification.type){case"condition-save":var i=a.duration,o=i.saveType.toString();return"death"!==o&&(o=o.toUpperCase()),r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," must make a ",o," save against dc ",i.saveDC),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{key:"success",onClick:function(){return e.success()}},"success")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close"))));case"condition-end":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," is no longer affected by condition ",a.name),r.a.createElement("button",{onClick:function(){return e.close()}},"close"));case"trait-recharge":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," can attempt to recharge ",n.name," (",n.usage,")"),r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{key:"recharge",onClick:function(){return e.success()}},"recharge")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close"))));default:return null}}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ua=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"openStatBlock",value:function(e){var t=this.props.getMonster(e.monsterName,e.monsterGroupName);t&&this.props.openStatBlock(t)}},{key:"render",value:function(){var e=this;try{if(!this.props.hasMonsters)return r.a.createElement(d.a,{align:"middle",justify:"center",className:"scrollable"},r.a.createElement(p.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Kt,null,r.a.createElement("div",{className:"section"},"this screen is for building encounters, but before you can do that you need to do these things first:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("library")}},"monsters screen")),this.props.hasMonsters?r.a.createElement(Xt.a,{title:"done",style:{marginLeft:"5px"}}):null)))));var t=this.props.encounters;E.sort(t);var a=t.map((function(t){return r.a.createElement(ma,{key:t.id,encounter:t,parties:e.props.parties,edit:function(t){return e.props.editEncounter(t)},delete:function(t){return e.props.deleteEncounter(t)},run:function(t,a){return e.props.runEncounter(t,a)},openStatBlock:function(t){return e.openStatBlock(t)},getMonster:function(t,a){return e.props.getMonster(t,a)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"on this page you can set up encounters"),r.a.createElement("div",{className:"section"},"when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can then run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of encounters that you have created"),r.a.createElement("div",{className:"section"},"select an encounter from the list to add monsters to it"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start building an encounter, press the ",r.a.createElement("b",null,"create a new encounter")," button")),r.a.createElement("button",{onClick:function(){return e.props.addEncounter()}},"create a new encounter")),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{heading:"encounters",content:a})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ma=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getText",value:function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("div",{className:"name"},t)}},{key:"getPortrait",value:function(e){var t=this.props.getMonster(e.monsterName,e.monsterGroupName);return t&&t.portrait?r.a.createElement(Q,{source:t,inline:!0}):null}},{key:"render",value:function(){var e=this;try{var t=this.props.encounter.slots.map((function(t){return r.a.createElement("div",{key:t.id,className:"combatant-row"},e.getPortrait(t),e.getText(t),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(t)}}))}));0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),this.props.encounter.waves.forEach((function(a){t.push(r.a.createElement("div",{key:"name "+a.id,className:"section subheading"},a.name||"unnamed wave")),a.slots.forEach((function(a){t.push(r.a.createElement("div",{key:a.id,className:"combatant-row"},e.getPortrait(a),e.getText(a),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(a)}})))})),0===t.length&&t.push(r.a.createElement("div",{key:"empty "+a.id,className:"section"},"no monsters"))}));var a=null;if(this.props.parties.length>0){var n=this.props.parties.map((function(e){return{id:e.id,text:e.name}}));a=r.a.createElement(R,{options:n,placeholder:"run with...",select:function(t){return e.props.run(e.props.encounter,t)}})}return r.a.createElement("div",{className:"card encounter"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.encounter.name||"unnamed encounter")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"subheading"},"monsters"),t,r.a.createElement("div",{className:"subheading"},"xp"),O.getEncounterXP(this.props.encounter,this.props.getMonster)),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("button",{onClick:function(){return e.props.edit(e.props.encounter)}},"edit encounter"),r.a.createElement(j,{text:"delete encounter",callback:function(){return e.props.delete(e.props.encounter)}})))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),da=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{align:"middle",justify:"center",className:"scrollable"},r.a.createElement(p.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Kt,null,r.a.createElement("div",{className:"heading"},"welcome to ",r.a.createElement("span",{className:"app-name"},"dojo")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("span",{className:"app-name"},"dojo")," is an app for dms of dungeons and dragons fifth edition"),r.a.createElement("div",{className:"section"},"with this app you can:"),r.a.createElement("ul",null,r.a.createElement("li",null,"build unique, challenging monsters"),r.a.createElement("li",null,"create encounters of just the right difficulty for your players"),r.a.createElement("li",null,"design intricate tactical maps - or have the app generate them for you"),r.a.createElement("li",null,"run combat without the book-keeping")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"use the buttons at the bottom of the screen to explore the app's main features, or press the dm tools button at the top right for additional dm tools"))))}}]),t}(r.a.Component),pa=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.maps;E.sort(t);var a=t.map((function(t){return r.a.createElement(ha,{key:t.id,map:t,editMap:function(t){return e.props.editMap(t)},removeMap:function(t){return e.props.deleteMap(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"on this page you can set up tactical maps"),r.a.createElement("div",{className:"section"},"when you have created a map you can use it in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of maps"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start a new map, press the ",r.a.createElement("b",null,"create a new map")," button")),r.a.createElement("button",{onClick:function(){return e.props.addMap()}},"create a new map"),r.a.createElement(W,{text:"map generator"},r.a.createElement("button",{onClick:function(){return e.props.generateMap("dungeon")}},"create a new dungeon map"),r.a.createElement("button",{onClick:function(){return e.props.generateMap("delve")}},"create a new delve map"))),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{heading:"maps",content:a})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ha=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"card map"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.map.name||"unnamed map")),r.a.createElement("div",{className:"card-content"},r.a.createElement(d.a,{align:"middle",justify:"center",className:"fixed-height"},r.a.createElement(p.a,{span:24},r.a.createElement(ye,{map:this.props.map,mode:"thumbnail",size:12}))),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.editMap(e.props.map)}},"edit map"),r.a.createElement(j,{text:"delete map",callback:function(){return e.props.removeMap(e.props.map)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),fa=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{if(!this.props.hasMonsters)return r.a.createElement(d.a,{align:"middle",justify:"center",className:"scrollable"},r.a.createElement(p.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Kt,null,r.a.createElement("div",{className:"section"},"to kickstart your monster collection, let's import all the monsters from the ",r.a.createElement("a",{href:"http://dnd.wizards.com/articles/features/systems-reference-document-srd",target:"_blank",rel:"noopener noreferrer"},"d&d system reference document")),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.addOpenGameContent()}},"import monsters"))));var t=this.props.library;E.sort(t);var a=t.map((function(t){return r.a.createElement(va,{key:t.id,group:t,open:function(t){return e.props.selectMonsterGroup(t)},delete:function(t){return e.props.deleteMonsterGroup(t)},openStatBlock:function(t){return e.props.openStatBlock(t)},openDemographics:function(t){return e.props.openDemographics(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"you can maintain your menagerie of monsters here"),r.a.createElement("div",{className:"section"},"you can then use these monsters to design combat encounters in the encounter builder"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of monster groups"),r.a.createElement("div",{className:"section"},"select a monster group from the list to see stat blocks for monsters in that group"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start adding monsters, press the ",r.a.createElement("b",null,"create a new monster group")," button")),r.a.createElement("button",{onClick:function(){return e.props.addMonsterGroup()}},"create a new monster group"),r.a.createElement("button",{onClick:function(){return e.props.openDemographics(null)}},"show demographics")),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{heading:"monster groups",content:a})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),va=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getMonsters",value:function(){var e=this,t=this.props.group.monsters.map((function(t){return r.a.createElement("div",{key:t.id,className:"combatant-row"},r.a.createElement(Q,{source:t,inline:!0}),r.a.createElement("div",{className:"name"},t.name||"unnamed monster"),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(t)}}))}));return 0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),t)}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"card monster"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.group.name||"unnamed group")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},this.getMonsters()),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.open(e.props.group)}},"open group"),r.a.createElement("button",{onClick:function(){return e.props.openDemographics(e.props.group)}},"demographics"),r.a.createElement(j,{text:"delete group",callback:function(){return e.props.delete(e.props.group)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ga=a(246),ba=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];return 0!==this.props.monsterGroup.monsters.length?this.props.monsterGroup.monsters.forEach((function(a){t.push(r.a.createElement(ce,{monster:a,mode:"editable",library:e.props.library,moveToGroup:function(t,a){return e.props.moveToGroup(t,a)},removeMonster:function(t){return e.props.removeMonster(t)},viewMonster:function(t){return e.props.viewMonster(t)},editMonster:function(t){return e.props.editMonster(t)},cloneMonster:function(t,a){return e.props.cloneMonster(t,a)}}))})):t.push(r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"there are no monsters in this group"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ya,{monsterGroup:this.props.monsterGroup,goBack:function(){return e.props.goBack()},addMonster:function(){return e.props.addMonster()},importMonster:function(){return e.props.importMonster()},changeValue:function(t,a){return e.props.changeValue(e.props.monsterGroup,t,a)},removeMonsterGroup:function(){return e.props.removeMonsterGroup()},openDemographics:function(){return e.props.openDemographics(e.props.monsterGroup)}})),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{content:t,heading:this.props.monsterGroup.name||"unnamed group"})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ya=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getSummary",value:function(){if(0===this.props.monsterGroup.monsters.length)return r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,"no monsters"));var e={min:30,max:0};this.props.monsterGroup.monsters.forEach((function(t){e.min=Math.min(e.min,t.challenge),e.max=Math.max(e.max,t.challenge)}));var t=e.min===e.max?E.challenge(e.min):E.challenge(e.min)+" - "+E.challenge(e.max);return r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"monsters")),r.a.createElement("div",{className:"section"},this.props.monsterGroup.monsters.length),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"challenge rating")),r.a.createElement("div",{className:"section"},t))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"monster group name"),r.a.createElement(X,{text:this.props.monsterGroup.name,placeholder:"monster group name",onChange:function(t){return e.props.changeValue("name",t)}})),r.a.createElement("div",{className:"divider"}),this.getSummary(),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.addMonster()}},"add a new monster"),r.a.createElement("button",{onClick:function(){return e.props.importMonster()}},"import a monster"),r.a.createElement("button",{onClick:function(){return e.props.openDemographics()}},"show demographics"),r.a.createElement(j,{text:"delete group",callback:function(){return e.props.removeMonsterGroup()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.goBack()}},r.a.createElement(ga.a,{style:{fontSize:"10px"}})," back to the list")))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ea=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.parties;E.sort(t);var a=t.map((function(t){return r.a.createElement(ka,{key:t.id,party:t,open:function(t){return e.props.selectParty(t)},delete:function(t){return e.props.deleteParty(t)},openStatBlock:function(t){return e.props.openStatBlock(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"this page is where you can tell dojo all about your pcs"),r.a.createElement("div",{className:"section"},"you can add a party for each of your gaming groups"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of parties that you have created"),r.a.createElement("div",{className:"section"},"select a party from the list to see pc details"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start adding a party, press the ",r.a.createElement("b",null,"create a new party")," button")),r.a.createElement("button",{onClick:function(){return e.props.addParty()}},"create a new party"),r.a.createElement("button",{onClick:function(){return e.props.importParty()}},"import a party")),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{heading:"parties",content:a})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ka=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getText",value:function(e){var t=e.name||"unnamed pc";return e.player&&(t+=" ("+e.player+")"),t}},{key:"render",value:function(){var e=this;try{var t=this.props.party.pcs.filter((function(e){return e.active})).map((function(t){return r.a.createElement("div",{key:t.id,className:"combatant-row"},r.a.createElement(Q,{source:t,inline:!0}),r.a.createElement("div",{className:"name"},e.getText(t)),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(t)}}))}));0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no pcs"));var a=this.props.party.pcs.filter((function(e){return!e.active}));return a.length>0&&(t.push(r.a.createElement("div",{key:"inactive",className:"subheading"},"inactive pcs")),a.forEach((function(a){return t.push(r.a.createElement("div",{key:a.id,className:"combatant-row"},r.a.createElement(Q,{source:a,inline:!0}),r.a.createElement("div",{className:"name"},e.getText(a)),r.a.createElement(Jt.a,{className:"info-icon",onClick:function(){return e.props.openStatBlock(a)}})))}))),r.a.createElement("div",{className:"card pc"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.party.name||"unnamed party")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"subheading"},"pcs"),t),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.open(e.props.party)}},"open party"),r.a.createElement(j,{text:"delete party",callback:function(){return e.props.delete(e.props.party)}})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Na=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.party.pcs.filter((function(e){return e.active})),a=[];t.forEach((function(t){a.push(r.a.createElement(mt,{pc:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},importPC:function(t){return e.props.importPC(t)},removePC:function(t){return e.props.removePC(t)}}))}));var n=this.props.party.pcs.filter((function(e){return!e.active})),s=[];return n.forEach((function(t){s.push(r.a.createElement(mt,{pc:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},importPC:function(t){return e.props.importPC(t)},removePC:function(t){return e.props.removePC(t)}}))})),0===t.length&&a.push(r.a.createElement(ne,null,r.a.createElement("div",{className:"section"},"there are no pcs in this party"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(p.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar sidebar-left"},r.a.createElement(wa,{party:this.props.party,goBack:function(){return e.props.goBack()},addPC:function(){return e.props.addPC()},changeValue:function(t,a){return e.props.changeValue(e.props.party,t,a)},removeParty:function(){return e.props.removeParty()}})),r.a.createElement(p.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Be,{content:a,heading:this.props.party.name||"unnamed party"}),r.a.createElement(Be,{content:s,heading:"inactive pcs"})))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),wa=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getSummary",value:function(){var e=this.props.party.pcs.filter((function(e){return e.active}));if(0===e.length)return r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,"no pcs"));var t,a,n,s;t=e.map((function(e){return e.languages})).join(", ").split(/[ ,;]+/).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[]).sort((function(e,t){return"Common"===e?-1:"Common"===t?1:e.localeCompare(t)})).join(", ");var i={min:null,max:null},o={min:null,max:null},c={min:null,max:null};return e.forEach((function(e){i.min=null===i.min?e.passiveInsight:Math.min(i.min,e.passiveInsight),i.max=null===i.max?e.passiveInsight:Math.max(i.max,e.passiveInsight),o.min=null===o.min?e.passiveInvestigation:Math.min(o.min,e.passiveInvestigation),o.max=null===o.max?e.passiveInvestigation:Math.max(o.max,e.passiveInvestigation),c.min=null===c.min?e.passivePerception:Math.min(c.min,e.passivePerception),c.max=null===c.max?e.passivePerception:Math.max(c.max,e.passivePerception)})),a=i.min===i.max?i.min.toString():i.min+" - "+i.max,n=o.min===o.max?o.min.toString():o.min+" - "+o.max,s=c.min===c.max?c.min.toString():c.min+" - "+c.max,r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"section",style:{display:""!==t?"block":"none"}},r.a.createElement("div",{className:"subheading"},"party languages")),r.a.createElement("div",{className:"section"},t),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party passive skills")),r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"insight")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"invest.")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"percep."))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},a),r.a.createElement("div",{className:"cell three"},n),r.a.createElement("div",{className:"cell three"},s))))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party name"),r.a.createElement(X,{text:this.props.party.name,placeholder:"party name",onChange:function(t){return e.props.changeValue("name",t)}})),r.a.createElement("div",{className:"divider"}),this.getSummary(),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.addPC()}},"add a new pc"),r.a.createElement(j,{text:"delete party",callback:function(){return e.props.removeParty()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.goBack()}},r.a.createElement(ga.a,{style:{fontSize:"10px"}})," back to the list")))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),xa=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveAfterDelay=E.debounce((function(){return a.saveAll()}),5e3);var n=[];try{var r=window.localStorage.getItem("data-parties");r&&(n=JSON.parse(r))}catch(v){console.error("Could not parse JSON: ",v)}var s=[];try{var i=window.localStorage.getItem("data-library");i&&(s=JSON.parse(i)).forEach((function(e){e.monsters.forEach((function(e){if(void 0===e.legendaryActions){var t=e.traits.some((function(e){return"legendary"===e.type}))?3:0;e.legendaryActions=t}}))}))}catch(v){console.error("Could not parse JSON: ",v)}var c=[];try{var m=window.localStorage.getItem("data-encounters");m&&(c=JSON.parse(m))}catch(v){console.error("Could not parse JSON: ",v)}var d=[];try{var p=window.localStorage.getItem("data-maps");p&&(d=JSON.parse(p))}catch(v){console.error("Could not parse JSON: ",v)}var h=[];try{var f=window.localStorage.getItem("data-combats");f&&(h=JSON.parse(f)).forEach((function(e){e.combatants.forEach((function(e){void 0===e.note&&(e.note="")})),e.map&&void 0===e.map.notes&&(e.map.notes=[]),void 0===e.report&&(e.report=[])}))}catch(v){console.error("Could not parse JSON: ",v)}return a.state={view:"home",drawer:null,parties:n,library:s,encounters:c,maps:d,combats:h,selectedPartyID:null,selectedMonsterGroupID:null,selectedCombatID:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.saveAfterDelay()}},{key:"setView",value:function(e){this.save(),this.setState({view:e})}},{key:"openToolsDrawer",value:function(e){this.setState({drawer:{type:e}})}},{key:"closeDrawer",value:function(){this.setState({drawer:null})}},{key:"selectParty",value:function(e){this.setState({selectedPartyID:e?e.id:null})}},{key:"selectMonsterGroup",value:function(e){this.setState({selectedMonsterGroupID:e?e.id:null})}},{key:"selectPartyByID",value:function(e){this.save(),this.setState({view:"parties",selectedPartyID:e})}},{key:"selectMonsterGroupByID",value:function(e){this.save(),this.setState({view:"library",selectedMonsterGroupID:e})}},{key:"selectEncounterByID",value:function(e){this.save(),this.setState({view:"encounters"})}},{key:"selectMapByID",value:function(e){this.save(),this.setState({view:"maps"})}},{key:"resetAll",value:function(){var e=this;this.setState({parties:[],library:[],encounters:[],maps:[],combats:[],selectedPartyID:null,selectedMonsterGroupID:null,selectedCombatID:null},(function(){return e.saveAll()}))}},{key:"getMonster",value:function(e,t){var a=this.state.library.find((function(e){return e.name===t}));if(a){var n=a.monsters.find((function(t){return t.name===e}));if(n)return n}return null}},{key:"changeValue",value:function(e,t,a){var n=this;switch(t){case"hpCurrent":a=Math.min(a,e.hpMax),a=Math.max(a,0);break;case"hpTemp":a=Math.max(a,0);break;case"level":a=Math.max(a,1),a=void 0!==e.player?Math.min(a,20):Math.min(a,6);break;case"count":case"hitDice":a=Math.max(a,1)}for(var r=t.split("."),s=e,i=0;i!==r.length;++i){var o=r[i];i===r.length-1?s[o]=a:s=s[o]}if(E.sort(this.state.parties),E.sort(this.state.library),E.sort(this.state.encounters),"initiative"===t&&!e.pending){var c=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));O.sortCombatants(c)}this.setState({parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,combats:this.state.combats,selectedPartyID:this.state.selectedPartyID,selectedMonsterGroupID:this.state.selectedMonsterGroupID,selectedCombatID:this.state.selectedCombatID,drawer:this.state.drawer})}},{key:"nudgeValue",value:function(e,t,a){for(var n=t.split("."),r=e,s=0;s!==n.length;++s){var i=n[s];if(s===n.length-1){var o=null;switch(i){case"challenge":o=E.nudgeChallenge(r[i],a);break;case"size":case"displaySize":o=E.nudgeSize(r[i],a);break;default:o=r[i]+a}this.changeValue(e,t,o)}else r=r[i]}}},{key:"addParty",value:function(){var e=k.createParty();e.name="new party";var t=[].concat(this.state.parties,[e]);E.sort(t),this.setState({parties:t,selectedPartyID:e.id})}},{key:"removeCurrentParty",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));t&&this.removeParty(t)}},{key:"removeParty",value:function(e){var t=this.state.parties.indexOf(e);this.state.parties.splice(t,1),this.setState({parties:this.state.parties,selectedPartyID:null})}},{key:"importParty",value:function(){this.setState({drawer:{type:"import-party",party:k.createParty()}})}},{key:"acceptImportedParty",value:function(){this.state.parties.push(this.state.drawer.party),this.setState({parties:this.state.parties,drawer:null})}},{key:"removePC",value:function(e){var t=this,a=this.state.parties.find((function(e){return e.id===t.state.selectedPartyID}));if(a){var n=a.pcs.indexOf(e);a.pcs.splice(n,1),this.setState({parties:this.state.parties})}}},{key:"editPC",value:function(e){e||((e=k.createPC()).name="new pc");var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"pc",pc:t}})}},{key:"importPC",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"update-pc",pc:t}})}},{key:"savePC",value:function(){var e=this;E.sort(this.state.drawer.pc.companions);var t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=t.pcs.find((function(t){return t.id===e.state.drawer.pc.id}));if(a){var n=t.pcs.indexOf(a);t.pcs[n]=this.state.drawer.pc}else t.pcs.push(this.state.drawer.pc);E.sort(t.pcs),this.setState({parties:this.state.parties,drawer:null})}}},{key:"addMonsterGroup",value:function(){var e=k.createMonsterGroup();e.name="new group";var t=[].concat(this.state.library,[e]);E.sort(t),this.setState({library:t,selectedMonsterGroupID:e.id})}},{key:"removeCurrentMonsterGroup",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&this.removeMonsterGroup(t)}},{key:"removeMonsterGroup",value:function(e){var t=this.state.library.indexOf(e);this.state.library.splice(t,1),this.setState({library:this.state.library,selectedMonsterGroupID:null})}},{key:"removeMonster",value:function(e){var t=this,a=this.state.library.find((function(e){return e.id===t.state.selectedMonsterGroupID}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1),this.setState({library:this.state.library})}}},{key:"importMonster",value:function(){this.setState({drawer:{type:"import-monster",monster:k.createMonster()}})}},{key:"acceptImportedMonster",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&(t.monsters.push(this.state.drawer.monster),this.setState({library:this.state.library,drawer:null}))}},{key:"moveToGroup",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1);var r=this.state.library.find((function(e){return e.id===t}));r&&(r.monsters.push(e),E.sort(r.monsters),this.setState({library:this.state.library}))}}},{key:"editMonster",value:function(e){e||((e=k.createMonster()).name="new monster");var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"monster",monster:t,showSidebar:!1}})}},{key:"saveMonster",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));if(t){var a=t.monsters.find((function(t){return t.id===e.state.drawer.monster.id}));if(a){var n=t.monsters.indexOf(a);t.monsters[n]=this.state.drawer.monster}else t.monsters.push(this.state.drawer.monster);E.sort(t.monsters),this.setState({library:this.state.library,drawer:null})}}},{key:"toggleShowSidebar",value:function(){var e=this.state.drawer;e.showSidebar=!e.showSidebar,this.setState({drawer:e})}},{key:"cloneMonster",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=y.clone(e,t);a.monsters.push(n),E.sort(a.monsters),this.setState({library:this.state.library})}}},{key:"addOpenGameContent",value:function(){var e=this;fetch("/dojo/data/monsters.json").then((function(e){return e.json()})).then((function(t){t.forEach((function(t){try{if(t.name){var a=y.createFromJSON(t),n=a.tag||a.category;0===n.indexOf("swarm")&&(n="swarm"),"any race"===n&&(n="npc");var r=e.state.library.find((function(e){return e.name===n}));r||(r={id:E.guid(),name:n,monsters:[]},e.state.library.push(r)),r.monsters.push(a)}}catch(s){console.error(s)}})),E.sort(e.state.library),e.setState({library:e.state.library})}))}},{key:"openDemographics",value:function(e){this.setState({drawer:{type:"monster-demographics",group:e}})}},{key:"editEncounter",value:function(e){e||((e=k.createEncounter()).name="new encounter");var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"encounter",encounter:t}})}},{key:"saveEncounter",value:function(){var e=this,t=this.state.encounters,a=this.state.encounters.find((function(t){return t.id===e.state.drawer.encounter.id}));a?t[this.state.encounters.indexOf(a)]=this.state.drawer.encounter:t.push(this.state.drawer.encounter);E.sort(t),this.setState({encounters:t,drawer:null})}},{key:"removeEncounter",value:function(e){var t=this.state.encounters.indexOf(e);this.state.encounters.splice(t,1),this.setState({encounters:this.state.encounters})}},{key:"generateMap",value:function(e){var t=k.createMap();t.name="new "+e,C.generate(e,t),this.state.maps.push(t),this.setState({maps:this.state.maps})}},{key:"editMap",value:function(e){e||((e=k.createMap()).name="new map");var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"map",map:t}})}},{key:"saveMap",value:function(){var e=this,t=this.state.maps,a=this.state.maps.find((function(t){return t.id===e.state.drawer.map.id}));a?t[this.state.maps.indexOf(a)]=this.state.drawer.map:t.push(this.state.drawer.map);E.sort(t),this.setState({maps:t,drawer:null})}},{key:"removeMap",value:function(e){var t=this.state.maps.indexOf(e);this.state.maps.splice(t,1),this.setState({maps:this.state.maps})}},{key:"createCombat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=1===this.state.parties.length?this.state.parties[0]:null;if(t){var n=this.state.parties.find((function(e){return e.id===t}));n&&(a=n)}var r=1===this.state.encounters.length?this.state.encounters[0]:null;e&&(r=e);var s=k.createCombatSetup();s.party=JSON.parse(JSON.stringify(a)),s.encounter=JSON.parse(JSON.stringify(e)),r&&(s.slotInfo=E.getCombatSlotData(r,this.state.library)),this.setState({drawer:{type:"combat-start",combatSetup:s}})}},{key:"startCombat",value:function(){var e=this,t=this.state.drawer.combatSetup;if(t.party&&t.encounter){var a=t.party.name||"unnamed party",n=t.encounter.name||"unnamed encounter",r=k.createCombat();r.name=a+" vs "+n,r.encounter=JSON.parse(JSON.stringify(t.encounter));var s=k.createCombatReportEntry();s.type="combat-start",r.report.push(s),t.party.pcs.filter((function(e){return e.active})).forEach((function(e){O.addPCToCombat(r,e)})),r.encounter.slots.forEach((function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName),s=t.slotInfo.find((function(e){return e.id===a.id}));n&&s?s.members.forEach((function(e){O.addMonsterToCombat(r,n,e.init,e.hp,e.name)})):r.issues.push("unknown monster: "+a.monsterName+" in group "+a.monsterGroupName)})),O.addPlaceholderToCombat(r),O.sortCombatants(r),t.map&&(r.map=JSON.parse(JSON.stringify(t.map))),this.setState({combats:[].concat(this.state.combats,[r]),selectedCombatID:r.id,drawer:null,view:"combat"})}}},{key:"openAddWaveModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=k.createCombatSetup();a.encounter=t.encounter,a.slotInfo=E.getCombatSlotData(t.encounter,this.state.library),this.setState({drawer:{type:"combat-wave",combatSetup:a}})}}},{key:"addWaveToCombat",value:function(){var e=this,t=this.state.drawer.combatSetup,a=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t&&t.encounter&&a){var n=t.encounter.waves.find((function(e){return e.id===t.waveID}));n&&(n.slots.forEach((function(n){var r=e.getMonster(n.monsterName,n.monsterGroupName);if(r)for(var s=parseInt(E.modifier(r.abilityScores.dex),10),i=E.dieRoll(),o=0;o!==n.count;++o){var c=JSON.parse(JSON.stringify(r));if(c.id=E.guid(),c.displayName=null,t.slotInfo){var l=t.slotInfo.find((function(e){return e.id===n.id}));l&&(c.displayName=l.members[o].name)}c.displaySize=r.size,c.showOnMap=!0,c.current=!1,c.pending="manual"===e.state.drawer.combatSetup.encounterInitMode,c.active="manual"!==e.state.drawer.combatSetup.encounterInitMode,c.defeated=!1,c.initiative=s+i,c.hp=c.hpMax,c.conditions=[],c.tags=[],c.altitude=0,c.aura={radius:0,style:"rounded",color:"#005080"},a&&a.combatants.push(c)}else if(a){var u="unknown monster: "+n.monsterName+" in group "+n.monsterGroupName;a.issues.push(u)}})),O.sortCombatants(a),this.setState({combats:this.state.combats,drawer:null}))}}},{key:"openAddCombatantModal",value:function(){var e=this;if(this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}))){var t=k.createCombatSetup();t.encounter=k.createEncounter(),t.slotInfo=E.getCombatSlotData(t.encounter,this.state.library),this.setState({drawer:{type:"combat-add-combatants",combatSetup:t}})}}},{key:"addMonsterToAddCombatantsModal",value:function(e){var t=this.state.drawer.combatSetup;if(t&&t.encounter){var a=E.getMonsterGroup(e,this.state.library),n=k.createEncounterSlot();n.id=e.id,n.monsterName=e.name,n.monsterGroupName=a.name,t.encounter.slots.push(n),t.slotInfo=E.getCombatSlotData(t.encounter,this.state.library),this.setState({drawer:this.state.drawer})}}},{key:"addCombatantsToCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID})),a=this.state.drawer.combatSetup;t&&a&&a.encounter&&(a.encounter.slots.forEach((function(n){var r=e.getMonster(n.monsterName,n.monsterGroupName),s=a.slotInfo.find((function(e){return e.id===n.id}));r&&s?s.members.forEach((function(e){O.addMonsterToCombat(t,r,e.init,e.hp,e.name)})):t.issues.push("unknown monster: "+n.monsterName+" in group "+n.monsterGroupName)})),O.sortCombatants(t),this.setState({combats:this.state.combats,drawer:null}))}},{key:"addPCToEncounter",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=this.state.parties.find((function(t){return t.id===e}));if(r){var s=r.pcs.find((function(e){return e.id===t}));s&&(O.addPCToCombat(n,s),this.setState({combats:this.state.combats}))}}}},{key:"addCompanionToEncounter",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&(O.addCompanionToCombat(a,e),this.setState({combats:this.state.combats}))}},{key:"pauseCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=k.createCombatReportEntry();a.type="combat-pause",t.report.push(a),this.setState({selectedCombatID:null})}}},{key:"resumeCombat",value:function(e){var t=k.createCombatReportEntry();t.type="combat-resume",e.report.push(t),this.setState({selectedCombatID:e.id})}},{key:"endCombat",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t){var a=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));a&&(t=a)}if(t){var n=k.createCombatReportEntry();n.type="combat-end",t.report.push(n);var r=this.state.combats.indexOf(t);this.state.combats.splice(r,1),this.setState({combats:this.state.combats,selectedCombatID:null})}}},{key:"makeCurrent",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){if(n.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(a){if(a.duration)switch(a.duration.type){case"saves":e&&t.id===e.id&&"start"===a.duration.point&&n.notifications.push({id:E.guid(),type:"condition-save",data:a,combatant:e});break;case"combatant":if(e&&(a.duration.combatantID===e.id||null===a.duration.combatantID)&&"start"===a.duration.point){var r=t.conditions.indexOf(a);t.conditions.splice(r,1),n.notifications.push({id:E.guid(),type:"condition-end",data:a,combatant:e})}break;case"rounds":if(e&&t.id===e.id&&(a.duration.count-=1),0===a.duration.count){var s=t.conditions.indexOf(a);t.conditions.splice(s,1),n&&n.notifications.push({id:E.guid(),type:"condition-end",data:a,combatant:e})}}}))})),e&&"monster"===e.type&&(e.traits.filter((function(e){return e.uses>0&&e.usage.toLowerCase().startsWith("recharge ")})).forEach((function(t){n.notifications.push({id:E.guid(),type:"trait-recharge",data:t,combatant:e})})),e.traits.filter((function(e){return"legendary"===e.type})).forEach((function(e){e.uses=0}))),n.combatants.forEach((function(e){e.current=!1})),e&&(e.current=!0,"pc"===e.type)){var r=k.createCombatReportEntry();r.type="turn-start",r.combatantID=e.id,n.report.push(r)}t&&(n.round+=1),this.setState({combats:this.state.combats})}}},{key:"makeActive",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=e.some((function(e){return e.pending}));e.forEach((function(e){e.pending=!1,e.active=!0,e.defeated=!1})),n&&O.sortCombatants(a),this.setState({combats:this.state.combats})}}},{key:"makeDefeated",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=a.combatants.find((function(e){return e.current}));e.forEach((function(e){if(e.pending=!1,e.active=!1,e.defeated=!0,a.map&&(a.map.items=a.map.items.filter((function(t){return t.id!==e.id}))),n&&"pc"===n.type&&"monster"===e.type){var t=k.createCombatReportEntry();t.type="kill",t.combatantID=n.id,a.report.push(t)}})),n&&e.find((function(e){return e.id===n.id}))?this.endTurn(n):this.setState({combats:this.state.combats})}}},{key:"useTrait",value:function(e,t){t.uses+=1,this.setState({combats:this.state.combats})}},{key:"rechargeTrait",value:function(e,t){t.uses=0,this.setState({combats:this.state.combats})}},{key:"removeCombatants",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&(e.forEach((function(e){var t=a.combatants.indexOf(e);if(a.combatants.splice(t,1),a.map){var n=a.map.items.find((function(t){return t.id===e.id}));if(n){var r=a.map.items.indexOf(n);a.map.items.splice(r,1)}}})),this.setState({combats:this.state.combats}))}},{key:"endTurn",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){if("pc"===e.type){var n=k.createCombatReportEntry();n.type="turn-end",n.combatantID=e.id,a.report.push(n)}a.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(n){if(n.duration)switch(n.duration.type){case"saves":if(t.id===e.id&&"end"===n.duration.point){var r=k.createNotification();r.type="condition-save",r.data=n,r.combatant=e,a.notifications.push(r)}break;case"combatant":if((n.duration.combatantID===e.id||null===n.duration.combatantID)&&"end"===n.duration.point){var s=t.conditions.indexOf(n);t.conditions.splice(s,1);var i=k.createNotification();i.type="condition-end",i.data=n,i.combatant=e,a.notifications.push(i)}}}))}));var r=a.combatants.filter((function(e){return e.current||!e.pending&&e.active&&!e.defeated})).filter((function(e){return"placeholder"!==e.type||O.combatHasLairActions(a)}));if(0===r.length)this.makeCurrent(null,!1);else if(1===r.length&&r[0].defeated)this.makeCurrent(null,!1);else{var s=r.indexOf(e)+1,i=!1;s>=r.length&&(s=0,i=!0),this.makeCurrent(r[s],i)}}}},{key:"changeHP",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&(e.forEach((function(e){var t=a.combatants.find((function(t){return t.id===e.id}));t&&(t.hpCurrent=e.hp,t.hpTemp=e.temp);var n=a.combatants.find((function(e){return e.current}));if(n&&"pc"===n.type){var r=k.createCombatReportEntry();r.type="damage",r.combatantID=n.id,r.value=e.damage,a.report.push(r)}})),this.setState({combats:this.state.combats}))}},{key:"toggleTag",value:function(e,t){e.forEach((function(e){e.tags.includes(t)?e.tags=e.tags.filter((function(e){return e!==t})):e.tags.push(t)})),this.setState({combats:this.state.combats})}},{key:"toggleCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&(e.forEach((function(e){var r=e.conditions.find((function(e){return e.name===t}));if(r)a.removeCondition(e,r);else{var s=k.createCondition();s.name=t,e.conditions.push(s),e.conditions=E.sort(e.conditions,[{field:"name",dir:"asc"}]);var i=n.combatants.find((function(e){return e.current}));if(i&&"pc"===i.type){var o=k.createCombatReportEntry();o.type="condition-add",o.combatantID=i.id,n.report.push(o)}}})),this.setState({combats:this.state.combats}))}},{key:"toggleHidden",value:function(e){e.forEach((function(e){e.showOnMap=!e.showOnMap})),this.setState({combats:this.state.combats})}},{key:"mapAdd",value:function(e,t,a){var n=this,r=k.createMapItem();r.id=e.id,r.type=e.type,r.x=t,r.y=a;var s=1;"monster"===e.type&&(s=E.miniSize(e.size)),r.height=s,r.width=s;var i=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));i&&i.map&&(i.map.items.push(r),this.setState({combats:this.state.combats}))}},{key:"mapMove",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&(e.forEach((function(e){if(n.map){var a=n.map.items.find((function(t){return t.id===e}));if(a){switch(t){case"N":a.y-=1;break;case"NE":a.x+=1,a.y-=1;break;case"E":a.x+=1;break;case"SE":a.x+=1,a.y+=1;break;case"S":a.y+=1;break;case"SW":a.x-=1,a.y+=1;break;case"W":a.x-=1;break;case"NW":a.x-=1,a.y-=1}if("pc"===a.type){var r=k.createCombatReportEntry();r.type="movement",r.combatantID=a.id,n.report.push(r)}}}})),this.setState({combats:this.state.combats}))}},{key:"mapResize",value:function(e,t,a){var n=this,r=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));if(r&&r.map){var s=r.map.items.find((function(t){return t.id===e}));if(s){switch(a){case"in":switch(t){case"N":s.height>1&&(s.y+=1,s.height-=1);break;case"E":s.width>1&&(s.width-=1);break;case"S":s.height>1&&(s.height-=1);break;case"W":s.width>1&&(s.x+=1,s.width-=1)}break;case"out":switch(t){case"N":s.y-=1,s.height+=1;break;case"E":s.width+=1;break;case"S":s.height+=1;break;case"W":s.x-=1,s.width+=1}}this.setState({combats:this.state.combats})}}}},{key:"mapRemove",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&(e.forEach((function(e){if(a.map){var t=a.map.items.find((function(t){return t.id===e}));if(t){var n=a.map.items.indexOf(t);a.map.items.splice(n,1)}}})),this.setState({combats:this.state.combats}))}},{key:"mapAddNote",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=k.createMapNote();n.targetID=e,a.map.notes.push(n),this.setState({combats:this.state.combats})}}},{key:"mapRemoveNote",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=a.map.notes.findIndex((function(t){return t.targetID===e}));a.map.notes.splice(n,1),this.setState({combats:this.state.combats})}}},{key:"scatterCombatants",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(C.scatterCombatants(a,e),this.setState({combats:this.state.combats}))}},{key:"rotateMap",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&t.map&&(C.rotateMap(t.map),this.setState({combats:this.state.combats}))}},{key:"addMapItem",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(a.map.items.push(e),this.setState({combats:this.state.combats}))}},{key:"addCondition",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=k.createCondition();n.name="blinded",this.setState({drawer:{type:"condition-add",condition:n,combatants:e,combat:a}})}}},{key:"addConditionFromModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&(this.state.drawer.combatants.forEach((function(a){var n=JSON.parse(JSON.stringify(e.state.drawer.condition));n.id=E.guid(),a.conditions.push(n),E.sort(a.conditions,[{field:"name",dir:"asc"}]);var r=t.combatants.find((function(e){return e.current}));if(r&&"pc"===r.type){var s=k.createCombatReportEntry();s.type="condition-add",s.combatantID=r.id,t.report.push(s)}})),this.setState({combats:this.state.combats,drawer:null}))}},{key:"editCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&this.setState({drawer:{type:"condition-edit",condition:t,combatants:[e],combat:n}})}},{key:"editConditionFromModal",value:function(){var e=this;this.state.drawer.combatants.forEach((function(t){var a=t.conditions.find((function(t){return t.id===e.state.drawer.condition.id}));if(a){var n=t.conditions.indexOf(a);t.conditions[n]=e.state.drawer.condition,E.sort(t.conditions,[{field:"name",dir:"asc"}])}})),this.setState({combats:this.state.combats,drawer:null})}},{key:"removeCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=e.conditions.indexOf(t);e.conditions.splice(r,1);var s=n.combatants.find((function(e){return e.current}));if(s&&"pc"===s.type){var i=k.createCombatReportEntry();i.type="condition-remove",i.combatantID=s.id,n.report.push(i)}this.setState({combats:this.state.combats})}}},{key:"closeNotification",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=n.notifications.indexOf(e);if(n.notifications.splice(r,1),t&&e.combatant&&e.data){var s=e.combatant.conditions.indexOf(e.data);e.combatant.conditions.splice(s,1)}this.setState({combats:this.state.combats})}}},{key:"showLeaderboard",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&this.setState({drawer:{type:"leaderboard",combat:t}})}},{key:"save",value:function(){switch(this.state.view){case"parties":this.saveKey(this.state.parties,"data-parties");break;case"library":this.saveKey(this.state.library,"data-library");break;case"encounters":this.saveKey(this.state.encounters,"data-encounters");break;case"maps":this.saveKey(this.state.maps,"data-maps");break;case"combat":this.saveKey(this.state.combats,"data-combats")}}},{key:"saveAll",value:function(){this.saveKey(this.state.parties,"data-parties"),this.saveKey(this.state.library,"data-library"),this.saveKey(this.state.encounters,"data-encounters"),this.saveKey(this.state.maps,"data-maps"),this.saveKey(this.state.combats,"data-combats")}},{key:"saveKey",value:function(e,t){try{var a=JSON.stringify(e);console.info("Saving ("+t+"): "+E.toData(a.length)),window.localStorage.setItem(t,a)}catch(n){console.error("Could not stringify data: ",n)}}},{key:"getContent",value:function(){var e=this,t=!1;this.state.parties.forEach((function(e){return t=t||e.pcs.length>0}));var a=!1;switch(this.state.library.forEach((function(e){return a=a||e.monsters.length>0})),this.state.view){case"home":return r.a.createElement(da,null);case"parties":return this.state.selectedPartyID?r.a.createElement(Na,{party:this.state.parties.find((function(t){return t.id===e.state.selectedPartyID})),goBack:function(){return e.selectParty(null)},removeParty:function(){return e.removeCurrentParty()},addPC:function(){return e.editPC(null)},editPC:function(t){return e.editPC(t)},importPC:function(t){return e.importPC(t)},removePC:function(t){return e.removePC(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)}}):r.a.createElement(Ea,{parties:this.state.parties,addParty:function(){return e.addParty()},importParty:function(){return e.importParty()},selectParty:function(t){return e.selectParty(t)},deleteParty:function(t){return e.removeParty(t)},openStatBlock:function(t){return e.setState({drawer:{type:"stat-block",source:t}})}});case"library":return this.state.selectedMonsterGroupID?r.a.createElement(ba,{monsterGroup:this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID})),library:this.state.library,goBack:function(){return e.selectMonsterGroup(null)},removeMonsterGroup:function(){return e.removeCurrentMonsterGroup()},openDemographics:function(t){return e.openDemographics(t)},addMonster:function(){return e.editMonster(null)},importMonster:function(){return e.importMonster()},removeMonster:function(t){return e.removeMonster(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},viewMonster:function(t){return e.setState({drawer:{type:"stat-block",source:t}})},editMonster:function(t){return e.editMonster(t)},cloneMonster:function(t,a){return e.cloneMonster(t,a)},moveToGroup:function(t,a){return e.moveToGroup(t,a)}}):r.a.createElement(fa,{library:this.state.library,hasMonsters:a,addMonsterGroup:function(){return e.addMonsterGroup()},selectMonsterGroup:function(t){return e.selectMonsterGroup(t)},deleteMonsterGroup:function(t){return e.removeMonsterGroup(t)},addOpenGameContent:function(){return e.addOpenGameContent()},openStatBlock:function(t){return e.setState({drawer:{type:"stat-block",source:t}})},openDemographics:function(t){return e.openDemographics(t)}});case"encounters":return r.a.createElement(ua,{encounters:this.state.encounters,parties:this.state.parties,hasMonsters:a,addEncounter:function(){return e.editEncounter(null)},editEncounter:function(t){return e.editEncounter(t)},deleteEncounter:function(t){return e.removeEncounter(t)},runEncounter:function(t,a){return e.createCombat(t,a)},getMonster:function(t,a){return e.getMonster(t,a)},setView:function(t){return e.setView(t)},openStatBlock:function(t){return e.setState({drawer:{type:"stat-block",source:t}})}});case"maps":return r.a.createElement(pa,{maps:this.state.maps,addMap:function(){return e.editMap(null)},generateMap:function(t){return e.generateMap(t)},editMap:function(t){return e.editMap(t)},deleteMap:function(t){return e.removeMap(t)}});case"combat":return this.state.selectedCombatID?r.a.createElement(ca,{combat:this.state.combats.find((function(t){return t.id===e.state.selectedCombatID})),parties:this.state.parties,encounters:this.state.encounters,pauseCombat:function(){return e.pauseCombat()},endCombat:function(){return e.endCombat()},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},makeCurrent:function(t){return e.makeCurrent(t,!1)},makeActive:function(t){return e.makeActive(t)},makeDefeated:function(t){return e.makeDefeated(t)},useTrait:function(t,a){return e.useTrait(t,a)},rechargeTrait:function(t,a){return e.rechargeTrait(t,a)},removeCombatants:function(t){return e.removeCombatants(t)},addCombatants:function(){return e.openAddCombatantModal()},addCompanion:function(t){return e.addCompanionToEncounter(t)},addPC:function(t,a){return e.addPCToEncounter(t,a)},addWave:function(){return e.openAddWaveModal()},addCondition:function(t){return e.addCondition(t)},editCondition:function(t,a){return e.editCondition(t,a)},removeCondition:function(t,a){return e.removeCondition(t,a)},mapAdd:function(t,a,n){return e.mapAdd(t,a,n)},mapResize:function(t,a,n){return e.mapResize(t,a,n)},mapMove:function(t,a){return e.mapMove(t,a)},mapRemove:function(t){return e.mapRemove(t)},mapAddNote:function(t){return e.mapAddNote(t)},mapRemoveNote:function(t){return e.mapRemoveNote(t)},endTurn:function(t){return e.endTurn(t)},changeHP:function(t){return e.changeHP(t)},closeNotification:function(t,a){return e.closeNotification(t,a)},toggleTag:function(t,a){return e.toggleTag(t,a)},toggleCondition:function(t,a){return e.toggleCondition(t,a)},toggleHidden:function(t){return e.toggleHidden(t)},scatterCombatants:function(t){return e.scatterCombatants(t)},rotateMap:function(){return e.rotateMap()},addOverlay:function(t){return e.addMapItem(t)},showLeaderboard:function(){return e.showLeaderboard()}}):r.a.createElement(Ut,{combats:this.state.combats,hasPCs:t,hasMonsters:a,createCombat:function(){return e.createCombat()},resumeCombat:function(t){return e.resumeCombat(t)},deleteCombat:function(t){return e.endCombat(t)},openStatBlock:function(t){return e.setState({drawer:{type:"stat-block",source:t}})},setView:function(t){return e.setView(t)}})}return null}},{key:"getDrawer",value:function(){var e=this,t=null,a=null,n=null,s="50%",i=!1;if(this.state.drawer)switch(this.state.drawer.type){case"import-party":t=r.a.createElement(dt,{party:this.state.drawer.party}),a="import party",n=r.a.createElement("button",{onClick:function(){return e.acceptImportedParty()}},"accept party"),i=!0;break;case"pc":t=r.a.createElement(pt,{pc:this.state.drawer.pc}),a="pc editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.savePC()}},"save changes")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes")));break;case"update-pc":t=r.a.createElement(ht,{pc:this.state.drawer.pc}),a="update pc",n=r.a.createElement("button",{onClick:function(){return e.savePC()}},"accept pc"),i=!0;break;case"monster":t=r.a.createElement(at,{monster:this.state.drawer.monster,library:this.state.library,showSidebar:this.state.drawer.showSidebar}),a="monster editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:6},r.a.createElement("button",{onClick:function(){return e.saveMonster()}},"save changes")),r.a.createElement(p.a,{span:6},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes")),r.a.createElement(p.a,{span:12},r.a.createElement(M,{label:"advanced tools",checked:this.state.drawer.showSidebar,changeValue:function(){return e.toggleShowSidebar()}}))),s="85%";break;case"stat-block":t=r.a.createElement(Mt,{source:this.state.drawer.source}),a="monster",i=!0;break;case"import-monster":t=r.a.createElement(lt,{monster:this.state.drawer.monster}),a="import monster",n=r.a.createElement("button",{onClick:function(){return e.acceptImportedMonster()}},"accept monster"),i=!0;break;case"monster-demographics":t=r.a.createElement(Ge,{groups:this.state.drawer.group?[this.state.drawer.group]:this.state.library}),a="demographics",i=!0;break;case"encounter":t=r.a.createElement(He,{encounter:this.state.drawer.encounter,parties:this.state.parties,library:this.state.library,getMonster:function(t,a){return e.getMonster(t,a)}}),a="encounter editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.saveEncounter()}},"save changes")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes"))),s="75%";break;case"map":t=r.a.createElement(Ke,{map:this.state.drawer.map}),a="map editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.saveMap()}},"save changes")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes"))),s="100%";break;case"combat-start":t=r.a.createElement(xe,{type:"start",combatSetup:this.state.drawer.combatSetup,parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({drawer:e.state.drawer})}}),a="start combat",n=r.a.createElement("button",{className:this.state.drawer.combatSetup.party&&this.state.drawer.combatSetup.encounter?"":"disabled",onClick:function(){return e.startCombat()}},"start encounter"),s="75%",i=!0;break;case"combat-wave":t=r.a.createElement(xe,{type:"add-wave",combatSetup:this.state.drawer.combatSetup,library:this.state.library,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({drawer:e.state.drawer})}}),a="add a wave",n=r.a.createElement("button",{className:null!==this.state.drawer.combatSetup.waveID?"":"disabled",onClick:function(){return e.addWaveToCombat()}},"add wave"),s="75%",i=!0;break;case"combat-add-combatants":t=r.a.createElement(xe,{type:"add-combatants",combatSetup:this.state.drawer.combatSetup,library:this.state.library,getMonster:function(t,a){return e.getMonster(t,a)},addMonster:function(t){return e.addMonsterToAddCombatantsModal(t)},notify:function(){return e.setState({drawer:e.state.drawer})}}),a="add combatants",n=r.a.createElement("button",{className:null!==this.state.drawer.combatSetup.encounter?"":"disabled",onClick:function(){return e.addCombatantsToCombat()}},"add combatants"),s="75%",i=!0;break;case"condition-add":t=r.a.createElement(ze,{condition:this.state.drawer.condition,combatants:this.state.drawer.combatants,combat:this.state.drawer.combat}),a="add a condition",n=r.a.createElement("button",{onClick:function(){return e.addConditionFromModal()}},"add"),s="75%",i=!0;break;case"condition-edit":t=r.a.createElement(ze,{condition:this.state.drawer.condition,combatants:this.state.drawer.combatants,combat:this.state.drawer.combat}),a="edit condition",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.editConditionFromModal()}},"save changes")),r.a.createElement(p.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes"))),s="75%";break;case"leaderboard":t=r.a.createElement(qe,{combat:this.state.drawer.combat}),a="leaderboard",i=!0;break;case"tools":t=r.a.createElement(Ht,{library:this.state.library}),a="dm tools",i=!0;break;case"reference":t=r.a.createElement(St,null),a="reference",i=!0;break;case"search":t=r.a.createElement(Ot,{parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,openParty:function(t){return e.selectPartyByID(t)},openGroup:function(t){return e.selectMonsterGroupByID(t)},openEncounter:function(t){return e.selectEncounterByID(t)},openMap:function(t){return e.selectMapByID(t)}}),a="search",i=!0;break;case"about":t=r.a.createElement(T,{resetAll:function(){return e.resetAll()}}),a="about",i=!0}return{content:t,header:a,footer:n,width:s,closable:i}}},{key:"render",value:function(){var e=this;try{var t=this.getDrawer();return r.a.createElement("div",{className:"dojo"},r.a.createElement(_t,{view:this.state.view,openDrawer:function(t){return e.openToolsDrawer(t)}}),r.a.createElement("div",{className:"page-content"},this.getContent()),r.a.createElement(qt,{view:this.state.view,setView:function(t){return e.setView(t)}}),r.a.createElement(h.a,{closable:!1,maskClosable:t.closable,width:t.width,visible:null!==t.content,onClose:function(){return e.closeDrawer()}},r.a.createElement("div",{className:"drawer-header"},r.a.createElement("div",{className:"app-title"},t.header)),r.a.createElement("div",{className:"drawer-content"},t.content),r.a.createElement("div",{className:"drawer-footer"},t.footer)))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);i.a.render(r.a.createElement(xa,null),document.getElementById("root"))},65:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAJlQTFRF/////v7+/f399PT06enp4eHh3t7e3d3d8/Pz0dHRzc3NzMzM/Pz85+fn4+Pjzs7O6Ojo8fHx3Nzc0NDQ1tbW7e3t9fX12tra7u7u2NjY9vb2+Pj45ubm09PTz8/P29vb9/f34uLi0tLS5eXl+fn57+/v8vLy7Ozs1NTU8PDw1dXV5OTk6urq+vr619fX2dnZ+/v739/f4ODgwOjgmwAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAP8SURBVHja7d1tV6JAGIBhB6lGxzIDx8qyF61VN23r//+4/dBCGiCkCzQP9/Wxs5t77jMPBwZWWi0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMqkvIopV0t5bf/o+KRSx0d+23NxUemTTtdUrts50c4tr95px9Skc9pzrNVZ39Smf+ZULXVeYytj+ucuTeKgY2rVGTg0hBemZhfuDKIO6o4VaGdincbnDP2gUvGRsnvqzOH9OPo3h0NbqWEYffKxK4d4bxStq8uqP/oyWlsjV07ke1fRkeO66o++jo6WVz1iEYtYxCIWsX5oLNUbt7Vuj3vEyovl2ZvRbTCZBLd359eKWLti3T88xtdB3dvpjFiZsdRTuL0BfPWsiJUeS/1K7HHNF4pYqbEWKfuBc02stFj3y7Rtp6sZsZKxvKPU22LdG0WsRKx2xqb8fEysRKzfWfdEX4j1NVb8k4QTj1hfYt0/ZsVaror+1pnXkFh6khXrsei1tl5PvWbEWmTeoA7aBVstTX/aI1ahVqExZpK/thjDVkt/nNL2c2txgI9amfxJ5NRBf25X5E1i409K9eZlZc4kNv1yR29fgu+exIZfSOvwy9/ZOYlCtmjCtFivq2+uq7xJlLL597jP5p9O2wbbMYlStpWHiVrzgfruDOZNopgbFoP11nGr+7rfuto5iXJuhY2/eSsss1X2JEq8yTovcpM1YwZ3TqKsZx28mdXaroqcty93P+ueWquhD4bktMqYxGbG2jmD2ZPYyFi56ypjEpsYq1CrtElsYKwCM5gxic2LVXBdpU1i42J9o1ViEuXG+qMOmsG0SRQby45878B1lZhEqbHs2gS+OrjV9iQKjWXXxpjgRR00g4lJlBnLflQJtidxj3W1PYkiY9l19Ec2J3HPVsZMngXHilttTeJeM/ixtJ7kxrKbVeJJ3HtdiY61sa42JvGAVoJjfWn1bxL3n0HJsWyySuB7h6wrubES68oYY4KHg1pJjZXaypgDvzxKZiwbmjKIjJWxroiVEqusVhJjlTSDImOVtq4ExiqxlbhY5c2gvFhlritpscptJSvWfbmtZMVa9IlVONYTsYhFLGIRi1jEIhaxiEUsYsmM9bycl2op6Skab1Yy0c9nlYVYxCIWsYhVTSxb9Udb52J5d/E3zVT8jhL1Ej27dOfMm/ve4m/Hmg4rNY2/O+LNlVYt//MbCfqV+vxc35lYtub3qhnTsc7E8t7rjvXu0MtG7bzeVnN3FlarpYa1vocuGDr1Wlbl11gr5b8x/vBal8u6Wi0v3Xub9HgaTip/N3J3Ek7HLQep1cC/qZg/WDn7knIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9dffijal8TIpWcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMTAtMjBUMDM6MDY6MzErMDA6MDA219rQAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTEwLTIwVDAzOjA2OjMxKzAwOjAwR4pibAAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAASUVORK5CYII="}},[[133,1,2]]]);