(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,function(e,t,a){e.exports=a.p+"static/media/down-arrow-black.a2fc7a1f.svg"},,function(e,t,a){e.exports=a.p+"static/media/down-arrow.697dc1af.svg"},,,function(e,t,a){e.exports=a.p+"static/media/close-black.7645a5b9.svg"},function(e,t,a){e.exports=a.p+"static/media/warning.67a11a95.svg"},,,function(e,t,a){e.exports=a.p+"static/media/ellipsis.9650a20f.svg"},function(e,t,a){e.exports=a.p+"static/media/minus.7003cf50.svg"},function(e,t,a){e.exports=a.p+"static/media/plus.b60accff.svg"},function(e,t,a){e.exports=a.p+"static/media/checked.5cbd1005.svg"},function(e,t,a){e.exports=a.p+"static/media/unchecked.3d4ae2dd.svg"},function(e){e.exports={name:"dojo",version:"3.4.18",homepage:"https://andyaiken.github.io/dojo/",dependencies:{"@types/react":"^16.8.12","@types/showdown":"^1.9.2","gh-pages":"^2.0.1","node-sass":"^4.11.0",react:"^16.8.6","react-dom":"^16.8.6","react-scripts":"2.1.8",showdown:"^1.9.0",tslint:"^5.15.0","tslint-react":"^3.6.0",typescript:"^3.3.4000"},scripts:{start:"react-scripts start --display-error-details",lint:"tslint --config tslint.json --format verbose 'src/**/*.{ts,tsx}'",predeploy:"react-scripts build",deploy:"gh-pages -d build"},eslintConfig:{extends:["eslint-recommended","react-app"]},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"]}},function(e,t,a){e.exports=a.p+"static/media/settings.042bb1c2.svg"},function(e,t,a){e.exports=a(33)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(14),i=a.n(r),o=(a(28),a(29),a(30),a(1)),c=a(2),l=a(4),u=a(3),m=a(5),p=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getMonsterGroup",value:function(e,t){var a=this.monsterIdToGroup[e.id];if(!a){var n=t.find(function(t){return t.monsters.includes(e)});n&&(a=n,this.monsterIdToGroup[e.id]=a)}return a}},{key:"match",value:function(e,t){if(!e)return!0;var a=!0;return e.toLowerCase().split(" ").forEach(function(e){-1===t.toLowerCase().indexOf(e)&&(a=!1)}),a}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"sort",value:function(e){return e.sort(function(e,t){var a=e.name.toLowerCase(),n=t.name.toLowerCase();return a<n?-1:a>n?1:0}),e}},{key:"sortByValue",value:function(e){return e.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),e}},{key:"sortByCount",value:function(e){return e.sort(function(e,t){if(e.count<t.count)return 1;if(e.count>t.count)return-1;var a=e.value.toLowerCase(),n=t.value.toLowerCase();return a<n?-1:a>n?1:0}),e}},{key:"modifierValue",value:function(e){return Math.floor((e-10)/2)}},{key:"modifier",value:function(e){var t=this.modifierValue(e),a=t.toString();return t>=0&&(a="+"+a),a}},{key:"dieRoll",value:function(){return Math.floor(20*Math.random())+1}},{key:"miniSize",value:function(e){switch(e){case"tiny":case"small":case"medium":return 1;case"large":return 2;case"huge":return 3;case"gargantuan":return 4;default:return 1}}},{key:"hitDieType",value:function(e){switch(e){case"tiny":return 4;case"small":return 6;case"medium":return 8;case"large":return 10;case"huge":return 12;case"gargantuan":return 20;default:return 8}}},{key:"challenge",value:function(e){switch(e){case.125:return"1/8";case.25:return"1/4";case.5:return"1/2";default:return e.toString()}}},{key:"parseChallenge",value:function(e){switch(e){case"1/8":return.125;case"1/4":return.25;case"1/2":return.5;default:return parseInt(e,10)}}},{key:"challengeDetails",value:function(){var e=[];return e.push({cr:0,ac:13,hpMin:1,hpMax:6,attack:3,dmgMin:0,dmgMax:1,save:13}),e.push({cr:.125,ac:13,hpMin:7,hpMax:35,attack:3,dmgMin:2,dmgMax:3,save:13}),e.push({cr:.25,ac:13,hpMin:36,hpMax:49,attack:3,dmgMin:4,dmgMax:5,save:13}),e.push({cr:.5,ac:13,hpMin:50,hpMax:70,attack:3,dmgMin:6,dmgMax:8,save:13}),e.push({cr:1,ac:13,hpMin:71,hpMax:85,attack:3,dmgMin:9,dmgMax:14,save:13}),e.push({cr:2,ac:13,hpMin:86,hpMax:100,attack:3,dmgMin:15,dmgMax:20,save:13}),e.push({cr:3,ac:13,hpMin:101,hpMax:115,attack:4,dmgMin:21,dmgMax:26,save:13}),e.push({cr:4,ac:14,hpMin:116,hpMax:130,attack:5,dmgMin:27,dmgMax:32,save:14}),e.push({cr:5,ac:15,hpMin:131,hpMax:145,attack:6,dmgMin:33,dmgMax:38,save:15}),e.push({cr:6,ac:15,hpMin:146,hpMax:160,attack:6,dmgMin:39,dmgMax:44,save:15}),e.push({cr:7,ac:15,hpMin:161,hpMax:175,attack:6,dmgMin:45,dmgMax:50,save:15}),e.push({cr:8,ac:16,hpMin:176,hpMax:190,attack:7,dmgMin:51,dmgMax:56,save:16}),e.push({cr:9,ac:16,hpMin:191,hpMax:205,attack:7,dmgMin:57,dmgMax:62,save:16}),e.push({cr:10,ac:17,hpMin:206,hpMax:220,attack:7,dmgMin:63,dmgMax:68,save:16}),e.push({cr:11,ac:17,hpMin:221,hpMax:235,attack:8,dmgMin:69,dmgMax:74,save:17}),e.push({cr:12,ac:17,hpMin:236,hpMax:250,attack:8,dmgMin:75,dmgMax:80,save:17}),e.push({cr:13,ac:18,hpMin:251,hpMax:265,attack:8,dmgMin:81,dmgMax:86,save:18}),e.push({cr:14,ac:18,hpMin:266,hpMax:280,attack:8,dmgMin:87,dmgMax:92,save:18}),e.push({cr:15,ac:18,hpMin:281,hpMax:295,attack:8,dmgMin:93,dmgMax:98,save:18}),e.push({cr:16,ac:18,hpMin:296,hpMax:310,attack:9,dmgMin:99,dmgMax:104,save:18}),e.push({cr:17,ac:19,hpMin:311,hpMax:325,attack:10,dmgMin:105,dmgMax:110,save:19}),e.push({cr:18,ac:19,hpMin:326,hpMax:340,attack:10,dmgMin:111,dmgMax:116,save:19}),e.push({cr:19,ac:19,hpMin:341,hpMax:355,attack:10,dmgMin:117,dmgMax:122,save:19}),e.push({cr:20,ac:19,hpMin:356,hpMax:400,attack:10,dmgMin:123,dmgMax:140,save:19}),e.push({cr:21,ac:19,hpMin:401,hpMax:445,attack:11,dmgMin:141,dmgMax:158,save:20}),e.push({cr:22,ac:19,hpMin:446,hpMax:490,attack:11,dmgMin:159,dmgMax:176,save:20}),e.push({cr:23,ac:19,hpMin:491,hpMax:535,attack:11,dmgMin:177,dmgMax:194,save:20}),e.push({cr:24,ac:19,hpMin:536,hpMax:580,attack:12,dmgMin:195,dmgMax:212,save:21}),e.push({cr:25,ac:19,hpMin:581,hpMax:625,attack:12,dmgMin:213,dmgMax:230,save:21}),e.push({cr:26,ac:19,hpMin:626,hpMax:670,attack:12,dmgMin:231,dmgMax:248,save:21}),e.push({cr:27,ac:19,hpMin:671,hpMax:715,attack:13,dmgMin:249,dmgMax:266,save:22}),e.push({cr:28,ac:19,hpMin:716,hpMax:760,attack:13,dmgMin:267,dmgMax:284,save:22}),e.push({cr:29,ac:19,hpMin:761,hpMax:805,attack:13,dmgMin:285,dmgMax:302,save:22}),e.push({cr:30,ac:19,hpMin:806,hpMax:850,attack:14,dmgMin:303,dmgMax:320,save:23}),e}},{key:"experience",value:function(e){switch(e){case 0:return 10;case.125:return 25;case.25:return 50;case.5:return 100;case 1:return 200;case 2:return 450;case 3:return 700;case 4:return 1100;case 5:return 1800;case 6:return 2300;case 7:return 2900;case 8:return 3900;case 9:return 5e3;case 10:return 5900;case 11:return 7200;case 12:return 8400;case 13:return 1e4;case 14:return 11500;case 15:return 13e3;case 16:return 15e3;case 17:return 18e3;case 18:return 2e4;case 19:return 22e3;case 20:return 25e3;case 21:return 33e3;case 22:return 41e3;case 23:return 5e4;case 24:return 62e3;case 30:return 155e3;default:return 0}}},{key:"experienceFactor",value:function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 1.5;case 3:case 4:case 5:case 6:return 2;case 7:case 8:case 9:case 10:return 2.5;case 11:case 12:case 13:case 14:return 3;default:return 4}}},{key:"pcExperience",value:function(e,t){switch(t){case"easy":switch(e){case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 125;case 5:return 250;case 6:return 300;case 7:return 350;case 8:return 450;case 9:return 550;case 10:return 600;case 11:return 800;case 12:return 1e3;case 13:return 1100;case 14:return 1250;case 15:return 1400;case 16:return 1600;case 17:return 2e3;case 18:return 2100;case 19:return 2400;case 20:return 2800;default:return 0}case"medium":switch(e){case 1:return 50;case 2:return 100;case 3:return 150;case 4:return 250;case 5:return 500;case 6:return 600;case 7:return 750;case 8:return 900;case 9:return 1100;case 10:return 1200;case 11:return 1600;case 12:return 2e3;case 13:return 2200;case 14:return 2500;case 15:return 2800;case 16:return 3200;case 17:return 3900;case 18:return 4200;case 19:return 4900;case 20:return 5700;default:return 0}case"hard":switch(e){case 1:return 75;case 2:return 150;case 3:return 225;case 4:return 375;case 5:return 750;case 6:return 900;case 7:return 1100;case 8:return 1400;case 9:return 1600;case 10:return 1900;case 11:return 2400;case 12:return 3e3;case 13:return 3400;case 14:return 3800;case 15:return 4300;case 16:return 4800;case 17:return 5900;case 18:return 6300;case 19:return 7300;case 20:return 8500;default:return 0}case"deadly":switch(e){case 1:return 100;case 2:return 200;case 3:return 400;case 4:return 500;case 5:return 1100;case 6:return 1400;case 7:return 1700;case 8:return 2100;case 9:return 2400;case 10:return 2800;case 11:return 3600;case 12:return 4500;case 13:return 5100;case 14:return 5700;case 15:return 6400;case 16:return 7200;case 17:return 8800;case 18:return 9500;case 19:return 10900;case 20:return 12700;default:return 0}default:return 0}}},{key:"traitType",value:function(e){switch(e){case"trait":return"trait";case"action":return"action";case"legendary":return"legendary action";case"lair":return"lair action";case"regional":return"regional effect";default:return e}}},{key:"nudgeChallenge",value:function(e,t){var a=0;switch(e){case 0:-1===t&&(a=0),1===t&&(a=.125);break;case.125:-1===t&&(a=0),1===t&&(a=.25);break;case.25:-1===t&&(a=.125),1===t&&(a=.5);break;case.5:-1===t&&(a=.25),1===t&&(a=1);break;case 1:-1===t&&(a=.5),1===t&&(a=2);break;default:a=e+t}return a}},{key:"conditionText",value:function(e){switch(e.name){case"blinded":return["a blinded creature can\u2019t see and automatically fails any ability check that requires sight","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage"];case"charmed":return["a charmed creature can\u2019t attack the charmer or target the charmer with harmful abilities or magical effects","the charmer has advantage on any ability check to interact socially with the creature"];case"deafened":return["a deafened creature can\u2019t hear and automatically fails any ability check that requires hearing."];case"exhaustion":switch(e.level){case 1:return["disadvantage on ability checks"];case 2:return["disadvantage on ability checks","speed halved"];case 3:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws"];case 4:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved"];case 5:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0"];case 6:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0","death"];default:return[]}case"frightened":return["a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight","the creature can\u2019t willingly move closer to the source of its fear"];case"grappled":return["a grappled creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","the condition ends if the grappler is incapacitated","the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect"];case"incapacitated":return["an incapacitated creature can\u2019t take actions or reactions"];case"invisible":return["an invisible creature is impossible to see without the aid of magic or a special sense","for the purpose of hiding, the creature is heavily obscured","the creature\u2019s location can be detected by any noise it makes or any tracks it leaves","attack rolls against the creature have disadvantage, and the creature\u2019s attack rolls have advantage"];case"paralyzed":return["a paralyzed creature is incapacitated (can\u2019t take actions or reactions) and can\u2019t move or speak","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"petrified":return["a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)","its weight increases by a factor of ten, and it ceases aging","the creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","attack rolls against the creature have advantage","the creature automatically fails strength and dexterity saving throws","the creature has resistance to all damage","the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized"];case"poisoned":return["a poisoned creature has disadvantage on attack rolls and ability checks"];case"prone":return["a prone creature\u2019s only movement option is to crawl, unless it stands up and thereby ends the condition","the creature has disadvantage on attack rolls","an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage"];case"restrained":return["a restrained creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage","the creature has disadvantage on dexterity saving throws"];case"stunned":return["a stunned creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move, and can speak only falteringly","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage"];case"unconscious":return["an unconscious creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","the creature drops whatever its holding and falls prone","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"custom":default:return[]}}},{key:"conditionDurationText",value:function(e,t){if(null!==e.duration)switch(e.duration.type){case"saves":var a=e.duration,n=a.saveType.toString();"death"!==n&&(n=n.toUpperCase());var s=a.count>1?"saves":"save";return"until you make "+a.count+" "+n+" "+s+" at dc "+a.saveDC;case"combatant":var r=e.duration,i=r.point,o=t.combatants.find(function(e){return e.id===r.combatantID});return"until the "+i+" of "+(o?(o.displayName||o.name||"unnamed monster")+"'s":"someone's")+" next turn";case"rounds":var c=e.duration,l=c.count>1?"rounds":"round";return"for "+c.count+" "+l;default:return null}return null}},{key:"getMonsterNames",value:function(e){var t=[];return e&&e.slots.forEach(function(e){var a=[];if(1===e.count)a.push(e.monsterName);else for(var n=0;n!==e.count;++n)a.push(e.monsterName+" "+(n+1));t.push({id:e.id,names:a})}),t}}]),e}();p.monsterIdToGroup={};var d=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"createParty",value:function(){return{id:p.guid(),name:"",pcs:[]}}},{key:"createPC",value:function(){return{id:p.guid(),type:"pc",active:!0,player:"",name:"",race:"",classes:"",level:1,languages:"Common",passiveInsight:10,passiveInvestigation:10,passivePerception:10,initiative:10,url:""}}},{key:"createMonsterGroup",value:function(){return{id:p.guid(),name:"",monsters:[]}}},{key:"createMonster",value:function(){return{id:p.guid(),type:"monster",name:"",size:"medium",category:"humanoid",tag:"",alignment:"",challenge:1,abilityScores:{str:10,dex:10,con:10,int:10,wis:10,cha:10},ac:10,hpMax:4,hpTemp:0,hitDice:1,damage:{resist:"",vulnerable:"",immune:""},savingThrows:"",speed:"",skills:"",senses:"",languages:"",equipment:"",traits:[],conditionImmunities:""}}},{key:"createTrait",value:function(){return{id:p.guid(),name:"",usage:"",type:"action",text:"",uses:0}}},{key:"createEncounter",value:function(){return{id:p.guid(),name:"",slots:[],waves:[]}}},{key:"createEncounterSlot",value:function(){return{id:p.guid(),monsterGroupName:"",monsterName:"",count:1}}},{key:"createEncounterWave",value:function(){return{id:p.guid(),name:"",slots:[]}}},{key:"createMapFolio",value:function(){return{id:p.guid(),name:"",maps:[]}}},{key:"createMap",value:function(){return{id:p.guid(),name:"",items:[]}}},{key:"createMapItem",value:function(){return{id:p.guid(),type:"tile",x:0,y:0,width:4,height:4,terrain:null}}},{key:"createCombatSetup",value:function(){return{partyID:null,encounterID:null,waveID:null,folioID:null,mapID:null,monsterNames:[],encounterInitMode:"group"}}},{key:"createCombat",value:function(){return{id:p.guid(),name:"",encounterID:null,combatants:[],map:null,round:1,notifications:[],issues:[],timestamp:null}}},{key:"createNotification",value:function(){return{id:p.guid(),type:"condition-save",data:null,combatant:null}}},{key:"createCondition",value:function(){return{id:p.guid(),name:"",level:1,text:null,duration:null}}},{key:"createConditionDurationSaves",value:function(){return{type:"saves",count:1,saveType:"str",saveDC:10,point:"start"}}},{key:"createConditionDurationCombatant",value:function(){return{type:"combatant",point:"start",combatantID:null}}},{key:"createConditionDurationRounds",value:function(){return{type:"rounds",count:1}}}]),e}(),h=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;this.props.getHeading&&(e=this.props.getHeading());var t=null;return this.props.getContent&&(t=this.props.getContent()),t?s.a.createElement("div",{className:"card"},e,s.a.createElement("div",{className:"card-content"},t)):null}catch(a){console.error(a)}}}]),t}(s.a.Component);h.defaultProps={getHeading:null,getContent:null};var v=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"here you can run a combat encounter by specifying a party and an encounter"),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},"below you will see a list of encounters that you have paused"),s.a.createElement("div",{className:"section"},"you can resume a paused combat by selecting it"))}},{key:"render",value:function(){return s.a.createElement(h,{getContent:this.getContent})}}]),t}(s.a.Component),f=a(12),g=a.n(f),b=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pressed:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(){this.setState({pressed:!this.state.pressed})}},{key:"perform",value:function(){this.toggle(),this.props.callback()}},{key:"render",value:function(){var e=this;try{var t=null;return t=this.state.pressed?s.a.createElement("div",null,s.a.createElement("div",{className:"title"},this.props.text," - are you sure?"),s.a.createElement("img",{className:"image",src:g.a,alt:"warning"}),this.props.details?s.a.createElement("div",{className:"details"},this.props.details):null,s.a.createElement("div",{className:"confirmation"},s.a.createElement("div",{className:"destructive",onClick:function(){return e.perform()}},"yes"),s.a.createElement("div",{className:"non-destructive",onClick:function(){return e.toggle()}},"no"))):s.a.createElement("div",null,s.a.createElement("div",{className:"title"},this.props.text),s.a.createElement("img",{className:"image",src:g.a,alt:"warning"})),s.a.createElement("button",{className:this.props.disabled?"disabled":"",onClick:function(){return e.toggle()}},t)}catch(a){return console.error(a),null}}}]),t}(s.a.Component);b.defaultProps={details:null,disabled:!1};var y=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e="control-row";switch(this.props.disabled&&(e+=" disabled"),this.props.controls.length){case 1:e+=" one";break;case 2:e+=" two";break;case 3:e+=" three";break;case 4:e+=" four";break;case 5:e+=" five"}return s.a.createElement("div",{className:e},this.props.controls)}catch(t){return console.error(t),null}}}]),t}(s.a.Component);y.defaultProps={disabled:!1};var E=a(15),k=a.n(E),N=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={open:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleOpen",value:function(e){e.stopPropagation(),this.setState({open:!this.state.open})}},{key:"select",value:function(e){this.setState({open:!1}),this.props.select(e)}},{key:"render",value:function(){var e=this;try{if(0===this.props.options.length)return null;var t,a=this.props.disabled?"dropdown disabled":"dropdown",n=[];if(this.props.selectedID){var r=this.props.options.find(function(t){return t.id===e.props.selectedID});r&&(t=r.text)}else t=this.props.placeholder;if(n.push(s.a.createElement("div",{key:"selection",className:"dropdown-top",title:t},s.a.createElement("div",{className:"item-text"},t),s.a.createElement("img",{className:"arrow",src:k.a,alt:"arrow"}))),this.state.open){a+=" open";var i=this.props.options.map(function(t){return null===t.text?s.a.createElement("div",{key:t.id,className:"divider"}):s.a.createElement(C,{key:t.id,option:t,selected:t.id===e.props.selectedID,select:function(t){return e.select(t)}})});n.push(s.a.createElement("div",{key:"options",className:"dropdown-options"},i))}return s.a.createElement("div",{className:a,onClick:function(t){return e.toggleOpen(t)}},n)}catch(o){return console.error(o),null}}}]),t}(s.a.Component);N.defaultProps={selectedID:null,placeholder:"select...",disabled:!1};var C=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="dropdown-option";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),s.a.createElement("div",{className:t,title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(a){return console.error(a),null}}}]),t}(s.a.Component),x=a(6),w=a.n(x),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={expanded:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(){this.setState({expanded:!this.state.expanded})}},{key:"render",value:function(){var e=this;try{var t=this.props.disabled?"expander disabled":"expander";this.state.expanded&&(t+=" expanded");var a=null;return this.state.expanded&&(a=s.a.createElement("div",{className:"expander-content"},this.props.content)),s.a.createElement("div",{className:t},s.a.createElement("div",{className:"expander-header",onClick:function(){return e.toggle()}},s.a.createElement("div",{className:"expander-text"},this.props.text),s.a.createElement("img",{className:"expander-button",src:w.a,alt:"arrow"})),a)}catch(n){return console.error(n),null}}}]),t}(s.a.Component);M.defaultProps={disabled:!1};var O=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.stopPropagation(),this.props.click(t,a)}},{key:"render",value:function(){var e=this;try{var t="radial "+(this.props.direction||"out");this.props.disabled&&(t+=" disabled");var a="out"===this.props.direction||"both"===this.props.direction||"eight"===this.props.direction,n="in"===this.props.direction||"both"===this.props.direction,r="eight"===this.props.direction;return s.a.createElement("div",{className:t},s.a.createElement("div",{className:"empty",style:{display:r?"none":"inline-block"}}),s.a.createElement("div",{className:"btn diag",style:{display:r?"inline-block":"none"}},s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(135deg)"},alt:"nw",onClick:function(t){return e.click(t,"NW")}})),s.a.createElement("div",{className:"btn"},s.a.createElement("div",null,s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(180deg)"},alt:"n",onClick:function(t){return e.click(t,"N","out")}})),s.a.createElement("div",null,s.a.createElement("img",{src:w.a,style:{display:n?"inline-block":"none"},alt:"n",onClick:function(t){return e.click(t,"N","in")}}))),s.a.createElement("div",{className:"empty",style:{display:r?"none":"inline-block"}}),s.a.createElement("div",{className:"btn diag",style:{display:r?"inline-block":"none"}},s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(-135deg)"},alt:"ne",onClick:function(t){return e.click(t,"NE")}})),s.a.createElement("div",{className:"btn",style:{padding:n&&a?"10px 0":"0"}},s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(90deg)"},alt:"w",onClick:function(t){return e.click(t,"W","out")}}),s.a.createElement("img",{src:w.a,style:{display:n?"inline-block":"none",transform:"rotate(-90deg)"},alt:"w",onClick:function(t){return e.click(t,"W","in")}})),s.a.createElement("div",{className:"empty"}),s.a.createElement("div",{className:"btn",style:{padding:n&&a?"10px 0":"0"}},s.a.createElement("img",{src:w.a,style:{display:n?"inline-block":"none",transform:"rotate(90deg)"},alt:"e",onClick:function(t){return e.click(t,"E","in")}}),s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(-90deg)"},alt:"e",onClick:function(t){return e.click(t,"E","out")}})),s.a.createElement("div",{className:"empty",style:{display:r?"none":"inline-block"}}),s.a.createElement("div",{className:"btn diag",style:{display:r?"inline-block":"none"}},s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(45deg)"},alt:"sw",onClick:function(t){return e.click(t,"SW")}})),s.a.createElement("div",{className:"btn"},s.a.createElement("div",null,s.a.createElement("img",{src:w.a,style:{display:n?"inline-block":"none",transform:"rotate(180deg)"},alt:"s",onClick:function(t){return e.click(t,"S","in")}})),s.a.createElement("div",null,s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none"},alt:"s",onClick:function(t){return e.click(t,"S","out")}}))),s.a.createElement("div",{className:"empty",style:{display:r?"none":"inline-block"}}),s.a.createElement("div",{className:"btn diag",style:{display:r?"inline-block":"none"}},s.a.createElement("img",{src:w.a,style:{display:a?"inline-block":"none",transform:"rotate(-45deg)"},alt:"se",onClick:function(t){return e.click(t,"SE")}})))}catch(i){return console.error(i),null}}}]),t}(s.a.Component);O.defaultProps={direction:"out",disabled:!1};var S=a(16),j=a.n(S),I=a(17),D=a.n(I),V=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){e.stopPropagation(),this.props.nudgeValue(t)}},{key:"touchEnd",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.props.nudgeValue(t)}},{key:"render",value:function(){var e=this;try{var t="info-value",a=this.props.source[this.props.name];0===a&&(t+=" dimmed"),this.props.display&&(a=this.props.display(a));var n=[],r=[];this.props.factors?(this.props.factors.forEach(function(t){n.push(s.a.createElement("div",{key:"minus"+t,className:"spin-button factor",onTouchEnd:function(a){return e.touchEnd(a,-1*t)},onClick:function(a){return e.click(a,-1*t)}},"-"+t)),r.push(s.a.createElement("div",{key:"plus"+t,className:"spin-button factor",onTouchEnd:function(a){return e.touchEnd(a,1*t)},onClick:function(a){return e.click(a,1*t)}},"+"+t))}),n.reverse()):(n.push(s.a.createElement("div",{key:"minus1",className:"spin-button",onTouchEnd:function(t){return e.touchEnd(t,-1)},onClick:function(t){return e.click(t,-1)}},s.a.createElement("img",{className:"image",src:j.a,alt:"minus"}))),r.push(s.a.createElement("div",{key:"plus1",className:"spin-button",onTouchEnd:function(t){return e.touchEnd(t,1)},onClick:function(t){return e.click(t,1)}},s.a.createElement("img",{className:"image",src:D.a,alt:"plus"}))));var i=80*(this.props.factors?this.props.factors.length:1);return s.a.createElement("div",{className:this.props.disabled?"spin disabled":"spin"},s.a.createElement("div",{className:"minus"},n),s.a.createElement("div",{className:"info",style:{width:"calc(100% - "+i+"px)"}},s.a.createElement("div",{className:"info-label"},this.props.label),s.a.createElement("div",{className:t},a)),s.a.createElement("div",{className:"plus"},r))}catch(o){return console.error(o),null}}}]),t}(s.a.Component);V.defaultProps={label:null,disabled:!1,factors:null,display:null};var T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showAbilityScores:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleAbilityScores",value:function(){this.setState({showAbilityScores:!this.state.showAbilityScores})}},{key:"render",value:function(){var e=this;try{return this.props.edit?s.a.createElement("div",null,s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"str",label:"strength",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.str",t)}}),s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"dex",label:"dexterity",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.dex",t)}}),s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"con",label:"constitution",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.con",t)}}),s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"int",label:"intelligence",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.int",t)}}),s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"wis",label:"wisdom",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.wis",t)}}),s.a.createElement(V,{source:this.props.combatant.abilityScores,name:"cha",label:"charisma",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.cha",t)}})):s.a.createElement("div",{className:"ability-scores",onClick:function(){return e.toggleAbilityScores()}},s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"str"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.str:p.modifier(this.props.combatant.abilityScores.str))),s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"dex"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.dex:p.modifier(this.props.combatant.abilityScores.dex))),s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"con"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.con:p.modifier(this.props.combatant.abilityScores.con))),s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"int"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.int:p.modifier(this.props.combatant.abilityScores.int))),s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"wis"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.wis:p.modifier(this.props.combatant.abilityScores.wis))),s.a.createElement("div",{className:"ability-score"},s.a.createElement("div",{className:"ability-heading"},"cha"),s.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.cha:p.modifier(this.props.combatant.abilityScores.cha))))}catch(t){console.error(t)}}}]),t}(s.a.Component);T.defaultProps={edit:null,nudgeValue:null};var P=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];if(this.props.combatant.conditions)for(var a=0;a!==this.props.combatant.conditions.length;++a){var n=this.props.combatant.conditions[a];t.push(s.a.createElement(F,{key:a,condition:n,combat:this.props.combat,nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)},editCondition:function(t){return e.props.editCondition(t)},removeCondition:function(t){return e.props.removeCondition(t)}}))}return s.a.createElement("div",{className:"section"},t,s.a.createElement("button",{onClick:function(){return e.props.addCondition()}},"add a condition"))}catch(r){console.error(r)}}}]),t}(s.a.Component),F=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.condition.name||"condition";"exhaustion"===this.props.condition.name&&(t+=" ("+this.props.condition.level+")"),"custom"===this.props.condition.name&&null!==this.props.condition.text&&(t=this.props.condition.text),null!==this.props.condition.duration&&(t+=" "+p.conditionDurationText(this.props.condition,this.props.combat));var a=[];"exhaustion"===this.props.condition.name&&a.push(s.a.createElement("div",{key:"level",className:"section"},s.a.createElement(V,{source:this.props.condition,name:"level",label:"level",nudgeValue:function(t){return e.props.nudgeConditionValue(e.props.condition,"level",t)}})));for(var n=p.conditionText(this.props.condition),r=0;r!==n.length;++r)a.push(s.a.createElement("div",{key:r,className:"section"},n[r]));return s.a.createElement(M,{text:t,content:s.a.createElement("div",null,a,s.a.createElement("div",{className:"divider"}),s.a.createElement("button",{onClick:function(){return e.props.editCondition(e.props.condition)}},"edit"),s.a.createElement("button",{onClick:function(){return e.props.removeCondition(e.props.condition.id)}},"remove"))})}catch(i){console.error(i)}}}]),t}(s.a.Component),G=a(9),H=a.n(G),A=["tiny","small","medium","large","huge","gargantuan"],z=["aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","humanoid","monstrosity","ooze","plant","undead"],L=["trait","action","legendary","lair","regional"],Y=new H.a.Converter,W=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"createTraitPanel",value:function(e,t,a){var n=this;return s.a.createElement(R,{key:e.id,trait:e,mode:this.props.mode,prevTrait:t,nextTrait:a,changeValue:function(e,t,a){return n.props.changeValue(e,t,a)},removeTrait:function(e){return n.props.removeTrait(e)},copyTrait:function(e){return n.props.copyTrait(e)},swapTraits:function(e,t){return n.props.swapTraits(e,t)}})}},{key:"createSection",value:function(e,t){var a=p.traitType(t)+"s",n=e[t];return 0===n.length?null:s.a.createElement("div",null,s.a.createElement("div",{className:"section subheading"},a),n)}},{key:"render",value:function(){var e=this;try{var t={};return L.forEach(function(a){for(var n=e.props.combatant.traits.filter(function(e){return e.type===a}).filter(function(t){return p.match(e.props.filter,t.name)}),r=[],i=0;i!==n.length;++i){var o=n[i],c=0!==i?n[i-1]:null,l=i!==n.length-1?n[i+1]:null;r.push(e.createTraitPanel(o,c,l))}"edit"===e.props.mode&&r.push(s.a.createElement("button",{key:"add",onClick:function(){return e.props.addTrait(a)}},"add a new ",p.traitType(a))),t[a]=r}),"edit"===this.props.mode?s.a.createElement("div",{className:"row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-4 list-column"},this.createSection(t,"trait")),s.a.createElement("div",{className:"columns small-4 medium-4 large-4 list-column"},this.createSection(t,"action")),s.a.createElement("div",{className:"columns small-4 medium-4 large-4 list-column"},this.createSection(t,"legendary"),this.createSection(t,"lair"),this.createSection(t,"regional"))):s.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"legendary"),this.createSection(t,"lair"),this.createSection(t,"regional"))}catch(a){console.error(a)}}}]),t}(s.a.Component);W.defaultProps={mode:"view",filter:"",addTrait:null,copyTrait:null,removeTrait:null,changeValue:null,swapTraits:null};var R=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=0,a=this.props.trait.name||"unnamed "+p.traitType(this.props.trait.type);if(this.props.trait.usage){var n="";this.props.trait.usage.toLowerCase().startsWith("recharge ")&&(t=1,this.props.trait.uses>0&&(n="; used"));var r=this.props.trait.usage.toLowerCase().match(/(\d+)\s*\/\s*day/);r&&(t=parseInt(r[1],10),this.props.trait.uses>0&&(n="; used "+this.props.trait.uses)),a+=" *("+this.props.trait.usage+n+")*"}var i="**"+a+"** "+this.props.trait.text;switch(this.props.mode){case"view":return s.a.createElement("div",{key:this.props.trait.id,className:"section trait"},s.a.createElement("div",{dangerouslySetInnerHTML:{__html:Y.makeHtml(i)}}));case"edit":var o=s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"name",value:this.props.trait.name,onChange:function(t){return e.props.changeValue(e.props.trait,"name",t.target.value)}}),s.a.createElement("input",{type:"text",placeholder:"usage",value:this.props.trait.usage,onChange:function(t){return e.props.changeValue(e.props.trait,"usage",t.target.value)}}),s.a.createElement("textarea",{placeholder:"details",value:this.props.trait.text,onChange:function(t){return e.props.changeValue(e.props.trait,"text",t.target.value)}}),s.a.createElement("div",{className:"divider"}),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"up",className:this.props.prevTrait?"":"disabled",onClick:function(){return e.props.swapTraits(e.props.trait,e.props.prevTrait)}},"move up"),s.a.createElement("button",{key:"down",className:this.props.nextTrait?"":"disabled",onClick:function(){return e.props.swapTraits(e.props.trait,e.props.nextTrait)}},"move down")]}),s.a.createElement(b,{text:"delete",callback:function(){return e.props.removeTrait(e.props.trait)}}));return s.a.createElement(M,{text:this.props.trait.name||"unnamed "+p.traitType(this.props.trait.type),content:o});case"template":return s.a.createElement("div",{key:this.props.trait.id,className:"section trait"},s.a.createElement("div",{dangerouslySetInnerHTML:{__html:Y.makeHtml(i)}}),s.a.createElement("button",{onClick:function(){return e.props.copyTrait(e.props.trait)}},"copy"));case"combat":var c="",l=null;if(t>0)this.props.trait.uses>=t?(c="strikethrough",l=s.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",0)}},"recharge")):l=s.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",e.props.trait.uses+1)}},"use");return s.a.createElement("div",{key:this.props.trait.id,className:"section trait"},s.a.createElement("div",{className:c,dangerouslySetInnerHTML:{__html:Y.makeHtml(i)}}),l)}}catch(u){console.error(u)}}}]),t}(s.a.Component),_=a(8),q=a.n(_),J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showDetails:!1,cloneName:e.combatant.name+" copy",damageOrHealing:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCloneName",value:function(e){this.setState({cloneName:e})}},{key:"toggleDetails",value:function(){this.setState({showDetails:!this.state.showDetails})}},{key:"setDamage",value:function(e){this.setState({damageOrHealing:e})}},{key:"nudgeDamage",value:function(e){this.setState({damageOrHealing:Math.max(this.state.damageOrHealing+e,0)})}},{key:"heal",value:function(){var e=this,t=this.props.combatant,a=(t.hp?t.hp:0)+this.state.damageOrHealing;a=Math.min(a,this.props.combatant.hpMax),this.setState({damageOrHealing:0},function(){e.props.changeHP(t,a,e.props.combatant.hpTemp)})}},{key:"damage",value:function(){var e=this,t=this.props.combatant,a=t.hp?t.hp:0,n=this.props.combatant.hpTemp,s=this.state.damageOrHealing,r=Math.min(s,n);s-=r,n-=r,a-=s,a=Math.max(a,0),this.setState({damageOrHealing:0},function(){e.props.changeHP(t,a,n)})}},{key:"description",value:function(){var e=(this.props.combatant.size+" "+this.props.combatant.category).toLowerCase();this.props.combatant.tag&&(e+=" ("+this.props.combatant.tag.toLowerCase()+")"),e+=", ";var t="";return this.props.combatant.alignment&&(t=this.props.combatant.alignment.toLowerCase()+", "),e+t+("cr "+p.challenge(this.props.combatant.challenge))}},{key:"monsterIsInWave",value:function(e){var t=this;return e.slots.some(function(e){var a=t.props.library.find(function(e){return e.monsters.includes(t.props.combatant)});return!!a&&e.monsterGroupName===a.name&&e.monsterName===t.props.combatant.name})}},{key:"getHP",value:function(){if(0===this.props.combatant.hitDice)return this.props.combatant.hpMax;var e=p.hitDieType(this.props.combatant.size),t=p.modifierValue(this.props.combatant.abilityScores.con)*this.props.combatant.hitDice,a="";return t>0&&(a=" +"+t),t<0&&(a=" "+t),this.props.combatant.hpMax+" ("+this.props.combatant.hitDice+"d"+e+a+")"}},{key:"render",value:function(){var e=this;try{var t=[];if(-1===this.props.mode.indexOf("no-buttons")){if(-1!==this.props.mode.indexOf("view")){if(-1!==this.props.mode.indexOf("editable")){t.push(s.a.createElement("button",{key:"edit",onClick:function(){return e.props.editMonster(e.props.combatant)}},"edit monster")),t.push(s.a.createElement(M,{key:"clone",text:"clone monster",content:s.a.createElement("div",null,s.a.createElement("input",{type:"text",placeholder:"monster name",value:this.state.cloneName,onChange:function(t){return e.setCloneName(t.target.value)}}),s.a.createElement("button",{onClick:function(){return e.props.cloneMonster(e.props.combatant,e.state.cloneName)}},"create copy"))}));var a=[];this.props.library.forEach(function(t){-1===t.monsters.indexOf(e.props.combatant)&&a.push({id:t.id,text:t.name})}),t.push(s.a.createElement(N,{key:"move",options:a,placeholder:"move to group...",select:function(t){return e.props.moveToGroup(e.props.combatant,t)}})),t.push(s.a.createElement(b,{key:"remove",text:"delete monster",callback:function(){return e.props.removeMonster(e.props.combatant)}}))}if(-1!==this.props.mode.indexOf("encounter"))if(this.props.slot)t.push(s.a.createElement("button",{key:"remove",onClick:function(){return e.props.removeEncounterSlot(e.props.slot)}},"remove from encounter"));else{var n=!1;if(this.monsterIsInWave(this.props.encounter)||(t.push(s.a.createElement("button",{key:"add encounter",onClick:function(){return e.props.addEncounterSlot(e.props.combatant,null)}},"add to encounter")),n=!0),this.props.encounter.waves.forEach(function(a){e.monsterIsInWave(a)||(t.push(s.a.createElement("button",{key:"add "+a.id,onClick:function(){return e.props.addEncounterSlot(e.props.combatant,a.id)}},"add to ",a.name)),n=!0)}),!n)return s.a.createElement(h,{getHeading:function(){return s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},e.props.combatant.name))},getContent:function(){return s.a.createElement("div",{className:"section centered"},s.a.createElement("i",null,"this monster is already part of this encounter"))}})}}if(-1!==this.props.mode.indexOf("combat")){var r=this.props.combatant;-1!==this.props.mode.indexOf("tactical")&&(-1!==this.props.mode.indexOf("on-map")&&(t.push(s.a.createElement("div",{key:"mapMove",className:"section centered"},s.a.createElement(O,{direction:"eight",click:function(t){return e.props.mapMove(r,t)}}))),t.push(s.a.createElement(V,{key:"altitude",source:this.props.combatant,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"altitude",5*t)}})),t.push(s.a.createElement("button",{key:"mapRemove",onClick:function(){return e.props.mapRemove(r)}},"remove from map"))),-1!==this.props.mode.indexOf("off-map")&&t.push(s.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(r)}},"add to map")),t.push(s.a.createElement("div",{key:"tactical-div",className:"divider"}))),!r.pending||r.active||r.defeated||t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(r)}})),r.pending||!r.active||r.defeated||(r.current?(t.push(s.a.createElement("button",{key:"endTurn",onClick:function(){return e.props.endTurn(r)}},"end turn")),t.push(s.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(r)}},"mark as defeated and end turn"))):(t.push(s.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(r)}},"start turn")),t.push(s.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(r)}},"mark as defeated")),t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(r)}})))),r.pending||r.active||!r.defeated||(t.push(s.a.createElement("button",{key:"makeActive",onClick:function(){return e.props.makeActive(r)}},"mark as active")),t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(r)}}))),t.push(s.a.createElement(M,{key:"rename",text:"change name",content:s.a.createElement("div",null,s.a.createElement("input",{type:"text",value:r.displayName,onChange:function(t){return e.props.changeValue(e.props.combatant,"displayName",t.target.value)}}))})),t.push(s.a.createElement(M,{key:"init",text:"change initiative score",content:s.a.createElement("div",null,s.a.createElement(V,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}))}))}this.props.mode.indexOf("template")}var i=null;if(-1!==this.props.mode.indexOf("view")){var o=null;this.props.slot&&(o=s.a.createElement("div",null,s.a.createElement("div",{className:"divider"}),s.a.createElement(V,{source:this.props.slot,name:"count",label:"count",nudgeValue:function(t){return e.props.nudgeValue(e.props.slot,"count",t)}})));var c=null;this.state.showDetails&&(c=s.a.createElement("div",null,s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"ac")," ",this.props.combatant.ac),s.a.createElement("div",{className:"section",style:{display:0!==this.props.combatant.hpMax?"":"none"}},s.a.createElement("b",null,"hp")," ",this.getHP()),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.speed?"":"none"}},s.a.createElement("b",null,"speed")," ",this.props.combatant.speed),s.a.createElement("div",{className:"section"},s.a.createElement(T,{combatant:this.props.combatant})),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.savingThrows?"":"none"}},s.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.skills?"":"none"}},s.a.createElement("b",null,"skills")," ",this.props.combatant.skills),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.resist?"":"none"}},s.a.createElement("b",null,"damage resistances")," ",this.props.combatant.damage.resist),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.vulnerable?"":"none"}},s.a.createElement("b",null,"damage vulnerabilities")," ",this.props.combatant.damage.vulnerable),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.immune?"":"none"}},s.a.createElement("b",null,"damage immunities")," ",this.props.combatant.damage.immune),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.conditionImmunities?"":"none"}},s.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.senses?"":"none"}},s.a.createElement("b",null,"senses")," ",this.props.combatant.senses),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.languages?"":"none"}},s.a.createElement("b",null,"languages")," ",this.props.combatant.languages),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.equipment?"":"none"}},s.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment),s.a.createElement("div",{className:"divider"}),s.a.createElement(W,{combatant:this.props.combatant}))),i=s.a.createElement("div",{className:"stats"},s.a.createElement("div",{className:"section centered"},s.a.createElement("i",null,this.description())),o,c)}-1!==this.props.mode.indexOf("combat")&&(i=s.a.createElement("div",{className:"stats"},s.a.createElement("div",{className:"section centered"},s.a.createElement("i",null,this.description())),s.a.createElement("div",{className:"divider"}),s.a.createElement(V,{source:this.props.combatant,name:"hp",label:"hit points",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hp",t)}}),s.a.createElement(V,{source:this.props.combatant,name:"hpTemp",label:"temp hp",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hpTemp",t)}}),s.a.createElement("div",{className:"divider"}),s.a.createElement(V,{source:this.state,name:"damageOrHealing",factors:[1,10],nudgeValue:function(t){return e.nudgeDamage(t)}}),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"heal",onClick:function(){return e.heal()}},"heal"),s.a.createElement("button",{key:"reset",onClick:function(){return e.setDamage(0)}},"reset"),s.a.createElement("button",{key:"damage",onClick:function(){return e.damage()}},"damage")],disabled:0===this.state.damageOrHealing}),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.resist?"":"none"}},s.a.createElement("b",null,"damage resistances")," ",this.props.combatant.damage.resist),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.vulnerable?"":"none"}},s.a.createElement("b",null,"damage vulnerabilities")," ",this.props.combatant.damage.vulnerable),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.immune?"":"none"}},s.a.createElement("b",null,"damage immunities")," ",this.props.combatant.damage.immune),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement(T,{combatant:this.props.combatant})),s.a.createElement("div",{className:"section",style:{display:0!==this.props.combatant.ac?"":"none"}},s.a.createElement("b",null,"ac")," ",this.props.combatant.ac),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.savingThrows?"":"none"}},s.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.skills?"":"none"}},s.a.createElement("b",null,"skills")," ",this.props.combatant.skills),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.speed?"":"none"}},s.a.createElement("b",null,"speed")," ",this.props.combatant.speed),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.senses?"":"none"}},s.a.createElement("b",null,"senses")," ",this.props.combatant.senses),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.languages?"":"none"}},s.a.createElement("b",null,"languages")," ",this.props.combatant.languages),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.equipment?"":"none"}},s.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment),s.a.createElement("div",{className:"divider"}),s.a.createElement(W,{combatant:this.props.combatant,mode:"combat",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section subheading"},"conditions"),s.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.conditionImmunities?"":"none"}},s.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities),s.a.createElement(P,{combatant:this.props.combatant,combat:this.props.combat,addCondition:function(){return e.props.addCondition(e.props.combatant)},editCondition:function(t){return e.props.editCondition(e.props.combatant,t)},removeCondition:function(t){return e.props.removeCondition(e.props.combatant,t)},nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)}}))),-1!==this.props.mode.indexOf("template")&&(-1!==this.props.mode.indexOf("overview")&&(i=s.a.createElement("div",null,s.a.createElement("div",{className:"section centered"},s.a.createElement("i",null,this.description())),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"speed")," ",this.props.combatant.speed||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"senses")," ",this.props.combatant.senses||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"languages")," ",this.props.combatant.languages||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment||"-"))),-1!==this.props.mode.indexOf("abilities")&&(i=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement(T,{combatant:this.props.combatant})),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"skills")," ",this.props.combatant.skills||"-"))),-1!==this.props.mode.indexOf("cbt-stats")&&(i=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"ac")," ",this.props.combatant.ac),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"hp")," ",this.getHP()),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"damage immunity")," ",this.props.combatant.damage.immune||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"damage resistance")," ",this.props.combatant.damage.resist||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"damage vulnerability")," ",this.props.combatant.damage.vulnerable||"-"),s.a.createElement("div",{className:"section"},s.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities||"-"))),-1!==this.props.mode.indexOf("actions")&&(i=s.a.createElement(W,{combatant:this.props.combatant,mode:"template",filter:this.props.filter,copyTrait:function(t){return e.props.copyTrait(t)}})));var l=null;if(-1!==this.props.mode.indexOf("combat"));else if(-1!==this.props.mode.indexOf("template"));else{var u=this.state.showDetails?"image rotate":"image";l=s.a.createElement("img",{className:u,src:q.a,alt:"arrow",onClick:function(){return e.toggleDetails()}})}var m=(this.props.combatant?this.props.combatant.displayName:null)||this.props.combatant.name||"unnamed monster";return s.a.createElement("div",{className:"card monster"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},m),l),s.a.createElement("div",{className:"card-content"},i,s.a.createElement("div",{style:{display:t.length>0?"":"none"}},s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},t))))}catch(p){console.error(p)}}}]),t}(s.a.Component);J.defaultProps={library:null,changeValue:null,nudgeValue:null,filter:"",editMonster:null,removeMonster:null,cloneMonster:null,moveToGroup:null,copyTrait:null,encounter:null,slot:null,addEncounterSlot:null,removeEncounterSlot:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,changeHP:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null};var X=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showDetails:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleDetails",value:function(){this.setState({showDetails:!this.state.showDetails})}},{key:"render",value:function(){var e=this;try{var t=[];if(-1!==this.props.mode.indexOf("edit")&&(this.props.combatant.active?t.push(s.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.combatant,"active",!1)}},"mark inactive")):t.push(s.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.combatant,"active",!0)}},"mark active")),t.push(s.a.createElement(b,{key:"remove",text:"delete pc",callback:function(){return e.props.removePC(e.props.combatant)}}))),-1!==this.props.mode.indexOf("combat")){var a=this.props.combatant;-1!==this.props.mode.indexOf("tactical")&&(-1!==this.props.mode.indexOf("on-map")&&(t.push(s.a.createElement("div",{key:"mapMove",className:"section centered"},s.a.createElement(O,{direction:"eight",click:function(t){return e.props.mapMove(a,t)}}))),t.push(s.a.createElement(V,{key:"altitude",source:this.props.combatant,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"altitude",5*t)}})),t.push(s.a.createElement("button",{key:"mapRemove",onClick:function(){return e.props.mapRemove(a)}},"remove from map"))),-1!==this.props.mode.indexOf("off-map")&&t.push(s.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(a)}},"add to map")),t.push(s.a.createElement("div",{key:"tactical-div",className:"divider"}))),!a.pending||a.active||a.defeated||t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(a)}})),a.pending||!a.active||a.defeated||(a.current?(t.push(s.a.createElement("button",{key:"endTurn",onClick:function(){return e.props.endTurn(a)}},"end turn")),t.push(s.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(a)}},"mark as defeated and end turn"))):(t.push(s.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(a)}},"start turn")),t.push(s.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(a)}},"mark as defeated")),t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(a)}}))),t.push(s.a.createElement(M,{key:"init",text:"change initiative score",content:s.a.createElement("div",null,s.a.createElement(V,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}))}))),a.pending||a.active||!a.defeated||(t.push(s.a.createElement("button",{key:"makeActive",onClick:function(){return e.props.makeActive(a)}},"mark as active")),t.push(s.a.createElement(b,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(a)}})))}var n=(this.props.combatant.race||"unknown race")+" "+(this.props.combatant.classes||"unknown class")+", level "+this.props.combatant.level,r=s.a.createElement("div",{className:"stats"},s.a.createElement("div",{className:"section centered lowercase"},s.a.createElement("i",null,n),s.a.createElement("div",{style:{display:this.props.combatant.url?"":"none"}},s.a.createElement("a",{href:this.props.combatant.url,target:"_blank",rel:"noopener noreferrer"},"d&d beyond sheet"))),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section subheading"},"languages"),s.a.createElement("div",{className:"section"},this.props.combatant.languages||"-"),s.a.createElement("div",{className:"section subheading"},"passive skills"),s.a.createElement("div",{className:"section"},s.a.createElement("div",null,s.a.createElement("b",null,"insight")," ",this.props.combatant.passiveInsight),s.a.createElement("div",null,s.a.createElement("b",null,"investigation")," ",this.props.combatant.passiveInvestigation),s.a.createElement("div",null,s.a.createElement("b",null,"perception")," ",this.props.combatant.passivePerception))),i=null;-1!==this.props.mode.indexOf("edit")&&(i=this.state.showDetails?s.a.createElement("div",{className:"edit"},s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"input-label",style:{display:this.state.showDetails?"":"none"}},"character name:"),s.a.createElement("input",{type:"text",value:this.props.combatant.name,onChange:function(t){return e.props.changeValue(e.props.combatant,"name",t.target.value)}}),s.a.createElement("div",{className:"input-label",style:{display:this.state.showDetails?"":"none"}},"player name:"),s.a.createElement("input",{type:"text",value:this.props.combatant.player,onChange:function(t){return e.props.changeValue(e.props.combatant,"player",t.target.value)}}),s.a.createElement("div",{className:"input-label"},"race:"),s.a.createElement("input",{type:"text",value:this.props.combatant.race,onChange:function(t){return e.props.changeValue(e.props.combatant,"race",t.target.value)}}),s.a.createElement("div",{className:"input-label"},"class:"),s.a.createElement("input",{type:"text",value:this.props.combatant.classes,onChange:function(t){return e.props.changeValue(e.props.combatant,"classes",t.target.value)}}),s.a.createElement("div",{className:"input-label"},"level:"),s.a.createElement(V,{source:this.props.combatant,name:"level",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"level",t)}}),s.a.createElement("div",{className:"input-label"},"languages:"),s.a.createElement("input",{type:"text",value:this.props.combatant.languages,onChange:function(t){return e.props.changeValue(e.props.combatant,"languages",t.target.value)}}),s.a.createElement("div",{className:"input-label"},"d&d beyond link:"),s.a.createElement("input",{type:"text",value:this.props.combatant.url,onChange:function(t){return e.props.changeValue(e.props.combatant,"url",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section subheading"},"passive skills"),s.a.createElement(V,{source:this.props.combatant,name:"passiveInsight",label:"insight",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"passiveInsight",t)}}),s.a.createElement(V,{source:this.props.combatant,name:"passiveInvestigation",label:"investigation",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"passiveInvestigation",t)}}),s.a.createElement(V,{source:this.props.combatant,name:"passivePerception",label:"perception",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"passivePerception",t)}})):r),-1!==this.props.mode.indexOf("combat")&&(i=r);var o=null;if(-1!==this.props.mode.indexOf("combat"));else{var c=this.state.showDetails?"image rotate":"image";o=s.a.createElement("img",{className:c,src:q.a,alt:"arrow",onClick:function(){return e.toggleDetails()}})}var l=(this.props.combatant?this.props.combatant.displayName:null)||this.props.combatant.name||"unnamed pc";return s.a.createElement("div",{className:"card pc"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},l),o),s.a.createElement("div",{className:"card-content"},i,s.a.createElement("div",{style:{display:t.length>0?"":"none"}},s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},t))))}catch(u){console.error(u)}}}]),t}(s.a.Component);X.defaultProps={removePC:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null};var U=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=this.props.combatant.hp||0,t=this.props.combatant.hpMax+this.props.combatant.hpTemp,a=this.props.combatant.hpMax/2,n=100*Math.max(e,0)/t,r="";r=e>=this.props.combatant.hpMax?"bar unhurt":e<=a?"bar bloodied":"bar injured";var i=null;if(this.props.combatant.hpTemp>0){var o=100*Math.max(this.props.combatant.hpTemp,0)/t;i=s.a.createElement("div",{className:"bar temp",style:{width:o+"%"}})}return s.a.createElement("div",{className:"hp-gauge"},s.a.createElement("div",{className:r,style:{width:n+"%"}}),i)}catch(c){console.error(c)}}}]),t}(s.a.Component),B=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getMapDimensions",value:function(e){var t=this,a=null;if(this.props.map.items.filter(function(e){return"edit"!==t.props.mode||"tile"===e.type}).forEach(function(e){a?(a.minX=Math.min(a.minX,e.x),a.maxX=Math.max(a.maxX,e.x+e.width-1),a.minY=Math.min(a.minY,e.y),a.maxY=Math.max(a.maxY,e.y+e.height-1)):a={minX:e.x,maxX:e.x+e.width-1,minY:e.y,maxY:e.y+e.height-1,width:0,height:0}}),!a){if("thumbnail"===this.props.mode)return null;a={minX:0,maxX:0,minY:0,maxY:0,width:0,height:0}}return a.minX-=e,a.maxX+=e,a.minY-=e,a.maxY+=e,a.width=1+a.maxX-a.minX,a.height=1+a.maxY-a.minY,a}},{key:"getSideLength",value:function(){switch(this.props.mode){case"thumbnail":return 5;case"edit":case"combat":return 25;default:return 5}}},{key:"getStyle",value:function(e,t,a,n,s){var r=this.getSideLength();return{left:"calc("+r+"px * "+(e-s.minX)+")",top:"calc("+r+"px * "+(t-s.minY)+")",width:"calc(("+r+"px * "+a+") + 1px)",height:"calc(("+r+"px * "+n+") + 1px)"}}},{key:"render",value:function(){var e=this;try{var t="edit"===this.props.mode?2:0,a=this.getMapDimensions(t);if(!a)return s.a.createElement("div",null,"(blank map)");var n=[];if("edit"===this.props.mode)for(var r=a.minY;r!==a.maxY+1;++r)for(var i=a.minX;i!==a.maxX+1;++i){var o=this.getStyle(i,r,1,1,a);n.push(s.a.createElement(K,{key:i+","+r,x:i,y:r,style:o,onClick:function(){return e.props.setSelectedItemID(null)},onDoubleClick:function(t,a){return e.props.addMapTile(t,a)}}))}var c=this.props.map.items.filter(function(e){return"tile"===e.type}).map(function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,a);return s.a.createElement(Q,{key:t.id,tile:t,style:n,selectable:"edit"===e.props.mode,selected:e.props.selectedItemID===t.id,thumbnail:"thumbnail"===e.props.mode,select:function(t){return"edit"===e.props.mode?e.props.setSelectedItemID(t):null}})}),l=[];"edit"!==this.props.mode&&(l=this.props.map.items.filter(function(e){return"monster"===e.type||"pc"===e.type}).map(function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,a),r=e.props.combatants.find(function(e){return e.id===t.id});return r?s.a.createElement(Z,{key:t.id,token:t,combatant:r,style:n,simple:"thumbnail"===e.props.mode,selectable:"combat"===e.props.mode,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.setSelectedItemID(t)}}):null}).filter(function(e){return null!==e}));var u=[];if(this.props.showOverlay)for(var m=a.minY;m!==a.maxY+1;++m)for(var p=a.minX;p!==a.maxX+1;++p){var d=this.getStyle(p,m,1,1,a);u.push(s.a.createElement(K,{key:p+","+m,x:p,y:m,style:d,overlay:!0,onClick:function(t,a){return e.props.gridSquareClicked(t,a)}}))}var h="map-panel "+this.props.mode;return s.a.createElement("div",{className:h,onClick:function(){return e.props.setSelectedItemID(null)}},s.a.createElement("div",{className:"grid",style:{height:this.getSideLength()*a.height+1+"px"}},n,c,l,u))}catch(v){console.error(v)}}}]),t}(s.a.Component);B.defaultProps={combatants:null,showOverlay:!1,selectedItemID:null,setSelectedItemID:null,addMapTile:null,gridSquareClicked:null};var K=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.onClick&&this.props.onClick(this.props.x,this.props.y)}},{key:"doubleClick",value:function(e){e.stopPropagation(),this.props.onDoubleClick&&this.props.onDoubleClick(this.props.x,this.props.y)}},{key:"render",value:function(){var e=this,t="grid-square";return this.props.overlay&&(t+=" grid-overlay"),s.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.click(t)},onDoubleClick:function(t){return e.doubleClick(t)}})}}]),t}(s.a.Component);K.defaultProps={overlay:!1,onDoubleClick:null};var Q=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.tile.id))}},{key:"render",value:function(){var e=this,t="tile "+this.props.tile.terrain;return this.props.selected&&(t+=" selected"),this.props.thumbnail&&(t+=" thumbnail"),s.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}})}}]),t}(s.a.Component),Z=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.token.id))}},{key:"render",value:function(){var e=this,t="token "+this.props.token.type;this.props.selected&&(t+=" selected"),this.props.combatant.current&&(t+=" current");var a=null,n=null,r=null,i=null;if(!this.props.simple){var o=this.props.combatant.displayName||this.props.combatant.name;a=s.a.createElement("div",{className:"initials"},o.split(" ").map(function(e){return e[0]})),"monster"===this.props.combatant.type&&(n=s.a.createElement(U,{combatant:this.props.combatant})),this.props.combatant.altitude>0&&(r=s.a.createElement("div",{className:"badge altitude"},"\u23f6")),this.props.combatant.altitude<0&&(r=s.a.createElement("div",{className:"badge altitude"},"\u23f7")),this.props.combatant.conditions&&this.props.combatant.conditions.length>0&&(i=s.a.createElement("div",{className:"badge"},"\u25c6"))}return s.a.createElement("div",{title:this.props.combatant.displayName||this.props.combatant.name,className:t,style:this.props.style,onClick:function(t){return e.select(t)}},a,n,r,i)}}]),t}(s.a.Component),$=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;return this.props.combat.map&&(t=s.a.createElement(B,{map:this.props.combat.map,mode:"thumbnail",combatants:this.props.combat.combatants})),s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.combat)}},s.a.createElement("div",{className:"heading"},this.props.combat.name||"unnamed combat"),s.a.createElement("div",{className:"text"},"paused at ",this.props.combat.timestamp),t)}catch(a){console.error(a)}}}]),t}(s.a.Component),ee=a(11),te=a.n(ee),ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showCards:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleCards",value:function(){this.setState({showCards:!this.state.showCards})}},{key:"render",value:function(){var e=this;try{if(this.props.hidden)return null;var t=null;if(this.props.heading){var a=null;this.props.showClose&&(a=s.a.createElement("img",{className:"image",src:te.a,alt:"close",onClick:function(){return e.props.close()}}));var n=null;if(this.props.showToggle){var r=this.state.showCards?"image rotate":"image";n=s.a.createElement("img",{className:r,src:w.a,alt:"arrow",onClick:function(){return e.toggleCards()}})}t=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},this.props.heading),n,a)}var i=[];return this.props.content.length>0&&this.state.showCards&&(i=this.props.content),s.a.createElement("div",{className:"card-group"},t,s.a.createElement("div",{className:"row small-up-1 medium-up-2 large-up-3 collapse"},i))}catch(o){console.error(o)}}}]),t}(s.a.Component);ae.defaultProps={heading:null,hidden:!1,showClose:!1,showToggle:!1,close:null};var ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={selectedTokenID:null,addingToMapID:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSelectedTokenID",value:function(e){this.setState({selectedTokenID:e})}},{key:"setAddingToMapID",value:function(e){this.setState({addingToMapID:e})}},{key:"createCard",value:function(e){var t=this,a="combat";this.props.combat&&this.props.combat.map&&(a+=" tactical",a+=this.props.combat.map.items.find(function(t){return t.id===e.id})?" on-map":" off-map");switch(e.type){case"pc":return s.a.createElement(X,{key:"selected",combatant:e,mode:a,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.props.makeDefeated(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},mapAdd:function(e){return t.setAddingToMapID(e.id)},mapMove:function(e,a){return t.props.mapMove(e,a)},mapRemove:function(e){return t.props.mapRemove(e)},endTurn:function(e){return t.props.endTurn(e)}});case"monster":return s.a.createElement(J,{key:"selected",combatant:e,mode:a,combat:this.props.combat,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.props.makeDefeated(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(e.id)},mapMove:function(e,a){return t.props.mapMove(e,a)},mapRemove:function(e){return t.props.mapRemove(e)},endTurn:function(e){return t.props.endTurn(e)},changeHP:function(e,a,n){return t.props.changeHP(e,a,n)}});default:return null}}},{key:"addCombatantToMap",value:function(e,t){var a=this;if(this.props.combat){var n=this.props.combat.combatants.find(function(e){return e.id===a.state.addingToMapID});n&&this.props.mapAdd(n,e,t),this.setAddingToMapID(null)}}},{key:"showCombat",value:function(e){return p.match(this.props.filter,e.name)}},{key:"render",value:function(){var e=this;try{if(this.props.combat){var t=[],a=[],n=[],r=[];if(this.props.combat.combatants.forEach(function(i){if(i.current&&t.push(s.a.createElement("div",{key:i.id},e.createCard(i))),!i.pending||i.active||i.defeated||a.push(s.a.createElement(re,{key:i.id,combatant:i,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID,nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},makeActive:function(t){return e.props.makeActive(t)}})),!i.pending&&i.active&&!i.defeated)switch(i.type){case"pc":n.push(s.a.createElement(ie,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}));break;case"monster":n.push(s.a.createElement(oe,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}))}if(!i.pending&&!i.active&&i.defeated)switch(i.type){case"pc":r.push(s.a.createElement(ie,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}));break;case"monster":r.push(s.a.createElement(oe,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}))}}),this.props.showHelp&&0!==a.length){var i=s.a.createElement("div",{key:"pending-help"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"these combatants are not yet part of the encounter"),s.a.createElement("div",{className:"section"},"set initiative on each of them, then add them to the encounter"))}}));a=[i].concat(a)}if(this.props.showHelp&&0===t.length){var o=s.a.createElement("div",{key:"active-help"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)"),s.a.createElement("div",{className:"section"},"to begin the encounter, select the first combatant and press the ",s.a.createElement("b",null,"start turn")," button on their stat block"))}}));n=[o].concat(n)}0===t.length&&t.push(s.a.createElement(h,{key:"current",getContent:function(){return s.a.createElement("div",{className:"section"},"the current initiative holder will be displayed here")}}));var c=null;if(this.props.combat.notifications.length>0){var l=this.props.combat.notifications.map(function(t){return s.a.createElement(se,{key:t.id,notification:t,close:function(t,a){return e.props.close(t,a)}})});c=s.a.createElement("div",{className:"notifications"},l)}var u=null;this.props.combat.map&&(u=s.a.createElement(B,{map:this.props.combat.map,mode:"combat",showOverlay:null!==this.state.addingToMapID,combatants:this.props.combat.combatants,selectedItemID:this.state.selectedTokenID?this.state.selectedTokenID:void 0,setSelectedItemID:function(t){t&&e.setSelectedTokenID(t)},gridSquareClicked:function(t,a){return e.addCombatantToMap(t,a)}}));var m=null;if(this.state.selectedTokenID){var p=this.props.combat.combatants.find(function(t){return t.id===e.state.selectedTokenID});p&&!p.current&&(m=this.createCard(p))}return m||(m=s.a.createElement(h,{key:"selected",getContent:function(){return s.a.createElement("div",{className:"section"},"select a pc or monster to see its details here")}})),s.a.createElement("div",{className:"combat-manager row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},s.a.createElement(ae,{heading:"initiative holder",content:t})),s.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},c,s.a.createElement(ae,{heading:"waiting for intiative to be entered",content:a,hidden:0===a.length,showToggle:!0}),u,s.a.createElement(ae,{heading:"combatants in the encounter",content:n,hidden:0===n.length}),s.a.createElement(ae,{heading:"defeated",content:r,hidden:0===r.length,showToggle:!0})),s.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},s.a.createElement(ae,{heading:"selected combatant",content:[m]})))}var d=null;this.props.showHelp&&(d=s.a.createElement(v,null));var f=this.props.combats.filter(function(t){return e.showCombat(t)}).map(function(t){return s.a.createElement($,{key:t.id,combat:t,selected:!1,setSelection:function(t){return e.props.resumeEncounter(t)}})});return s.a.createElement("div",{className:"combat-manager row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},d,s.a.createElement("button",{onClick:function(){return e.props.createCombat()}},"start a new combat"),f),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"}))}catch(g){console.error(g)}}}]),t}(s.a.Component),se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"success",value:function(){switch(this.props.notification.type){case"condition-save":case"condition-end":var e=this.props.notification.data;e.duration&&("saves"!==e.duration.type&&"rounds"!==e.duration.type||(e.duration.count-=1,0===e.duration.count?this.close(!0):this.close()));break;case"trait-recharge":this.props.notification.data.uses=0,this.close()}}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.close(this.props.notification,e)}},{key:"render",value:function(){var e=this,t=this.props.notification.combatant,a=this.props.notification.data,n=this.props.notification.data,r=t.displayName||t.name||"unnamed monster";switch(this.props.notification.type){case"condition-save":var i=a.duration,o=i.saveType.toString();return"death"!==o&&(o=o.toUpperCase()),s.a.createElement("div",{key:this.props.notification.id,className:"notification"},s.a.createElement("div",{className:"text"},r," must make a ",o," save against dc ",i.saveDC),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"success",onClick:function(){return e.success()}},"success"),s.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));case"condition-end":return s.a.createElement("div",{key:this.props.notification.id,className:"notification"},s.a.createElement("div",{className:"text"},r," is no longer affected by condition ",a.name),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));case"trait-recharge":return s.a.createElement("div",{key:this.props.notification.id,className:"notification"},s.a.createElement("div",{className:"text"},r," can attempt to recharge ",n.name," (",n.usage,")"),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"recharge",onClick:function(){return e.success()}},"recharge"),s.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));default:return null}}}]),t}(s.a.Component),re=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this,t="combatant-row "+this.props.combatant.type;return(this.props.combatant.current||this.props.selected)&&(t+=" highlight"),s.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},s.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",s.a.createElement("span",{className:"info"},this.getInformationText())),s.a.createElement("div",{className:"content"},s.a.createElement(V,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}),s.a.createElement("button",{onClick:function(t){t.stopPropagation(),e.props.makeActive(e.props.combatant)}},"add to encounter")))}}]),t}(s.a.Component),ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.combatant.current||this.props.selected||!this.props.select||this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this,t="combatant-row "+this.props.combatant.type;(this.props.combatant.current||this.props.selected)&&(t+=" highlight");var a=(this.props.combatant.race||"unknown race")+" "+(this.props.combatant.classes||"unknown class")+", level "+this.props.combatant.level,n=[];return this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find(function(t){return t.id===e.props.combatant.id})||n.push(s.a.createElement("div",{key:"not-on-map",className:"note"},"not on the map"))),s.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},s.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",this.props.combatant.player?" | "+this.props.combatant.player:"",s.a.createElement("span",{className:"info"},this.getInformationText())),s.a.createElement("div",{className:"content"},s.a.createElement("div",{className:"section lowercase"},a),n))}}]),t}(s.a.Component),oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.combatant.current||this.props.selected||!this.props.select||this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this,t="combatant-row "+this.props.combatant.type;(this.props.combatant.current||this.props.selected)&&(t+=" highlight");var a=(this.props.combatant.hp?this.props.combatant.hp:0).toString();this.props.combatant.hpTemp>0&&(a+="+"+this.props.combatant.hpTemp);var n=null;this.props.combatant.pending||(n=s.a.createElement(U,{combatant:this.props.combatant}));var r=null;this.props.combatant.conditions&&(r=this.props.combatant.conditions.map(function(t){var a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),"custom"===t.name&&t.text&&(a=t.text),t.duration&&(a+=" "+p.conditionDurationText(t,e.props.combat));for(var n=[],r=p.conditionText(t),i=0;i!==r.length;++i)n.push(s.a.createElement("li",{key:i,className:"condition-text"},r[i]));return s.a.createElement("div",{key:t.id,className:"condition"},s.a.createElement("div",{className:"condition-name"},a),s.a.createElement("ul",null,n))}));var i=[];return this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find(function(t){return t.id===e.props.combatant.id})||i.push(s.a.createElement("div",{key:"not-on-map",className:"note"},"not on the map"))),s.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},s.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",s.a.createElement("span",{className:"info"},this.getInformationText())),s.a.createElement("div",{className:"content"},s.a.createElement("div",{className:"section key-stats"},s.a.createElement("div",{className:"key-stat"},s.a.createElement("div",{className:"stat-label"},"ac"),s.a.createElement("div",{className:"stat-value"},this.props.combatant.ac)),s.a.createElement("div",{className:"key-stat"},s.a.createElement("div",{className:"stat-value"},a),s.a.createElement("div",{className:"stat-label"},"hp"))),n,r,i))}}]),t}(s.a.Component),ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"this is the dm screen"),s.a.createElement("div",{className:"section"},"it contains a collection of modules which might be useful when you're running the game"),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},"click on a module below to open it"))}},{key:"render",value:function(){return s.a.createElement(h,{getContent:this.getContent})}}]),t}(s.a.Component),le=a(7),ue=a.n(le),me=a(10),pe=new H.a.Converter,de=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(me.a)(ue.a.mark(function e(){var t;return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/actions.md");case 2:return t=e.sent,e.t0=this,e.next=6,t.text();case 6:e.t1=e.sent,e.t2={source:e.t1},e.t0.setState.call(e.t0,e.t2);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.source||this.fetchData(),s.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.makeHtml(this.state.source||"")}})}}]),t}(s.a.Component),he=new H.a.Converter;he.setOption("tables",!0);var ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(me.a)(ue.a.mark(function e(){var t;return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/conditions.md");case 2:return t=e.sent,e.t0=this,e.next=6,t.text();case 6:e.t1=e.sent,e.t2={source:e.t1},e.t0.setState.call(e.t0,e.t2);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.source||this.fetchData(),s.a.createElement("div",{dangerouslySetInnerHTML:{__html:he.makeHtml(this.state.source||"")}})}}]),t}(s.a.Component),fe=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"initModel",value:function(t){var a=[];t.forEach(function(t){t.split(/\r?\n/).forEach(function(t){t&&e.addLineToModel(t,a)})}),e.model=a}},{key:"addLineToModel",value:function(e,t){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);for(var a=function(a){var n=e.substr(a-2,2),s=e.substr(a,1),r=t.find(function(e){return e.prev===n});r||(r={prev:n,freq:[]},t.push(r));var i=r.freq.find(function(e){return e.char===s});i||(i={char:s,count:0},r.freq.push(i)),i.count+=1},n=2;n!==e.length;++n)a(n)}},{key:"generate",value:function(t){for(var a=[],n=0;a.length<t&&n<100;){var s=e.extractLine();s&&!a.includes(s)?a.push(s):n+=1}return a}},{key:"extractLine",value:function(){for(var t=String.fromCharCode(0,1),a=function(){var a=t.substr(t.length-2,2),n=e.model.find(function(e){return e.prev===a});if(!n)return{v:null};var s="";n.freq.forEach(function(e){s+=e.char.repeat(e.count)});var r=Math.floor(Math.random()*s.length),i=s[r];if(i===String.fromCharCode(2))return{v:t=t.substr(2)};t+=i};;){var n=a();if("object"===typeof n)return n.v}}}]),e}();fe.model=[];var ge=a(18),be=a.n(ge),ye=a(19),Ee=a.n(ye),ke=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.changeValue(!this.props.checked)}},{key:"render",value:function(){var e=this;try{var t="checkbox";return this.props.checked&&(t+=" checked"),this.props.disabled&&(t+=" disabled"),s.a.createElement("div",{className:t,onClick:function(t){return e.click(t)}},s.a.createElement("img",{className:"image",src:this.props.checked?be.a:Ee.a,alt:"check"}),s.a.createElement("div",{className:"checkbox-label"},this.props.label))}catch(a){return console.error(a),null}}}]),t}(s.a.Component);ke.defaultProps={disabled:!1};var Ne=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.tabs?"selector tabs":"selector radio";this.props.disabled&&(t+=" disabled");for(var a=this.props.itemsPerRow?this.props.itemsPerRow:this.props.options.length,n=Math.ceil(this.props.options.length/a),r=[],i=0;i!==n;++i)r.push([]);this.props.options.forEach(function(t){var n=e.props.options.indexOf(t),i=Math.floor(n/a);r[i].push(s.a.createElement(Ce,{key:t.id,option:t,selected:t.id===e.props.selectedID,count:a,select:function(t){return e.props.select(t)}}))});var o=r.map(function(e){var t=r.indexOf(e);return s.a.createElement("div",{key:t},e)});return s.a.createElement("div",{className:t},o)}catch(c){return console.error(c),null}}}]),t}(s.a.Component);Ne.defaultProps={tabs:!1,disabled:!1,itemsPerRow:null};var Ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="option";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),s.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),null}}}]),t}(s.a.Component),xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={sources:{},output:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLanguages",value:function(){return["afrikaans","amharic","armenian","basque","belarusian","bulgarian","chichewa","chinese","croatian","czech","danish","dutch","english","finnish","french","german","greek","hawaiian","hindi","hungarian","icelandic","irish","italian","japanese","kannada","kazakh","korean","kyrgyz","latvian","lithuanian","macedonian","malay","maltese","maori","myanmar","nepalese","norwegian","persian","portuguese","punjabi","romanian","russian","samoan","serbian","shona","somali","spanish","swahili","swedish","thai","turkish","welsh","yiddish","zulu"]}},{key:"getPresets",value:function(){return[{name:"draconic",languages:["armenian","irish","maltese"]},{name:"dwarvish",languages:["czech","german","yiddish"]},{name:"elvish",languages:["finnish","spanish","welsh"]},{name:"goblin",languages:["hawaiian","kyrgyz","somali"]},{name:"orc",languages:["macedonian","russian","turkish"]}]}},{key:"addLanguage",value:function(){var e=Object(me.a)(ue.a.mark(function e(t){var a;return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/langs/"+t+".txt");case 2:return a=e.sent,e.next=5,a.text();case 5:this.state.sources[t]=e.sent,this.setState({sources:this.state.sources});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"removeLanguage",value:function(e){delete this.state.sources[e],this.setState({sources:this.state.sources})}},{key:"usePreset",value:function(e){var t=this,a=this.getPresets().find(function(t){return t.name===e});a&&this.setState({sources:{},output:[]},function(){a.languages.forEach(function(e){t.addLanguage(e)})})}},{key:"random",value:function(){for(var e=this,t=this.getLanguages(),a=[];3!==a.length;){var n=t[Math.floor(Math.random()*t.length)];a.includes(n)||a.push(n)}this.setState({sources:{},output:[]},function(){a.forEach(function(t){e.addLanguage(t)})})}},{key:"generate",value:function(){var e=this,t=[];Object.keys(this.state.sources).forEach(function(a){var n=e.state.sources[a];t.push(n)}),fe.initModel(t),this.setState({output:fe.generate(5)})}},{key:"reset",value:function(){this.setState({sources:{},output:[]})}},{key:"render",value:function(){var e=this,t=this.getPresets().map(function(e){return{id:e.name,text:e.name}}),a="";this.getPresets().forEach(function(t){Object.keys(e.state.sources).sort().join(", ")===t.languages.sort().join(", ")&&(a=t.name)});for(var n=this.getLanguages().map(function(t){var a=Object.keys(e.state.sources).includes(t);return s.a.createElement("div",{className:"column",key:t},s.a.createElement(ke,{label:t,checked:a,changeValue:function(a){return a?e.addLanguage(t):e.removeLanguage(t)}}))}),r=Object.keys(this.state.sources).length>0,i=r||this.state.output.length>0,o=[],c=0;c!==this.state.output.length;++c)o.push(s.a.createElement("div",{key:c,className:"section"},this.state.output[c]));return s.a.createElement("div",{className:"language"},s.a.createElement("div",{className:"subheading"},"presets"),s.a.createElement(Ne,{options:t,selectedID:a,select:function(t){return e.usePreset(t)}}),s.a.createElement("div",{className:"subheading"},"languages"),s.a.createElement("div",{className:"row collapse small-up-3 medium-up-4 large-up-6 language-options"},n),s.a.createElement("div",{className:"subheading"},"output"),s.a.createElement(y,{controls:[s.a.createElement("button",{key:"generate",className:r?"":"disabled",onClick:function(){return e.generate()}},"generate text"),s.a.createElement("button",{key:"reset",className:i?"":"disabled",onClick:function(){return e.reset()}},"reset"),s.a.createElement("button",{key:"random",onClick:function(){return e.random()}},"random sources")]}),s.a.createElement("div",{className:"language-output"},o))}}]),t}(s.a.Component),we=new H.a.Converter,Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(me.a)(ue.a.mark(function e(){var t;return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/skills.md");case 2:return t=e.sent,e.t0=this,e.next=6,t.text();case 6:e.t1=e.sent,e.t2={source:e.t1},e.t0.setState.call(e.t0,e.t2);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.source||this.fetchData(),s.a.createElement("div",{dangerouslySetInnerHTML:{__html:we.makeHtml(this.state.source||"")}})}}]),t}(s.a.Component),Oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.module)}},s.a.createElement("div",{className:"heading"},this.props.module.name||"unnamed module"),s.a.createElement("div",{className:"text"},this.props.module.desc||"no information"))}catch(t){console.error(t)}}}]),t}(s.a.Component),Se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getModules",value:function(){return[{id:"skills",name:"skills",desc:"listing of all the skills in the game"},{id:"conditions",name:"conditions",desc:"information about conditions and their effects"},{id:"actions",name:"actions",desc:"list of the available action types and examples"},{id:"language",name:"language generator",desc:"this tool allows you to generate text in unique languages"}]}},{key:"getContent",value:function(){switch(this.props.selectedModuleID){case"skills":return s.a.createElement(Me,null);case"conditions":return s.a.createElement(ve,null);case"actions":return s.a.createElement(de,null);case"language":return s.a.createElement(xe,null);default:return null}}},{key:"render",value:function(){var e=this;try{var t=null;this.props.showHelp&&(t=s.a.createElement(ce,null));for(var a=this.getModules(),n=[],r=0;r!==a.length;++r){var i=a[r];n.push(s.a.createElement(Oe,{key:i.id,module:i,selected:i.id===this.props.selectedModuleID,setSelection:function(t){return e.props.selectModule(t)}}))}return s.a.createElement("div",{className:"dm-screen row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t,n),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},s.a.createElement("div",{className:"dm-module"},this.getContent())))}catch(o){console.error(o)}}}]),t}(s.a.Component),je=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=0,a=0,n=[];n=n.concat(this.props.encounter.slots),this.props.encounter.waves.forEach(function(e){n=n.concat(e.slots)}),n.forEach(function(n){t+=n.count;var s=e.props.getMonster(n.monsterName,n.monsterGroupName);s&&(a+=p.experience(s.challenge)*n.count)});var r,i,o=a*p.experienceFactor(t);if(this.props.party){var c=0,l=0,u=0,m=0,d=this.props.party.pcs.filter(function(e){return e.active});d.forEach(function(e){c+=p.pcExperience(e.level,"easy"),l+=p.pcExperience(e.level,"medium"),u+=p.pcExperience(e.level,"hard"),m+=p.pcExperience(e.level,"deadly")});var h=null,v=null;if(o>0&&(h="trivial",o>=c&&(h="easy"),o>=l&&(h="medium"),o>=u&&(h="hard"),o>=m&&(h="deadly"),v=h,d.length<3||d.length>5)){var f=d.length<3;switch(h){case"trivial":v=f?"easy":"trivial";break;case"easy":v=f?"medium":"trivial";break;case"medium":v=f?"hard":"easy";break;case"hard":v=f?"deadly":"medium";break;case"deadly":v=f?"deadly":"hard";break;default:v=""}}r=s.a.createElement("div",{className:"table"},s.a.createElement("div",null,s.a.createElement("div",{className:"cell four"},s.a.createElement("b",null,"easy")),s.a.createElement("div",{className:"cell four"},s.a.createElement("b",null,"medium")),s.a.createElement("div",{className:"cell four"},s.a.createElement("b",null,"hard")),s.a.createElement("div",{className:"cell four"},s.a.createElement("b",null,"deadly"))),s.a.createElement("div",null,s.a.createElement("div",{className:"cell four"},c," xp"),s.a.createElement("div",{className:"cell four"},l," xp"),s.a.createElement("div",{className:"cell four"},u," xp"),s.a.createElement("div",{className:"cell four"},m," xp")));var g=function(e){return 100*e/Math.max(o,1.2*m)},b=function(e){return 100-g(e)};i=s.a.createElement("div",null,s.a.createElement("div",{className:"difficulty-gauge"},s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar trivial",style:{left:"0",right:b(c)+"%"}})),s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar easy",style:{left:g(c)+"%",right:b(l)+"%"}})),s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar medium",style:{left:g(l)+"%",right:b(u)+"%"}})),s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar hard",style:{left:g(u)+"%",right:b(m)+"%"}})),s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar deadly",style:{left:g(m)+"%",right:"0"}})),s.a.createElement("div",{className:"encounter-container"},s.a.createElement("div",{className:"encounter",style:{left:g(o)-.5+"%"}}))),s.a.createElement("div",{className:"subheading"},"difficulty"),s.a.createElement("div",{className:"section"},"difficulty for this party",s.a.createElement("div",{className:"right"},h)),s.a.createElement("div",{className:"section",style:{display:v===h?"none":""}},"effective difficulty for ",d.length," pc(s)",s.a.createElement("div",{className:"right"},s.a.createElement("b",null,v))))}return s.a.createElement("div",null,s.a.createElement("div",{className:"subheading"},"xp value"),s.a.createElement("div",{className:"section"},"xp for this encounter",s.a.createElement("div",{className:"right"},a," xp")),s.a.createElement("div",{className:"section",style:{display:o===a?"none":""}},"effective xp for ",t," monster(s)",s.a.createElement("div",{className:"right"},o," xp")),r,i)}}]),t}(s.a.Component),Ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showDetails:!1,party:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleDetails",value:function(){this.setState({showDetails:!this.state.showDetails})}},{key:"selectParty",value:function(e){var t=this.props.parties.find(function(t){return t.id===e});this.setState({party:t})}},{key:"render",value:function(){var e=this;try{var t=[];if(this.props.parties)for(var a=0;a!==this.props.parties.length;++a){var n=this.props.parties[a];t.push({id:n.id,text:n.name})}var r=s.a.createElement("div",null,s.a.createElement(N,{options:t,placeholder:"select party...",selectedID:this.state.party?this.state.party.id:void 0,select:function(t){return e.selectParty(t)}}),s.a.createElement(je,{encounter:this.props.selection,party:this.state.party,getMonster:function(t,a){return e.props.getMonster(t,a)}})),i=this.state.showDetails?"image rotate":"image",o=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"encounter"),s.a.createElement("img",{className:i,src:q.a,alt:"arrow",onClick:function(){return e.toggleDetails()}})),c=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"encounter name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),s.a.createElement("div",{style:{display:this.state.showDetails?"":"none"}},s.a.createElement("div",{className:"divider"}),r),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addWave()}},"add a new wave"),s.a.createElement(b,{text:"delete encounter",callback:function(){return e.props.removeEncounter()}})));return s.a.createElement(h,{getHeading:function(){return o},getContent:function(){return c}})}catch(l){console.error(l)}}}]),t}(s.a.Component),De=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;this.props.title&&(e=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},this.props.title)));var t=this.props.getContent();return s.a.createElement("div",{className:"card error"},e,s.a.createElement("div",{className:"card-content"},t))}catch(a){console.error(a)}}}]),t}(s.a.Component);De.defaultProps={title:null};var Ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showAll:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"render",value:function(){var e=this;try{var t=["all sizes"].concat(A).map(function(e){return{id:e,text:e}}),a=["all types"].concat(z).map(function(e){return{id:e,text:e}}),n=null;if(this.state.showAll)n=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"name",value:this.props.filter.name,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),s.a.createElement(V,{source:this.props.filter,name:"challengeMin",label:"min cr",display:function(e){return p.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMin",t)}}),s.a.createElement(V,{source:this.props.filter,name:"challengeMax",label:"max cr",display:function(e){return p.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMax",t)}}),s.a.createElement(N,{options:t,placeholder:"filter by size...",selectedID:this.props.filter.size,select:function(t){return e.props.changeValue("size",t)}}),s.a.createElement(N,{options:a,placeholder:"filter by type...",selectedID:this.props.filter.category,select:function(t){return e.props.changeValue("category",t)}}),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.props.resetFilter()}},"clear filter")));else{var r="";"all sizes"!==this.props.filter.size&&(r+=r?" "+this.props.filter.size:this.props.filter.size),"all types"!==this.props.filter.category&&(r+=r?" "+this.props.filter.category:this.props.filter.category),r+=" monsters of cr "+p.challenge(this.props.filter.challengeMin)+" to "+p.challenge(this.props.filter.challengeMax),n=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"name",value:this.props.filter.name,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),s.a.createElement("div",{className:"section"},"showing ",r))}return s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"filter"),s.a.createElement("img",{className:this.state.showAll?"image rotate":"image",src:q.a,alt:"arrow",onClick:function(){return e.toggleAll()}})),s.a.createElement("div",{className:"card-content"},n))}catch(i){console.error(i)}}}]),t}(s.a.Component),Te=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){var e=null;return e=0===this.props.encounters.length?s.a.createElement("div",{className:"section"},"to start building an encounter, press the button below"):s.a.createElement("div",{className:"section"},"select an encounter from the list to add monsters to it"),s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"on this page you can set up encounters"),s.a.createElement("div",{className:"section"},"when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs"),s.a.createElement("div",{className:"divider"}),e)}},{key:"render",value:function(){var e=this;try{return s.a.createElement(h,{getContent:function(){return e.getContent()}})}catch(t){console.error(t)}}}]),t}(s.a.Component),Pe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"wave")),a=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"wave name",value:this.props.wave.name,onChange:function(t){return e.props.changeValue(e.props.wave,"name",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement(b,{text:"delete wave",callback:function(){return e.props.removeWave(e.props.wave)}})));return s.a.createElement(h,{getHeading:function(){return t},getContent:function(){return a}})}catch(n){console.error(n)}}}]),t}(s.a.Component),Fe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];return this.props.encounter.slots.forEach(function(e){var a=e.monsterName||"unnamed monster";e.count>1&&(a+=" x"+e.count),t.push(s.a.createElement("div",{key:e.id,className:"text"},a))}),0===t.length&&t.push(s.a.createElement("div",{key:"empty",className:"text"},"no monsters")),this.props.encounter.waves.forEach(function(e){t.push(s.a.createElement("div",{key:"name "+e.id,className:"text subheading"},e.name||"unnamed wave")),e.slots.forEach(function(e){var a=e.monsterName||"unnamed monster";e.count>1&&(a+=" x"+e.count),t.push(s.a.createElement("div",{key:e.id,className:"text"},a))}),0===t.length&&t.push(s.a.createElement("div",{key:"empty "+e.id,className:"text"},"no monsters"))}),s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.encounter)}},s.a.createElement("div",{className:"heading"},this.props.encounter.name||"unnamed encounter"),t)}catch(a){console.error(a)}}}]),t}(s.a.Component),Ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={filter:{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"matchMonster",value:function(e){return!(e.challenge<this.state.filter.challengeMin)&&(!(e.challenge>this.state.filter.challengeMax)&&(!(""!==this.state.filter.name&&!p.match(this.state.filter.name,e.name))&&(("all types"===this.state.filter.category||e.category===this.state.filter.category)&&("all sizes"===this.state.filter.size||e.size===this.state.filter.size))))}},{key:"changeFilterValue",value:function(e,t){this.state.filter[e]=t,this.setState({filter:this.state.filter})}},{key:"nudgeFilterValue",value:function(e,t){var a=p.nudgeChallenge(this.state.filter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({filter:{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}})}},{key:"getMonsterCards",value:function(e,t){var a=this,n=[];return e.forEach(function(r){var i=a.props.getMonster(r.monsterName,r.monsterGroupName);if(i)n.push(s.a.createElement("div",{className:"column",key:i.id},s.a.createElement(J,{combatant:i,slot:r,encounter:a.props.selection,mode:"view encounter",nudgeValue:function(e,t,n){return a.props.nudgeValue(e,t,n)},removeEncounterSlot:function(e){return a.props.removeEncounterSlot(e,t)}})));else{var o=e.indexOf(r),c="unknown monster: "+r.monsterName+" in group "+r.monsterGroupName;n.push(s.a.createElement("div",{className:"column",key:o},s.a.createElement(De,{getContent:function(){return s.a.createElement("div",{className:"section"},c)}})))}}),0===e.length&&n.push(s.a.createElement("div",{className:"column",key:"empty"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",{className:"section"},"no monsters")}}))),n}},{key:"getLibrarySection",value:function(){var e=this;if(!this.props.selection)return null;var t=[];t.push(s.a.createElement("div",{className:"column",key:"filter"},s.a.createElement(Ve,{filter:this.state.filter,changeValue:function(t,a){return e.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}})));var a=[];return this.props.selection&&(this.props.library.forEach(function(t){t.monsters.forEach(function(t){e.matchMonster(t)&&a.push(t)})}),a.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),a.forEach(function(a){t.push(s.a.createElement("div",{className:"column",key:a.id},s.a.createElement(J,{key:a.id,combatant:a,encounter:e.props.selection,library:e.props.library,mode:"view encounter",addEncounterSlot:function(t,a){return e.props.addEncounterSlot(t,a)}})))}),s.a.createElement(ae,{heading:"monster library",content:t,showToggle:!0})}},{key:"showEncounter",value:function(e){return p.match(this.props.filter,e.name)}},{key:"render",value:function(){var e=this;try{var t=null;this.props.showHelp&&(t=s.a.createElement(Te,{encounters:this.props.encounters}));var a,n=this.props.encounters.filter(function(t){return e.showEncounter(t)}).map(function(t){return s.a.createElement(Fe,{key:t.id,encounter:t,selected:t===e.props.selection,setSelection:function(t){return e.props.selectEncounter(t)}})}),r=[],i=[];return this.props.selection&&(a=this.props.selection.name||"unnamed encounter",r.push(s.a.createElement("div",{className:"column",key:"info"},s.a.createElement(Ie,{selection:this.props.selection,parties:this.props.parties,filter:this.props.filter,changeValue:function(t,a){return e.props.changeValue(e.props.selection,t,a)},addWave:function(){return e.props.addWave()},removeEncounter:function(){return e.props.removeEncounter()},getMonster:function(t,a){return e.props.getMonster(t,a)}}))),this.getMonsterCards(this.props.selection.slots,null).forEach(function(e){return r.push(e)}),i=this.props.selection.waves.map(function(t){var a=[];return a.push(s.a.createElement("div",{className:"column",key:"info"},s.a.createElement(Pe,{wave:t,removeWave:function(t){return e.props.removeWave(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))),e.getMonsterCards(t.slots,t.id).forEach(function(e){return a.push(e)}),s.a.createElement(ae,{key:t.id,heading:t.name||"unnamed wave",content:a,showToggle:!0})})),s.a.createElement("div",{className:"encounter-builder row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t,s.a.createElement("button",{onClick:function(){return e.props.addEncounter()}},"add a new encounter"),n),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},s.a.createElement(ae,{content:r,heading:a,showClose:null!==this.props.selection,close:function(){return e.props.selectEncounter(null)}}),i,this.getLibrarySection()))}catch(o){console.error(o)}}}]),t}(s.a.Component),He=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;return 0===this.props.library.length&&(t=s.a.createElement("div",null,s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"text"},s.a.createElement("div",null,"since your collection of monsters is empty, you might want to start by pressing the button below to add monsters from the\xa0",s.a.createElement("a",{href:"http://dnd.wizards.com/articles/features/systems-reference-document-srd",target:"_blank",rel:"noopener noreferrer"},"system reference document"))),s.a.createElement("div",{className:"text"},s.a.createElement("button",{onClick:function(){return e.props.addOpenGameContent()}},"add monsters")))),s.a.createElement("div",{className:"home scrollable"},s.a.createElement("div",{className:"vertical-center-outer"},s.a.createElement("div",{className:"vertical-center-middle"},s.a.createElement("div",{className:"vertical-center-inner"},s.a.createElement("div",{className:"welcome-panel"},s.a.createElement("div",{className:"heading"},"welcome to ",s.a.createElement("b",null,"dojo")),s.a.createElement("div",{className:"text"},s.a.createElement("div",null,s.a.createElement("b",null,"dojo")," is an app for dms of dungeons and dragons fifth edition")),s.a.createElement("div",{className:"text"},s.a.createElement("div",null,"with ",s.a.createElement("b",null,"dojo")," you can:",s.a.createElement("ul",null,s.a.createElement("li",null,"build unique, challenging monsters"),s.a.createElement("li",null,"create encounters of just the right difficulty for your players"),s.a.createElement("li",null,"design intricate tactical maps"),s.a.createElement("li",null,"run combat without the book-keeping")))),t,s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"text"},s.a.createElement("div",null,"use the buttons at the bottom of the screen to access the app's features")))))))}catch(a){console.error(a)}}}]),t}(s.a.Component),Ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){var e=null;return e=0===this.props.mapFolios.length?s.a.createElement("div",{className:"section"},"to start a new folio, press the button below"):s.a.createElement("div",{className:"section"},"select a map folio from the list to see the maps it contains"),s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"on this page you can set up folios containing tactical maps"),s.a.createElement("div",{className:"section"},"when you have created a map you can use it in encounters"),s.a.createElement("div",{className:"divider"}),e)}},{key:"render",value:function(){var e=this;try{return s.a.createElement(h,{getContent:function(){return e.getContent()}})}catch(t){console.error(t)}}}]),t}(s.a.Component),ze=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return s.a.createElement("div",{className:"card map"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},this.props.map.name||"unnamed map")),s.a.createElement("div",{className:"card-content"},s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"map name",value:this.props.map.name,onChange:function(t){return e.props.changeValue(e.props.map,"name",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section centered"},s.a.createElement(B,{map:this.props.map,mode:"thumbnail"})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.props.editMap(e.props.map)}},"edit map"),s.a.createElement(b,{text:"delete map",callback:function(){return e.props.removeMap(e.props.map)}}))))}catch(t){console.error(t)}}}]),t}(s.a.Component),Le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"map folio")),a=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"folio name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue(e.props.selection,"name",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addMap()}},"add a new map"),s.a.createElement(b,{text:"delete folio",callback:function(){return e.props.removeMapFolio()}})));return s.a.createElement(h,{getHeading:function(){return t},getContent:function(){return a}})}catch(n){console.error(n)}}}]),t}(s.a.Component),Ye=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=p.match(this.props.filter,this.props.mapFolio.name),a=[],n=0;n!==this.props.mapFolio.maps.length;++n){var r=this.props.mapFolio.maps[n],i=r.name||"unnamed map";(t||p.match(this.props.filter,i))&&a.push(s.a.createElement("div",{key:r.id,className:"text"},i))}return 0===a.length&&a.push(s.a.createElement("div",{key:"empty",className:"text"},"no maps")),s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.mapFolio)}},s.a.createElement("div",{className:"heading"},this.props.mapFolio.name||"unnamed folio"),a)}catch(o){console.error(o)}}}]),t}(s.a.Component),We=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showMapFolio",value:function(e){var t=this,a=p.match(this.props.filter,e.name);return a||e.maps.forEach(function(e){a=p.match(t.props.filter,e.name)||a}),a}},{key:"render",value:function(){var e=this;try{var t=null;this.props.showHelp&&(t=s.a.createElement(Ae,{mapFolios:this.props.mapFolios}));var a=this.props.mapFolios.filter(function(t){return e.showMapFolio(t)}).map(function(t){return s.a.createElement(Ye,{key:t.id,mapFolio:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectMapFolio(t)}})}),n=null;if(this.props.selection){var r=[];r.push(s.a.createElement("div",{className:"column",key:"info"},s.a.createElement(Le,{selection:this.props.selection,filter:this.props.filter,addMap:function(){return e.props.addMap()},removeMapFolio:function(){return e.props.removeMapFolio()},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))),this.props.selection.maps.filter(function(t){return p.match(e.props.filter,t.name)}).forEach(function(t){r.push(s.a.createElement("div",{className:"column",key:t.id},s.a.createElement(ze,{map:t,editMap:function(t){return e.props.editMap(t)},removeMap:function(t){return e.props.removeMap(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}})))}),0===r.length&&r.push(s.a.createElement("div",{className:"column",key:"empty"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",{className:"section"},"no maps")}}))),n=s.a.createElement("div",null,s.a.createElement(ae,{content:r,heading:this.props.selection.name||"unnamed folio",showClose:null!==this.props.selection,close:function(){return e.props.selectMapFolio(null)}}))}return s.a.createElement("div",{className:"map-builder row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t,s.a.createElement("button",{onClick:function(){return e.props.addMapFolio()}},"add a new map folio"),a),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},n))}catch(i){console.error(i)}}}]),t}(s.a.Component),Re=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"you can maintain your menagerie of monsters here"),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},"select a monster group from the list to see stat blocks for monsters in that group"),s.a.createElement("div",{className:"section"},"to quickly find a monster, type its name into the filter box"))}},{key:"render",value:function(){var e=this;return s.a.createElement(h,{getContent:function(){return e.getContent()}})}}]),t}(s.a.Component),_e=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"monster group")),a=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"group name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addMonster()}},"add a new monster"),s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.sortMonsters()}},"sort monsters"),s.a.createElement(b,{text:"delete group",callback:function(){return e.props.removeMonsterGroup()}})));return s.a.createElement(h,{getHeading:function(){return t},getContent:function(){return a}})}catch(n){console.error(n)}}}]),t}(s.a.Component),qe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=p.match(this.props.filter,this.props.group.name),a=[],n=0;n!==this.props.group.monsters.length;++n){var r=this.props.group.monsters[n],i=r.name||"unnamed monster";(t||p.match(this.props.filter,i))&&a.push(s.a.createElement("div",{key:r.id,className:"text"},i))}return 0===a.length&&a.push(s.a.createElement("div",{key:"empty",className:"text"},"no monsters")),s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.group)}},s.a.createElement("div",{className:"heading"},this.props.group.name||"unnamed group"),a)}catch(o){console.error(o)}}}]),t}(s.a.Component),Je=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showMonsterGroup",value:function(e){var t=this,a=p.match(this.props.filter,e.name);return a||e.monsters.forEach(function(e){a=p.match(t.props.filter,e.name)||a}),a}},{key:"render",value:function(){var e=this;try{var t=null;this.props.showHelp&&(t=s.a.createElement(Re,null));var a,n=this.props.library.filter(function(t){return e.showMonsterGroup(t)}).map(function(t){return s.a.createElement(qe,{key:t.id,group:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectMonsterGroup(t)}})}),r=[];if(this.props.selection){r.push(s.a.createElement("div",{className:"column",key:"info"},s.a.createElement(_e,{selection:this.props.selection,filter:this.props.filter,addMonster:function(){return e.props.addMonster()},sortMonsters:function(){return e.props.sortMonsters()},changeValue:function(t,a){return e.props.changeValue(e.props.selection,t,a)},removeMonsterGroup:function(){return e.props.removeMonsterGroup()}})));var i=this.props.selection.monsters.filter(function(t){return p.match(e.props.filter,t.name)});0!==i.length?i.forEach(function(t){r.push(s.a.createElement("div",{className:"column",key:t.id},s.a.createElement(J,{combatant:t,mode:"view editable",library:e.props.library,changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},moveToGroup:function(t,a){return e.props.moveToGroup(t,a)},removeMonster:function(t){return e.props.removeMonster(t)},editMonster:function(t){return e.props.editMonster(t)},cloneMonster:function(t,a){return e.props.cloneMonster(t,a)}})))}):r.push(s.a.createElement("div",{className:"column",key:"empty"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",{className:"section"},"no monsters")}})))}return this.props.selection&&((a=this.props.selection.name)||(a="unnamed group")),s.a.createElement("div",{className:"monster-library row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t,s.a.createElement("button",{onClick:function(){return e.props.addMonsterGroup()}},"add a new monster group"),n),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},s.a.createElement(ae,{content:r,heading:a,showClose:null!==this.props.selection,close:function(){return e.props.selectMonsterGroup(null)}})))}catch(o){console.error(o)}}}]),t}(s.a.Component),Xe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getContent",value:function(){var e=null;return e=0===this.props.parties.length?s.a.createElement("div",{className:"section"},"to start adding a party, press the button below"):s.a.createElement("div",{className:"section"},"select a party from the list to see pc details"),s.a.createElement("div",null,s.a.createElement("div",{className:"section"},"this page is where you can tell dojo all about your pcs"),s.a.createElement("div",{className:"section"},"you can add a party for each of your gaming groups"),s.a.createElement("div",{className:"divider"}),e)}},{key:"render",value:function(){var e=this;try{return s.a.createElement(h,{getContent:function(){return e.getContent()}})}catch(t){console.error(t)}}}]),t}(s.a.Component),Ue=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.selection.pcs.filter(function(e){return e.active}),a=t.map(function(e){return e.languages}).join(", ").split(/[ ,;]+/).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[]).sort(function(e,t){return"Common"===e?-1:"Common"===t?1:e.localeCompare(t)}).join(", "),n="-",r="-",i="-";if(0!==t.length){var o={min:null,max:null},c={min:null,max:null},l={min:null,max:null};t.forEach(function(e){o.min=null===o.min?e.passiveInsight:Math.min(o.min,e.passiveInsight),o.max=null===o.max?e.passiveInsight:Math.max(o.max,e.passiveInsight),c.min=null===c.min?e.passiveInvestigation:Math.min(c.min,e.passiveInvestigation),c.max=null===c.max?e.passiveInvestigation:Math.max(c.max,e.passiveInvestigation),l.min=null===l.min?e.passivePerception:Math.min(l.min,e.passivePerception),l.max=null===l.max?e.passivePerception:Math.max(l.max,e.passivePerception)}),n=o.min===o.max?o.min.toString():o.min+" - "+o.max,r=c.min===c.max?c.min.toString():c.min+" - "+c.max,i=l.min===l.max?l.min.toString():l.min+" - "+l.max}var u=s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"party")),m=s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"party name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section",style:{display:""!==a?"block":"none"}},s.a.createElement("div",{className:"subheading"},"languages")),s.a.createElement("div",{className:"section"},a),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"passive skills")),s.a.createElement("div",{className:"table"},s.a.createElement("div",null,s.a.createElement("div",{className:"cell three"},s.a.createElement("b",null,"insight")),s.a.createElement("div",{className:"cell three"},s.a.createElement("b",null,"invest.")),s.a.createElement("div",{className:"cell three"},s.a.createElement("b",null,"percep."))),s.a.createElement("div",null,s.a.createElement("div",{className:"cell three"},n),s.a.createElement("div",{className:"cell three"},r),s.a.createElement("div",{className:"cell three"},i))),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addPC()}},"add a new pc"),s.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.sortPCs()}},"sort pcs"),s.a.createElement(b,{text:"delete party",callback:function(){return e.props.removeParty()}})));return s.a.createElement(h,{getHeading:function(){return u},getContent:function(){return m}})}catch(p){console.error(p)}}}]),t}(s.a.Component),Be=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=p.match(this.props.filter,this.props.party.name),a=[],n=0;n!==this.props.party.pcs.length;++n){var r=this.props.party.pcs[n],i=r.name||"unnamed pc";r.player&&(i+=" ("+r.player+")"),(t||p.match(this.props.filter,i))&&a.push(s.a.createElement("div",{key:r.id,className:"text"},i))}return 0===a.length&&a.push(s.a.createElement("div",{key:"empty",className:"text"},"no pcs")),s.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.party)}},s.a.createElement("div",{className:"heading"},this.props.party.name||"unnamed party"),a)}catch(o){console.error(o)}}}]),t}(s.a.Component),Ke=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showParty",value:function(e){var t=this,a=p.match(this.props.filter,e.name);return a||e.pcs.forEach(function(e){a=p.match(t.props.filter,e.name)||a}),a}},{key:"render",value:function(){var e=this;try{var t=null;this.props.showHelp&&(t=s.a.createElement(Xe,{parties:this.props.parties}));var a,n=this.props.parties.filter(function(t){return e.showParty(t)}).map(function(t){return s.a.createElement(Be,{key:t.id,party:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectParty(t)}})}),r=[],i=[];if(this.props.selection){r.push(s.a.createElement("div",{className:"column",key:"info"},s.a.createElement(Ue,{selection:this.props.selection,filter:this.props.filter,addPC:function(){return e.props.addPC()},sortPCs:function(){return e.props.sortPCs()},changeValue:function(t,a){return e.props.changeValue(e.props.selection,t,a)},removeParty:function(){return e.props.removeParty()}})));var o=this.props.selection.pcs.filter(function(t){return p.match(e.props.filter,t.name)}),c=o.filter(function(e){return e.active});c.forEach(function(t){r.push(s.a.createElement("div",{className:"column",key:t.id},s.a.createElement(X,{combatant:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},removePC:function(t){return e.props.removePC(t)}})))}),o.filter(function(e){return!e.active}).forEach(function(t){i.push(s.a.createElement("div",{className:"column",key:t.id},s.a.createElement(X,{combatant:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},removePC:function(t){return e.props.removePC(t)}})))}),0===c.length&&r.push(s.a.createElement("div",{className:"column",key:"empty"},s.a.createElement(h,{getContent:function(){return s.a.createElement("div",{className:"section"},"no pcs")}})))}return this.props.selection&&(a=this.props.selection.name||"unnamed party"),s.a.createElement("div",{className:"parties row collapse"},s.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t,s.a.createElement("button",{onClick:function(){return e.props.addParty()}},"add a new party"),n),s.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},s.a.createElement(ae,{content:r,heading:a,showClose:null!==this.props.selection,close:function(){return e.props.selectParty(null)},hidden:!this.props.selection}),s.a.createElement(ae,{content:i,heading:"inactive pcs",showClose:!1,hidden:0===i.length})))}catch(l){console.error(l)}}}]),t}(s.a.Component),Qe=a(20),Ze=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return s.a.createElement("div",{className:"about"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-12 medium-12 large-12 list-column"},s.a.createElement("div",{className:"heading"},"about dojo"),s.a.createElement("div",{className:"section"},"dojo by ",s.a.createElement("a",{href:"mailto:andy.aiken@live.co.uk"},"andy aiken")),s.a.createElement("div",{className:"section"},"version ",s.a.createElement("b",null,Qe.version)),s.a.createElement("div",{className:"section"},"if you would like to contribut to this project, you can do so ",s.a.createElement("a",{href:"https://github.com/andyaiken/dojo",target:"_blank",rel:"noopener noreferrer"},"here")),s.a.createElement("div",{className:"section"},"dungeons and dragons copyright wizards of the coast"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-12 medium-12 large-12 list-column"},s.a.createElement("div",{className:"heading"},"options"),s.a.createElement(b,{text:"clear all data",callback:function(){return e.props.resetAll()}}),s.a.createElement(ke,{label:"show help cards",checked:this.props.options.showHelp,changeValue:function(t){return e.props.changeValue(e.props.options,"showHelp",t)}}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-12 medium-12 large-12 list-column"},s.a.createElement("div",{className:"heading"},"open game license"),s.a.createElement("div",{className:"section"},"The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved."),s.a.createElement("ol",null,s.a.createElement("li",null,"Definitions: (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement."),s.a.createElement("li",null,"The License: This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License."),s.a.createElement("li",null,"Offer and Acceptance: By Using the Open Game Content You indicate Your acceptance of the terms of this License."),s.a.createElement("li",null,"Grant and Consideration: In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content."),s.a.createElement("li",null,"Representation of Authority to Contribute: If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License."),s.a.createElement("li",null,"Notice of License Copyright: You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute."),s.a.createElement("li",null,"Use of Product Identity: You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity."),s.a.createElement("li",null,"Identification: If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content."),s.a.createElement("li",null,"Updating the License: Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License."),s.a.createElement("li",null,"Copy of this License: You MUST include a copy of this License with every copy of the Open Game Content You Distribute."),s.a.createElement("li",null,"Use of Contributor Credits: You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so."),s.a.createElement("li",null,"Inability to Comply: If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected."),s.a.createElement("li",null,"Termination: This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License."),s.a.createElement("li",null,"Reformation: If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable."),s.a.createElement("li",null,"COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.")))))}catch(t){console.error(t)}}}]),t}(s.a.Component),$e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={combatSetup:e.combatSetup},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setParty",value:function(e){var t=this;this.state.combatSetup.partyID=e,this.setState({combatSetup:this.state.combatSetup},function(){return t.props.notify()})}},{key:"setEncounter",value:function(e){var t=this;this.state.combatSetup.encounterID=e;var a=this.props.encounters.find(function(t){return t.id===e});a&&(this.state.combatSetup.monsterNames=p.getMonsterNames(a)),this.setState({combatSetup:this.state.combatSetup},function(){return t.props.notify()})}},{key:"setFolioID",value:function(e){if(e&&""!==e){var t=this.props.mapFolios.find(function(t){return t.id===e});t&&(this.state.combatSetup.folioID=t.id,this.state.combatSetup.mapID=1===t.maps.length?t.maps[0].id:null)}else this.state.combatSetup.folioID=null,this.state.combatSetup.mapID=null;this.setState({combatSetup:this.state.combatSetup})}},{key:"setMapID",value:function(e){this.state.combatSetup.mapID=e,this.setState({combatSetup:this.state.combatSetup})}},{key:"setWave",value:function(e){var t=this;this.state.combatSetup.waveID=e;var a=this.props.encounters.find(function(e){return e.id===t.state.combatSetup.encounterID});if(a){var n=a.waves.find(function(t){return t.id===e});n&&(this.state.combatSetup.monsterNames=p.getMonsterNames(n))}this.setState({combatSetup:this.state.combatSetup},function(){return t.props.notify()})}},{key:"setEncounterInitMode",value:function(e){this.state.combatSetup.encounterInitMode=e,this.setState({combatSetup:this.state.combatSetup})}},{key:"changeName",value:function(e,t,a){var n=this.state.combatSetup.monsterNames.find(function(t){return t.id===e});n&&(n.names[t]=a,this.setState({combatSetup:this.state.combatSetup}))}},{key:"getPartySection",value:function(){var e=this;if(0===this.props.parties.length)return s.a.createElement("div",{className:"section"},"you have not defined any parties");var t=this.props.parties.map(function(e){return{id:e.id,text:e.name||"unnamed party"}}),a=null;if(this.state.combatSetup.partyID){var n=this.props.parties.find(function(t){return t.id===e.state.combatSetup.partyID});if(n){var r=n.pcs.filter(function(e){return e.active}).map(function(e){return s.a.createElement("li",{key:e.id},e.name||"unnamed pc"," (level ",e.level,")")});0===r.length&&r.push(s.a.createElement("li",{key:"empty"},"no pcs")),a=s.a.createElement("div",null,s.a.createElement("div",{className:"subheading"},"pcs"),s.a.createElement("ul",null,r))}}return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"party"),s.a.createElement(N,{options:t,placeholder:"select party...",selectedID:this.state.combatSetup.partyID?this.state.combatSetup.partyID:void 0,select:function(t){return e.setParty(t)}}),a)}},{key:"getEncounterSection",value:function(){var e=this;if(0===this.props.encounters.length)return s.a.createElement("div",{className:"section"},"you have not built any encounters");var t=this.props.encounters.map(function(e){return{id:e.id,text:e.name||"unnamed encounter"}}),a=null;if(this.state.combatSetup.encounterID){var n=this.props.encounters.find(function(t){return t.id===e.state.combatSetup.encounterID});if(n){var r=n.slots.map(function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),s.a.createElement("li",{key:e.id},t)});0===r.length&&r.push(s.a.createElement("li",{key:"empty"},"no monsters"));var i=n.waves.map(function(e){if(0===e.slots.length)return null;var t=e.slots.map(function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" x"+e.count),s.a.createElement("li",{key:e.id},t)});return s.a.createElement("div",{key:e.id},s.a.createElement("div",{className:"subheading"},e.name||"unnamed wave"),s.a.createElement("ul",null,t))});a=s.a.createElement("div",null,s.a.createElement("div",{className:"subheading"},"monsters"),s.a.createElement("ul",null,r),i)}}return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"encounter"),s.a.createElement(N,{options:t,placeholder:"select encounter...",selectedID:this.state.combatSetup.encounterID?this.state.combatSetup.encounterID:void 0,select:function(t){return e.setEncounter(t)}}),a)}},{key:"getMapSection",value:function(){var e=this,t=this.props.mapFolios.filter(function(e){return e.maps.length>0});if(0===t.length)return null;var a=[{id:"",text:"none"}].concat(t.map(function(e){return{id:e.id,text:e.name||"unnamed folio"}})),n=null,r=null;if(this.state.combatSetup.folioID){var i=this.props.mapFolios.find(function(t){return t.id===e.state.combatSetup.folioID});if(i){var o=i.maps.map(function(e){return{id:e.id,text:e.name||"unnamed map"}});if(1!==o.length&&(n=s.a.createElement(Ne,{options:o,selectedID:this.state.combatSetup.mapID,select:function(t){return e.setMapID(t)}})),this.state.combatSetup.mapID){var c=i.maps.find(function(t){return t.id===e.state.combatSetup.mapID});c&&(r=s.a.createElement(B,{map:c,mode:"thumbnail"}))}}}return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"map"),s.a.createElement(N,{options:a,placeholder:"select map folio...",selectedID:this.state.combatSetup.folioID?this.state.combatSetup.folioID:void 0,select:function(t){return e.setFolioID(t)}}),n,r)}},{key:"getWaveSection",value:function(){var e=this;if(null===this.state.combatSetup.encounterID)return s.a.createElement("div",{className:"section"},"you have not selected an encounter");var t=this.props.encounters.find(function(t){return t.id===e.state.combatSetup.encounterID});if(t){if(0===t.waves.length)return s.a.createElement("div",{className:"section"},"you have not defined any waves");var a=t.waves.map(function(e){return{id:e.id,text:e.name||"unnamed wave"}}),n=null;if(this.state.combatSetup.waveID){var r=t.waves.find(function(t){return t.id===e.state.combatSetup.waveID});if(r){var i=r.slots.map(function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),s.a.createElement("li",{key:e.id},t)});0===i.length&&i.push(s.a.createElement("li",{key:"empty"},"no monsters")),n=s.a.createElement("div",null,s.a.createElement("div",{className:"subheading"},"monsters"),s.a.createElement("ul",null,i))}}return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"wave"),s.a.createElement(N,{options:a,placeholder:"select wave...",selectedID:this.state.combatSetup.waveID?this.state.combatSetup.waveID:void 0,select:function(t){return e.setWave(t)}}),n)}return null}},{key:"getDifficultySection",value:function(){var e=this,t=this.props.parties.find(function(t){return t.id===e.state.combatSetup.partyID}),a=this.props.encounters.find(function(t){return t.id===e.state.combatSetup.encounterID});return t&&a?s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"encounter difficulty"),s.a.createElement(je,{party:t,encounter:a,getMonster:function(t,a){return e.props.getMonster(t,a)}})):s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"encounter difficulty"),s.a.createElement("div",{className:"section"},"select a party and an encounter on the left to see difficulty information."))}},{key:"getMonsterSection",value:function(){var e=this;if(null===this.state.combatSetup.encounterID)return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"monsters"),s.a.createElement("div",{className:"section"},"select an encounter to see monster options here."));if(!this.props.parties&&null===this.state.combatSetup.waveID)return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"monsters"),s.a.createElement("div",{className:"section"},"select a wave to see monster options here."));var t=this.props.encounters.find(function(t){return t.id===e.state.combatSetup.encounterID});if(t){var a=t;if(this.state.combatSetup.waveID){var n=t.waves.find(function(t){return t.id===e.state.combatSetup.waveID});n&&(a=n)}if(0===a.slots.length)return null;var r=this.state.combatSetup.monsterNames.map(function(t){var n=a.slots.find(function(e){return e.id===t.id});if(n){for(var r=[],i=0;i!==t.names.length;++i)r.push(s.a.createElement("div",{key:i},s.a.createElement(et,{value:t.names[i],slotID:n.id,index:i,changeName:function(t,a,n){return e.changeName(t,a,n)}})));return s.a.createElement("div",{key:t.id,className:"name-row"},s.a.createElement("div",{className:"name-label"},n.monsterName),s.a.createElement("div",{className:"name-inputs"},r))}});return s.a.createElement("div",null,s.a.createElement("div",{className:"heading"},"monsters"),s.a.createElement("div",{className:"subheading"},"initiative"),s.a.createElement(Ne,{options:[{id:"manual",text:"enter manually"},{id:"individual",text:"roll individually"},{id:"group",text:"roll in groups"}],selectedID:this.state.combatSetup.encounterInitMode,select:function(t){return e.setEncounterInitMode(t)}}),s.a.createElement("div",{className:"subheading"},"names"),s.a.createElement("div",null,r))}return null}},{key:"render",value:function(){try{var e=null,t=null;return this.props.parties?(e=s.a.createElement("div",null,this.getPartySection(),this.getEncounterSection(),this.getMapSection()),t=s.a.createElement("div",null,this.getDifficultySection(),this.getMonsterSection())):(e=s.a.createElement("div",null,this.getWaveSection()),t=s.a.createElement("div",null,this.getMonsterSection())),s.a.createElement("div",{className:"row",style:{height:"100%",margin:"0 -15px"}},s.a.createElement("div",{className:"column small-6 medium-6 large-6 scrollable"},e),s.a.createElement("div",{className:"column small-6 medium-6 large-6 scrollable"},t))}catch(a){console.error(a)}}}]),t}(s.a.Component);$e.defaultProps={parties:null,mapFolios:null};var et=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("input",{type:"text",value:this.props.value,onChange:function(t){return e.props.changeName(e.props.slotID,e.props.index,t.target.value)}})}}]),t}(s.a.Component),tt=["blinded","charmed","deafened","exhaustion","frightened","grappled","incapacitated","invisible","paralyzed","petrified","poisoned","prone","restrained","stunned","unconscious","custom"],at=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.items.map(function(t){return s.a.createElement(nt,{key:t.id,item:t,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.select(t)}})});return s.a.createElement("div",{className:"radio-group"},t)}catch(a){return console.error(a),null}}}]),t}(s.a.Component);at.defaultProps={};var nt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t="radio-item",a=null;return this.props.selected&&(t+=" selected",a=s.a.createElement("div",{className:"radio-item-details"},this.props.item.details)),this.props.item.disabled&&(t+=" disabled"),s.a.createElement("div",{className:t,onClick:function(){return e.props.select(e.props.item.id)}},s.a.createElement("div",{className:"radio-item-text"},this.props.item.text),a)}}]),t}(s.a.Component),st=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={condition:e.condition},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCondition",value:function(e){this.state.condition.name=e,this.state.condition.level=1,this.state.condition.text="custom"===e?"custom condition":null,this.setState({condition:this.state.condition})}},{key:"setDuration",value:function(e){var t=null;switch(e){case"saves":t=d.createConditionDurationSaves();break;case"combatant":(t=d.createConditionDurationCombatant()).combatantID=this.props.combatant.id;break;case"rounds":t=d.createConditionDurationRounds()}this.state.condition.duration=t,this.setState({condition:this.state.condition})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({condition:this.state.condition})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t]+a;"level"===t&&(n=Math.max(n,1),n=Math.min(n,6)),"count"===t&&(n=Math.max(n,1)),"saveDC"===t&&(n=Math.max(n,0)),e[t]=n,this.setState({condition:this.state.condition})}},{key:"render",value:function(){var e=this;try{var t=tt.map(function(t){var a=[],n=[];if(t===e.state.condition.name){"custom"===t&&a.push(s.a.createElement("input",{type:"text",placeholder:"custom condition",value:e.state.condition.text?e.state.condition.text:"",onChange:function(t){return e.changeValue(e.state.condition,"text",t.target.value)}})),"exhaustion"===t&&a.push(s.a.createElement(V,{key:"exhaustion-spin",source:e.props.condition,name:"level",label:"exhaustion",nudgeValue:function(t){return e.nudgeValue(e.props.condition,"level",t)}}));for(var r=p.conditionText(e.state.condition),i=0;i!==r.length;++i)n.push(s.a.createElement("li",{key:i,className:"section"},r[i]))}return{id:t,text:t,details:s.a.createElement("div",{key:t},a,s.a.createElement("ul",null,n)),disabled:!!e.props.combatant.conditionImmunities&&-1!==e.props.combatant.conditionImmunities.indexOf(t)}}),a=["str","dex","con","int","wis","cha","death"].map(function(e){return{id:e,text:e}}),n=[{id:"start",text:"start of turn"},{id:"end",text:"end of turn"}],r=this.props.combat.combatants.map(function(e){return{id:e.id,text:e.displayName||e.name||"unnamed monster"}}),i=[{id:"none",text:"until removed (default)",details:s.a.createElement("div",{className:"section"},s.a.createElement("div",null,"the condition persists until it is manually removed"))},{id:"saves",text:"until a successful save",details:s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"number of saves required"),s.a.createElement(V,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"save dc"),s.a.createElement(V,{source:this.props.condition.duration,name:"saveDC",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"saveDC",t)}})),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"type of save"),s.a.createElement(Ne,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.saveType:null,select:function(t){return e.changeValue(e.props.condition.duration,"saveType",t)}})),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"make the save at the start or end of the turn"),s.a.createElement(Ne,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"combatant",text:"until someone's next turn",details:s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"combatant"),s.a.createElement(N,{options:r,selectedID:this.props.condition.duration&&this.props.condition.duration.combatantID||void 0,select:function(t){return e.changeValue(e.props.condition.duration,"combatantID",t)}})),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"start or end of the turn"),s.a.createElement(Ne,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"rounds",text:"for a number of rounds",details:s.a.createElement("div",null,s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"subheading"},"number of rounds"),s.a.createElement(V,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})))}];return s.a.createElement("div",{className:"condition-modal"},s.a.createElement("div",{className:"row",style:{height:"100%"}},s.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},s.a.createElement("div",{className:"heading"},"condition"),s.a.createElement(at,{items:t,selectedItemID:this.state.condition.name,select:function(t){return e.setCondition(t)}})),s.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},s.a.createElement("div",{className:"heading"},"duration"),s.a.createElement(at,{items:i,selectedItemID:this.state.condition.duration?this.state.condition.duration.type:"none",select:function(t){return e.setDuration(t)}}))))}catch(o){console.error(o)}}}]),t}(s.a.Component),rt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={chart:"challenge"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectChart",value:function(e){this.setState({chart:e})}},{key:"render",value:function(){var e=this;try{var t=null,a=[];if(this.props.library.forEach(function(e){return e.monsters.forEach(function(e){return a.push(e)})}),0!==a.length){var n=[],r=0,i={};switch(this.state.chart){case"challenge":[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].forEach(function(e){n.push({value:e,title:"challenge "+p.challenge(e)})}),n.forEach(function(e){var t=e.value;i[t.toString()]=a.filter(function(e){return e.challenge===t})}),n.forEach(function(e){var t=e.value;r=Math.max(i[t].length,r)});break;case"size":A.forEach(function(e){n.push({value:e,title:e})}),n.forEach(function(e){var t=e.value;i[t.toString()]=a.filter(function(e){return e.size===t})}),n.forEach(function(e){var t=e.value;r=Math.max(i[t].length,r)});break;case"type":z.forEach(function(e){n.push({value:e,title:e})}),n.forEach(function(e){var t=e.value;i[t.toString()]=a.filter(function(e){return e.category===t})}),n.forEach(function(e){var t=e.value;r=Math.max(i[t].length,r)})}for(var o=[],c=0;c!==n.length;++c){var l=n[c],u=i[l.value],m=u?u.length:0;o.push(s.a.createElement("div",{key:l.title,className:"bar-container",title:l.title+": "+u.length+" monsters"},s.a.createElement("div",{className:"bar",style:{width:"calc((100% - 1px) * "+m+" / "+r+")"}})))}t=s.a.createElement("div",null,s.a.createElement(Ne,{options:[{id:"challenge",text:"challenge rating"},{id:"size",text:"size"},{id:"type",text:"type"}],selectedID:this.state.chart,select:function(t){return e.selectChart(t)}}),s.a.createElement("div",{className:"chart"},s.a.createElement("div",{className:"plot"},o)))}return t}catch(d){console.error(d)}}}]),t}(s.a.Component),it=["cavern","dirt","flagstone","floorboard","grassland","pit","sand","snow","water"],ot=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=it.map(function(e){return{id:e,text:e}});return s.a.createElement("div",{className:"card map-tile"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"map tile")),s.a.createElement("div",{className:"card-content"},s.a.createElement("div",{className:"subheading"},"size"),s.a.createElement("div",{className:"section"},this.props.tile.width," sq x ",this.props.tile.height," sq"),s.a.createElement("div",{className:"section"},5*this.props.tile.width," ft x ",5*this.props.tile.height," ft"),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"subheading"},"terrain"),s.a.createElement(N,{options:t,placeholder:"select terrain",selectedID:this.props.tile.terrain?this.props.tile.terrain:void 0,select:function(t){return e.props.changeValue(e.props.tile,"terrain",t)}}),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"subheading"},"move"),s.a.createElement("div",{className:"section centered"},s.a.createElement(O,{direction:"out",click:function(t){return e.props.moveMapItem(e.props.tile,t)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"subheading"},"resize"),s.a.createElement("div",{className:"section centered"},s.a.createElement(O,{direction:"both",click:function(t,a){return e.props.resizeMapItem(e.props.tile,t,a)}})),s.a.createElement("div",{className:"divider"}),s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.props.cloneMapItem(e.props.tile)}},"clone tile"),s.a.createElement("button",{onClick:function(){return e.props.removeMapItem(e.props.tile)}},"remove tile"))))}catch(a){console.error(a)}}}]),t}(s.a.Component),ct=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={map:e.map,selectedTileID:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSelectedTileID",value:function(e){this.setState({selectedTileID:e})}},{key:"addMapTile",value:function(e,t){var a=d.createMapItem();a.x=e,a.y=t,a.terrain="flagstone",this.state.map.items.push(a),this.setState({map:this.state.map,selectedTileID:a.id})}},{key:"moveMapItem",value:function(e,t){switch(t){case"N":e.y-=1;break;case"E":e.x+=1;break;case"S":e.y+=1;break;case"W":e.x-=1}this.setState({map:this.state.map})}},{key:"bigMapItem",value:function(e,t){switch(t){case"N":e.y-=1,e.height+=1;break;case"E":e.width+=1;break;case"S":e.height+=1;break;case"W":e.x-=1,e.width+=1}this.setState({map:this.state.map})}},{key:"smallMapItem",value:function(e,t){switch(t){case"N":e.height>1&&(e.y+=1,e.height-=1);break;case"E":e.width>1&&(e.width-=1);break;case"S":e.height>1&&(e.height-=1);break;case"W":e.width>1&&(e.x+=1,e.width-=1)}this.setState({map:this.state.map})}},{key:"resizeMapItem",value:function(e,t,a){switch(a){case"in":this.smallMapItem(e,t);break;case"out":this.bigMapItem(e,t)}}},{key:"cloneMapItem",value:function(e){var t=JSON.parse(JSON.stringify(e));t.id=p.guid(),t.x+=1,t.y+=1,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})}},{key:"removeMapItem",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.setState({map:this.state.map,selectedTileID:null})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({map:this.state.map})}},{key:"render",value:function(){var e=this;try{var t=null;if(this.state.selectedTileID){var a=this.state.map.items.find(function(t){return t.id===e.state.selectedTileID});a&&(t=s.a.createElement("div",{className:"tools"},s.a.createElement(ot,{tile:a,moveMapItem:function(t,a){return e.moveMapItem(t,a)},resizeMapItem:function(t,a,n){return e.resizeMapItem(t,a,n)},cloneMapItem:function(t){return e.cloneMapItem(t)},removeMapItem:function(t){return e.removeMapItem(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}})))}else t=s.a.createElement("div",{className:"tools"},s.a.createElement("p",null,"to add a new tile to the map, double-click on an empty grid square"),s.a.createElement("p",null,"to edit an existing tile, click on it once to select it"));return s.a.createElement("div",{className:"map-editor"},t,s.a.createElement(B,{map:this.state.map,mode:"edit",selectedItemID:this.state.selectedTileID?this.state.selectedTileID:void 0,setSelectedItemID:function(t){return e.setSelectedTileID(t)},addMapTile:function(t,a){return e.addMapTile(t,a)}}))}catch(n){console.error(n)}}}]),t}(s.a.Component),lt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={monster:e.monster,page:"overview",showFilter:!1,helpSection:"speed",filter:{size:!0,type:!0,subtype:!1,alignment:!1,challenge:!0,text:""}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setPage",value:function(e){var t=this.getHelpOptionsForPage(e);this.setState({page:e,helpSection:t[0]})}},{key:"toggleFilter",value:function(){this.setState({showFilter:!this.state.showFilter})}},{key:"setHelpSection",value:function(e){this.setState({helpSection:e})}},{key:"toggleMatch",value:function(e){this.state.filter[e]=!this.state.filter[e],this.setState({filter:this.state.filter})}},{key:"setFilterText",value:function(e){this.state.filter.text=e,this.setState({filter:this.state.filter})}},{key:"getHelpOptionsForPage",value:function(e){switch(e){case"overview":return["speed","senses","languages","equipment"];case"abilities":return["str","dex","con","int","wis","cha","saves","skills"];case"cbt-stats":return["armor class","hit dice","resistances","vulnerabilities","immunities","conditions"];case"actions":return["actions"];default:return[]}}},{key:"getMonsters",value:function(){var e=this,t=[];return this.props.library.forEach(function(a){a.monsters.forEach(function(a){var n=!0;e.state.monster.id===a.id&&(n=!1),e.state.filter.size&&e.state.monster.size!==a.size&&(n=!1),e.state.filter.type&&e.state.monster.category!==a.category&&(n=!1),e.state.filter.subtype&&e.state.monster.tag!==a.tag&&(n=!1),e.state.filter.alignment&&e.state.monster.alignment!==a.alignment&&(n=!1),e.state.filter.challenge&&e.state.monster.challenge!==a.challenge&&(n=!1),n&&t.push(a)})}),t}},{key:"setRandomValue",value:function(e,t,a){var n=t[Math.floor(Math.random()*t.length)],s=null,r=e.split(".");r.forEach(function(e){e===r[r.length-1]?s=n[e]:n=n[e]}),this.changeValue(e,s,a)}},{key:"geneSplice",value:function(e){var t=this;["speed","senses","languages","equipment","abilityScores.str","abilityScores.dex","abilityScores.con","abilityScores.int","abilityScores.wis","abilityScores.cha","savingThrows","skills","ac","hitDice","damage.resist","damage.vulnerable","damage.immune","conditionImmunities"].forEach(function(a){t.setRandomValue(a,e,!1)}),L.forEach(function(a){t.state.monster.traits.filter(function(e){return e.type===a}).forEach(function(e){var a=t.state.monster.traits.findIndex(function(t){return t===e});t.state.monster.traits.splice(a,1)});var n=[];e.forEach(function(e){e.traits.filter(function(e){return e.type===a}).forEach(function(e){return n.push(e)})});var s=[];n.forEach(function(e){var t=s.find(function(t){return t.trait.name===e.name});t?t.count+=1:s.push({trait:e,count:1})});var r=[];s.filter(function(t){return t.count===e.length}).forEach(function(e){t.copyTrait(e.trait),r.push(e.trait.id)}),r.forEach(function(e){var t=s.findIndex(function(t){return t.trait.id===e});s.splice(t,1)});for(var i=n.length/e.length;t.state.monster.traits.filter(function(e){return e.type===a}).length<i;){var o=Math.floor(Math.random()*s.length),c=s[o].trait;t.copyTrait(c),s.splice(o,1)}}),this.setState({monster:this.state.monster})}},{key:"addTrait",value:function(e){var t=d.createTrait();t.type=e,t.name="New "+this.getActionTypeName(e,!1).toLowerCase(),this.state.monster.traits.push(t),this.setState({monster:this.state.monster})}},{key:"addRandomTrait",value:function(e,t){var a=[];t.forEach(function(t){t.traits.filter(function(t){return t.type===e}).forEach(function(e){a.push(e)})});var n=Math.floor(Math.random()*a.length),s=a[n];this.copyTrait(s)}},{key:"removeTrait",value:function(e){var t=this.state.monster.traits.indexOf(e);this.state.monster.traits.splice(t,1),this.setState({monster:this.state.monster})}},{key:"swapTraits",value:function(e,t){var a=this.state.monster.traits.indexOf(e),n=this.state.monster.traits.indexOf(t);this.state.monster.traits[n]=e,this.state.monster.traits[a]=t,this.setState({monster:this.state.monster})}},{key:"getActionTypeName",value:function(e,t){var a=p.traitType(e);return t&&(a+="s"),a}},{key:"copyTrait",value:function(e){var t=JSON.parse(JSON.stringify(e));t.id=p.guid(),this.state.monster.traits.push(t),this.setState({monster:this.state.monster})}},{key:"changeTrait",value:function(e,t,a){e[t]=a,this.setState({monster:this.state.monster})}},{key:"nudgeValue",value:function(e,t){var a=this.state.monster,n=null,s=e.split(".");s.forEach(function(e){e===s[s.length-1]?n=a[e]:a=a[e]});var r="challenge"===e?p.nudgeChallenge(n,t):(n||0)+t;this.changeValue(e,r)}},{key:"changeValue",value:function(e,t){var a=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.state.monster,r=e.split(".");r.forEach(function(i){if(i===r[r.length-1]){if(s[i]=t,"abilityScores.con"===e||"size"===e||"hitDice"===e){var o=(p.hitDieType(a.state.monster.size)+1)/2+Math.floor((a.state.monster.abilityScores.con-10)/2),c=Math.floor(a.state.monster.hitDice*o);a.state.monster.hpMax=c}n&&a.setState({monster:a.state.monster})}else s=s[i]})}},{key:"getHelpSection",value:function(e){switch(this.state.helpSection){case"speed":return this.getValueSection("speed","text",e);case"senses":return this.getValueSection("senses","text",e);case"languages":return this.getValueSection("languages","text",e);case"equipment":return this.getValueSection("equipment","text",e);case"str":return this.getValueSection("abilityScores.str","number",e);case"dex":return this.getValueSection("abilityScores.dex","number",e);case"con":return this.getValueSection("abilityScores.con","number",e);case"int":return this.getValueSection("abilityScores.int","number",e);case"wis":return this.getValueSection("abilityScores.wis","number",e);case"cha":return this.getValueSection("abilityScores.cha","number",e);case"saves":return this.getValueSection("savingThrows","text",e);case"skills":return this.getValueSection("skills","text",e);case"armor class":return this.getValueSection("ac","number",e);case"hit dice":return this.getValueSection("hitDice","number",e);case"resistances":return this.getValueSection("damage.resist","text",e);case"vulnerabilities":return this.getValueSection("damage.vulnerable","text",e);case"immunities":return this.getValueSection("damage.immune","text",e);case"conditions":return this.getValueSection("conditionImmunities","text",e);case"actions":return this.getActionsSection(e);default:return null}}},{key:"getValueSection",value:function(e,t,a){var n=this,r=a.map(function(a){var n=e.split("."),s=a,r=null;return n.forEach(function(e){e===n[n.length-1]?r=s[e]:s=s[e]}),"text"===t&&""===r&&(r=null),r}).filter(function(e){return null!==e}),i=[];if("number"===t){var o=null,c=null;if(r.forEach(function(e){(null===o||e<o)&&(o=e),(null===c||e>c)&&(c=e)}),null!==o&&null!==c)for(var l=o;l<=c;++l)i.push({value:l,count:0})}switch(r.forEach(function(e){var t=i.find(function(t){return t.value===e});t?t.count+=1:i.push({value:e,count:1})}),t){case"number":p.sortByValue(i);break;case"text":p.sortByCount(i)}"text"===t&&(0!==a.length-r.length&&i.push({value:"",count:a.length-r.length}));var u=i.map(function(t){var r=100*t.count/a.length;return s.a.createElement("div",{className:"row small-up-3 medium-up-3 large-up-3 value-list",key:i.indexOf(t)},s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:"text-container"},t.value||"(none specified)")),s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:"bar-container"},s.a.createElement("div",{className:"bar",style:{width:r+"%"}}))),s.a.createElement("div",{className:"column"},s.a.createElement("button",{onClick:function(){return n.changeValue(e,t.value)}},"use this value")))});return s.a.createElement("div",null,u,s.a.createElement("button",{onClick:function(){return n.setRandomValue(e,a,!0)}},"select random value"))}},{key:"getActionsSection",value:function(e){var t=this,a=[];return a.push(s.a.createElement("div",{className:"row small-up-4 medium-up-4 large-up-4 value-list",key:"header"},s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:"text-container"},s.a.createElement("b",null,"type"))),s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:"text-container number"},s.a.createElement("b",null,"average number"))),s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:"text-container number"},s.a.createElement("b",null,"min - max"))))),L.forEach(function(n){var r=null,i=null,o=0;e.forEach(function(e){var t=e.traits.filter(function(e){return e.type===n}).length;(null===r||t<r)&&(r=t),(null===i||t>i)&&(i=t),o+=t});var c=Math.round(o/e.length);a.push(s.a.createElement("div",{className:"row small-up-4 medium-up-4 large-up-4 value-list",key:n},s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:0===o?"text-container disabled":"text-container"},t.getActionTypeName(n,!0))),s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:0===o?"text-container number disabled":"text-container number"},c)),s.a.createElement("div",{className:"column"},s.a.createElement("div",{className:0===o?"text-container number disabled":"text-container number"},r," - ",i)),s.a.createElement("div",{className:"column"},s.a.createElement("button",{className:0===o?"disabled":"",onClick:function(){return t.addRandomTrait(n,e)}},"add random"))))}),s.a.createElement("div",null,a)}},{key:"getFilterCard",value:function(e){var t=this,a=[];this.state.filter.size&&a.push("size"),this.state.filter.type&&a.push("type"),this.state.filter.subtype&&a.push("subtype"),this.state.filter.alignment&&a.push("alignment"),this.state.filter.challenge&&a.push("challenge rating");var n=a.length>0?"based on "+a.join(", "):"no criteria specified",r=s.a.createElement("div",{className:"section"},e.length," similar monsters (",n,")"),i=null;return i=this.state.showFilter?s.a.createElement("div",null,s.a.createElement(ke,{label:"size "+this.state.monster.size,checked:this.state.filter.size,changeValue:function(e){return t.toggleMatch("size")}}),s.a.createElement(ke,{label:"type "+this.state.monster.category,checked:this.state.filter.type,changeValue:function(e){return t.toggleMatch("type")}}),s.a.createElement(ke,{label:this.state.monster.tag?"subtype "+this.state.monster.tag:"subtype",checked:this.state.filter.subtype,disabled:!this.state.monster.tag,changeValue:function(e){return t.toggleMatch("subtype")}}),s.a.createElement(ke,{label:this.state.monster.alignment?"alignment "+this.state.monster.alignment:"alignment",checked:this.state.filter.alignment,disabled:!this.state.monster.alignment,changeValue:function(e){return t.toggleMatch("alignment")}}),s.a.createElement(ke,{label:"challenge rating "+p.challenge(this.state.monster.challenge),checked:this.state.filter.challenge,changeValue:function(e){return t.toggleMatch("challenge")}}),s.a.createElement("div",{className:"divider"}),s.a.createElement("button",{className:e.length<2?"disabled":"",onClick:function(){return t.geneSplice(e)}},"build random monster"),s.a.createElement("div",{className:"divider"}),r):s.a.createElement("div",null,r),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"title"},"similar monsters"),s.a.createElement("img",{className:this.state.showFilter?"image rotate":"image",src:q.a,alt:"arrow",onClick:function(){return t.toggleFilter()}})),s.a.createElement("div",{className:"card-content"},i)))}},{key:"getMonsterCards",value:function(e){var t=this;return p.sort(e).map(function(e){return e.traits.some(function(e){return p.match(t.state.filter.text,e.name)})?s.a.createElement("div",{className:"section",key:e.id},s.a.createElement(J,{combatant:e,mode:"template "+t.state.page,filter:t.state.filter.text,copyTrait:function(e){return t.copyTrait(e)}})):null}).filter(function(e){return!!e})}},{key:"render",value:function(){var e=this;try{var t=[];this.props.showMonsters&&(t=this.getMonsters());var a=null;switch(this.state.page){case"overview":var n=z.map(function(e){return{id:e,text:e}}),r=A.map(function(e){return{id:e,text:e}});a=s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"name"),s.a.createElement("input",{type:"text",value:this.state.monster.name,onChange:function(t){return e.changeValue("name",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"size"),s.a.createElement(N,{options:r,selectedID:this.state.monster.size,select:function(t){return e.changeValue("size",t)}}),s.a.createElement("div",{className:"subheading"},"type"),s.a.createElement(N,{options:n,selectedID:this.state.monster.category,select:function(t){return e.changeValue("category",t)}}),s.a.createElement("div",{className:"subheading"},"subtype"),s.a.createElement("input",{type:"text",value:this.state.monster.tag,onChange:function(t){return e.changeValue("tag",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"alignment"),s.a.createElement("input",{type:"text",value:this.state.monster.alignment,onChange:function(t){return e.changeValue("alignment",t.target.value)}})),s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"challenge rating"),s.a.createElement(V,{source:this.state.monster,name:"challenge",display:function(e){return p.challenge(e)},nudgeValue:function(t){return e.nudgeValue("challenge",t)}}),s.a.createElement("div",{className:"subheading"},"speed"),s.a.createElement("input",{type:"text",value:this.state.monster.speed,onChange:function(t){return e.changeValue("speed",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"senses"),s.a.createElement("input",{type:"text",value:this.state.monster.senses,onChange:function(t){return e.changeValue("senses",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"languages"),s.a.createElement("input",{type:"text",value:this.state.monster.languages,onChange:function(t){return e.changeValue("languages",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"equipment"),s.a.createElement("input",{type:"text",value:this.state.monster.equipment,onChange:function(t){return e.changeValue("equipment",t.target.value)}})));break;case"abilities":a=s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"ability scores"),s.a.createElement(T,{edit:!0,combatant:this.state.monster,nudgeValue:function(t,a,n){return e.nudgeValue(a,n)}})),s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"saving throws"),s.a.createElement("input",{type:"text",value:this.state.monster.savingThrows,onChange:function(t){return e.changeValue("savingThrows",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"skills"),s.a.createElement("input",{type:"text",value:this.state.monster.skills,onChange:function(t){return e.changeValue("skills",t.target.value)}})));break;case"cbt-stats":a=s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"armor class"),s.a.createElement(V,{source:this.state.monster,name:"ac",nudgeValue:function(t){return e.nudgeValue("ac",t)}}),s.a.createElement("div",{className:"subheading"},"hit dice"),s.a.createElement(V,{source:this.state.monster,name:"hitDice",display:function(t){return t+"d"+p.hitDieType(e.state.monster.size)},nudgeValue:function(t){return e.nudgeValue("hitDice",t)}}),s.a.createElement("div",{className:"subheading"},"hit points"),s.a.createElement("div",{className:"hp-value"},this.state.monster.hpMax," hp")),s.a.createElement("div",{className:"columns small-6 medium-6 large-6"},s.a.createElement("div",{className:"subheading"},"damage resistances"),s.a.createElement("input",{type:"text",value:this.state.monster.damage.resist,onChange:function(t){return e.changeValue("damage.resist",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"damage vulnerabilities"),s.a.createElement("input",{type:"text",value:this.state.monster.damage.vulnerable,onChange:function(t){return e.changeValue("damage.vulnerable",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"damage immunities"),s.a.createElement("input",{type:"text",value:this.state.monster.damage.immune,onChange:function(t){return e.changeValue("damage.immune",t.target.value)}}),s.a.createElement("div",{className:"subheading"},"condition immunities"),s.a.createElement("input",{type:"text",value:this.state.monster.conditionImmunities,onChange:function(t){return e.changeValue("conditionImmunities",t.target.value)}})));break;case"actions":a=s.a.createElement(W,{combatant:this.state.monster,mode:"edit",addTrait:function(t){return e.addTrait(t)},removeTrait:function(t){return e.removeTrait(t)},swapTraits:function(t,a){return e.swapTraits(t,a)},changeValue:function(t,a,n){return e.changeTrait(t,a,n)}})}var i=null;if(this.props.showMonsters&&t.length>1){var o=null;if(this.getHelpOptionsForPage(this.state.page).length>1){var c=this.getHelpOptionsForPage(this.state.page).map(function(e){return{id:e,text:e}});o=s.a.createElement(Ne,{tabs:!1,options:c,selectedID:this.state.helpSection,select:function(t){return e.setHelpSection(t)}})}i=s.a.createElement("div",{className:"monster-help"},s.a.createElement("div",{className:"subheading"},"information from similar monsters"),o,this.getHelpSection(t))}var l=null;if(this.props.showMonsters){var u=null;"actions"===this.state.page&&t.length>0&&(u=s.a.createElement("input",{type:"text",placeholder:"search for traits and actions",value:this.state.filter.text,onChange:function(t){return e.setFilterText(t.target.value)}})),l=s.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable list-column"},this.getFilterCard(t),u,this.getMonsterCards(t))}return s.a.createElement("div",{className:"row",style:{height:"100%",margin:"0 -15px"}},s.a.createElement("div",{className:this.props.showMonsters?"columns small-8 medium-8 large-8 scrollable":"columns small-12 medium-12 large-12 scrollable",style:{transition:"none"}},s.a.createElement("div",{className:"section"},s.a.createElement(Ne,{tabs:!0,options:[{id:"overview",text:"overview"},{id:"abilities",text:"abilities"},{id:"cbt-stats",text:"combat"},{id:"actions",text:"actions"}],selectedID:this.state.page,select:function(t){return e.setPage(t)}}),a,i)),l)}catch(m){console.error(m)}}}]),t}(s.a.Component),ut=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="dm"===this.props.view?"navigator-item selected":"navigator-item",a="parties"===this.props.view?"navigator-item selected":"navigator-item",n="library"===this.props.view?"navigator-item selected":"navigator-item",r="encounter"===this.props.view?"navigator-item selected":"navigator-item",i="maps"===this.props.view?"navigator-item selected":"navigator-item",o="combat"===this.props.view?"navigator-item selected":"navigator-item",c=0!==this.props.library.length,l=0!==this.props.parties.length&&0!==this.props.encounters.length;return c||(r+=" disabled"),l||(o+=" disabled"),s.a.createElement("div",{className:this.props.blur?"navbar blur":"navbar"},s.a.createElement("div",{className:t,onClick:function(){return e.props.setView("dm")}},"dm screen"),s.a.createElement("div",{className:a,onClick:function(){return e.props.setView("parties")}},"player characters"),s.a.createElement("div",{className:n,onClick:function(){return e.props.setView("library")}},"monster library"),s.a.createElement("div",{className:r,onClick:function(){return c?e.props.setView("encounter"):null}},"encounter builder"),s.a.createElement("div",{className:i,onClick:function(){return e.props.setView("maps")}},"map folios"),s.a.createElement("div",{className:o,onClick:function(){return l?e.props.setView("combat"):null}},"combat manager"))}catch(u){console.error(u)}}}]),t}(s.a.Component),mt=a(21),pt=a.n(mt),dt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return s.a.createElement("div",{className:this.props.blur?"titlebar blur":"titlebar"},s.a.createElement("div",{className:"app-name",onClick:function(){return e.props.openHome()}},"dojo"),this.props.actions,s.a.createElement("img",{className:"settings-icon",src:pt.a,title:"about",alt:"about",onClick:function(){return e.props.openAbout()}}))}catch(t){console.error(t)}}}]),t}(s.a.Component),ht=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"home",options:{showHelp:!0},parties:[],library:[],encounters:[],mapFolios:[],combats:[],selectedPartyID:null,selectedMonsterGroupID:null,selectedEncounterID:null,selectedMapFolioID:null,selectedCombatID:null,selectedDMModuleID:null,modal:null,filter:""};try{var n=null;try{var s=window.localStorage.getItem("data");s&&(n=JSON.parse(s))}catch(r){console.error("Could not parse JSON: ",r),n=null}null!==n&&(n.library.forEach(function(e){e.monsters.forEach(function(e){e.traits.forEach(function(e){e.uses=0})})}),n.encounters.forEach(function(e){e.waves||(e.waves=[])}),n.mapFolios||(n.mapFolios=[],n.selectedMapFolioID=null),n.combats.forEach(function(e){e.notifications||(e.notifications=[]),e.combatants.forEach(function(e){(void 0===e.altitude&&(e.altitude=0),"monster"===e.type)&&e.traits.forEach(function(e){void 0===e.uses&&(e.uses=0)})})}),n.view="home",n.modal=null,n.filter="",a.state=n)}catch(r){console.error(r)}return a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=null;try{e=JSON.stringify(this.state)}catch(t){console.error("Could not stringify data: ",t),e=null}null!==e&&window.localStorage.setItem("data",e)}},{key:"addParty",value:function(){var e=d.createParty();e.name="new party";var t=[].concat(this.state.parties,[e]);p.sort(t),this.setState({parties:t,selectedPartyID:e.id})}},{key:"removeParty",value:function(){var e=this.getParty(this.state.selectedPartyID);if(e){var t=this.state.parties.indexOf(e);this.state.parties.splice(t,1),this.setState({parties:this.state.parties,selectedPartyID:null})}}},{key:"addPC",value:function(){var e=this.getParty(this.state.selectedPartyID);if(e){var t=d.createPC();t.name="new pc",e.pcs.push(t),this.setState({parties:this.state.parties})}}},{key:"removePC",value:function(e){var t=this.getParty(this.state.selectedPartyID);if(t){var a=t.pcs.indexOf(e);t.pcs.splice(a,1),this.setState({parties:this.state.parties})}}},{key:"sortPCs",value:function(){var e=this.getParty(this.state.selectedPartyID);e&&(p.sort(e.pcs),this.setState({parties:this.state.parties}))}},{key:"addMonsterGroup",value:function(){var e=d.createMonsterGroup();e.name="new group";var t=[].concat(this.state.library,[e]);p.sort(t),this.setState({library:t,selectedMonsterGroupID:e.id})}},{key:"removeMonsterGroup",value:function(){var e=this.getMonsterGroup(this.state.selectedMonsterGroupID);if(e){var t=this.state.library.indexOf(e);this.state.library.splice(t,1),this.setState({library:this.state.library,selectedMonsterGroupID:null})}}},{key:"addMonster",value:function(){var e=d.createMonster();e.name="new monster";var t=this.getMonsterGroup(this.state.selectedMonsterGroupID);t&&(t.monsters.push(e),this.setState({library:this.state.library}))}},{key:"removeMonster",value:function(e){var t=this.getMonsterGroup(this.state.selectedMonsterGroupID);if(t){var a=t.monsters.indexOf(e);t.monsters.splice(a,1),this.setState({library:this.state.library})}}},{key:"sortMonsters",value:function(){var e=this.getMonsterGroup(this.state.selectedMonsterGroupID);e&&(p.sort(e.monsters),this.setState({library:this.state.library}))}},{key:"moveToGroup",value:function(e,t){var a=this.findMonster(e);if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1);var s=this.getMonsterGroup(t);s&&(s.monsters.push(e),p.sort(s.monsters),this.setState({library:this.state.library}))}}},{key:"editMonster",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({modal:{type:"monster",monster:t,showMonsters:!1}})}},{key:"saveMonster",value:function(){var e=this,t=this.getMonsterGroup(this.state.selectedMonsterGroupID);if(t){var a=t.monsters.find(function(t){return t.id===e.state.modal.monster.id});if(a){var n=t.monsters.indexOf(a);t.monsters[n]=this.state.modal.monster,this.setState({library:this.state.library,modal:null})}}}},{key:"toggleShowSimilarMonsters",value:function(){this.state.modal.showMonsters=!this.state.modal.showMonsters,this.setState({modal:this.state.modal})}},{key:"openDemographics",value:function(){this.setState({modal:{type:"demographics"}})}},{key:"cloneMonster",value:function(e,t){var a=this.findMonster(e);if(a){var n={id:p.guid(),type:"monster",name:t||e.name+" copy",size:e.size,category:e.category,tag:e.tag,alignment:e.alignment,challenge:e.challenge,abilityScores:{str:e.abilityScores.str,dex:e.abilityScores.dex,con:e.abilityScores.con,int:e.abilityScores.int,wis:e.abilityScores.wis,cha:e.abilityScores.cha},ac:e.ac,hpMax:e.hpMax,hpTemp:e.hpTemp,hitDice:e.hitDice,damage:{resist:e.damage.resist,vulnerable:e.damage.vulnerable,immune:e.damage.immune},savingThrows:e.savingThrows,speed:e.speed,skills:e.skills,senses:e.senses,languages:e.languages,equipment:e.equipment,traits:e.traits.map(function(e){return{id:p.guid(),name:e.name,usage:e.usage,type:e.type,text:e.text,uses:0}}),conditionImmunities:e.conditionImmunities};a.monsters.push(n),p.sort(a.monsters),this.setState({library:this.state.library})}}},{key:"addOpenGameContent",value:function(){var e=this;fetch("./data/monsters.json").then(function(e){return e.json()}).then(function(t){t.forEach(function(t){try{if(t.name){var a=d.createMonster();a.type="monster",a.name=t.name,a.size=t.size.toLowerCase(),a.category=t.type,a.tag=t.subtype,a.alignment=t.alignment,a.challenge=p.parseChallenge(t.challenge_rating),a.ac=t.armor_class,a.hpMax=t.hit_points,a.speed=t.speed,a.senses=t.senses,a.languages=t.languages;var n=t.hit_dice.indexOf("d");a.hitDice=parseInt(t.hit_dice.substring(0,n),10),a.abilityScores.str=t.strength,a.abilityScores.dex=t.dexterity,a.abilityScores.con=t.constitution,a.abilityScores.int=t.intelligence,a.abilityScores.wis=t.wisdom,a.abilityScores.cha=t.charisma,a.damage.resist=t.damage_resistances,a.damage.vulnerable=t.damage_vulnerabilities,a.damage.immune=t.damage_immunities,a.conditionImmunities=t.condition_immunities;[{field:"strength_save",text:"Strength"},{field:"dexterity_save",text:"Dexterity"},{field:"constitution_save",text:"Constitution"},{field:"intelligence_save",text:"Intelligence"},{field:"wisdom_save",text:"Wisdom"},{field:"charisma_save",text:"Charisma"}].forEach(function(e){if(t[e.field]){var n=e.text+" "+t[e.field];a.savingThrows+=""===a.savingThrows?n:", "+n}});[{field:"acrobatics",text:"Acrobatics"},{field:"animal_handling",text:"Animal handling"},{field:"arcana",text:"Arcana"},{field:"athletics",text:"Athletics"},{field:"deception",text:"Deception"},{field:"history",text:"History"},{field:"insight",text:"Insight"},{field:"intimidation",text:"Intimidation"},{field:"investigation",text:"Investigation"},{field:"medicine",text:"Medicine"},{field:"nature",text:"Nature"},{field:"perception",text:"Perception"},{field:"performance",text:"Performance"},{field:"persuasion",text:"Persuasion"},{field:"religion",text:"Religion"},{field:"sleight_of_hand",text:"Sleight of hand"},{field:"stealth",text:"Stealth"},{field:"survival",text:"Survival"}].forEach(function(e){if(t[e.field]){var n=e.text+" "+t[e.field];a.skills+=""===a.skills?n:", "+n}}),t.special_abilities&&t.special_abilities.forEach(function(t){var n=e.buildTrait(t,"trait");a.traits.push(n)}),t.actions&&t.actions.forEach(function(t){var n=e.buildTrait(t,"action");a.traits.push(n)}),t.legendary_actions&&t.legendary_actions.forEach(function(t){var n=e.buildTrait(t,"legendary");a.traits.push(n)});var s=a.tag;""===s&&(s=a.category),0===s.indexOf("swarm")&&(s="swarm"),"any race"===s&&(s="npc");var r=e.getMonsterGroupByName(s);r||(r={id:p.guid(),name:s,monsters:[]},e.state.library.push(r)),r.monsters.push(a)}}catch(i){console.error(i)}}),p.sort(e.state.library),e.setState({view:"library",library:e.state.library})})}},{key:"buildTrait",value:function(e,t){var a="",n="",s=e.name.indexOf("(");if(-1===s)a=e.name;else{var r=e.name.indexOf(")");a=e.name.substring(0,s-1),n=e.name.substring(s+1,r).toLowerCase()}var i=e.desc.replace(/\u2022/g,"*");return{id:p.guid(),type:t,name:a,usage:n,text:i,uses:0}}},{key:"addEncounter",value:function(){var e=d.createEncounter();e.name="new encounter";var t=[].concat(this.state.encounters,[e]);p.sort(t),this.setState({encounters:t,selectedEncounterID:e.id})}},{key:"removeEncounter",value:function(){var e=this.getEncounter(this.state.selectedEncounterID);if(e){var t=this.state.encounters.indexOf(e);this.state.encounters.splice(t,1),this.setState({encounters:this.state.encounters,selectedEncounterID:null})}}},{key:"addEncounterSlot",value:function(e,t){var a=this.findMonster(e);if(a){var n=d.createEncounterSlot();n.monsterGroupName=a.name,n.monsterName=e.name;var s=this.getEncounter(this.state.selectedEncounterID);if(s){if(null!==t){var r=s.waves.find(function(e){return e.id===t});r&&(r.slots.push(n),this.sortEncounterSlots(r))}else s.slots.push(n),this.sortEncounterSlots(s);this.setState({encounters:this.state.encounters})}}}},{key:"removeEncounterSlot",value:function(e,t){var a=this.getEncounter(this.state.selectedEncounterID);if(a){if(t){var n=a.waves.find(function(e){return e.id===t});if(n){var s=n.slots.indexOf(e);n.slots.splice(s,1)}}else{var r=a.slots.indexOf(e);a.slots.splice(r,1)}this.setState({encounters:this.state.encounters})}}},{key:"sortEncounterSlots",value:function(e){e.slots.sort(function(e,t){var a=e.monsterName.toLowerCase(),n=t.monsterName.toLowerCase();return a<n?-1:a>n?1:0})}},{key:"addWaveToEncounter",value:function(){var e=this.getEncounter(this.state.selectedEncounterID);if(e){var t=d.createEncounterWave();t.name="wave "+(e.waves.length+2),e.waves.push(t),this.setState({encounters:this.state.encounters})}}},{key:"removeWave",value:function(e){var t=this.getEncounter(this.state.selectedEncounterID);if(t){var a=t.waves.indexOf(e);t.waves.splice(a,1),this.setState({encounters:this.state.encounters})}}},{key:"addMapFolio",value:function(){var e=d.createMapFolio();e.name="new folio";var t=[].concat(this.state.mapFolios,[e]);p.sort(t),this.setState({mapFolios:t,selectedMapFolioID:e.id})}},{key:"removeMapFolio",value:function(){var e=this.getMapFolio(this.state.selectedMapFolioID);if(e){var t=this.state.mapFolios.indexOf(e);this.state.mapFolios.splice(t,1),this.setState({mapFolios:this.state.mapFolios,selectedMapFolioID:null})}}},{key:"addMap",value:function(){var e=this.getMapFolio(this.state.selectedMapFolioID);if(e){var t=d.createMap();t.name="new map",e.maps.push(t),this.setState({mapFolios:this.state.mapFolios})}}},{key:"editMap",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({modal:{type:"map",map:t}})}},{key:"saveMap",value:function(){var e=this,t=this.getMapFolio(this.state.selectedMapFolioID);if(t){var a=t.maps.find(function(t){return t.id===e.state.modal.map.id});if(a){var n=t.maps.indexOf(a);t.maps[n]=this.state.modal.map,this.setState({mapFolios:this.state.mapFolios,modal:null})}}}},{key:"removeMap",value:function(e){var t=this.getMapFolio(this.state.selectedMapFolioID);if(t){var a=t.maps.indexOf(e);t.maps.splice(a,1),this.setState({mapFolios:this.state.mapFolios})}}},{key:"createCombat",value:function(){var e=1===this.state.parties.length?this.state.parties[0]:null,t=1===this.state.encounters.length?this.state.encounters[0]:null,a=d.createCombatSetup();a.partyID=e?e.id:null,a.encounterID=t?t.id:null,t&&(a.monsterNames=p.getMonsterNames(t)),this.setState({modal:{type:"combat-start",combatSetup:a}})}},{key:"startCombat",value:function(){var e=this,t=this.state.modal.combatSetup,a=this.getParty(t.partyID),n=this.getEncounter(t.encounterID);if(a&&n){var s=a.name||"unnamed party",r=n.name||"unnamed encounter",i=d.createCombat();if(i.name=s+" vs "+r,i.encounterID=n.id,a.pcs.filter(function(e){return e.active}).forEach(function(e){var t=JSON.parse(JSON.stringify(e));t.current=!1,t.pending=!0,t.active=!1,t.defeated=!1,t.displayName=e.name,t.initiative=10,t.hp=null,t.conditions=[],t.altitude=0,i.combatants.push(t)}),n.slots.forEach(function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName);if(n)for(var s=parseInt(p.modifier(n.abilityScores.dex),10),r=p.dieRoll(),o=0;o!==a.count;++o){var c=p.dieRoll(),l=JSON.parse(JSON.stringify(n));if(l.id=p.guid(),l.displayName=null,t.monsterNames){var u=t.monsterNames.find(function(e){return e.id===a.id});u&&(l.displayName=u.names[o])}switch(t.encounterInitMode){case"manual":l.initiative=10;break;case"group":l.initiative=s+r;break;case"individual":l.initiative=s+c}l.current=!1,l.pending="manual"===t.encounterInitMode,l.active="manual"!==t.encounterInitMode,l.defeated=!1,l.hp=l.hpMax,l.conditions=[],l.altitude=0,i.combatants.push(l)}else i.issues.push("unknown monster: "+a.monsterName+" in group "+a.monsterGroupName)}),i.combatants.forEach(function(e){return e.altitude=0}),this.sortCombatants(i),t.folioID&&t.mapID){var o=this.getMapFolio(t.folioID);if(o){var c=o.maps.find(function(e){return e.id===t.mapID});c&&(i.map=JSON.parse(JSON.stringify(c)))}}this.setState({combats:[].concat(this.state.combats,[i]),selectedCombatID:i.id,modal:null})}}},{key:"openWaveModal",value:function(){var e=this.getCombat(this.state.selectedCombatID);if(e){var t=this.getEncounter(e.encounterID);if(t){var a=d.createCombatSetup();a.encounterID=e.encounterID,a.monsterNames=p.getMonsterNames(t),this.setState({modal:{type:"combat-wave",combatSetup:a}})}}}},{key:"pauseCombat",value:function(){var e=this.getCombat(this.state.selectedCombatID);e&&(e.timestamp=(new Date).toLocaleString(),this.setState({combats:this.state.combats,selectedCombatID:null}))}},{key:"resumeCombat",value:function(e){this.setState({selectedCombatID:e.id})}},{key:"endCombat",value:function(){var e=this.getCombat(this.state.selectedCombatID);if(e){var t=this.state.combats.indexOf(e);this.state.combats.splice(t,1),this.setState({combats:this.state.combats,selectedCombatID:null})}}},{key:"makeCurrent",value:function(e,t){var a=this.getCombat(this.state.selectedCombatID);a&&(a.combatants.filter(function(e){return e.conditions}).forEach(function(t){t.conditions.forEach(function(n){if(n.duration)switch(n.duration.type){case"saves":a&&e&&t.id===e.id&&"start"===n.duration.point&&a.notifications.push({id:p.guid(),type:"condition-save",data:n,combatant:e});break;case"combatant":if(a&&e&&n.duration.combatantID===e.id&&"start"===n.duration.point){var s=t.conditions.indexOf(n);t.conditions.splice(s,1),a.notifications.push({id:p.guid(),type:"condition-end",data:n,combatant:e})}break;case"rounds":if(e&&t.id===e.id&&(n.duration.count-=1),0===n.duration.count){var r=t.conditions.indexOf(n);t.conditions.splice(r,1),a&&a.notifications.push({id:p.guid(),type:"condition-end",data:n,combatant:e})}}})}),e&&"monster"===e.type&&e.traits.filter(function(e){return e.uses>0&&e.usage.toLowerCase().startsWith("recharge ")}).forEach(function(t){a.notifications.push({id:p.guid(),type:"trait-recharge",data:t,combatant:e})}),a.combatants.forEach(function(e){e.current=!1}),e&&(e.current=!0),t&&(a.round+=1),this.setState({combats:this.state.combats}))}},{key:"makeActive",value:function(e){var t=this.getCombat(this.state.selectedCombatID);t&&(e.pending=!1,e.active=!0,e.defeated=!1,this.sortCombatants(t),this.setState({combats:this.state.combats}))}},{key:"makeDefeated",value:function(e){e.pending=!1,e.active=!1,e.defeated=!0,e.current?this.endTurn(e):this.setState({combats:this.state.combats})}},{key:"addWaveToCombat",value:function(){var e=this,t=this.state.modal.combatSetup,a=this.getEncounter(t.encounterID),n=this.getCombat(this.state.selectedCombatID);if(t&&a&&n){var s=a.waves.find(function(e){return e.id===t.waveID});s&&(s.slots.forEach(function(a){var s=e.getMonster(a.monsterName,a.monsterGroupName);if(s)for(var r=parseInt(p.modifier(s.abilityScores.dex),10),i=p.dieRoll(),o=0;o!==a.count;++o){var c=p.dieRoll(),l=JSON.parse(JSON.stringify(s));if(l.id=p.guid(),l.displayName=null,t.monsterNames){var u=t.monsterNames.find(function(e){return e.id===a.id});u&&(l.displayName=u.names[o])}switch(t.encounterInitMode){case"manual":l.initiative=10;break;case"group":l.initiative=r+i;break;case"individual":l.initiative=r+c}l.current=!1,l.pending="manual"===e.state.modal.combatSetup.encounterInitMode,l.active="manual"!==e.state.modal.combatSetup.encounterInitMode,l.defeated=!1,l.hp=l.hpMax,l.conditions=[],n&&n.combatants.push(l)}else if(n){var m="unknown monster: "+a.monsterName+" in group "+a.monsterGroupName;n.issues.push(m)}}),this.sortCombatants(n),this.setState({combats:this.state.combats,modal:null}))}}},{key:"removeCombatant",value:function(e){var t=this.getCombat(this.state.selectedCombatID);if(t){var a=t.combatants.indexOf(e);t.combatants.splice(a,1),this.setState({combats:this.state.combats})}}},{key:"mapAdd",value:function(e,t,a){var n=d.createMapItem();n.id=e.id,n.type=e.type,n.x=t,n.y=a;var s=1;"monster"===e.type&&(s=p.miniSize(e.size)),n.height=s,n.width=s;var r=this.getCombat(this.state.selectedCombatID);r&&r.map&&(r.map.items.push(n),this.setState({combats:this.state.combats}))}},{key:"mapMove",value:function(e,t){var a=this.getCombat(this.state.selectedCombatID);if(a&&a.map){var n=a.map.items.find(function(t){return t.id===e.id});if(n){switch(t){case"N":n.y-=1;break;case"NE":n.x+=1,n.y-=1;break;case"E":n.x+=1;break;case"SE":n.x+=1,n.y+=1;break;case"S":n.y+=1;break;case"SW":n.x-=1,n.y+=1;break;case"W":n.x-=1;break;case"NW":n.x-=1,n.y-=1}this.setState({combats:this.state.combats})}}}},{key:"mapRemove",value:function(e){var t=this.getCombat(this.state.selectedCombatID);if(t&&t.map){var a=t.map.items.find(function(t){return t.id===e.id});if(a){var n=t.map.items.indexOf(a);t.map.items.splice(n,1),this.setState({combats:this.state.combats})}}}},{key:"endTurn",value:function(e){var t=this.getCombat(this.state.selectedCombatID);if(t){t.combatants.filter(function(e){return e.conditions}).forEach(function(a){a.conditions.forEach(function(n){if(n.duration)switch(n.duration.type){case"saves":if(t&&a.id===e.id&&"end"===n.duration.point){var s=d.createNotification();s.type="condition-save",s.data=n,s.combatant=e,t.notifications.push(s)}break;case"combatant":if(t&&n.duration.combatantID===e.id&&"end"===n.duration.point){var r=a.conditions.indexOf(n);a.conditions.splice(r,1);var i=d.createNotification();i.type="condition-end",i.data=n,i.combatant=e,t.notifications.push(i)}}})});var a=t.combatants.filter(function(e){return e.current||!e.pending&&e.active&&!e.defeated});if(0===a.length)this.makeCurrent(null,!1);else if(1===a.length&&a[0].defeated)this.makeCurrent(null,!1);else{var n=a.indexOf(e)+1,s=!1;n>=a.length&&(n=0,s=!0),this.makeCurrent(a[n],s)}}}},{key:"changeHP",value:function(e,t,a){e.hp=t,e.hpTemp=a,this.setState({combats:this.state.combats})}},{key:"addCondition",value:function(e){var t=this.getCombat(this.state.selectedCombatID);if(t){var a=d.createCondition();a.name="blinded",this.setState({modal:{type:"condition-add",condition:a,combatant:e,combat:t}})}}},{key:"addConditionFromModal",value:function(){this.state.modal.combatant.conditions.push(this.state.modal.condition),this.setState({combats:this.state.combats,modal:null})}},{key:"editCondition",value:function(e,t){var a=this.getCombat(this.state.selectedCombatID);a&&this.setState({modal:{type:"condition-edit",condition:t,combatant:e,combat:a}})}},{key:"editConditionFromModal",value:function(){var e=this,t=this.state.modal.combatant.conditions,a=t.find(function(t){return t.id===e.state.modal.condition.id});if(a){var n=t.indexOf(a);t[n]=this.state.modal.condition,this.setState({combats:this.state.combats,modal:null})}}},{key:"removeCondition",value:function(e,t){var a=e.conditions.find(function(e){return e.id===t});if(a){var n=e.conditions.indexOf(a);e.conditions.splice(n,1),this.setState({combats:this.state.combats})}}},{key:"sortCombatants",value:function(e){e.combatants.sort(function(e,t){return e.initiative&&t.initiative&&e.initiative<t.initiative?1:e.initiative&&t.initiative&&e.initiative>t.initiative?-1:e.name<t.name?-1:e.name>t.name?1:0})}},{key:"closeNotification",value:function(e,t){var a=this.getCombat(this.state.selectedCombatID);if(a){var n=a.notifications.indexOf(e);if(a.notifications.splice(n,1),t&&e.combatant&&e.data){var s=e.combatant.conditions.indexOf(e.data);e.combatant.conditions.splice(s,1)}this.setState({combats:this.state.combats})}}},{key:"setView",value:function(e){this.setState({view:e})}},{key:"openAbout",value:function(){this.setState({modal:{type:"about"}})}},{key:"closeModal",value:function(){this.setState({modal:null})}},{key:"selectDMModule",value:function(e){this.setState({selectedDMModuleID:e?e.id:null})}},{key:"selectParty",value:function(e){this.setState({selectedPartyID:e?e.id:null})}},{key:"selectMonsterGroup",value:function(e){this.setState({selectedMonsterGroupID:e?e.id:null})}},{key:"selectEncounter",value:function(e){this.setState({selectedEncounterID:e?e.id:null})}},{key:"selectMapFolio",value:function(e){this.setState({selectedMapFolioID:e?e.id:null})}},{key:"getParty",value:function(e){return this.state.parties.find(function(t){return t.id===e})}},{key:"getMonsterGroup",value:function(e){return this.state.library.find(function(t){return t.id===e})}},{key:"getEncounter",value:function(e){return this.state.encounters.find(function(t){return t.id===e})}},{key:"getMapFolio",value:function(e){return this.state.mapFolios.find(function(t){return t.id===e})}},{key:"getCombat",value:function(e){return this.state.combats.find(function(t){return t.id===e})}},{key:"getMonster",value:function(e,t){var a=this.getMonsterGroupByName(t);if(a)return a.monsters.find(function(t){return t.name===e})}},{key:"getMonsterGroupByName",value:function(e){return this.state.library.find(function(t){return t.name===e})}},{key:"findMonster",value:function(e){return this.state.library.find(function(t){return t.monsters.includes(e)})}},{key:"resetAll",value:function(){this.setState({parties:[],selectedPartyID:null,library:[],selectedMonsterGroupID:null,encounters:[],selectedEncounterID:null,mapFolios:[],selectedMapFolioID:null,combats:[],selectedCombatID:null})}},{key:"changeValue",value:function(e,t,a){switch(t){case"hp":a=Math.min(a,e.hpMax),a=Math.max(a,0);break;case"hpTemp":a=Math.max(a,0);break;case"level":a=Math.max(a,1),a=void 0!==e.player?Math.min(a,20):Math.min(a,6);break;case"count":case"hitDice":a=Math.max(a,1)}for(var n=t.split("."),s=e,r=0;r!==n.length;++r){var i=n[r];r===n.length-1?s[i]=a:s=s[i]}if(p.sort(this.state.parties),p.sort(this.state.library),p.sort(this.state.encounters),"initiative"===t&&!e.pending){var o=this.getCombat(this.state.selectedCombatID);this.sortCombatants(o)}this.setState({parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,combats:this.state.combats,selectedPartyID:this.state.selectedPartyID,selectedMonsterGroupID:this.state.selectedMonsterGroupID,selectedEncounterID:this.state.selectedEncounterID,selectedCombatID:this.state.selectedCombatID,options:this.state.options,modal:this.state.modal})}},{key:"nudgeValue",value:function(e,t,a){for(var n=t.split("."),s=e,r=0;r!==n.length;++r){var i=n[r];if(r===n.length-1){var o;o="challenge"===i?p.nudgeChallenge(s.challenge,a):s[i]+a,this.changeValue(e,t,o)}else s=s[i]}}},{key:"render",value:function(){var e=this;try{var t=null,a=null;switch(this.state.view){case"home":t=s.a.createElement(He,{library:this.state.library,addOpenGameContent:function(){return e.addOpenGameContent()}});break;case"dm":t=s.a.createElement(Se,{selectedModuleID:this.state.selectedDMModuleID,showHelp:this.state.options.showHelp,selectModule:function(t){return e.selectDMModule(t)}});break;case"parties":t=s.a.createElement(Ke,{parties:this.state.parties,selection:this.getParty(this.state.selectedPartyID)||null,filter:this.state.filter,showHelp:this.state.options.showHelp,selectParty:function(t){return e.selectParty(t)},addParty:function(){return e.addParty()},removeParty:function(){return e.removeParty()},addPC:function(){return e.addPC()},removePC:function(t){return e.removePC(t)},sortPCs:function(){return e.sortPCs()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)}}),a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));break;case"library":t=s.a.createElement(Je,{library:this.state.library,selection:this.getMonsterGroup(this.state.selectedMonsterGroupID)||null,filter:this.state.filter,showHelp:this.state.options.showHelp,selectMonsterGroup:function(t){return e.selectMonsterGroup(t)},addMonsterGroup:function(){return e.addMonsterGroup()},removeMonsterGroup:function(){return e.removeMonsterGroup()},addMonster:function(){return e.addMonster()},removeMonster:function(t){return e.removeMonster(t)},sortMonsters:function(){return e.sortMonsters()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},editMonster:function(t){return e.editMonster(t)},cloneMonster:function(t,a){return e.cloneMonster(t,a)},moveToGroup:function(t,a){return e.moveToGroup(t,a)}}),a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.openDemographics()}},"demographics")),s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));break;case"encounter":t=s.a.createElement(Ge,{encounters:this.state.encounters,selection:this.getEncounter(this.state.selectedEncounterID)||null,filter:this.state.filter,parties:this.state.parties,library:this.state.library,showHelp:this.state.options.showHelp,selectEncounter:function(t){return e.selectEncounter(t)},addEncounter:function(){return e.addEncounter()},removeEncounter:function(){return e.removeEncounter()},addWave:function(){return e.addWaveToEncounter()},removeWave:function(t){return e.removeWave(t)},getMonster:function(t,a){return e.getMonster(t,a)||null},addEncounterSlot:function(t,a){return e.addEncounterSlot(t,a)},removeEncounterSlot:function(t,a){return e.removeEncounterSlot(t,a)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}}),a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));break;case"maps":t=s.a.createElement(We,{mapFolios:this.state.mapFolios,selection:this.getMapFolio(this.state.selectedMapFolioID)||null,filter:this.state.filter,showHelp:this.state.options.showHelp,selectMapFolio:function(t){return e.selectMapFolio(t)},addMapFolio:function(){return e.addMapFolio()},removeMapFolio:function(){return e.removeMapFolio()},addMap:function(){return e.addMap()},editMap:function(t){return e.editMap(t)},removeMap:function(t){return e.removeMap(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}}),a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));break;case"combat":var n=this.getCombat(this.state.selectedCombatID);if(t=s.a.createElement(ne,{combats:this.state.combats,combat:n||null,filter:this.state.filter,showHelp:this.state.options.showHelp,createCombat:function(){return e.createCombat()},resumeEncounter:function(t){return e.resumeCombat(t)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},makeCurrent:function(t){return e.makeCurrent(t,!1)},makeActive:function(t){return e.makeActive(t)},makeDefeated:function(t){return e.makeDefeated(t)},removeCombatant:function(t){return e.removeCombatant(t)},addCondition:function(t){return e.addCondition(t)},editCondition:function(t,a){return e.editCondition(t,a)},removeCondition:function(t,a){return e.removeCondition(t,a)},mapAdd:function(t,a,n){return e.mapAdd(t,a,n)},mapMove:function(t,a){return e.mapMove(t,a)},mapRemove:function(t){return e.mapRemove(t)},endTurn:function(t){return e.endTurn(t)},changeHP:function(t,a,n){return e.changeHP(t,a,n)},close:function(t,a){return e.closeNotification(t,a)}}),n){var r=this.getEncounter(n.encounterID);if(r){var i=0;n.combatants.filter(function(e){return"monster"===e.type}).forEach(function(e){i+=p.experience(e.challenge)}),a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"text"},"round: ",n.round)),s.a.createElement("div",{className:"section"},s.a.createElement("div",{className:"text"},"xp: ",i)),s.a.createElement("div",{className:"section",style:{display:0===r.waves.length?"none":""}},s.a.createElement("button",{onClick:function(){return e.openWaveModal()}},"add wave")),s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.pauseCombat()}},"pause encounter")),s.a.createElement("div",{className:"section"},s.a.createElement("button",{onClick:function(){return e.endCombat()}},"end encounter")))}}else a=s.a.createElement("div",{className:"actions"},s.a.createElement("div",{className:"section"},s.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})))}var o=null;if(this.state.modal){var c=!1,l=null,u=null,m=!0,d={left:[],right:[s.a.createElement("button",{key:"close",onClick:function(){return e.closeModal()}},"close")]};switch(this.state.modal.type){case"about":c=!0,l="about",u=s.a.createElement(Ze,{options:this.state.options,resetAll:function(){return e.resetAll()},changeValue:function(t,a,n){return e.changeValue(t,a,n)}}),d.right=[];break;case"demographics":c=!0,l="demographics",u=s.a.createElement(rt,{library:this.state.library}),d.right=[];break;case"monster":l="monster editor",u=s.a.createElement(lt,{monster:this.state.modal.monster,library:this.state.library,showMonsters:this.state.modal.showMonsters}),m=!1,d.left=[s.a.createElement(ke,{key:"similar",label:"similar monsters",checked:this.state.modal.showMonsters,changeValue:function(){return e.toggleShowSimilarMonsters()}})],d.right=[s.a.createElement("button",{key:"save",onClick:function(){return e.saveMonster()}},"save"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"map":l="map editor",u=s.a.createElement(ct,{map:this.state.modal.map}),m=!1,d.right=[s.a.createElement("button",{key:"save",onClick:function(){return e.saveMap()}},"save"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"combat-start":l="start a new encounter",u=s.a.createElement($e,{combatSetup:this.state.modal.combatSetup,parties:this.state.parties,encounters:this.state.encounters,mapFolios:this.state.mapFolios,getMonster:function(t,a){return e.getMonster(t,a)||null},notify:function(){return e.setState({modal:e.state.modal})}}),m=!1,d.right=[s.a.createElement("button",{key:"start encounter",className:this.state.modal.combatSetup.partyID&&this.state.modal.combatSetup.encounterID?"":"disabled",onClick:function(){return e.startCombat()}},"start encounter"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"combat-wave":l="encounter waves",u=s.a.createElement($e,{combatSetup:this.state.modal.combatSetup,encounters:this.state.encounters,getMonster:function(t,a){return e.getMonster(t,a)||null},notify:function(){return e.setState({modal:e.state.modal})}}),m=!1,d.right=[s.a.createElement("button",{key:"add wave",className:null!==this.state.modal.combatSetup.waveID?"":"disabled",onClick:function(){return e.addWaveToCombat()}},"add wave"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"condition-add":l="add a condition",u=s.a.createElement(st,{condition:this.state.modal.condition,combatant:this.state.modal.combatant,combat:this.state.modal.combat}),m=!1,d.right=[s.a.createElement("button",{key:"add",onClick:function(){return e.addConditionFromModal()}},"add"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"condition-edit":l="edit condition",u=s.a.createElement(st,{condition:this.state.modal.condition,combatant:this.state.modal.combatant,combat:this.state.modal.combat}),d.right=[s.a.createElement("button",{key:"save",onClick:function(){return e.editConditionFromModal()}},"save"),s.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")]}o=s.a.createElement("div",{className:"overlay"},s.a.createElement("div",{className:c?"modal sidebar":"modal"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("div",{className:"title"},l),c?s.a.createElement("img",{className:"image",src:te.a,alt:"close",onClick:function(){return e.closeModal()}}):null),s.a.createElement("div",{className:m?"modal-content scrollable":"modal-content"},u),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("div",{className:"left"},d.left),s.a.createElement("div",{className:"right"},d.right))))}return s.a.createElement("div",{className:"dojo"},s.a.createElement(dt,{actions:a,blur:null!==o,openHome:function(){return e.setView("home")},openAbout:function(){return e.openAbout()}}),s.a.createElement("div",{className:null===o?"page-content":"page-content blur"},t),s.a.createElement(ut,{view:this.state.view,parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,blur:null!==o,setView:function(t){return e.setView(t)}}),o)}catch(h){console.error(h)}}}]),t}(s.a.Component);i.a.render(s.a.createElement(ht,null),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.945037a1.chunk.js.map