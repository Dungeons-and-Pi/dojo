(this.webpackJsonpdojo=this.webpackJsonpdojo||[]).push([[0],{112:function(e,t,a){e.exports=a.p+"static/media/ellipsis.9650a20f.svg"},117:function(e,t,a){e.exports=a.p+"static/media/down-arrow.697dc1af.svg"},120:function(e,t,a){e.exports=a.p+"static/media/down-arrow-black.a2fc7a1f.svg"},126:function(e,t,a){e.exports=a(214)},131:function(e,t,a){},132:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(11),i=a.n(s),o=(a(131),a(132),a(47)),c=a(2),l=a(3),u=a(5),m=a(4),p=a(6),d=a(220),h=a(221),v=a(219),f=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"getMonsterGroup",value:function(e,t){var a=this.monsterIdToGroup[e.id];if(!a){var n=t.find((function(t){return t.monsters.includes(e)}));n&&(a=n,this.monsterIdToGroup[e.id]=a)}return a}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"sort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===t.length&&(t=[{field:"name",dir:"asc"}]);var a=function(e,t,a){if(void 0!==e[a]&&void 0!==t[a]){if(e[a]<t[a])return-1;if(e[a]>t[a])return 1}return 0};return e.sort((function(e,n){var r=0;return t.forEach((function(t){0===r&&(r=a(e,n,t.field)*("asc"===t.dir?1:-1))})),r})),e}},{key:"debounce",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){clearTimeout(t),t=setTimeout(e,a)}}},{key:"toData",value:function(e){var t=e/1073741824;if(t>=1)return t.toFixed(2)+" GB";var a=e/1048576;if(a>=1)return a.toFixed(2)+" MB";var n=e/1024;return n>=1?n.toFixed(2)+" KB":e+" B"}},{key:"modifierValue",value:function(e){return Math.floor((e-10)/2)}},{key:"modifier",value:function(e){var t=this.modifierValue(e),a=t.toString();return t>=0&&(a="+"+a),a}},{key:"dieRoll",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=0,n=0;n!==t;++n)a+=Math.floor(Math.random()*e)+1;return a}},{key:"miniSize",value:function(e){switch(e){case"tiny":return.4;case"small":return.6;case"medium":return 1;case"large":return 2;case"huge":return 3;case"gargantuan":return 4;default:return 1}}},{key:"hitDieType",value:function(e){switch(e){case"tiny":return 4;case"small":return 6;case"medium":return 8;case"large":return 10;case"huge":return 12;case"gargantuan":return 20;default:return 8}}},{key:"proficiency",value:function(e){return e<5?2:e<9?3:e<13?4:e<17?5:6}},{key:"challenge",value:function(e){switch(e){case.125:return"1/8";case.25:return"1/4";case.5:return"1/2";default:return e.toString()}}},{key:"parseChallenge",value:function(e){switch(e){case"1/8":return.125;case"1/4":return.25;case"1/2":return.5;default:return parseInt(e,10)}}},{key:"challengeDetails",value:function(){var e=[];return e.push({cr:0,ac:13,hpMin:1,hpMax:6,attack:3,dmgMin:0,dmgMax:1,save:13}),e.push({cr:.125,ac:13,hpMin:7,hpMax:35,attack:3,dmgMin:2,dmgMax:3,save:13}),e.push({cr:.25,ac:13,hpMin:36,hpMax:49,attack:3,dmgMin:4,dmgMax:5,save:13}),e.push({cr:.5,ac:13,hpMin:50,hpMax:70,attack:3,dmgMin:6,dmgMax:8,save:13}),e.push({cr:1,ac:13,hpMin:71,hpMax:85,attack:3,dmgMin:9,dmgMax:14,save:13}),e.push({cr:2,ac:13,hpMin:86,hpMax:100,attack:3,dmgMin:15,dmgMax:20,save:13}),e.push({cr:3,ac:13,hpMin:101,hpMax:115,attack:4,dmgMin:21,dmgMax:26,save:13}),e.push({cr:4,ac:14,hpMin:116,hpMax:130,attack:5,dmgMin:27,dmgMax:32,save:14}),e.push({cr:5,ac:15,hpMin:131,hpMax:145,attack:6,dmgMin:33,dmgMax:38,save:15}),e.push({cr:6,ac:15,hpMin:146,hpMax:160,attack:6,dmgMin:39,dmgMax:44,save:15}),e.push({cr:7,ac:15,hpMin:161,hpMax:175,attack:6,dmgMin:45,dmgMax:50,save:15}),e.push({cr:8,ac:16,hpMin:176,hpMax:190,attack:7,dmgMin:51,dmgMax:56,save:16}),e.push({cr:9,ac:16,hpMin:191,hpMax:205,attack:7,dmgMin:57,dmgMax:62,save:16}),e.push({cr:10,ac:17,hpMin:206,hpMax:220,attack:7,dmgMin:63,dmgMax:68,save:16}),e.push({cr:11,ac:17,hpMin:221,hpMax:235,attack:8,dmgMin:69,dmgMax:74,save:17}),e.push({cr:12,ac:17,hpMin:236,hpMax:250,attack:8,dmgMin:75,dmgMax:80,save:17}),e.push({cr:13,ac:18,hpMin:251,hpMax:265,attack:8,dmgMin:81,dmgMax:86,save:18}),e.push({cr:14,ac:18,hpMin:266,hpMax:280,attack:8,dmgMin:87,dmgMax:92,save:18}),e.push({cr:15,ac:18,hpMin:281,hpMax:295,attack:8,dmgMin:93,dmgMax:98,save:18}),e.push({cr:16,ac:18,hpMin:296,hpMax:310,attack:9,dmgMin:99,dmgMax:104,save:18}),e.push({cr:17,ac:19,hpMin:311,hpMax:325,attack:10,dmgMin:105,dmgMax:110,save:19}),e.push({cr:18,ac:19,hpMin:326,hpMax:340,attack:10,dmgMin:111,dmgMax:116,save:19}),e.push({cr:19,ac:19,hpMin:341,hpMax:355,attack:10,dmgMin:117,dmgMax:122,save:19}),e.push({cr:20,ac:19,hpMin:356,hpMax:400,attack:10,dmgMin:123,dmgMax:140,save:19}),e.push({cr:21,ac:19,hpMin:401,hpMax:445,attack:11,dmgMin:141,dmgMax:158,save:20}),e.push({cr:22,ac:19,hpMin:446,hpMax:490,attack:11,dmgMin:159,dmgMax:176,save:20}),e.push({cr:23,ac:19,hpMin:491,hpMax:535,attack:11,dmgMin:177,dmgMax:194,save:20}),e.push({cr:24,ac:19,hpMin:536,hpMax:580,attack:12,dmgMin:195,dmgMax:212,save:21}),e.push({cr:25,ac:19,hpMin:581,hpMax:625,attack:12,dmgMin:213,dmgMax:230,save:21}),e.push({cr:26,ac:19,hpMin:626,hpMax:670,attack:12,dmgMin:231,dmgMax:248,save:21}),e.push({cr:27,ac:19,hpMin:671,hpMax:715,attack:13,dmgMin:249,dmgMax:266,save:22}),e.push({cr:28,ac:19,hpMin:716,hpMax:760,attack:13,dmgMin:267,dmgMax:284,save:22}),e.push({cr:29,ac:19,hpMin:761,hpMax:805,attack:13,dmgMin:285,dmgMax:302,save:22}),e.push({cr:30,ac:19,hpMin:806,hpMax:850,attack:14,dmgMin:303,dmgMax:320,save:23}),e}},{key:"experience",value:function(e){switch(e){case 0:return 10;case.125:return 25;case.25:return 50;case.5:return 100;case 1:return 200;case 2:return 450;case 3:return 700;case 4:return 1100;case 5:return 1800;case 6:return 2300;case 7:return 2900;case 8:return 3900;case 9:return 5e3;case 10:return 5900;case 11:return 7200;case 12:return 8400;case 13:return 1e4;case 14:return 11500;case 15:return 13e3;case 16:return 15e3;case 17:return 18e3;case 18:return 2e4;case 19:return 22e3;case 20:return 25e3;case 21:return 33e3;case 22:return 41e3;case 23:return 5e4;case 24:return 62e3;case 30:return 155e3;default:return 0}}},{key:"experienceFactor",value:function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 1.5;case 3:case 4:case 5:case 6:return 2;case 7:case 8:case 9:case 10:return 2.5;case 11:case 12:case 13:case 14:return 3;default:return 4}}},{key:"pcExperience",value:function(e,t){switch(t){case"easy":switch(e){case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 125;case 5:return 250;case 6:return 300;case 7:return 350;case 8:return 450;case 9:return 550;case 10:return 600;case 11:return 800;case 12:return 1e3;case 13:return 1100;case 14:return 1250;case 15:return 1400;case 16:return 1600;case 17:return 2e3;case 18:return 2100;case 19:return 2400;case 20:return 2800;default:return 0}case"medium":switch(e){case 1:return 50;case 2:return 100;case 3:return 150;case 4:return 250;case 5:return 500;case 6:return 600;case 7:return 750;case 8:return 900;case 9:return 1100;case 10:return 1200;case 11:return 1600;case 12:return 2e3;case 13:return 2200;case 14:return 2500;case 15:return 2800;case 16:return 3200;case 17:return 3900;case 18:return 4200;case 19:return 4900;case 20:return 5700;default:return 0}case"hard":switch(e){case 1:return 75;case 2:return 150;case 3:return 225;case 4:return 375;case 5:return 750;case 6:return 900;case 7:return 1100;case 8:return 1400;case 9:return 1600;case 10:return 1900;case 11:return 2400;case 12:return 3e3;case 13:return 3400;case 14:return 3800;case 15:return 4300;case 16:return 4800;case 17:return 5900;case 18:return 6300;case 19:return 7300;case 20:return 8500;default:return 0}case"deadly":switch(e){case 1:return 100;case 2:return 200;case 3:return 400;case 4:return 500;case 5:return 1100;case 6:return 1400;case 7:return 1700;case 8:return 2100;case 9:return 2400;case 10:return 2800;case 11:return 3600;case 12:return 4500;case 13:return 5100;case 14:return 5700;case 15:return 6400;case 16:return 7200;case 17:return 8800;case 18:return 9500;case 19:return 10900;case 20:return 12700;default:return 0}default:return 0}}},{key:"traitType",value:function(e,t){var a="";switch(e){case"trait":a="trait";break;case"action":a="action";break;case"bonus":a="bonus action";break;case"reaction":a="reaction";break;case"legendary":a="legendary action";break;case"lair":a="lair action"}return t&&(a+="s"),a}},{key:"nudgeChallenge",value:function(e,t){var a=0;switch(e){case 0:-1===t&&(a=0),1===t&&(a=.125);break;case.125:-1===t&&(a=0),1===t&&(a=.25);break;case.25:-1===t&&(a=.125),1===t&&(a=.5);break;case.5:-1===t&&(a=.25),1===t&&(a=1);break;case 1:-1===t&&(a=.5),1===t&&(a=2);break;default:a=e+t}return a}},{key:"nudgeSize",value:function(e,t){var a=["tiny","small","medium","large","huge","gargantuan"],n=a.indexOf(e)+t;return n<0&&(n=0),n>=a.length&&(n=a.length-1),a[n]}},{key:"conditionText",value:function(e){switch(e.name){case"blinded":return["a blinded creature can\u2019t see and automatically fails any ability check that requires sight","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage"];case"charmed":return["a charmed creature can\u2019t attack the charmer or target the charmer with harmful abilities or magical effects","the charmer has advantage on any ability check to interact socially with the creature"];case"deafened":return["a deafened creature can\u2019t hear and automatically fails any ability check that requires hearing."];case"exhaustion":switch(e.level){case 1:return["disadvantage on ability checks"];case 2:return["disadvantage on ability checks","speed halved"];case 3:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws"];case 4:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved"];case 5:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0"];case 6:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0","death"];default:return[]}case"frightened":return["a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight","the creature can\u2019t willingly move closer to the source of its fear"];case"grappled":return["a grappled creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","the condition ends if the grappler is incapacitated","the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect"];case"incapacitated":return["an incapacitated creature can\u2019t take actions or reactions","being incapacitated breaks concentration"];case"invisible":return["an invisible creature is impossible to see without the aid of magic or a special sense","for the purpose of hiding, the creature is heavily obscured","the creature\u2019s location can be detected by any noise it makes or any tracks it leaves","attack rolls against the creature have disadvantage, and the creature\u2019s attack rolls have advantage"];case"paralyzed":return["a paralyzed creature is incapacitated (can\u2019t take actions or reactions) and can\u2019t move or speak","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"petrified":return["a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)","its weight increases by a factor of ten, and it ceases aging","the creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","attack rolls against the creature have advantage","the creature automatically fails strength and dexterity saving throws","the creature has resistance to all damage","the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized"];case"poisoned":return["a poisoned creature has disadvantage on attack rolls and ability checks"];case"prone":return["a prone creature\u2019s only movement option is to crawl, unless it stands up (using half its speed) and thereby ends the condition","the creature has disadvantage on attack rolls","an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage"];case"restrained":return["a restrained creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage","the creature has disadvantage on dexterity saving throws"];case"stunned":return["a stunned creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move, and can speak only falteringly","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage"];case"unconscious":return["an unconscious creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","the creature drops whatever its holding and falls prone","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];default:return[]}}},{key:"conditionDurationText",value:function(e,t){if(null!==e.duration)switch(e.duration.type){case"saves":var a=e.duration,n=a.saveType.toString();"death"!==n&&(n=n.toUpperCase());var r=a.count>1?"saves":"save";return"until you make "+a.count+" "+n+" "+r+" at dc "+a.saveDC;case"combatant":var s=e.duration,i=s.point,o=t.combatants.find((function(e){return e.id===s.combatantID}));return"until the "+i+" of "+(o?(o.displayName||o.name||"unnamed monster")+"'s":"someone's")+" next turn";case"rounds":var c=e.duration,l=c.count>1?"rounds":"round";return"for "+c.count+" "+l;default:return null}return null}},{key:"getMonsterNames",value:function(e){var t=[];return e&&e.slots.forEach((function(e){var a=[];if(1===e.count)a.push(e.monsterName);else for(var n=0;n!==e.count;++n)a.push(e.monsterName+" "+(n+1));t.push({id:e.id,names:a})})),t}},{key:"getTagTitle",value:function(e){switch(e){case"conc":return"concentrating";case"bane":return"affected by bane";case"bless":return"affected by bless";default:return e}}},{key:"getTagDescription",value:function(e){switch(e){case"conc":return"if damaged, must make con save (dc is half damage taken or 10, whichever is higher) or lose concentration";case"bane":return"subtract d4 from attack rolls and saving throws";case"bless":return"add d4 to attack rolls and saving throws";default:return e}}}]),e}();f.monsterIdToGroup={};var g=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"createParty",value:function(){return{id:f.guid(),name:"",pcs:[]}}},{key:"createPC",value:function(){return{id:f.guid(),type:"pc",active:!0,player:"",name:"",size:"medium",race:"",classes:"",level:1,languages:"Common",passiveInsight:10,passiveInvestigation:10,passivePerception:10,portrait:"",url:"",companions:[]}}},{key:"createCompanion",value:function(){return{id:f.guid(),name:""}}},{key:"createMonsterGroup",value:function(){return{id:f.guid(),name:"",monsters:[]}}},{key:"createMonster",value:function(){return{id:f.guid(),type:"monster",name:"",size:"medium",category:"humanoid",tag:"",alignment:"",challenge:1,abilityScores:{str:10,dex:10,con:10,int:10,wis:10,cha:10},ac:10,hpMax:4,hpTemp:0,hitDice:1,damage:{resist:"",vulnerable:"",immune:""},savingThrows:"",speed:"",skills:"",senses:"",languages:"",equipment:"",traits:[],conditionImmunities:"",portrait:""}}},{key:"createTrait",value:function(){return{id:f.guid(),name:"",usage:"",type:"action",text:"",uses:0}}},{key:"createEncounter",value:function(){return{id:f.guid(),name:"",slots:[],waves:[]}}},{key:"createEncounterSlot",value:function(){return{id:f.guid(),monsterGroupName:"",monsterName:"",count:1}}},{key:"createEncounterWave",value:function(){return{id:f.guid(),name:"",slots:[]}}},{key:"createMonsterFilter",value:function(){return{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}}},{key:"createMap",value:function(){return{id:f.guid(),name:"",items:[],notes:[]}}},{key:"createMapItem",value:function(){return{id:f.guid(),type:"tile",x:0,y:0,width:4,height:4,terrain:"",customBackground:"",content:null,size:"medium",color:"",opacity:255,style:null}}},{key:"createMapNote",value:function(){return{id:f.guid(),targetID:"",text:""}}},{key:"createCombatSetup",value:function(){return{party:null,encounter:null,waveID:null,map:null,monsterNames:[],encounterInitMode:"group"}}},{key:"createCombat",value:function(){return{id:f.guid(),name:"",encounter:e.createEncounter(),combatants:[],map:null,round:1,notifications:[],issues:[],report:[]}}},{key:"createNotification",value:function(){return{id:f.guid(),type:"condition-save",data:null,combatant:null}}},{key:"createCombatReportEntry",value:function(){return{id:f.guid(),type:"combat-start",timestamp:Date.now(),combatantID:"",value:0}}},{key:"createCondition",value:function(){return{id:f.guid(),name:"",level:1,text:"",duration:null}}},{key:"createConditionDurationSaves",value:function(){return{type:"saves",count:1,saveType:"str",saveDC:10,point:"start"}}},{key:"createConditionDurationCombatant",value:function(){return{type:"combatant",point:"start",combatantID:null}}},{key:"createConditionDurationRounds",value:function(){return{type:"rounds",count:1}}}]),e}(),b=["tiny","small","medium","large","huge","gargantuan"],y=["aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","humanoid","monstrosity","ooze","plant","undead"],E=["trait","action","bonus","reaction","legendary","lair"],k=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"getDescription",value:function(e){var t=e.size;e&&(t=e.displaySize||t);var a=(t+" "+e.category).toLowerCase();e.tag&&(a+=" ("+e.tag.toLowerCase()+")"),a+=", ";var n="";return e.alignment&&(n=e.alignment.toLowerCase()+", "),a+n+("cr "+f.challenge(e.challenge))}},{key:"nudgeValue",value:function(t,a,n){var r,s=t,i=null,o=a.split(".");switch(o.forEach((function(e){e===o[o.length-1]?i=s[e]:s=s[e]})),a){case"challenge":r=f.nudgeChallenge(i,n);break;case"size":r=f.nudgeSize(i,n);break;default:r=(i||0)+n}e.changeValue(t,a,r)}},{key:"changeValue",value:function(e,t,a){var n=e,r=t.split(".");r.forEach((function(s){if(s===r[r.length-1]){if(n[s]=a,"abilityScores.con"===t||"size"===t||"hitDice"===t){var i=(f.hitDieType(e.size)+1)/2+Math.floor((e.abilityScores.con-10)/2),o=Math.floor(e.hitDice*i);e.hpMax=o}}else n=n[s]}))}},{key:"clear",value:function(e){e.name="",e.size="medium",e.category="beast",e.tag="",e.alignment="",e.challenge=1,e.abilityScores.str=10,e.abilityScores.dex=10,e.abilityScores.con=10,e.abilityScores.int=10,e.abilityScores.wis=10,e.abilityScores.cha=10,e.ac=10,e.hpMax=0,e.hpTemp=0,e.hitDice=1,e.damage.resist="",e.damage.vulnerable="",e.damage.immune="",e.savingThrows="",e.speed="",e.skills="",e.senses="",e.languages="",e.equipment="",e.traits=[],e.conditionImmunities="",e.portrait=""}},{key:"clone",value:function(e,t){return{id:f.guid(),type:"monster",name:t||e.name+" copy",size:e.size,category:e.category,tag:e.tag,alignment:e.alignment,challenge:e.challenge,abilityScores:{str:e.abilityScores.str,dex:e.abilityScores.dex,con:e.abilityScores.con,int:e.abilityScores.int,wis:e.abilityScores.wis,cha:e.abilityScores.cha},ac:e.ac,hpMax:e.hpMax,hpTemp:e.hpTemp,hitDice:e.hitDice,damage:{resist:e.damage.resist,vulnerable:e.damage.vulnerable,immune:e.damage.immune},savingThrows:e.savingThrows,speed:e.speed,skills:e.skills,senses:e.senses,languages:e.languages,equipment:e.equipment,traits:e.traits.map((function(e){return{id:f.guid(),name:e.name,usage:e.usage,type:e.type,text:e.text,uses:0}})),conditionImmunities:e.conditionImmunities,portrait:e.portrait}}},{key:"createFromJSON",value:function(e){var t=this,a=g.createMonster();a.type="monster",a.name=e.name,a.size=e.size.toLowerCase(),a.category=e.type,a.tag=e.subtype,a.alignment=e.alignment,a.challenge=f.parseChallenge(e.challenge_rating),a.ac=e.armor_class,a.hpMax=e.hit_points,a.speed=e.speed,a.senses=e.senses,a.languages=e.languages;var n=e.hit_dice.indexOf("d");a.hitDice=parseInt(e.hit_dice.substring(0,n),10),a.abilityScores.str=e.strength,a.abilityScores.dex=e.dexterity,a.abilityScores.con=e.constitution,a.abilityScores.int=e.intelligence,a.abilityScores.wis=e.wisdom,a.abilityScores.cha=e.charisma,a.damage.resist=e.damage_resistances,a.damage.vulnerable=e.damage_vulnerabilities,a.damage.immune=e.damage_immunities,a.conditionImmunities=e.condition_immunities;[{field:"strength_save",text:"Strength"},{field:"dexterity_save",text:"Dexterity"},{field:"constitution_save",text:"Constitution"},{field:"intelligence_save",text:"Intelligence"},{field:"wisdom_save",text:"Wisdom"},{field:"charisma_save",text:"Charisma"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.savingThrows+=""===a.savingThrows?n:", "+n}}));return[{field:"acrobatics",text:"Acrobatics"},{field:"animal_handling",text:"Animal handling"},{field:"arcana",text:"Arcana"},{field:"athletics",text:"Athletics"},{field:"deception",text:"Deception"},{field:"history",text:"History"},{field:"insight",text:"Insight"},{field:"intimidation",text:"Intimidation"},{field:"investigation",text:"Investigation"},{field:"medicine",text:"Medicine"},{field:"nature",text:"Nature"},{field:"perception",text:"Perception"},{field:"performance",text:"Performance"},{field:"persuasion",text:"Persuasion"},{field:"religion",text:"Religion"},{field:"sleight_of_hand",text:"Sleight of hand"},{field:"stealth",text:"Stealth"},{field:"survival",text:"Survival"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.skills+=""===a.skills?n:", "+n}})),e.special_abilities&&e.special_abilities.forEach((function(e){var n=t.buildTrait(e,"trait");a.traits.push(n)})),e.actions&&e.actions.forEach((function(e){var n=t.buildTrait(e,"action");a.traits.push(n)})),e.reactions&&e.reactions.forEach((function(e){var n=t.buildTrait(e,"reaction");a.traits.push(n)})),e.legendary_actions&&e.legendary_actions.forEach((function(e){var n=t.buildTrait(e,"legendary");a.traits.push(n)})),a}},{key:"buildTrait",value:function(e,t){var a="",n="",r=e.name.indexOf("(");if(-1===r)a=e.name;else{var s=e.name.indexOf(")");a=e.name.substring(0,r-1),n=e.name.substring(r+1,s).toLowerCase()}var i=e.desc.replace(/\u2022/g,"*"),o=t;return"Lair Actions"===a&&(o="lair"),0===i.indexOf("As a bonus action")&&(o="bonus"),{id:f.guid(),type:o,name:a,usage:n,text:i,uses:0}}},{key:"import",value:function(t,a){e.clear(a);var n=(new DOMParser).parseFromString(t,"text/html");try{a.name=n.getElementsByClassName("mon-stat-block__name")[0].innerText.trim();var r=n.getElementsByClassName("mon-stat-block__meta")[0].innerText.toLowerCase().trim(),s=r.indexOf(" ");a.size=r.substring(0,s).trim();var i=(r=r.substring(s+1).trim()).indexOf(",");a.alignment=r.substring(i+1).trim();var o=(r=r.substring(0,i).trim()).indexOf("("),c=r.indexOf(")");-1!==o&&-1!==c&&(a.tag=r.substring(o+1,c).trim(),r=r.substring(0,o).trim()),a.category=r}catch(F){console.error(F)}try{for(var l=n.getElementsByClassName("mon-stat-block__attribute"),u=0;u!==l.length;++u){var m=l[u],p=m.getElementsByClassName("mon-stat-block__attribute-label")[0].innerText.toLowerCase().trim(),d=m.getElementsByClassName("mon-stat-block__attribute-data-value")[0].innerText.toLowerCase().trim();switch(p){case"armor class":a.ac=Number.parseInt(d,10);break;case"hit points":a.hpMax=Number.parseInt(d,10);var h=m.getElementsByClassName("mon-stat-block__attribute-data-extra")[0].innerText.toLowerCase().trim();a.hitDice=Number.parseInt(h.substring(1,h.indexOf("d")),10);break;case"speed":a.speed=d}}}catch(F){console.error(F)}try{for(var v=n.getElementsByClassName("ability-block__stat"),f=0;f!==v.length;++f){var b=v[f],y=b.getElementsByClassName("ability-block__heading")[0].innerText.toLowerCase().trim(),E=b.getElementsByClassName("ability-block__score")[0].innerText.toLowerCase().trim(),k=Number.parseInt(E,10);a.abilityScores[y]=k}}catch(F){console.error(F)}try{for(var N=n.getElementsByClassName("mon-stat-block__tidbit"),x=0;x!==N.length;++x){var w=N[x],C=w.getElementsByClassName("mon-stat-block__tidbit-label")[0].innerText.toLowerCase().trim(),S=w.getElementsByClassName("mon-stat-block__tidbit-data")[0].innerText.toLowerCase().trim();switch(C){case"saving throws":a.savingThrows=S;break;case"skills":a.skills=S;break;case"damage vulnerabilities":a.damage.vulnerable=S;break;case"damage resistances":a.damage.resist=S;break;case"damage immunities":a.damage.immune=S;break;case"condition immunities":a.conditionImmunities=S;break;case"senses":a.senses=S;break;case"languages":a.languages=S;break;case"challenge":var O=S.indexOf(" ");a.challenge=Number.parseInt(S.substring(0,O),10)}}}catch(F){console.error(F)}try{for(var M=n.getElementsByClassName("mon-stat-block__description-block"),j=0;j!==M.length;++j){var I=M[j],D="trait",V=I.getElementsByClassName("mon-stat-block__description-block-heading");if(V.length>0)switch(V[0].innerText.toLowerCase().trim()){case"actions":D="action";break;case"bonus actions":D="bonus";break;case"reactions":D="reaction";break;case"legendary actions":D="legendary";break;case"lair actions":D="lair"}for(var T=I.getElementsByTagName("p"),P=0;P!==T.length;++P){var A=T[P].innerText.trim(),z=g.createTrait();z.type=D;var G=A.indexOf(".");z.text=A.substring(G+1).trim();var R=(A=A.substring(0,G)).indexOf("("),L=A.indexOf(")");if(-1!==R&&-1!==L&&(z.usage=A.substring(R+1,L).trim(),A=A.substring(0,R).trim()),z.name=A,z.name)a.traits.push(z);else{var B=a.traits[a.traits.length-1];B.text+="\n",B.text+=z.text}}}}catch(F){console.error(F)}}},{key:"copyTrait",value:function(e,t){var a=JSON.parse(JSON.stringify(t));a.id=f.guid(),e.traits.push(a)}},{key:"addTrait",value:function(e,t){var a=g.createTrait();a.type=t,a.name="New "+f.traitType(t,!1).toLowerCase(),e.traits.push(a)}},{key:"moveTrait",value:function(e,t,a){var n,r=e.traits.splice(t,1);(n=e.traits).splice.apply(n,[a,0].concat(Object(o.a)(r)))}},{key:"removeTrait",value:function(e,t){var a=e.traits.indexOf(t);e.traits.splice(a,1)}},{key:"swapTraits",value:function(e,t,a){var n=e.traits.indexOf(t),r=e.traits.indexOf(a);e.traits[r]=t,e.traits[n]=a}},{key:"spliceMonsters",value:function(e,t){var a=this;["size","category","tag","alignment","challenge","speed","senses","languages","equipment","abilityScores.str","abilityScores.dex","abilityScores.con","abilityScores.int","abilityScores.wis","abilityScores.cha","savingThrows","skills","ac","hitDice","damage.resist","damage.vulnerable","damage.immune","conditionImmunities"].forEach((function(n){a.setRandomValue(e,n,t)})),e.traits=[],E.forEach((function(n){var r=[];t.forEach((function(e){e.traits.filter((function(e){return e.type===n})).forEach((function(e){return r.push(e)}))}));var s=[];r.forEach((function(e){var t=s.find((function(t){return t.trait.name===e.name}));t?t.count+=1:s.push({trait:e,count:1})}));var i=[];s.filter((function(e){return e.count===t.length})).forEach((function(t){a.copyTrait(e,t.trait),i.push(t.trait.id)})),i.forEach((function(e){var t=s.findIndex((function(t){return t.trait.id===e}));s.splice(t,1)}));for(var o=r.length/t.length;e.traits.filter((function(e){return e.type===n})).length<o;){var c=Math.floor(Math.random()*s.length),l=s[c].trait;a.copyTrait(e,l),s.splice(c,1)}}))}},{key:"setRandomValue",value:function(e,t,a){var n=a[Math.floor(Math.random()*a.length)],r=null,s=t.split(".");s.forEach((function(e){e===s[s.length-1]?r=n[e]:n=n[e]})),this.changeValue(e,t,r)}},{key:"addRandomTrait",value:function(e,t,a){var n=[];a.forEach((function(e){e.traits.filter((function(e){return e.type===t})).forEach((function(e){n.push(e)}))}));var r=Math.floor(Math.random()*n.length),s=n[r];this.copyTrait(e,s)}}]),e}(),N=["default","cavern","dirt","flagstone","floorboard","grassland","pit","sand","snow","water","custom"],x=["single","double","arch","bars"],w=["stairs","spiral","ladder"],C=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"scatterCombatants",value:function(t,a){if(t.map&&(t.map.items=t.map.items.filter((function(e){return e.type!==a})),t.map.items.filter((function(e){return"tile"===e.type})).length>0)){var n=e.mapDimensions(t.map);if(n)t.combatants.filter((function(e){return e.type===a})).forEach((function(r){for(var s=[],i=n.minX;i<=n.maxX;++i)for(var o=n.minY;o<=n.maxY;++o){e.canAddMonsterHere(t.map,r,i,o)&&s.push({x:i,y:o})}if(s.length>0&&t.map){var c=s[Math.floor(Math.random()*s.length)],l=f.miniSize(r.displaySize),u=g.createMapItem();u.id=r.id,u.type=a,u.x=c.x,u.y=c.y,u.height=l,u.width=l,t.map.items.push(u)}}))}}},{key:"mapDimensions",value:function(e){var t=e.items.filter((function(e){return"tile"===e.type}));if(t.length>0){var a=t[0].x,n=t[0].y,r=t[0].x+t[0].width-1,s=t[0].y+t[0].height-1;return t.forEach((function(e){a=Math.min(a,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x+e.width-1),s=Math.max(s,e.y+e.height-1)})),{minX:a,minY:n,maxX:r,maxY:s}}return null}},{key:"canAddTileHere",value:function(t,a,n,r,s,i){for(var o=[],c=n-s,l=r-i,u=n+(a.width-1)+s,m=r+(a.height-1)+i,p=c;p<=u;++p)for(var d=l;d<=m;++d){var h=e.itemsAt(t,p,d).every((function(e){return"tile"!==e.type}));o.push(h)}return o.every((function(e){return e}))}},{key:"canAddMonsterHere",value:function(t,a,n,r){for(var s=[],i=f.miniSize(a.displaySize),o=n+Math.max(1,i)-1,c=r+Math.max(1,i)-1,l=n;l<=o;++l)for(var u=r;u<=c;++u){var m=e.itemsAt(t,l,u),p=m.length>0&&m.every((function(e){return"tile"===e.type}));s.push(p)}return s.every((function(e){return e}))}},{key:"itemsAt",value:function(e,t,a){return e.items.filter((function(e){var n=e.x,r=e.x+e.width-1,s=e.y,i=e.y+e.height-1;return t>=n&&t<=r&&a>=s&&a<=i}))}},{key:"rotateMap",value:function(e){e.items.forEach((function(e){var t=-1*(e.y+e.height-1),a=e.x,n=e.height,r=e.width;e.x=t,e.y=a,e.width=n,e.height=r,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal")}))}},{key:"mapSize",value:function(t){return t.items.filter((function(e){return"tile"===e.type})).reduce((function(t,a){return t+e.mapTileSize(a)}),0)}},{key:"mapTileSize",value:function(e){return"tile"===e.type?e.width*e.height:0}},{key:"getNote",value:function(e,t){return e.notes.find((function(e){return e.targetID===t.id}))||null}},{key:"generate",value:function(t,a){switch(t){case"dungeon":for(var n=0;n<10;)e.addRoom(a)&&(n+=1);break;case"delve":for(var r=0;r<3;)e.addRoom(a)&&(r+=1);break;case"room":for(var s=!1;!s;)s=e.addRoom(a)}}},{key:"addRoom",value:function(t){var a=g.createMapItem();a.type="tile",a.terrain="default",a.style="square",a.width=f.dieRoll(4,2)+2,a.height=f.dieRoll(4,2)+2;var n=e.mapDimensions(t);if(n){n.minX-=a.width+10,n.minY-=a.height+10,n.maxX+=10,n.maxY+=10;for(var r=[],s=n.minX;s!==n.maxX;++s)for(var i=n.minY;i!==n.maxY;++i){e.canAddTileHere(t,a,s,i,1,1)&&r.push({x:s,y:i})}if(!(r.length>0))return!1;var o=Math.floor(Math.random()*r.length);a.x=r[o].x,a.y=r[o].y;var c=[];if(t.items.filter((function(e){return"tile"===e.type})).forEach((function(n){var r=Math.max(a.x,n.x),s=Math.min(a.x+a.width-1,n.x+n.width-1);if(s-r+1>=2)for(var i=Math.min(a.y+a.height-1,n.y+n.height-1)+1,o=Math.max(a.y,n.y)-1,l=r;l<=s-1;++l){var u=g.createMapItem();u.type="tile",u.terrain="default",u.style="square",u.x=l,u.y=i,u.width=2,u.height=o-i+1,e.canAddTileHere(t,u,u.x,u.y,1,0)&&c.push({tile:u,horizontal:!1})}var m=Math.max(a.y,n.y),p=Math.min(a.y+a.height-1,n.y+n.height-1);if(p-m+1>=2)for(var d=Math.min(a.x+a.width-1,n.x+n.width-1)+1,h=Math.max(a.x,n.x)-1,v=m;v<=p-1;++v){var f=g.createMapItem();f.type="tile",f.terrain="default",f.style="square",f.x=d,f.y=v,f.width=h-d+1,f.height=2,e.canAddTileHere(t,f,f.x,f.y,0,1)&&c.push({tile:f,horizontal:!0})}})),!(c.length>0))return!1;var l=Math.floor(Math.random()*c.length),u=c[l];if(!u.horizontal&&1===u.tile.height||u.horizontal&&1===u.tile.width)2===f.dieRoll(2)&&(u.tile.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:u.horizontal?"vertical":"horizontal"});else{if(!u.horizontal&&u.tile.height>=4||u.horizontal&&u.tile.width>=4){if(2===f.dieRoll(2)){var m=g.createMapItem();m.type="tile",m.terrain="default",m.style="square",m.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:""},u.horizontal?(m.x=u.tile.x,m.y=u.tile.y,m.width=1,m.height=2,m.content.orientation="vertical",u.tile.x+=1,u.tile.width-=1):(m.x=u.tile.x,m.y=u.tile.y,m.width=2,m.height=1,m.content.orientation="horizontal",u.tile.y+=1,u.tile.height-=1),t.items.push(m)}if(2===f.dieRoll(2)){var p=g.createMapItem();p.type="tile",p.terrain="default",p.style="square",p.content={type:"doorway",style:e.getRandomDoorwayStyle(),orientation:""},u.horizontal?(p.x=u.tile.x+u.tile.width-1,p.y=u.tile.y,p.width=1,p.height=2,p.content.orientation="vertical",u.tile.width-=1):(p.x=u.tile.x,p.y=u.tile.y+u.tile.height-1,p.width=2,p.height=1,p.content.orientation="horizontal",u.tile.height-=1),t.items.push(p)}}(!u.horizontal&&u.tile.height<=4||u.horizontal&&u.tile.width<=4)&&3===f.dieRoll(3)&&(u.tile.content={type:"stairway",style:"stairs",orientation:u.horizontal?"vertical":"horizontal"})}t.items.push(u.tile),t.items.push(a)}else t.items.push(a);return!0}},{key:"getRandomDoorwayStyle",value:function(){var e=Math.floor(Math.random()*x.length);return x[e]}}]),e}(),S=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"matchParty",value:function(t,a){return!!e.match(t,a.name)||a.pcs.some((function(a){return e.matchPC(t,a)}))}},{key:"matchPC",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.player)||(!!e.match(t,a.race)||(!!e.match(t,a.classes)||a.companions.some((function(a){return e.matchCompanion(t,a)})))))}},{key:"matchCompanion",value:function(t,a){return!!e.match(t,a.name)}},{key:"matchGroup",value:function(t,a){return!!e.match(t,a.name)||a.monsters.some((function(a){return e.matchMonster(t,a)}))}},{key:"matchMonster",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.category)||(!!e.match(t,a.tag)||(!!e.match(t,a.senses)||(!!e.match(t,a.languages)||(!!e.match(t,a.equipment)||a.traits.some((function(a){return e.matchTrait(t,a)})))))))}},{key:"matchTrait",value:function(t,a){return!!e.match(t,a.name)||(!!e.match(t,a.usage)||!!e.match(t,a.text))}},{key:"matchEncounter",value:function(t,a){return!!e.match(t,a.name)||(!!a.waves.some((function(a){return e.matchEncounterWave(t,a)}))||a.slots.some((function(a){return e.matchEncounterSlot(t,a)})))}},{key:"matchEncounterWave",value:function(t,a){return!!e.match(t,a.name)||a.slots.some((function(a){return e.matchEncounterSlot(t,a)}))}},{key:"matchEncounterSlot",value:function(t,a){return!!e.match(t,a.monsterName)}},{key:"matchMap",value:function(t,a){return!!e.match(t,a.name)||a.notes.some((function(a){return e.matchMapNote(t,a)}))}},{key:"matchMapNote",value:function(t,a){return!!e.match(t,a.text)}},{key:"match",value:function(e,t){if(!e)return!0;var a=!0;return e.toLowerCase().split(" ").forEach((function(e){-1===t.toLowerCase().indexOf(e)&&(a=!1)})),a}}]),e}(),O=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"getMonsterCount",value:function(e){var t=0,a=[];return a=a.concat(e.slots),e.waves.forEach((function(e){a=a.concat(e.slots)})),a.forEach((function(e){t+=e.count})),t}},{key:"getEncounterXP",value:function(e,t){var a=0,n=[];return n=n.concat(e.slots),e.waves.forEach((function(e){n=n.concat(e.slots)})),n.forEach((function(e){var n=t(e.monsterName,e.monsterGroupName);n&&(a+=f.experience(n.challenge)*e.count)})),a}},{key:"getAdjustedEncounterXP",value:function(e,t){var a=0,n=0,r=[];return r=r.concat(e.slots),e.waves.forEach((function(e){r=r.concat(e.slots)})),r.forEach((function(e){a+=e.count;var r=t(e.monsterName,e.monsterGroupName);r&&(n+=f.experience(r.challenge)*e.count)})),n*f.experienceFactor(a)}},{key:"getCombatXP",value:function(e){var t=0;return e.combatants.filter((function(e){return"monster"===e.type})).forEach((function(e){var a=e;t+=f.experience(a.challenge)})),t}},{key:"getFilterDescription",value:function(e){var t="";"all sizes"!==e.size&&(t+=t?" "+e.size:e.size),"all types"!==e.category&&(t+=t?" "+e.category:e.category);var a=f.challenge(e.challengeMin),n=f.challenge(e.challengeMax);return t+=" monsters of cr "+(e.challengeMin===e.challengeMax?a:a+" to "+n)}},{key:"buildEncounter",value:function(t,a,n,r,s){for(;e.getAdjustedEncounterXP(t,(function(e,t){return s(e,t)}))<=a;)if(t.slots.length>0&&f.dieRoll(3)>1){var i=Math.floor(Math.random()*t.slots.length);t.slots[i].count+=1}else{if("break"===function(){var a=[];if(r.forEach((function(r){r.monsters.filter((function(t){return e.matchMonster(t,n)})).filter((function(e){return!t.slots.find((function(t){return t.monsterGroupName===r.name&&t.monsterName===e.name}))})).forEach((function(e){return a.push({groupName:r.name,monsterName:e.name})}))})),a.length>0){var s=Math.floor(Math.random()*a.length),i=g.createEncounterSlot();i.monsterGroupName=a[s].groupName,i.monsterName=a[s].monsterName,t.slots.push(i)}else if(0===t.slots.length)return"break"}())break}for(var o=function(){var e=Math.floor(Math.random()*t.slots.length),a=t.slots[e];t.slots=t.slots.filter((function(e){return e.id!==a.id}));var n=g.createEncounterWave();n.name="wave "+(t.waves.length+2),n.slots.push(a),t.waves.push(n)};t.slots.length>1&&10===f.dieRoll(10);)o()}},{key:"matchMonster",value:function(e,t){return!(e.challenge<t.challengeMin)&&(!(e.challenge>t.challengeMax)&&(!(""!==t.name&&!S.match(t.name,e.name))&&(("all types"===t.category||e.category===t.category)&&("all sizes"===t.size||e.size===t.size))))}}]),e}(),M=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.changeValue(!this.props.checked)}},{key:"render",value:function(){var e=this;try{var t="checkbox "+this.props.display;this.props.checked&&(t+=" checked"),this.props.disabled&&(t+=" disabled");var a=null;return"switch"===this.props.display&&(a=r.a.createElement("div",{className:"toggle-container"},r.a.createElement("div",{className:"toggle"}))),r.a.createElement("div",{className:t,onClick:function(t){return e.click(t)}},r.a.createElement("div",{className:"checkbox-label"},this.props.label),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);M.defaultProps={display:"switch",disabled:!1};var j=a(87),I=a.n(j),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={pressed:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(){this.setState({pressed:!this.state.pressed})}},{key:"perform",value:function(){this.toggle(),this.props.callback()}},{key:"render",value:function(){var e=this;try{var t=null;return t=this.state.pressed?r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.props.text," - are you sure?"),r.a.createElement("img",{className:"image",src:I.a,alt:"warning"}),this.props.details?r.a.createElement("div",{className:"details"},this.props.details):null,r.a.createElement("div",{className:"confirmation"},r.a.createElement("div",{className:"destructive",onClick:function(){return e.perform()}},"yes"),r.a.createElement("div",{className:"non-destructive",onClick:function(){return e.toggle()}},"no"))):r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.props.text),r.a.createElement("img",{className:"image",src:I.a,alt:"warning"})),r.a.createElement("button",{className:this.props.disabled?"disabled":"",onClick:function(){return e.toggle()}},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);D.defaultProps={details:null,disabled:!1};var V=a(61),T=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=0,a=0,n=0;n!==localStorage.length;++n){var s=localStorage.key(n);if(s){var i=localStorage.getItem(s);i&&(s.startsWith("data")&&(t+=i.length),s.startsWith("image")&&(a+=i.length))}}return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement("div",{className:"section"},"designed by ",r.a.createElement("a",{href:"mailto:andy.aiken@live.co.uk"},"andy aiken")),r.a.createElement("div",{className:"section"},"version ",r.a.createElement("b",null,V.version)),r.a.createElement("div",{className:"section"},"if you would like to raise a bug or request a new feature, you can do so ",r.a.createElement("a",{href:"https://github.com/andyaiken/dojo",target:"_blank",rel:"noopener noreferrer"},"here")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"open game license"),r.a.createElement("div",{className:"section"},"The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved."),r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement("b",null,"Definitions"),": (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement."),r.a.createElement("li",null,r.a.createElement("b",null,"The License"),": This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Offer and Acceptance"),": By Using the Open Game Content You indicate Your acceptance of the terms of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Grant and Consideration"),": In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content."),r.a.createElement("li",null,r.a.createElement("b",null,"Representation of Authority to Contribute"),": If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Notice of License Copyright"),": You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute."),r.a.createElement("li",null,r.a.createElement("b",null,"Use of Product Identity"),": You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity."),r.a.createElement("li",null,r.a.createElement("b",null,"Identification"),": If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content."),r.a.createElement("li",null,r.a.createElement("b",null,"Updating the License"),": Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Copy of this License"),": You MUST include a copy of this License with every copy of the Open Game Content You Distribute."),r.a.createElement("li",null,r.a.createElement("b",null,"Use of Contributor Credits"),": You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so."),r.a.createElement("li",null,r.a.createElement("b",null,"Inability to Comply"),": If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected."),r.a.createElement("li",null,r.a.createElement("b",null,"Termination"),": This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License."),r.a.createElement("li",null,r.a.createElement("b",null,"Reformation"),": If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable."),r.a.createElement("li",null,r.a.createElement("b",null,"COPYRIGHT NOTICE")," Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"options"),r.a.createElement("div",{className:"section"},"this will reset the entire app and cannot be undone"),r.a.createElement("div",{className:"section"},"use it at your own risk"),r.a.createElement(D,{text:"clear all data",callback:function(){return e.props.resetAll()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"data"),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"total"),r.a.createElement(h.a,{span:8,className:"statistic-value"},f.toData(t+a))),r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"data"),r.a.createElement(h.a,{span:8,className:"statistic-value"},f.toData(t))),r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"images"),r.a.createElement(h.a,{span:8,className:"statistic-value"},f.toData(a)))))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),P=a(112),A=a.n(P),z=a(63),G=a.n(z),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={open:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggleOpen",value:function(e){e.stopPropagation(),this.setState({open:!this.state.open})}},{key:"select",value:function(e){this.setState({open:!1}),this.props.select(e)}},{key:"clear",value:function(e){e.stopPropagation(),this.props.clear()}},{key:"render",value:function(){var e=this;try{if(0===this.props.options.length)return null;var t,a=this.props.disabled?"dropdown disabled":"dropdown",n=[];if(this.props.selectedID&&(t=this.props.options.find((function(t){return t.id===e.props.selectedID}))),n.push(r.a.createElement("div",{key:"selection",className:"dropdown-top",title:t?t.text:this.props.placeholder},r.a.createElement("div",{className:"item-text"},t?t.text:this.props.placeholder),r.a.createElement("img",{className:t&&this.props.clear?"clear":"arrow",alt:t&&this.props.clear?"clear":"arrow",src:t&&this.props.clear?G.a:A.a,onClick:function(a){return t&&e.props.clear?e.clear(a):null}}))),this.state.open){a+=" open";var s=this.props.options.map((function(t){return null===t.text?r.a.createElement("div",{key:t.id,className:"divider"}):r.a.createElement(L,{key:t.id,option:t,selected:t.id===e.props.selectedID,select:function(t){return e.select(t)}})}));n.push(r.a.createElement("div",{key:"options",className:"dropdown-options"},s))}return r.a.createElement("div",{className:a,onClick:function(t){return e.toggleOpen(t)}},n)}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);R.defaultProps={selectedID:null,placeholder:"select...",disabled:!1,clear:null};var L=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="dropdown-option";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),B=a(217),F=a(20),Y=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{var e="expander";return this.props.disabled&&(e+=" disabled"),r.a.createElement(B.a,{className:e,bordered:!1,expandIcon:function(e){return r.a.createElement(F.a,{type:"down-circle",rotate:e.isActive?-180:0})},expandIconPosition:"right"},r.a.createElement(B.a.Panel,{key:"one",header:r.a.createElement("div",{className:"collapse-header-text"},this.props.text)},this.props.children))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Y.defaultProps={disabled:!1};var H=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e,t){e.stopPropagation(),this.props.nudgeValue(t)}},{key:"touchEnd",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.props.nudgeValue(t)}},{key:"render",value:function(){var e=this;try{var t="info-value",a=this.props.source[this.props.name];0===a&&(t+=" dimmed"),this.props.display&&(a=this.props.display(a));var n=[],s=[],i=this.props.factors||[1];return i.forEach((function(t){n.push(r.a.createElement("div",{key:"minus"+t,className:1===t?"spin-button":"spin-button multiple",onTouchEnd:function(a){return e.touchEnd(a,-1*t)},onClick:function(a){return e.click(a,-1*t)}},1===t?r.a.createElement(F.a,{type:"minus"}):r.a.createElement("div",null,t))),s.push(r.a.createElement("div",{key:"plus"+t,className:1===t?"spin-button":"spin-button multiple",onTouchEnd:function(a){return e.touchEnd(a,1*t)},onClick:function(a){return e.click(a,1*t)}},1===t?r.a.createElement(F.a,{type:"plus"}):r.a.createElement("div",null,t)))})),n.reverse(),r.a.createElement("div",{className:this.props.disabled?"number-spin disabled":"number-spin"},r.a.createElement("div",{className:"minus"},n),r.a.createElement("div",{className:"info",style:{width:"calc(100% - "+60*i.length+"px)"}},r.a.createElement("div",{className:"info-label"},this.props.label),r.a.createElement("div",{className:t},a)),r.a.createElement("div",{className:"plus"},s))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);H.defaultProps={label:null,disabled:!1,factors:null,display:null};var W=a(216),q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).notifyAfterDelay=f.debounce((function(){return a.props.onChange(a.state.text)})),a.state={text:e.text},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onChange",value:function(e){var t=this;this.setState({text:e},(function(){return t.notifyAfterDelay()}))}},{key:"render",value:function(){var e=this;try{var t="textbox";return this.props.disabled&&(t+=" disabled"),this.props.lines>1?r.a.createElement(W.a.TextArea,{className:t,value:this.state.text,placeholder:this.props.placeholder,autoSize:{minRows:this.props.lines},onChange:function(t){return e.onChange(t.target.value)}}):r.a.createElement(W.a,{className:t,value:this.state.text,placeholder:this.props.placeholder,allowClear:!0,onChange:function(t){return e.onChange(t.target.value)}})}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);q.defaultProps={placeholder:"",lines:1,disabled:!1};var J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showAbilityScores:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggleAbilityScores",value:function(){this.setState({showAbilityScores:!this.state.showAbilityScores})}},{key:"render",value:function(){var e=this;try{return this.props.edit?r.a.createElement("div",null,r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"str",label:"strength",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.str",t)}}),r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"dex",label:"dexterity",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.dex",t)}}),r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"con",label:"constitution",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.con",t)}}),r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"int",label:"intelligence",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.int",t)}}),r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"wis",label:"wisdom",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.wis",t)}}),r.a.createElement(H,{source:this.props.combatant.abilityScores,name:"cha",label:"charisma",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.cha",t)}})):r.a.createElement("div",{className:"ability-scores",onClick:function(){return e.toggleAbilityScores()}},r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"str"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.str:f.modifier(this.props.combatant.abilityScores.str))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"dex"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.dex:f.modifier(this.props.combatant.abilityScores.dex))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"con"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.con:f.modifier(this.props.combatant.abilityScores.con))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"int"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.int:f.modifier(this.props.combatant.abilityScores.int))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"wis"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.wis:f.modifier(this.props.combatant.abilityScores.wis))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"cha"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.cha:f.modifier(this.props.combatant.abilityScores.cha))))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);J.defaultProps={edit:null,nudgeValue:null};var _=a(64),X=a.n(_),K=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getEditor",value:function(){var e=this,t=null;this.props.source.portrait&&(t=r.a.createElement("img",{className:"clear",src:G.a,onClick:function(){return e.props.clear()},alt:"clear"}));var a=X.a,n=localStorage.getItem("image-"+this.props.source.portrait);n&&(a=JSON.parse(n).data);return r.a.createElement("div",{className:"portrait editing"},r.a.createElement("div",{className:"section centered"},r.a.createElement("img",{src:a,alt:"portrait",onClick:function(){return e.props.edit()}}),t))}},{key:"getDisplay",value:function(){if(!this.props.source.portrait)return null;var e=localStorage.getItem("image-"+this.props.source.portrait);if(!e)return null;var t=JSON.parse(e);if(!t.data)return null;var a="portrait";return this.props.inline?a+=" inline":a+=" section centered",this.props.grabber&&(a+=" grabber"),r.a.createElement("div",{className:a,"data-movable-handle":this.props.grabber},r.a.createElement("img",{src:t.data,alt:"portrait"}))}},{key:"render",value:function(){try{return this.props.edit?this.getEditor():this.getDisplay()}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);K.defaultProps={inline:!1,grabber:!1,edit:null,clear:null};var U=a(36),Z=a.n(U),Q=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{var e="descriptive";return this.props.white&&(e+=" white"),r.a.createElement("div",{className:e},this.props.children)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Q.defaultProps={white:!1};var $=new Z.a.Converter,ee=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"createTraitPanel",value:function(e){var t=this;return r.a.createElement(te,{key:e.id,trait:e,mode:this.props.mode,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},copyTrait:function(e){return t.props.copyTrait(e)}})}},{key:"createSection",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e[t];if(0===n.length)return null;var s=null;if(a)switch(t){case"legendary":s=r.a.createElement(Q,{white:!0},"one legendary action can be used at the end of each other combatant's turn; spent actions are refreshed at the start of the monster's turn");break;case"lair":s=r.a.createElement(Q,{white:!0},"one lair action can be taken each round on initiative 20")}return r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"section subheading"},f.traitType(t,!0)),s,n)}},{key:"render",value:function(){var e=this;try{var t={};return E.forEach((function(a){for(var n=[],r=e.props.combatant.traits.filter((function(e){return e.type===a})),s=0;s!==r.length;++s){var i=r[s];n.push(e.createTraitPanel(i))}t[a]=n})),0===this.props.combatant.traits.length?r.a.createElement("div",null,r.a.createElement("i",null,"no traits or actions")):"combat"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction")):"combat-special"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"legendary",!0),this.createSection(t,"lair",!0)):r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction"),this.createSection(t,"legendary"),this.createSection(t,"lair"))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ee.defaultProps={mode:"view",copyTrait:null,changeValue:null};var te=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=0,a=this.props.trait.name||"unnamed "+f.traitType(this.props.trait.type,!1);if(this.props.trait.usage){var n="";this.props.trait.usage.toLowerCase().startsWith("recharge ")&&(t=1,this.props.trait.uses>0&&(n="; used"));var s=this.props.trait.usage.toLowerCase().match(/(\d+)\s*\/\s*day/);s&&(t=parseInt(s[1],10),this.props.trait.uses>0&&(n="; used "+this.props.trait.uses)),a+=" *("+this.props.trait.usage+n+")*"}"legendary"===this.props.trait.type&&(t=1,this.props.trait.uses>0&&(a+=" *(used)*"));var i="**"+a+"** "+this.props.trait.text;switch(this.props.mode){case"view":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:$.makeHtml(i)}}));case"template":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:$.makeHtml(i)}}),r.a.createElement("button",{onClick:function(){return e.props.copyTrait(e.props.trait)}},"copy"));case"combat":case"combat-special":var o="",c=null;if(t>0)this.props.trait.uses>=t?(o="strikethrough",c=r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",0)}},"recharge")):c=r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",e.props.trait.uses+1)}},"use");return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{className:o,dangerouslySetInnerHTML:{__html:$.makeHtml(i)}}),c)}}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ae=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"card"},this.props.heading,r.a.createElement("div",{className:"card-content"},this.props.children))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ae.defaultProps={heading:null};var ne=a(117),re=a.n(ne),se=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showDetails:!1,cloneName:e.monster.name+" copy"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setCloneName",value:function(e){this.setState({cloneName:e})}},{key:"toggleDetails",value:function(){this.setState({showDetails:!this.state.showDetails})}},{key:"description",value:function(){return k.getDescription(this.props.monster)}},{key:"monsterIsInWave",value:function(e){var t=this;return e.slots.some((function(e){var a=t.props.library.find((function(e){return e.monsters.includes(t.props.monster)}));return!!a&&e.monsterGroupName===a.name&&e.monsterName===t.props.monster.name}))}},{key:"getHP",value:function(){if(0===this.props.monster.hitDice)return this.props.monster.hpMax;var e=f.hitDieType(this.props.monster.size),t=f.modifierValue(this.props.monster.abilityScores.con)*this.props.monster.hitDice,a="";return t>0&&(a=" +"+t),t<0&&(a=" "+t),this.props.monster.hpMax+" ("+this.props.monster.hitDice+"d"+e+a+")"}},{key:"render",value:function(){var e=this;try{var t=[];if(-1===this.props.mode.indexOf("no-buttons")){if(-1!==this.props.mode.indexOf("view")){if(-1!==this.props.mode.indexOf("editable")){t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editMonster(e.props.monster)}},"edit monster")),t.push(r.a.createElement(Y,{key:"clone",text:"clone monster"},r.a.createElement(q,{text:this.state.cloneName,placeholder:"monster name",onChange:function(t){return e.setCloneName(t)}}),r.a.createElement("button",{onClick:function(){return e.props.cloneMonster(e.props.monster,e.state.cloneName)}},"create copy")));var a=[];this.props.library.forEach((function(t){-1===t.monsters.indexOf(e.props.monster)&&a.push({id:t.id,text:t.name})})),t.push(r.a.createElement(R,{key:"move",options:a,placeholder:"move to group...",select:function(t){return e.props.moveToGroup(e.props.monster,t)}})),t.push(r.a.createElement(D,{key:"remove",text:"delete monster",callback:function(){return e.props.removeMonster(e.props.monster)}}))}if(-1!==this.props.mode.indexOf("encounter"))if(this.props.slot){var n=[];this.props.library.forEach((function(t){t.monsters.filter((function(t){return t.challenge===e.props.monster.challenge})).filter((function(t){return t.id!==e.props.monster.id})).forEach((function(e){return n.push({id:e.id,text:e.name,group:t.name})}))})),f.sort(n,[{field:"text",dir:"asc"}]),n.length>0&&t.push(r.a.createElement(R,{key:"replace",placeholder:"replace with...",options:n,select:function(t){var a=n.find((function(e){return e.id===t}));a&&e.props.swapEncounterSlot(e.props.slot,a.group,a.text)}})),t.push(r.a.createElement("button",{key:"remove",onClick:function(){return e.props.removeEncounterSlot(e.props.slot)}},"remove from encounter"))}else{var s=!1;if(this.monsterIsInWave(this.props.encounter)||(t.push(r.a.createElement("button",{key:"add encounter",onClick:function(){return e.props.addEncounterSlot(e.props.monster,null)}},"add to encounter")),s=!0),this.props.encounter.waves.forEach((function(a){e.monsterIsInWave(a)||(t.push(r.a.createElement("button",{key:"add "+a.id,onClick:function(){return e.props.addEncounterSlot(e.props.monster,a.id)}},"add to ",a.name)),s=!0)})),!s)return r.a.createElement(ae,{heading:r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.monster.name))},r.a.createElement("div",{className:"section"},r.a.createElement("i",null,"this monster is already part of this encounter")))}-1!==this.props.mode.indexOf("candidate")&&(-1===this.props.mode.indexOf("selected")?t.push(r.a.createElement("button",{key:"select",onClick:function(){return e.props.selectMonster(e.props.monster)}},"select monster")):t.push(r.a.createElement("button",{key:"deselect",onClick:function(){return e.props.deselectMonster(e.props.monster)}},"deselect monster")))}this.props.mode.indexOf("template")}var i=null;if(-1!==this.props.mode.indexOf("view")){var o=null;this.props.slot&&(o=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement(H,{source:this.props.slot,name:"count",label:"count",nudgeValue:function(t){return e.props.nudgeValue(e.props.slot,"count",t)}})));var c=null;(this.state.showDetails||-1!==this.props.mode.indexOf("full"))&&(c=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(J,{combatant:this.props.monster})),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"ac")," ",this.props.monster.ac),r.a.createElement("div",{className:"section",style:{display:0!==this.props.monster.hpMax?"":"none"}},r.a.createElement("b",null,"hp")," ",this.getHP()),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.speed?"":"none"}},r.a.createElement("b",null,"speed")," ",this.props.monster.speed),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.savingThrows?"":"none"}},r.a.createElement("b",null,"saving throws")," ",this.props.monster.savingThrows),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.skills?"":"none"}},r.a.createElement("b",null,"skills")," ",this.props.monster.skills),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",this.props.monster.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",this.props.monster.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",this.props.monster.damage.immune),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",this.props.monster.conditionImmunities),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.senses?"":"none"}},r.a.createElement("b",null,"senses")," ",this.props.monster.senses),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.languages?"":"none"}},r.a.createElement("b",null,"languages")," ",this.props.monster.languages),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.equipment?"":"none"}},r.a.createElement("b",null,"equipment")," ",this.props.monster.equipment),r.a.createElement("div",{className:"divider"}),r.a.createElement(ee,{combatant:this.props.monster}))),i=r.a.createElement("div",{className:"stats"},r.a.createElement(K,{source:this.props.monster}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),o,c)}-1!==this.props.mode.indexOf("combat")&&(i=r.a.createElement("div",{className:"stats"},r.a.createElement(K,{source:this.props.monster}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(J,{combatant:this.props.monster})),r.a.createElement("div",{className:"section",style:{display:0!==this.props.monster.ac?"":"none"}},r.a.createElement("b",null,"ac")," ",this.props.monster.ac),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.savingThrows?"":"none"}},r.a.createElement("b",null,"saving throws")," ",this.props.monster.savingThrows),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.skills?"":"none"}},r.a.createElement("b",null,"skills")," ",this.props.monster.skills),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.speed?"":"none"}},r.a.createElement("b",null,"speed")," ",this.props.monster.speed),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.senses?"":"none"}},r.a.createElement("b",null,"senses")," ",this.props.monster.senses),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",this.props.monster.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",this.props.monster.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",this.props.monster.damage.immune),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",this.props.monster.conditionImmunities),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.languages?"":"none"}},r.a.createElement("b",null,"languages")," ",this.props.monster.languages),r.a.createElement("div",{className:"section",style:{display:""!==this.props.monster.equipment?"":"none"}},r.a.createElement("b",null,"equipment")," ",this.props.monster.equipment),r.a.createElement("div",{className:"divider"}),r.a.createElement(ee,{combatant:this.props.monster,mode:"combat",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))),-1!==this.props.mode.indexOf("template")&&(-1!==this.props.mode.indexOf("overview")&&(i=r.a.createElement("div",null,r.a.createElement(K,{source:this.props.monster}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"speed")," ",this.props.monster.speed||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"senses")," ",this.props.monster.senses||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"languages")," ",this.props.monster.languages||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"equipment")," ",this.props.monster.equipment||"-"))),-1!==this.props.mode.indexOf("abilities")&&(i=r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement(J,{combatant:this.props.monster})),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"saving throws")," ",this.props.monster.savingThrows||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"skills")," ",this.props.monster.skills||"-"))),-1!==this.props.mode.indexOf("cbt-stats")&&(i=r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"ac")," ",this.props.monster.ac),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"hp")," ",this.getHP()),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage immunity")," ",this.props.monster.damage.immune||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage resistance")," ",this.props.monster.damage.resist||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage vulnerability")," ",this.props.monster.damage.vulnerable||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"condition immunities")," ",this.props.monster.conditionImmunities||"-"))),-1!==this.props.mode.indexOf("actions")&&(i=r.a.createElement(ee,{combatant:this.props.monster,mode:"template",copyTrait:function(t){return e.props.copyTrait(t)}})));var l=null;if(-1!==this.props.mode.indexOf("combat"));else if(-1!==this.props.mode.indexOf("template"));else if(-1!==this.props.mode.indexOf("view full"));else{var u=this.state.showDetails?"image rotate":"image";l=r.a.createElement("img",{className:u,src:re.a,alt:"arrow",onClick:function(){return e.toggleDetails()}})}var m=(this.props.monster?this.props.monster.displayName:null)||this.props.monster.name||"unnamed monster";return r.a.createElement("div",{className:"card monster"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},m),l),r.a.createElement("div",{className:"card-content"},i,r.a.createElement("div",{style:{display:t.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},t))))}catch(p){return console.error(p),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);se.defaultProps={library:null,changeValue:null,nudgeValue:null,editMonster:null,removeMonster:null,cloneMonster:null,moveToGroup:null,copyTrait:null,selectMonster:null,deselectMonster:null,encounter:null,slot:null,addEncounterSlot:null,removeEncounterSlot:null,swapEncounterSlot:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,changeHP:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null,toggleTag:null,toggleCondition:null};var ie=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=["all sizes"].concat(b).map((function(e){return{id:e,text:e}})),a=["all types"].concat(y).map((function(e){return{id:e,text:e}}));return r.a.createElement(Y,{text:"showing "+O.getFilterDescription(this.props.filter)},r.a.createElement(q,{text:this.props.filter.name,placeholder:"name",onChange:function(t){return e.props.changeValue("name",t)}}),r.a.createElement(H,{source:this.props.filter,name:"challengeMin",label:"min cr",display:function(e){return f.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMin",t)}}),r.a.createElement(H,{source:this.props.filter,name:"challengeMax",label:"max cr",display:function(e){return f.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMax",t)}}),r.a.createElement(R,{options:t,placeholder:"filter by size...",selectedID:this.props.filter.size,select:function(t){return e.props.changeValue("size",t)}}),r.a.createElement(R,{options:a,placeholder:"filter by type...",selectedID:this.props.filter.category,select:function(t){return e.props.changeValue("category",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.resetFilter()}},"clear filter")))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),oe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={combatantSlots:e.combatantSlots,filter:g.createMonsterFilter()},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"changeFilterValue",value:function(e,t){var a=this.state.filter;a[e]=t,this.setState({filter:a})}},{key:"nudgeFilterValue",value:function(e,t){var a=f.nudgeChallenge(this.state.filter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({filter:g.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return O.matchMonster(e,this.state.filter)}},{key:"selectMonster",value:function(e){var t=g.createEncounterSlot();t.monsterGroupName=f.getMonsterGroup(e,this.props.library).name,t.monsterName=e.name,this.state.combatantSlots.push(t),this.state.combatantSlots.sort((function(e,t){return e.monsterName<t.monsterName?-1:e.monsterName>t.monsterName?1:0})),this.setState({combatantSlots:this.state.combatantSlots})}},{key:"deselectMonster",value:function(e){var t=f.getMonsterGroup(e,this.props.library),a=this.state.combatantSlots.find((function(a){return a.monsterGroupName===t.name&&a.monsterName===e.name}));if(a){var n=this.state.combatantSlots.indexOf(a);this.state.combatantSlots.splice(n,1),this.setState({combatantSlots:this.state.combatantSlots})}}},{key:"nudgeMonsterCount",value:function(e,t){if(e.count+=t,0===e.count){var a=this.props.library.find((function(t){return t.name===e.monsterGroupName}));if(a){var n=a.monsters.find((function(t){return t.name===e.monsterName}));n&&this.deselectMonster(n)}}else this.setState({combatantSlots:this.state.combatantSlots})}},{key:"render",value:function(){var e=this;try{var t=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){e.matchMonster(a)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var a=this.state.combatantSlots.map((function(t){var a=e.props.library.find((function(e){return e.name===t.monsterGroupName}));if(a){var n=a.monsters.find((function(e){return e.name===t.monsterName}));if(n)return n.id}return null})).filter((function(e){return!!e})),n=t.filter((function(e){return!a.includes(e.id)})).map((function(t){return r.a.createElement(se,{key:t.id,monster:t,mode:"view candidate",selectMonster:function(t){return e.selectMonster(t)}})}));0===n.length&&(n=r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"there are no monsters that match the above criteria (or you have already selected them all)")));var s=this.state.combatantSlots.map((function(t){var a=e.props.library.find((function(e){return e.name===t.monsterGroupName}));if(a){var n=a.monsters.find((function(e){return e.name===t.monsterName}));if(n)return r.a.createElement(se,{key:n.id,monster:n,slot:t,mode:"view candidate selected",deselectMonster:function(t){return e.deselectMonster(t)},nudgeValue:function(a,n,r){return e.nudgeMonsterCount(t,r)}})}return null}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"heading"},"monsters in library"),r.a.createElement(ie,{filter:this.state.filter,changeValue:function(t,a){return e.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),r.a.createElement("div",{className:"divider"}),n),r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"heading"},"selected monsters"),s))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ce=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=this.props.itemsPerRow?this.props.itemsPerRow:this.props.options.length,a=Math.ceil(this.props.options.length/t),n=[],s=0;s!==a;++s)n.push([]);this.props.options.forEach((function(a){var s=e.props.options.indexOf(a),i=Math.floor(s/t);n[i].push(r.a.createElement(le,{key:a.id,option:a,selected:a.id===e.props.selectedID,count:t,select:function(t){return e.props.select(t)}}))}));var i=n.map((function(e){var t=n.indexOf(e);return r.a.createElement("div",{key:t},e)}));return r.a.createElement("div",{className:this.props.disabled?"selector disabled":"selector"},i)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ce.defaultProps={disabled:!1,itemsPerRow:null};var le=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="option";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),r.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ue=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={selectedPartyID:e.party?e.party.id:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"selectParty",value:function(e){this.setState({selectedPartyID:e})}},{key:"render",value:function(){var e=this;try{var t,a,n=O.getMonsterCount(this.props.encounter),s=O.getEncounterXP(this.props.encounter,this.props.getMonster),i=O.getAdjustedEncounterXP(this.props.encounter,this.props.getMonster),o=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"xp for this encounter"),r.a.createElement(h.a,{span:8,className:"statistic-value"},s," xp"))),r.a.createElement("div",{className:"section",style:{display:i===s?"none":""}},r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"effective xp for ",n," monster(s)"),r.a.createElement(h.a,{span:8,className:"statistic-value"},i," xp")))),c=this.props.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(c){var l=0,u=0,m=0,p=0,v=c.pcs.filter((function(e){return e.active}));v.forEach((function(e){l+=f.pcExperience(e.level,"easy"),u+=f.pcExperience(e.level,"medium"),m+=f.pcExperience(e.level,"hard"),p+=f.pcExperience(e.level,"deadly")}));var g="trivial",b="trivial";if(i>0&&(i>=l&&(g="easy",b="easy"),i>=u&&(g="medium",b="medium"),i>=m&&(g="hard",b="hard"),i>=p&&(g="deadly",b="deadly"),p>0&&i>=10*p&&(g="tpk",b="tpk"),p>0&&i>=100*p&&(g="dm with a grudge",b="dm with a grudge"),p>0&&i>=1e3*p&&(g="now you're just being silly",b="now you're just being silly"),v.length<3||v.length>5)){var y=v.length<3;switch(g){case"trivial":b=y?"easy":"trivial";break;case"easy":b=y?"medium":"trivial";break;case"medium":b=y?"hard":"easy";break;case"hard":b=y?"deadly":"medium";break;case"deadly":b=y?"deadly":"hard";break;default:b=""}}t=r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell four easy"},r.a.createElement("b",null,"easy")),r.a.createElement("div",{className:"cell four medium"},r.a.createElement("b",null,"medium")),r.a.createElement("div",{className:"cell four hard"},r.a.createElement("b",null,"hard")),r.a.createElement("div",{className:"cell four deadly"},r.a.createElement("b",null,"deadly"))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell four"},l," xp"),r.a.createElement("div",{className:"cell four"},u," xp"),r.a.createElement("div",{className:"cell four"},m," xp"),r.a.createElement("div",{className:"cell four"},p," xp")));var E=function(e){return 100*e/Math.max(i,1.2*p)},k=function(e){return 100-E(e)};a=r.a.createElement("div",null,r.a.createElement("div",{className:"difficulty-gauge"},r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar trivial",style:{left:"0",right:k(l)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar easy",style:{left:E(l)+"%",right:k(u)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar medium",style:{left:E(u)+"%",right:k(m)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar hard",style:{left:E(m)+"%",right:k(p)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar deadly",style:{left:E(p)+"%",right:"0"}})),r.a.createElement("div",{className:"encounter-container"},r.a.createElement("div",{className:"encounter",style:{left:E(i)-.5+"%"}}))),o,r.a.createElement("div",{className:"section"},r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"difficulty for this party"),r.a.createElement(h.a,{span:8,className:"statistic-value"},g))),r.a.createElement("div",{className:"section",style:{display:b===g?"none":""}},r.a.createElement(d.a,null,r.a.createElement(h.a,{span:16},"effective difficulty for ",v.length," pc(s)"),r.a.createElement(h.a,{span:8,className:"statistic-value"},b))))}else a=o;var N=null;if(!this.props.party){var x=[];if(this.props.parties)for(var w=0;w!==this.props.parties.length;++w){var C=this.props.parties[w];x.push({id:C.id,text:C.name})}N=r.a.createElement(R,{options:x,placeholder:"select party...",selectedID:this.state.selectedPartyID?this.state.selectedPartyID:void 0,select:function(t){return e.selectParty(t)},clear:function(){return e.selectParty(null)}})}return r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"subheading"},"difficulty"),N,t,a)}catch(S){return console.error(S),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ue.defaultProps={party:null};var me=a(122),pe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{var e=this.props.combatant.hp||0,t=this.props.combatant.hpMax+this.props.combatant.hpTemp,a=this.props.combatant.hpMax/2,n=100*Math.max(e,0)/t,s="";s=e>=this.props.combatant.hpMax?"bar unhurt":e<=a?"bar bloodied":"bar injured";var i=null;if(this.props.combatant.hpTemp>0){var o=100*Math.max(this.props.combatant.hpTemp,0)/t;i=r.a.createElement("div",{className:"bar temp",style:{width:o+"%"}})}return r.a.createElement("div",{className:"hp-gauge"},r.a.createElement("div",{className:s,style:{width:n+"%"}}),i)}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),de=new Z.a.Converter;de.setOption("tables",!0);var he=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getMapDimensions",value:function(e){var t=this,a=null;if(this.props.map.items.filter((function(e){return"edit"!==t.props.mode||"tile"===e.type})).forEach((function(e){a?(a.minX=Math.min(a.minX,e.x),a.maxX=Math.max(a.maxX,e.x+e.width-1),a.minY=Math.min(a.minY,e.y),a.maxY=Math.max(a.maxY,e.y+e.height-1)):a={minX:e.x,maxX:e.x+e.width-1,minY:e.y,maxY:e.y+e.height-1}})),this.props.combatants&&this.props.combatants.filter((function(e){return e.aura.radius>0})).forEach((function(e){var n=t.props.map.items.find((function(t){return t.id===e.id}));if(n){var r=e.aura.radius/5,s=1,i=e;i&&(s=f.miniSize(i.size));var o=n.x-r,c=n.x+(s-1)+r,l=n.y-r,u=n.y+(s-1)+r;a&&(a.minX=Math.min(a.minX,o),a.maxX=Math.max(a.maxX,c),a.minY=Math.min(a.minY,l),a.maxY=Math.max(a.maxY,u))}})),!a){if("thumbnail"===this.props.mode)return null;a={minX:0,maxX:0,minY:0,maxY:0}}return a.minX-=e,a.maxX+=e,a.minY-=e,a.maxY+=e,a}},{key:"getStyle",value:function(e,t,a,n,r,s){var i=0,o=0;a<1&&(i=(1-a)/2),n<1&&(o=(1-n)/2);var c="0";switch(r){case"rounded":c=this.props.size+"px";break;case"circle":c="50%"}return{left:"calc("+this.props.size+"px * "+(e+i-s.minX)+")",top:"calc("+this.props.size+"px * "+(t+o-s.minY)+")",width:"calc(("+this.props.size+"px * "+a+") + 1px)",height:"calc(("+this.props.size+"px * "+n+") + 1px)",borderRadius:c,backgroundSize:this.props.size+"px"}}},{key:"render",value:function(){var e=this;try{var t="edit"===this.props.mode?2:0,a=this.getMapDimensions(t);if(!a)return r.a.createElement("div",{className:"section centered"},"(blank map)");var n=this.props.map.items.filter((function(e){return"tile"===e.type})).map((function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,t.style,a);return r.a.createElement(fe,{key:t.id,tile:t,note:"combat-player"!==e.props.mode?C.getNote(e.props.map,t):null,style:n,selectable:"edit"===e.props.mode,selected:e.props.selectedItemID===t.id,select:function(t){return"edit"===e.props.mode?e.props.setSelectedItemID(t):null}})})),s=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(s=this.props.map.items.filter((function(e){return"overlay"===e.type})).map((function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,t.style,a);return n.backgroundColor=t.color+t.opacity.toString(16),r.a.createElement(ge,{key:t.id,overlay:t,note:"combat-player"!==e.props.mode?C.getNote(e.props.map,t):null,style:n,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.setSelectedItemID(t)}})})));var i=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(i=this.props.combatants.filter((function(e){return e.aura.radius>0})).filter((function(t){return t.showOnMap||"combat-player"!==e.props.mode})).map((function(t){var n=e.props.map.items.find((function(e){return e.id===t.id}));if(n){var s=t.aura.radius/5,i=2*s+f.miniSize(t.displaySize),o=e.getStyle(n.x-s,n.y-s,i,i,t.aura.style,a);return o.backgroundColor=t.aura.color,r.a.createElement("div",{key:t.id+" aura",className:"aura",style:o})}return null})).filter((function(e){return null!==e})));var o=[];"edit"!==this.props.mode&&(o=this.props.map.items.filter((function(e){return"monster"===e.type||"pc"===e.type||"token"===e.type})).map((function(t){var n=f.miniSize(t.size),s=C.getNote(e.props.map,t),i=!1,o=e.props.combatants.find((function(e){return e.id===t.id}));o&&(n=f.miniSize(o.displaySize),!s&&o.note&&((s=g.createMapNote()).targetID=o.id,s.text=o.note),i="pc"===o.type);var c=e.getStyle(t.x,t.y,n,n,"circle",a);return r.a.createElement(be,{key:t.id,token:t,note:"combat-player"!==e.props.mode?s:null,combatant:o||null,style:c,simple:"thumbnail"===e.props.mode,showGauge:"combat"===e.props.mode,showHidden:"combat"===e.props.mode||i,selectable:"combat"===e.props.mode||"combat-player"===e.props.mode,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.setSelectedItemID(t)}})})).filter((function(e){return null!==e})));var c=[];if(this.props.showOverlay)for(var l=a.minY;l!==a.maxY+1;++l)for(var u=a.minX;u!==a.maxX+1;++u){var m=this.getStyle(u,l,1,1,"square",a);c.push(r.a.createElement(ve,{key:u+","+l,x:u,y:l,style:m,overlay:!0,onClick:function(t,a){return e.props.gridSquareClicked(t,a)}}))}var p="map-panel "+this.props.mode,d=1+a.maxX-a.minX,h=1+a.maxY-a.minY;return r.a.createElement("div",{className:p,onClick:function(){return e.props.setSelectedItemID(null)}},r.a.createElement("div",{className:"grid",style:{width:this.props.size*d+2+"px",height:this.props.size*h+2+"px"}},n,s,i,o,c))}catch(v){return console.error(v),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);he.defaultProps={combatants:null,showOverlay:!1,selectedItemID:null,setSelectedItemID:null,gridSquareClicked:null};var ve=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e,t){e.stopPropagation(),"single"===t&&this.props.onClick&&this.props.onClick(this.props.x,this.props.y),"double"===t&&this.props.onDoubleClick&&this.props.onDoubleClick(this.props.x,this.props.y)}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.props.overlay?"grid-square grid-overlay":"grid-square",style:this.props.style,onClick:function(t){return e.click(t,"single")},onDoubleClick:function(t){return e.click(t,"double")}})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ve.defaultProps={overlay:!1,onDoubleClick:null};var fe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.tile.id))}},{key:"getNoteText",value:function(){return this.props.note?this.props.note.text.trim():""}},{key:"render",value:function(){var e=this;try{var t="tile "+this.props.tile.terrain;this.props.selected&&(t+=" selected");var a=null;if("custom"===this.props.tile.terrain){var n=X.a,s=localStorage.getItem("image-"+this.props.tile.customBackground);if(s)n=JSON.parse(s).data;a=r.a.createElement("img",{className:"custom-image",alt:"map tile",src:n})}var i=null;if(this.props.tile.content)switch(this.props.tile.content.type){case"doorway":switch(this.props.tile.content.style){case"single":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}))}break;case"double":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("rect",{className:"thin outline",x:"10%",y:"25%",width:"80%",height:"50%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"25%",x2:"50%",y2:"75%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("rect",{className:"thin outline",x:"25%",y:"10%",width:"50%",height:"80%"}),r.a.createElement("line",{className:"thin",x1:"25%",y1:"50%",x2:"75%",y2:"50%"}))}break;case"arch":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"0",y1:"50%",x2:"20%",y2:"50%"}),r.a.createElement("line",{className:"thick",x1:"80%",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"20%",y2:"80%"}),r.a.createElement("line",{className:"medium",x1:"80%",y1:"20%",x2:"80%",y2:"80%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thick",x1:"50%",y1:"0",x2:"50%",y2:"20%"}),r.a.createElement("line",{className:"thick",x1:"50%",y1:"80%",x2:"50%",y2:"100%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"20%",x2:"80%",y2:"20%"}),r.a.createElement("line",{className:"medium",x1:"20%",y1:"80%",x2:"80%",y2:"80%"}))}break;case"bars":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"10%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"30%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"70%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"90%",cy:"50%",r:"5%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"10%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"30%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"50%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"70%",r:"5%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"90%",r:"5%"}))}}break;case"stairway":switch(this.props.tile.content.style){case"stairs":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thin",x1:"0",y1:"12.5%",x2:"100%",y2:"12.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"25%",x2:"100%",y2:"25%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"37.5%",x2:"100%",y2:"37.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"50%",x2:"100%",y2:"50%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"62.5%",x2:"100%",y2:"62.5%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"75%",x2:"100%",y2:"75%"}),r.a.createElement("line",{className:"thin",x1:"0",y1:"87.5%",x2:"100%",y2:"87.5%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("line",{className:"thin",x1:"12.5%",y1:"0",x2:"12.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"25%",y1:"0",x2:"25%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"37.5%",y1:"0",x2:"37.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"0",x2:"50%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"62.5%",y1:"0",x2:"62.5%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"75%",y1:"0",x2:"75%",y2:"100%"}),r.a.createElement("line",{className:"thin",x1:"87.5%",y1:"0",x2:"87.5%",y2:"100%"}))}break;case"spiral":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("ellipse",{className:"thin outline",cx:"50%",cy:"50%",rx:"40%",ry:"40%"}),r.a.createElement("ellipse",{className:"thin filled",cx:"50%",cy:"50%",rx:"10%",ry:"10%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"10%",x2:"50%",y2:"90%"}),r.a.createElement("line",{className:"thin",x1:"10%",y1:"50%",x2:"90%",y2:"50%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"20%",x2:"80%",y2:"80%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"80%",x2:"80%",y2:"20%"}));break;case"ladder":switch(this.props.tile.content.orientation){case"horizontal":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"20%",cy:"50%",r:"7%"}),r.a.createElement("line",{className:"thin",x1:"20%",y1:"50%",x2:"80%",y2:"50%"}),r.a.createElement("circle",{className:"thin filled",cx:"80%",cy:"50%",r:"7%"}));break;case"vertical":i=r.a.createElement("svg",{className:"tile-content"},r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"20%",r:"7%"}),r.a.createElement("line",{className:"thin",x1:"50%",y1:"20%",x2:"50%",y2:"80%"}),r.a.createElement("circle",{className:"thin filled",cx:"50%",cy:"80%",r:"7%"}))}}}var o=r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}},a,i),c=this.getNoteText();return c?r.a.createElement(me.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:de.makeHtml(c)}})},o):o}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ge=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"select",value:function(e){e.stopPropagation(),this.props.select(this.props.overlay.id)}},{key:"getNoteText",value:function(){return this.props.note?this.props.note.text.trim():""}},{key:"render",value:function(){var e=this;try{var t="overlay";this.props.selected&&(t+=" selected");var a=r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}}),n=this.getNoteText();return n?r.a.createElement(me.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:de.makeHtml(n)}})},a):a}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),be=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.token.id))}},{key:"getNoteText",value:function(){var e=this.props.combatant?"**"+this.props.combatant.displayName+"**":"";return this.props.combatant&&(this.props.combatant.showOnMap||(e+="\n\n",e+="**hidden**"),this.props.combatant.tags.forEach((function(t){e+="\n\n",e+="**"+f.getTagTitle(t)+"**",e+="\n\n",e+="* "+f.getTagDescription(t)})),this.props.combatant.conditions.forEach((function(t){e+="\n\n",e+="**"+t.name+"**",f.conditionText(t).forEach((function(t){e+="\n\n",e+="* "+t}))}))),this.props.note&&this.props.note.text&&(e+="\n\n",e+=this.props.note.text),e.trim()}},{key:"render",value:function(){var e=this;try{var t="token",a="token";this.props.selected&&(a+=" selected");var n=this.props.combatant;if(this.props.combatant&&(t=n.displayName||n.name||"combatant",a+=" "+this.props.combatant.type,this.props.combatant.current&&(a+=" current"),!this.props.combatant.showOnMap)){if(!this.props.showHidden)return null;a+=" hidden"}var s=null,i=null,o=null,c=null;if(this.props.combatant&&!this.props.simple){var l="";if(n&&n.portrait){var u=localStorage.getItem("image-"+n.portrait);if(u)l=JSON.parse(u).data}if(s=l?r.a.createElement("img",{className:"portrait",src:l,alt:t}):r.a.createElement("div",{className:"initials"},t.split(" ").map((function(e){return e[0]}))),"monster"===this.props.combatant.type&&this.props.showGauge){var m=this.props.combatant;(m.hp||0)<m.hpMax&&(i=r.a.createElement(pe,{combatant:m}))}this.props.combatant.altitude>0&&(o=r.a.createElement("div",{className:"badge"},r.a.createElement(F.a,{type:"up-square",theme:"twoTone",twoToneColor:"#3c78dc"}))),this.props.combatant.altitude<0&&(o=r.a.createElement("div",{className:"badge"},r.a.createElement(F.a,{type:"down-square",theme:"twoTone",twoToneColor:"#3c78dc"})));var p=this.props.combatant.conditions&&this.props.combatant.conditions.length>0,d=this.props.combatant.tags&&this.props.combatant.tags.length>0;(p||d)&&(c=r.a.createElement("div",{className:"conditions"},r.a.createElement(F.a,{type:"star",theme:"twoTone",twoToneColor:"#3c78dc"})))}var h=r.a.createElement("div",{className:a,style:this.props.style,onClick:function(t){return e.select(t)}},s,i,o,c),v=this.getNoteText();return v?r.a.createElement(me.a,{placement:"bottom",title:r.a.createElement("div",{dangerouslySetInnerHTML:{__html:de.makeHtml(v)}})},h):h}catch(f){return console.error(f),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ye=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={combatSetup:e.combatSetup},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setPartyID",value:function(e){var t=this,a=this.props.parties.find((function(t){return t.id===e})),n=this.state.combatSetup;n.party=a||null,this.setState({combatSetup:n},(function(){return t.props.notify()}))}},{key:"setEncounterID",value:function(e){var t=this,a=this.props.encounters.find((function(t){return t.id===e})),n=this.state.combatSetup;n.encounter=a||null,a&&(n.monsterNames=f.getMonsterNames(a)),this.setState({combatSetup:n},(function(){return t.props.notify()}))}},{key:"setMapID",value:function(e){var t=this.props.maps.find((function(t){return t.id===e})),a=this.state.combatSetup;a.map=t||null,this.setState({combatSetup:a})}},{key:"setWaveID",value:function(e){var t=this,a=this.state.combatSetup;if(a.waveID=e,a.encounter){var n=a.encounter.waves.find((function(t){return t.id===e}));n&&(a.monsterNames=f.getMonsterNames(n))}this.setState({combatSetup:a},(function(){return t.props.notify()}))}},{key:"generateEncounter",value:function(e){var t=this,a=g.createEncounter();a.name="new encounter";var n=g.createMonsterFilter(),r=0,s=0;if(this.state.combatSetup.party){var i=this.state.combatSetup.party.pcs.filter((function(e){return e.active}));i.forEach((function(t){r+=f.pcExperience(t.level,e),s+=t.level}));var o=s/i.length;n.challengeMax=Math.max(o,5)}O.buildEncounter(a,r,n,this.props.library,this.props.getMonster);var c=this.state.combatSetup;c.encounter=a,c.monsterNames=f.getMonsterNames(a),this.setState({combatSetup:c},(function(){return t.props.notify()}))}},{key:"generateMap",value:function(e){var t=this,a=g.createMap();a.name="new map",C.generate(e,a);var n=this.state.combatSetup;n.map=a,this.setState({combatSetup:n},(function(){return t.props.notify()}))}},{key:"setEncounterInitMode",value:function(e){var t=this.state.combatSetup;t.encounterInitMode=e,this.setState({combatSetup:t})}},{key:"changeName",value:function(e,t,a){var n=this.state.combatSetup.monsterNames.find((function(t){return t.id===e}));n&&(n.names[t]=a,this.setState({combatSetup:this.state.combatSetup}))}},{key:"render",value:function(){var e=this;try{var t=null,a=null;return this.props.parties?(t=r.a.createElement("div",null,r.a.createElement(Ee,{combatSetup:this.state.combatSetup,parties:this.props.parties,setPartyID:function(t){return e.setPartyID(t)}}),r.a.createElement(ke,{combatSetup:this.state.combatSetup,encounters:this.props.encounters,setEncounterID:function(t){return e.setEncounterID(t)},generateEncounter:function(t){return e.generateEncounter(t)}}),r.a.createElement(Ne,{combatSetup:this.state.combatSetup,maps:this.props.maps,setMapID:function(t){return e.setMapID(t)},generateMap:function(t){return e.generateMap(t)}})),a=r.a.createElement("div",null,r.a.createElement(we,{combatSetup:this.state.combatSetup,parties:this.props.parties,encounters:this.props.encounters,getMonster:function(t,a){return e.props.getMonster(t,a)}}),r.a.createElement(Ce,{combatSetup:this.state.combatSetup,parties:this.props.parties,setEncounterInitMode:function(t){return e.setEncounterInitMode(t)},changeName:function(t,a,n){return e.changeName(t,a,n)}}))):(t=r.a.createElement("div",null,r.a.createElement(xe,{combatSetup:this.state.combatSetup,setWaveID:function(t){return e.setWaveID(t)}})),a=r.a.createElement("div",null,r.a.createElement(Ce,{combatSetup:this.state.combatSetup,parties:this.props.parties,setEncounterInitMode:function(t){return e.setEncounterInitMode(t)},changeName:function(t,a,n){return e.changeName(t,a,n)}}))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},t),r.a.createElement(h.a,{span:12,className:"scrollable"},a))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ye.defaultProps={parties:null,library:null,encounters:null,maps:null};var Ee=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(0===this.props.parties.length)return r.a.createElement("div",{className:"section"},"you have not defined any parties");var t=this.props.parties.map((function(e){return{id:e.id,text:e.name||"unnamed party"}})),a=null;if(this.props.combatSetup.party){var n=this.props.combatSetup.party.pcs.filter((function(e){return e.active})).map((function(e){return r.a.createElement("li",{key:e.id},e.name||"unnamed pc"," (level ",e.level,")")}));0===n.length&&n.push(r.a.createElement("li",{key:"empty"},"no pcs")),a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"pcs"),r.a.createElement("ul",null,n))}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"party"),r.a.createElement(R,{options:t,placeholder:"select a party",selectedID:this.props.combatSetup.party?this.props.combatSetup.party.id:void 0,select:function(t){return e.props.setPartyID(t)},clear:function(){return e.props.setPartyID(null)}}),a)}}]),t}(r.a.Component),ke=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=null;if(this.props.combatSetup.encounter)t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.setEncounterID(null)}},"choose a different encounter"));else{var a=null;if(this.props.encounters.length>0){var n=this.props.encounters.map((function(e){return{id:e.id,text:e.name||"unnamed encounter"}}));a=r.a.createElement(R,{options:n,placeholder:"select an encounter",select:function(t){return e.props.setEncounterID(t)}})}var s=null;this.props.combatSetup.party&&(s=r.a.createElement("button",{onClick:function(){return e.props.generateEncounter("medium")}},"generate a random encounter")),t=r.a.createElement("div",null,a,s)}var i=null;if(this.props.combatSetup.encounter){var o=this.props.combatSetup.encounter.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("li",{key:e.id},t)}));0===o.length&&o.push(r.a.createElement("li",{key:"empty"},"no monsters"));var c=this.props.combatSetup.encounter.waves.map((function(e){if(0===e.slots.length)return null;var t=e.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" x"+e.count),r.a.createElement("li",{key:e.id},t)}));return r.a.createElement("div",{key:e.id},r.a.createElement("div",{className:"subheading"},e.name||"unnamed wave"),r.a.createElement("ul",null,t))}));i=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),r.a.createElement("ul",null,o),c)}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter"),t,i)}}]),t}(r.a.Component),Ne=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=null;if(this.props.combatSetup.map)t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.setMapID(null)}},"choose a different map"));else{var a=null;if(this.props.maps.length>0){var n=this.props.maps.map((function(e){return{id:e.id,text:e.name||"unnamed map"}}));a=r.a.createElement(R,{options:n,placeholder:"select a map",select:function(t){return e.props.setMapID(t)}})}t=r.a.createElement("div",null,a,r.a.createElement("button",{onClick:function(){return e.props.generateMap("delve")}},"generate a random delve"))}var s=null;return this.props.combatSetup.map&&(s=r.a.createElement(he,{map:this.props.combatSetup.map,mode:"thumbnail",size:12})),r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"map"),t,s)}}]),t}(r.a.Component),xe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(null===this.props.combatSetup.encounter)return r.a.createElement("div",{className:"section"},"you have not selected an encounter");if(0===this.props.combatSetup.encounter.waves.length)return r.a.createElement("div",{className:"section"},"you have not defined any waves");var t=this.props.combatSetup.encounter.waves.map((function(e){return{id:e.id,text:e.name||"unnamed wave"}})),a=null;if(this.props.combatSetup.waveID){var n=this.props.combatSetup.encounter.waves.find((function(t){return t.id===e.props.combatSetup.waveID}));if(n){var s=n.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("li",{key:e.id},t)}));0===s.length&&s.push(r.a.createElement("li",{key:"empty"},"no monsters")),a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),r.a.createElement("ul",null,s))}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"wave"),r.a.createElement(R,{options:t,placeholder:"select wave",selectedID:this.props.combatSetup.waveID?this.props.combatSetup.waveID:void 0,select:function(t){return e.props.setWaveID(t)},clear:function(){return e.props.setWaveID(null)}}),a)}}]),t}(r.a.Component),we=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.combatSetup.party&&this.props.combatSetup.encounter?r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement(ue,{parties:this.props.parties,party:this.props.combatSetup.party,encounter:this.props.combatSetup.encounter,getMonster:function(t,a){return e.props.getMonster(t,a)}})):r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement("div",{className:"section"},"select a party and an encounter on the left to see difficulty information."))}}]),t}(r.a.Component),Ce=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(null===this.props.combatSetup.encounter)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select an encounter to see monster options here."));if(!this.props.parties&&null===this.props.combatSetup.waveID)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select a wave to see monster options here."));if(this.props.combatSetup.encounter){var t=this.props.combatSetup.encounter;if(this.props.combatSetup.waveID){var a=this.props.combatSetup.encounter.waves.find((function(t){return t.id===e.props.combatSetup.waveID}));a&&(t=a)}if(0===t.slots.length)return null;var n=this.props.combatSetup.monsterNames.map((function(a){var n=t.slots.find((function(e){return e.id===a.id}));if(n){for(var s=[],i=0;i!==a.names.length;++i)s.push(r.a.createElement("div",{key:i},r.a.createElement(Se,{value:a.names[i],slotID:n.id,index:i,changeName:function(t,a,n){return e.props.changeName(t,a,n)}})));return r.a.createElement("div",{key:a.id,className:"name-row"},r.a.createElement("div",{className:"name-label"},n.monsterName),r.a.createElement("div",{className:"name-inputs"},s))}return null}));return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"subheading"},"initiative"),r.a.createElement(ce,{options:[{id:"manual",text:"enter manually"},{id:"individual",text:"roll individually"},{id:"group",text:"roll in groups"}],selectedID:this.props.combatSetup.encounterInitMode,select:function(t){return e.props.setEncounterInitMode(t)}}),r.a.createElement("div",{className:"subheading"},"names"),r.a.createElement("div",null,n))}return null}}]),t}(r.a.Component),Se=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement(q,{text:this.props.value,onChange:function(t){return e.props.changeName(e.props.slotID,e.props.index,t)}})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Oe=["blinded","charmed","deafened","exhaustion","frightened","grappled","incapacitated","invisible","paralyzed","petrified","poisoned","prone","restrained","stunned","unconscious"],Me=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.items.map((function(t){return r.a.createElement(je,{key:t.id,item:t,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.select(t)}})}));return r.a.createElement("div",{className:"radio-group"},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Me.defaultProps={};var je=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t="radio-item",a=null;return this.props.selected&&(t+=" selected",this.props.item.details&&(a=r.a.createElement("div",{className:"radio-item-details"},this.props.item.details))),this.props.item.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,onClick:function(){return e.props.select(e.props.item.id)}},r.a.createElement("div",{className:"radio-item-text"},this.props.item.text),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={condition:e.condition},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setCondition",value:function(e){if(this.state.condition.name!==e){var t=this.state.condition;t.name=e,t.level=1,t.text="",this.setState({condition:t})}}},{key:"setDuration",value:function(e){var t=null;switch(e){case"saves":t=g.createConditionDurationSaves();break;case"combatant":(t=g.createConditionDurationCombatant()).combatantID=this.props.combatant.id;break;case"rounds":t=g.createConditionDurationRounds()}var a=this.state.condition;a.duration=t,this.setState({condition:a})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({condition:this.state.condition})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t]+a;"level"===t&&(n=Math.max(n,1),n=Math.min(n,6)),"count"===t&&(n=Math.max(n,1)),"saveDC"===t&&(n=Math.max(n,0)),e[t]=n,this.setState({condition:this.state.condition})}},{key:"render",value:function(){var e=this;try{var t=Oe.map((function(t){var a=[],n=[];if(t===e.state.condition.name){"exhaustion"===t&&a.push(r.a.createElement(H,{key:"exhaustion-spin",source:e.props.condition,name:"level",label:"exhaustion",nudgeValue:function(t){return e.nudgeValue(e.props.condition,"level",t)}}));for(var s=f.conditionText(e.state.condition),i=0;i!==s.length;++i)n.push(r.a.createElement("li",{key:i,className:"section"},s[i]))}return{id:t,text:t,details:r.a.createElement("div",{key:t},a,r.a.createElement("ul",null,n)),disabled:!!e.props.combatant.conditionImmunities&&-1!==e.props.combatant.conditionImmunities.indexOf(t)}})),a=["str","dex","con","int","wis","cha","death"].map((function(e){return{id:e,text:e}})),n=[{id:"start",text:"start of turn"},{id:"end",text:"end of turn"}],s=this.props.combat.combatants.map((function(e){var t=e;return{id:t.id,text:t.displayName||t.name||"unnamed monster"}})),i=[{id:"none",text:"until removed (default)",details:r.a.createElement("div",{className:"section"},r.a.createElement("div",null,"the condition persists until it is manually removed"))},{id:"saves",text:"until a successful save",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of saves required"),r.a.createElement(H,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"save dc"),r.a.createElement(H,{source:this.props.condition.duration,name:"saveDC",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"saveDC",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"type of save"),r.a.createElement(ce,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.saveType:null,select:function(t){return e.changeValue(e.props.condition.duration,"saveType",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"make the save at the start or end of the turn"),r.a.createElement(ce,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"combatant",text:"until someone's next turn",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"combatant"),r.a.createElement(R,{options:s,selectedID:this.props.condition.duration&&this.props.condition.duration.combatantID||void 0,select:function(t){return e.changeValue(e.props.condition.duration,"combatantID",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"start or end of the turn"),r.a.createElement(ce,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"rounds",text:"for a number of rounds",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of rounds"),r.a.createElement(H,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})))}];return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"condition"),r.a.createElement(Me,{items:t,selectedItemID:this.state.condition.name,select:function(t){return e.setCondition(t)}})),r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"duration"),r.a.createElement(Me,{items:i,selectedItemID:this.state.condition.duration?this.state.condition.duration.type:"none",select:function(t){return e.setDuration(t)}})))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),De=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{if(0===this.props.data.length)return null;var t,a=Math.max.apply(Math,Object(o.a)(this.props.data.map((function(e){return e.value}))));if(this.props.collapse)t=this.props.data.filter((function(e){return e.value>0}));else{var n=this.props.data.find((function(e){return e.value>0}));this.props.data.reverse();var s=this.props.data.find((function(e){return e.value>0}));this.props.data.reverse();var i=n?this.props.data.indexOf(n):0,c=s?this.props.data.indexOf(s):this.props.data.length-1;t=this.props.data.slice(i,c+1)}var l=t.map((function(t){return r.a.createElement("div",{key:t.text,className:"bar-container"},r.a.createElement("div",{className:"bar",style:{width:"calc((100% - 1px) * "+t.value+" / "+a+")"}},r.a.createElement("div",{className:"label"},t.text,": ",e.props.display(t.value))))}));return r.a.createElement("div",{className:"plot"},l)}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);De.defaultProps={collapse:!1,display:function(e){return e.toString()}};var Ve=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getKillsChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"kill"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=f.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"kills"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t}))}},{key:"getDamageChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"damage"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=a.value}})),t=f.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"damage dealt"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t}))}},{key:"getMobilityChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"movement"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=f.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"mobility"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t}))}},{key:"getConditionsAddedChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"condition-add"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=f.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"conditions added"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t}))}},{key:"getConditionsRemovedChart",value:function(){var e=this,t=[];return this.props.combat.report.filter((function(e){return"condition-remove"===e.type})).forEach((function(a){var n=e.props.combat.combatants.find((function(e){return e.id===a.combatantID}));if(n&&"pc"===n.type){var r=t.find((function(e){return e.text===n.displayName}));void 0===r&&(r={text:n.displayName,value:0},t.push(r)),r.value+=1}})),t=f.sort(t,[{field:"value",dir:"desc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"conditions removed"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t}))}},{key:"getTurnLengthChart",value:function(){var e=this,t=[],a=null,n=[];return this.props.combat.report.forEach((function(r){switch(r.type){case"turn-start":a=r.timestamp;break;case"turn-end":if(null!==a){var s=e.props.combat.combatants.find((function(e){return e.id===r.combatantID}));if(s&&"pc"===s.type){var i=t.find((function(e){return e.text===s.displayName}));void 0===i&&(i={text:s.displayName,value:0},t.push(i));var o=r.timestamp-a;n.forEach((function(e){if(e.start&&e.end){var t=e.end-e.start;o-=t}})),i.value+=o}a=null,n=[]}break;case"combat-pause":n.push({start:r.timestamp,end:null});break;case"combat-resume":if(n.length>0)n[n.length-1].end=r.timestamp}})),t=f.sort(t,[{field:"value",dir:"asc"}]),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"turn length"),0===t.length?r.a.createElement("div",{className:"section"},"no data to display"):null,r.a.createElement(De,{data:t,display:function(e){var t=new Date(e);return t.getMinutes()+"m "+t.getSeconds()+"s"}}))}},{key:"render",value:function(){try{return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},this.getKillsChart(),this.getDamageChart(),this.getMobilityChart(),this.getConditionsAddedChart(),this.getConditionsRemovedChart(),this.getTurnLengthChart())}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Te=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.stopPropagation(),this.props.click(t,a)}},{key:"render",value:function(){var e=this;try{var t="radial "+(this.props.direction||"out");this.props.disabled&&(t+=" disabled");var a="out"===this.props.direction||"both"===this.props.direction||"eight"===this.props.direction,n="in"===this.props.direction||"both"===this.props.direction,s="eight"===this.props.direction;return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NW")}},r.a.createElement(F.a,{type:"arrow-up",rotate:-45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"N","out")}},r.a.createElement(F.a,{type:"arrow-up"})),r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"N","in")}},r.a.createElement(F.a,{type:"arrow-down"}))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NE")}},r.a.createElement(F.a,{type:"arrow-up",rotate:45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"W","out")}},r.a.createElement(F.a,{type:"arrow-left"})),r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"W","in")}},r.a.createElement(F.a,{type:"arrow-right"}))),r.a.createElement("div",{className:"cell"}),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"E","in")}},r.a.createElement(F.a,{type:"arrow-left"})),r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"E","out")}},r.a.createElement(F.a,{type:"arrow-right"}))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SW")}},r.a.createElement(F.a,{type:"arrow-down",rotate:45}))),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"S","in")}},r.a.createElement(F.a,{type:"arrow-up"})),r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"S","out")}},r.a.createElement(F.a,{type:"arrow-down"}))),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SE","out")}},r.a.createElement(F.a,{type:"arrow-down",rotate:-45}))))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Te.defaultProps={direction:"out",disabled:!1};var Pe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={images:a.listImages(),filter:""},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"listImages",value:function(){for(var e=[],t=0;t!==localStorage.length;++t){var a=localStorage.key(t);if(a&&a.startsWith("image-")){var n=localStorage.getItem(a);if(n){var r=JSON.parse(n);e.push({id:r.id,name:r.name,data:r.data})}}}return f.sort(e,[{field:"name",dir:"asc"}])}},{key:"setFilter",value:function(e){this.setState({filter:e})}},{key:"onFileSelected",value:function(e){var t=this;if(e.target.files){var a=new FileReader;a.onload=function(e){if(e.target){var a=e.target.result,r={id:f.guid(),name:n.name,data:a},s=JSON.stringify(r);localStorage.setItem("image-"+r.id,s),t.setState({images:t.listImages()})}};var n=e.target.files[0];a.readAsDataURL(n)}}},{key:"delete",value:function(e){localStorage.removeItem("image-"+e),this.setState({images:this.listImages()})}},{key:"render",value:function(){var e=this;try{var t=this.state.images.filter((function(t){return S.match(e.state.filter,t.name)})).map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"subheading"},t.name),r.a.createElement("img",{className:"selectable-image",src:t.data,alt:t.name,onClick:function(){return e.props.select(t.id)}}),r.a.createElement("button",{onClick:function(){return e.delete(t.id)}},"delete this image"))}));return 0===t.length&&t.push(r.a.createElement(Q,{key:"empty"},"no images")),this.state.images.length>0&&t.unshift(r.a.createElement(W.a.Search,{key:"search",placeholder:"search for an image",allowClear:!0,onChange:function(t){return e.setFilter(t.target.value)},onSearch:function(t){return e.setFilter(t)}})),r.a.createElement("div",{className:"full-height"},r.a.createElement("div",{className:"drawer-header"},r.a.createElement("div",{className:"text"},"select image")),r.a.createElement("div",{className:"drawer-content"},r.a.createElement("div",{className:"scrollable"},r.a.createElement("button",{onClick:function(){return document.getElementById("file-upload").click()}},"add a new image"),r.a.createElement("input",{type:"file",id:"file-upload",accept:"image/*",style:{display:"none"},onChange:function(t){return e.onFileSelected(t)}}),t)),r.a.createElement("div",{className:"drawer-footer"},r.a.createElement("button",{onClick:function(){return e.props.cancel()}},"cancel")))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={map:e.map,selectedTileID:null,addingTile:!1,mapSize:30,showImageSelection:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSelectedTileID",value:function(e){this.setState({selectedTileID:e})}},{key:"toggleAddingTile",value:function(){this.state.addingTile||0!==this.state.map.items.length?this.setState({addingTile:!this.state.addingTile}):this.addMapTile(0,0)}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}},{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addMapTile",value:function(e,t){var a=g.createMapItem();a.x=e,a.y=t,a.style="square",a.terrain="default",this.state.map.items.push(a),this.setState({map:this.state.map,selectedTileID:a.id,addingTile:!1})}},{key:"moveMapItem",value:function(e,t){switch(t){case"N":e.y-=1;break;case"NE":e.x+=1,e.y-=1;break;case"E":e.x+=1;break;case"SE":e.x+=1,e.y+=1;break;case"S":e.y+=1;break;case"SW":e.x-=1,e.y+=1;break;case"W":e.x-=1;break;case"NW":e.x-=1,e.y-=1}this.setState({map:this.state.map})}},{key:"bigMapItem",value:function(e,t){switch(t){case"N":e.y-=1,e.height+=1;break;case"E":e.width+=1;break;case"S":e.height+=1;break;case"W":e.x-=1,e.width+=1}this.setState({map:this.state.map})}},{key:"smallMapItem",value:function(e,t){switch(t){case"N":e.height>1&&(e.y+=1,e.height-=1);break;case"E":e.width>1&&(e.width-=1);break;case"S":e.height>1&&(e.height-=1);break;case"W":e.width>1&&(e.x+=1,e.width-=1)}this.setState({map:this.state.map})}},{key:"resizeMapItem",value:function(e,t,a){switch(a){case"in":this.smallMapItem(e,t);break;case"out":this.bigMapItem(e,t)}}},{key:"rotateMapItem",value:function(e){var t=e.width;e.width=e.height,e.height=t,e.content&&(e.content.orientation="horizontal"===e.content.orientation?"vertical":"horizontal"),this.setState({map:this.state.map})}},{key:"sendToBack",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.unshift(e),this.setState({map:this.state.map})}},{key:"bringToFront",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.state.map.items.push(e),this.setState({map:this.state.map})}},{key:"cloneMapItem",value:function(e){var t=JSON.parse(JSON.stringify(e));t.id=f.guid(),t.x+=1,t.y+=1,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})}},{key:"removeMapItem",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.setState({map:this.state.map,selectedTileID:null})}},{key:"setCustomImage",value:function(e){var t=this,a=this.state.map.items.find((function(e){return e.id===t.state.selectedTileID}));a&&this.changeValue(a,"customBackground",e)}},{key:"rotateMap",value:function(){C.rotateMap(this.state.map),this.setState({map:this.state.map})}},{key:"clearMap",value:function(){var e=this.state.map;e.items=[],this.setState({map:e,selectedTileID:null})}},{key:"generate",value:function(e){C.generate(e,this.state.map),this.setState({map:this.state.map})}},{key:"addNote",value:function(e){var t=g.createMapNote();t.targetID=e,this.state.map.notes.push(t),this.setState({map:this.state.map})}},{key:"removeNote",value:function(e){var t=this.state.map.notes.findIndex((function(t){return t.targetID===e}));this.state.map.notes.splice(t,1),this.setState({map:this.state.map})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({map:this.state.map,showImageSelection:!1})}},{key:"render",value:function(){var e=this;try{var t=null;if(this.state.selectedTileID){var a=this.state.map.items.find((function(t){return t.id===e.state.selectedTileID}));if(a){var n=C.getNote(this.state.map,a);t=r.a.createElement(ze,{tile:a,note:n,toggleImageSelection:function(){return e.toggleImageSelection()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},move:function(t,a){return e.moveMapItem(t,a)},resize:function(t,a,n){return e.resizeMapItem(t,a,n)},clone:function(t){return e.cloneMapItem(t)},remove:function(t){return e.removeMapItem(t)},rotate:function(t){return e.rotateMapItem(t)},sendToBack:function(t){return e.sendToBack(t)},bringToFront:function(t){return e.bringToFront(t)},addNote:function(t){return e.addNote(t)},removeNote:function(t){return e.removeNote(t)}})}}else t=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"map name"),r.a.createElement(q,{text:this.state.map.name,placeholder:"map name",onChange:function(t){return e.changeValue(e.state.map,"name",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement(Q,null,r.a.createElement("p",null,"to add a new tile to the map, click on the button below"),r.a.createElement("p",null,"to edit an existing tile, click on it to select it")),r.a.createElement("div",{className:"divider"}),r.a.createElement(H,{source:this.state,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(t){return e.nudgeMapSize(3*t)}}),this.state.addingTile?r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.toggleAddingTile()}},"click somewhere on the map to add your new tile, or click here to cancel")):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.toggleAddingTile()}},"add a new tile"),r.a.createElement("button",{onClick:function(){return e.generate("room")}},"add a random room"),r.a.createElement("button",{onClick:function(){return e.rotateMap()}},"rotate the map"),r.a.createElement(D,{text:"clear all tiles",callback:function(){return e.clearMap()}})));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:8,className:"scrollable"},t),r.a.createElement(h.a,{span:16,className:"scrollable both-ways"},r.a.createElement(he,{map:this.state.map,mode:"edit",size:this.state.mapSize,selectedItemID:this.state.selectedTileID?this.state.selectedTileID:void 0,showOverlay:this.state.addingTile,setSelectedItemID:function(t){return e.setSelectedTileID(t)},gridSquareClicked:function(t,a){return e.addMapTile(t,a)}})),r.a.createElement(v.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Pe,{select:function(t){return e.setCustomImage(t)},cancel:function(){return e.toggleImageSelection()}})))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ze=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={view:"position"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"getPositionSection",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement("div",{className:"section"},this.props.tile.width," sq x ",this.props.tile.height," sq"),r.a.createElement("div",{className:"section"},5*this.props.tile.width," ft x ",5*this.props.tile.height," ft"),r.a.createElement("div",{className:"subheading"},"move"),r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"eight",click:function(t){return e.props.move(e.props.tile,t)}})),r.a.createElement("div",{className:"subheading"},"resize"),r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"both",click:function(t,a){return e.props.resize(e.props.tile,t,a)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.sendToBack(e.props.tile)}},"send to back"),r.a.createElement("button",{onClick:function(){return e.props.bringToFront(e.props.tile)}},"bring to front"))}},{key:"getStyleSection",value:function(){var e=this,t=N.map((function(e){return{id:e,text:e}})),a=null;"custom"===this.props.tile.terrain&&(a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"custom image"),r.a.createElement("button",{onClick:function(){return e.props.toggleImageSelection()}},"select image"),r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.tile,"customBackground","")}},"clear image")));var n=["square","rounded","circle"].map((function(e){return{id:e,text:e}}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"terrain"),r.a.createElement(R,{options:t,placeholder:"select terrain",selectedID:this.props.tile.terrain?this.props.tile.terrain:void 0,select:function(t){return e.props.changeValue(e.props.tile,"terrain",t)}}),a,r.a.createElement("div",{className:"subheading"},"shape"),r.a.createElement(ce,{options:n,selectedID:this.props.tile.style,select:function(t){return e.props.changeValue(e.props.tile,"style",t)}}),r.a.createElement("div",{className:"subheading"},"content"),r.a.createElement(Me,{items:[{id:"none",text:"none"},{id:"doorway",text:"doorway",details:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,"style")),r.a.createElement(ce,{options:x.map((function(e){return{id:e,text:e}})),itemsPerRow:2,selectedID:this.props.tile.content?this.props.tile.content.style:null,select:function(t){return e.props.changeValue(e.props.tile.content,"style",t)}}),r.a.createElement("div",null,r.a.createElement("b",null,"orientation")),r.a.createElement(ce,{options:["horizontal","vertical"].map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:function(t){return e.props.changeValue(e.props.tile.content,"orientation",t)}}))},{id:"stairway",text:"stairway",details:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,"style")),r.a.createElement(ce,{options:w.map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.style:null,select:function(t){return e.props.changeValue(e.props.tile.content,"style",t)}}),r.a.createElement("div",null,r.a.createElement("b",null,"orientation")),r.a.createElement(ce,{options:["horizontal","vertical"].map((function(e){return{id:e,text:e}})),selectedID:this.props.tile.content?this.props.tile.content.orientation:null,select:function(t){return e.props.changeValue(e.props.tile.content,"orientation",t)}}))}],selectedItemID:this.props.tile.content?this.props.tile.content.type:"none",select:function(t){var a=null;if("none"!==t){var n="";switch(t){case"doorway":n=x[0];break;case"stairway":n=w[0]}a={type:t,orientation:"horizontal",style:n}}e.props.changeValue(e.props.tile,"content",a)}}))}},{key:"getNotesSection",value:function(){var e=this;return this.props.note?r.a.createElement("div",null,r.a.createElement(q,{text:this.props.note.text,placeholder:"details",lines:5,onChange:function(t){return e.props.changeValue(e.props.note,"text",t)}}),r.a.createElement("button",{onClick:function(){return e.props.removeNote(e.props.tile.id)}},"remove note from this tile")):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addNote(e.props.tile.id)}},"add a note to this tile"))}},{key:"render",value:function(){var e=this;try{var t=["position","style","notes"].map((function(e){return{id:e,text:e}})),a=null;switch(this.state.view){case"position":a=this.getPositionSection();break;case"style":a=this.getStyleSection();break;case"notes":a=this.getNotesSection()}return r.a.createElement("div",{className:"card map"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},"map tile")),r.a.createElement("div",{className:"card-content"},r.a.createElement(ce,{options:t,selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.rotate(e.props.tile)}},"rotate tile"),r.a.createElement("button",{onClick:function(){return e.props.clone(e.props.tile)}},"clone tile"),r.a.createElement("button",{onClick:function(){return e.props.remove(e.props.tile)}},"remove tile"))))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ge=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"initModel",value:function(t){var a=[],n=0;t.forEach((function(t){t.split(/\r?\n/).forEach((function(t){t&&(e.addLineToModel(t,a),n=Math.max(n,t.length))}))})),e.model=a,e.maxLength=n}},{key:"addLineToModel",value:function(e,t){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);for(var a=function(a){var n=e.substr(a-2,2),r=e.substr(a,1),s=t.find((function(e){return e.prev===n}));s||(s={prev:n,freq:[]},t.push(s));var i=s.freq.find((function(e){return e.char===r}));i||(i={char:r,count:0},s.freq.push(i)),i.count+=1},n=2;n!==e.length;++n)a(n)}},{key:"generate",value:function(t){for(var a=[],n=0;a.length<t&&n<100;){var r=e.extractLine();if(r&&!a.map((function(e){return e.line})).includes(r)&&r.length<=e.maxLength){var s=e.fit(r);a.push({line:r,fit:s})}else n+=1}return a}},{key:"extractLine",value:function(){for(var t=String.fromCharCode(0,1),a=function(){var a=t.substr(t.length-2,2),n=e.model.find((function(e){return e.prev===a}));if(!n)return{v:null};var r="";n.freq.forEach((function(e){r+=e.char.repeat(e.count)}));var s=Math.floor(Math.random()*r.length),i=r[s];if(i===String.fromCharCode(2))return{v:t=t.substr(2)};if(1===f.dieRoll()){["bdg","ptk","sz","aeiouy","lr","ckq","vf"].forEach((function(e){if(e.includes(i)){var t=Math.floor(Math.random()*e.length);i=e[t]}}))}t+=i};;){var n=a();if("object"===typeof n)return n.v}}},{key:"fit",value:function(t){t=String.fromCharCode(0,1)+t+String.fromCharCode(2);for(var a=[],n=function(n){var r=t.substr(n-2,2),s=t[n],i=e.model.find((function(e){return e.prev===r}));if(i){var o=i.freq.find((function(e){return e.char===s}));if(o){var c=i.freq.reduce((function(e,t){return Math.max(e,t.count)}),0),l=o.count/c;a.push(l)}else a.push(0)}},r=2;r!==t.length;++r)n(r);return a.reduce((function(e,t){return e+t}),0)/a.length}},{key:"generateNames",value:function(e){for(var t=[],a=["As Has Khe Zash Gl Ig Iv Kos Miv Pav Ser Dar Even Gor Rand Sto Tam Barer Keth Mum","Mar Burg Al Hel Wrayt S Eag Eath Joan Answ L Ot Ced At Tal Ham Jasm Mail Yash Row","Adr Alber Ba Bar Gar Kildr Kath Dies Eld Gurd Har Morg Or Rur Mar Vis Jen Torg Tak Thor End Ris Em Gunn","Ad All Aram Berri Car Enial Gann Im Per Sorvi Var Adr An Beth Bir Jelen Key Lesh Mer Mia Naiv Quel Sar Shan","Al An C Cor Eld Er Finn Gar Lin Mer Os Per Ros An Cal Cor Kith Lav Ned Pae Seraph T V Chen","Are Bala Bhar Don Gh Hesk Med Meh Nad Pand Patr Sham Shed Ak Bir Farid Fla Ka Ko Mish Thav Uad Eder Hener","Alu Stos Fa Ravay Leo Stok Vic El Yeng Car Ric Ar Guir Es My Pey"].join(" ").toLowerCase().split(" "),n=["Eir Eid Eed El Ar An Or Ef Al Vin Orn Dur Stag Elm Ur Us","Ik Ich Ern End Tor Nor In Rak Gen Sik Gran Linn Vok Brek Dal Gar","An Ar Il Rian Ric Is Dan Arai Meral Cian En Rion Ialis Ior Nan Kas","Ton Der Ade Rin Don Rich Nan Ret Al Born Coe By Fire Yas Dal Yle","Han Asar Ash Aar Esch An Rash En Arr Jed Rin Gar Ash Dinn Hun Rek","Orel Aadi Ahn Aver Eiros Kain Retor Lannan Pet Ikos","Er Ey A E Il Elia Ya Ed Eue Ild Oane Yne Orna Ie Ala Erri Ea Ia","Ber Tin Hild Dryn A Eth Runn Ellen Loda Dis Ja Lin Ra Tyrd De Rasa","Rie Aea Striana Inua Rynna Ilia Na Neth Leth Iel Lee Qui Astra Ia Ania Ynn","Dry Ree Lie Ora Emia Ian Ri Inia Ina Aena Ani Erna Lyse La Da Aela","Ra Ir Eh Ann Ilar Rinn Ann La Ra A Ina Va Hit Ederei Ere Eila","Ina Ceryn Vyn Ella Aella Vyre"].join(" ").toLowerCase().split(" ");t.length<e;){var r=Math.floor(Math.random()*a.length),s=Math.floor(Math.random()*n.length),i="";if(1===f.dieRoll(10)){var o=["-","'"];i=o[Math.floor(Math.random()*o.length)]}var c=a[r]+i+n[s];t.includes(c)||t.push(c)}return t.sort(),t}}]),e}();Ge.model=[],Ge.maxLength=0;var Re=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.options.map((function(t){return r.a.createElement(Le,{key:t.id,option:t,selected:t.id===e.props.selectedID,count:e.props.options.length,select:function(t){return e.props.select(t)}})}));return r.a.createElement("div",{className:this.props.disabled?"tabs disabled":"tabs"},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Re.defaultProps={disabled:!1};var Le=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="tab";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),r.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Be=a(54),Fe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={selectedTraitID:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSelectedTraitID",value:function(e){this.setState({selectedTraitID:e})}},{key:"createTraitBar",value:function(e){var t=this;return r.a.createElement(Ye,{key:e.id,trait:e,isSelected:e.id===this.state.selectedTraitID,select:function(e){return t.setSelectedTraitID(e)}})}},{key:"createSection",value:function(e,t){var a=this,n=e[t];return 0===n.length?null:r.a.createElement("div",null,r.a.createElement("div",{className:"section heading"},f.traitType(t,!0)),r.a.createElement(Be.List,{values:n,lockVertically:!0,onChange:function(e){var t=e.oldIndex,n=e.newIndex;return a.props.moveTrait(t,n)},renderList:function(e){var t=e.children,a=e.props;return r.a.createElement("div",a,t)},renderItem:function(e){var t=e.value,n=e.props,s=e.isDragged;return r.a.createElement("div",Object.assign({},n,{className:s?"dragged":""}),a.createTraitBar(t))}}))}},{key:"render",value:function(){var e=this;try{var t=[],a={};E.forEach((function(n){t.push({id:n,text:f.traitType(n,!1)}),a[n]=e.props.combatant.traits.filter((function(e){return e.type===n}))}));var n=this.props.combatant.traits.find((function(t){return t.id===e.state.selectedTraitID})),s=null;return s=n?r.a.createElement(He,{trait:n,removeTrait:function(t){return e.props.removeTrait(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}):r.a.createElement(Q,null,"select one of the traits or actions from the column to the left to edit its details here"),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement(R,{options:t,placeholder:"add a new...",select:function(t){return e.props.addTrait(t)}}),this.createSection(a,"trait"),this.createSection(a,"action"),this.createSection(a,"bonus"),this.createSection(a,"reaction"),this.createSection(a,"legendary"),this.createSection(a,"lair")),r.a.createElement(h.a,{span:12},s))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Fe.defaultProps={addTrait:null,copyTrait:null,removeTrait:null,changeValue:null,swapTraits:null};var Ye=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.props.isSelected?"trait-bar selected":"trait-bar",onClick:function(){return e.props.select(e.props.trait.id)}},r.a.createElement(F.a,{type:"menu",className:"grabber small","data-movable-handle":!0}),r.a.createElement("div",{className:"name"},this.props.trait.name||"unnamed "+f.traitType(this.props.trait.type,!1)))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),He=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"trait name"),r.a.createElement(q,{text:this.props.trait.name,onChange:function(t){return e.props.changeValue(e.props.trait,"name",t)}}),r.a.createElement("div",{className:"subheading"},"usage"),r.a.createElement(q,{text:this.props.trait.usage,onChange:function(t){return e.props.changeValue(e.props.trait,"usage",t)}}),r.a.createElement("div",{className:"subheading"},"details"),r.a.createElement(q,{text:this.props.trait.text,placeholder:"details",lines:5,onChange:function(t){return e.props.changeValue(e.props.trait,"text",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.removeTrait(e.props.trait)}},"remove this trait"))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),We=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={monster:e.monster,page:"overview",showFilter:!1,helpSection:"speed",sidebar:"similar",similarFilter:{size:!0,type:!0,subtype:!1,alignment:!1,challenge:!0},scratchpadFilter:g.createMonsterFilter(),scratchpadList:[],showImageSelection:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setPage",value:function(e){var t=this.getHelpOptionsForPage(e);this.setState({page:e,helpSection:t[0]})}},{key:"setHelpSection",value:function(e){this.setState({helpSection:e})}},{key:"toggleMatch",value:function(e){var t=this.state.similarFilter;t[e]=!t[e],this.setState({similarFilter:t})}},{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addToScratchpadList",value:function(e){var t=this.state.scratchpadList;t.push(e),f.sort(t),this.setState({scratchpadList:t})}},{key:"removeFromScratchpadList",value:function(e){var t=this.state.scratchpadList.indexOf(e);this.state.scratchpadList.splice(t,1),this.setState({scratchpadList:this.state.scratchpadList})}},{key:"getHelpOptionsForPage",value:function(e){switch(e){case"overview":return["speed","senses","languages","equipment"];case"abilities":return["str","dex","con","int","wis","cha","saves","skills"];case"cbt-stats":return["armor class","hit dice","resist","vulnerable","immune","conditions"];case"actions":return["actions"];default:return[]}}},{key:"getMonsters",value:function(){var e=this,t=[];return this.props.library.forEach((function(a){a.monsters.forEach((function(a){var n=!0;e.state.monster.id===a.id&&(n=!1),e.state.similarFilter.size&&e.state.monster.size!==a.size&&(n=!1),e.state.similarFilter.type&&e.state.monster.category!==a.category&&(n=!1),e.state.similarFilter.subtype&&e.state.monster.tag!==a.tag&&(n=!1),e.state.similarFilter.alignment&&e.state.monster.alignment!==a.alignment&&(n=!1),e.state.similarFilter.challenge&&e.state.monster.challenge!==a.challenge&&(n=!1),n&&t.push(a)}))})),t}},{key:"setRandomValue",value:function(e,t){k.setRandomValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"randomName",value:function(){var e=Ge.generateNames(1)[0];e=e[0].toUpperCase()+e.substr(1),this.changeValue("name",e)}},{key:"spliceMonsters",value:function(e){k.spliceMonsters(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addTrait",value:function(e){k.addTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addRandomTrait",value:function(e,t){k.addRandomTrait(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"moveTrait",value:function(e,t){k.moveTrait(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"removeTrait",value:function(e){k.removeTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"copyTrait",value:function(e){k.copyTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"changeTrait",value:function(e,t,a){e[t]=a,this.setState({monster:this.state.monster})}},{key:"nudgeValue",value:function(e,t){k.nudgeValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"changeValue",value:function(e,t){k.changeValue(this.state.monster,e,t),this.setState({monster:this.state.monster,showImageSelection:!1})}},{key:"changeFilterValue",value:function(e,t){var a=this.state.scratchpadFilter;a[e]=t,this.setState({scratchpadFilter:a})}},{key:"nudgeFilterValue",value:function(e,t){var a=f.nudgeChallenge(this.state.scratchpadFilter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({scratchpadFilter:g.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return O.matchMonster(e,this.state.scratchpadFilter)}},{key:"getHelpSection",value:function(e){switch(this.state.helpSection){case"speed":return this.getValueSection("speed","text",e);case"senses":return this.getValueSection("senses","text",e);case"languages":return this.getValueSection("languages","text",e);case"equipment":return this.getValueSection("equipment","text",e);case"str":return this.getValueSection("abilityScores.str","number",e);case"dex":return this.getValueSection("abilityScores.dex","number",e);case"con":return this.getValueSection("abilityScores.con","number",e);case"int":return this.getValueSection("abilityScores.int","number",e);case"wis":return this.getValueSection("abilityScores.wis","number",e);case"cha":return this.getValueSection("abilityScores.cha","number",e);case"saves":return this.getValueSection("savingThrows","text",e);case"skills":return this.getValueSection("skills","text",e);case"armor class":return this.getValueSection("ac","number",e);case"hit dice":return this.getValueSection("hitDice","number",e);case"resist":return this.getValueSection("damage.resist","text",e);case"vulnerable":return this.getValueSection("damage.vulnerable","text",e);case"immune":return this.getValueSection("damage.immune","text",e);case"conditions":return this.getValueSection("conditionImmunities","text",e);case"actions":return this.getActionsSection(e);default:return null}}},{key:"getValueSection",value:function(e,t,a){var n=this,s=a.map((function(a){var n=e.split("."),r=a,s=null;return n.forEach((function(e){e===n[n.length-1]?s=r[e]:r=r[e]})),"text"===t&&""===s&&(s=null),s})).filter((function(e){return null!==e})),i=[];if("number"===t){var o=null,c=null;if(s.forEach((function(e){(null===o||e<o)&&(o=e),(null===c||e>c)&&(c=e)})),null!==o&&null!==c)for(var l=o;l<=c;++l)i.push({value:l,count:0})}switch(s.forEach((function(e){var t=i.find((function(t){return t.value===e}));t?t.count+=1:i.push({value:e,count:1})})),t){case"number":f.sort(i,[{field:"value",dir:"asc"}]);break;case"text":f.sort(i,[{field:"count",dir:"desc"},{field:"value",dir:"asc"}])}"text"===t&&(0!==a.length-s.length&&i.push({value:"",count:a.length-s.length}));var u=i.map((function(t){var s=100*t.count/a.length;return r.a.createElement(d.a,{gutter:10,className:"value-list",key:i.indexOf(t)},r.a.createElement(h.a,{span:8,className:"text-container"},t.value||"(none specified)"),r.a.createElement(h.a,{span:8,className:"bar-container"},r.a.createElement("div",{className:"bar",style:{width:s+"%"}})),r.a.createElement(h.a,{span:8},r.a.createElement("button",{onClick:function(){return n.changeValue(e,t.value)}},"use this value")))}));return r.a.createElement("div",null,u,r.a.createElement("button",{onClick:function(){return n.setRandomValue(e,a)}},"select random value"))}},{key:"getActionsSection",value:function(e){var t=this,a=[];return a.push(r.a.createElement(d.a,{gutter:10,className:"value-list",key:"header"},r.a.createElement(h.a,{span:8,className:"text-container"},r.a.createElement("b",null,"type")),r.a.createElement(h.a,{span:4,className:"text-container number"},r.a.createElement("b",null,"avg")),r.a.createElement(h.a,{span:4,className:"text-container number"},r.a.createElement("b",null,"min - max")))),E.forEach((function(n){var s=null,i=null,o=0;e.forEach((function(e){var t=e.traits.filter((function(e){return e.type===n})).length;(null===s||t<s)&&(s=t),(null===i||t>i)&&(i=t),o+=t}));var c=Math.round(o/e.length);a.push(r.a.createElement(d.a,{gutter:10,className:"value-list",key:n},r.a.createElement(h.a,{span:8,className:0===o?"text-container disabled":"text-container"},f.traitType(n,!0)),r.a.createElement(h.a,{span:4,className:0===o?"text-container number disabled":"text-container number"},c),r.a.createElement(h.a,{span:4,className:0===o?"text-container number disabled":"text-container number"},s," - ",i),r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:0===o?"disabled":"",onClick:function(){return t.addRandomTrait(n,e)}},"add random"))))})),r.a.createElement("div",null,a)}},{key:"getMonsterCards",value:function(e){var t=this,a=f.sort(e).map((function(e){return r.a.createElement("div",{className:"section",key:e.id},r.a.createElement(se,{monster:e,mode:"template "+t.state.page,copyTrait:function(e){return t.copyTrait(e)}}))})).filter((function(e){return!!e}));if(0===a.length){var n="";switch(this.state.sidebar){case"similar":n="there are no monsters in your library which match the above criteria";break;case"scratchpad":n="your scratchpad list is empty; you can add monsters to it to see their stats here"}return r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},n),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"when there are monsters shown in this sidebar, you will see their combined stats on the left"),r.a.createElement("div",{className:"section"},"you can also quickly blend together all the monters in this list to create a new monster by clicking the ",r.a.createElement("b",null,"generate hybrid monster")," button above"))}return a}},{key:"render",value:function(){var e=this;try{var t=[];if(this.props.showSidebar)switch(this.state.sidebar){case"similar":t=this.getMonsters();break;case"scratchpad":t=this.state.scratchpadList}var a=null;switch(this.state.page){case"overview":var n=y.map((function(e){return{id:e,text:e}}));a=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"name"),r.a.createElement(q,{text:this.state.monster.name,onChange:function(t){return e.changeValue("name",t)}}),r.a.createElement("button",{onClick:function(){return e.randomName()}},"generate a random name"),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(H,{source:this.state.monster,name:"size",nudgeValue:function(t){return e.nudgeValue("size",t)}}),r.a.createElement("div",{className:"subheading"},"type"),r.a.createElement(R,{options:n,selectedID:this.state.monster.category,select:function(t){return e.changeValue("category",t)}}),r.a.createElement("div",{className:"subheading"},"subtype"),r.a.createElement(q,{text:this.state.monster.tag,onChange:function(t){return e.changeValue("tag",t)}}),r.a.createElement("div",{className:"subheading"},"alignment"),r.a.createElement(q,{text:this.state.monster.alignment,onChange:function(t){return e.changeValue("alignment",t)}}),r.a.createElement("div",{className:"subheading"},"challenge rating"),r.a.createElement(H,{source:this.state.monster,name:"challenge",display:function(e){return f.challenge(e)},nudgeValue:function(t){return e.nudgeValue("challenge",t)}})),r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"speed"),r.a.createElement(q,{text:this.state.monster.speed,onChange:function(t){return e.changeValue("speed",t)}}),r.a.createElement("div",{className:"subheading"},"senses"),r.a.createElement(q,{text:this.state.monster.senses,onChange:function(t){return e.changeValue("senses",t)}}),r.a.createElement("div",{className:"subheading"},"languages"),r.a.createElement(q,{text:this.state.monster.languages,onChange:function(t){return e.changeValue("languages",t)}}),r.a.createElement("div",{className:"subheading"},"equipment"),r.a.createElement(q,{text:this.state.monster.equipment,onChange:function(t){return e.changeValue("equipment",t)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(K,{source:this.state.monster,edit:function(){return e.toggleImageSelection()},clear:function(){return e.changeValue("portrait","")}})));break;case"abilities":a=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"ability scores"),r.a.createElement(J,{edit:!0,combatant:this.state.monster,nudgeValue:function(t,a,n){return e.nudgeValue(a,n)}})),r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"saving throws"),r.a.createElement(q,{text:this.state.monster.savingThrows,onChange:function(t){return e.changeValue("savingThrows",t)}}),r.a.createElement("div",{className:"subheading"},"skills"),r.a.createElement(q,{text:this.state.monster.skills,onChange:function(t){return e.changeValue("skills",t)}})));break;case"cbt-stats":a=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"armor class"),r.a.createElement(H,{source:this.state.monster,name:"ac",nudgeValue:function(t){return e.nudgeValue("ac",t)}}),r.a.createElement("div",{className:"subheading"},"hit dice"),r.a.createElement(H,{source:this.state.monster,name:"hitDice",display:function(t){return t+"d"+f.hitDieType(e.state.monster.size)},nudgeValue:function(t){return e.nudgeValue("hitDice",t)}}),r.a.createElement("div",{className:"subheading"},"hit points"),r.a.createElement("div",{className:"hp-value"},this.state.monster.hpMax," hp")),r.a.createElement(h.a,{span:12},r.a.createElement("div",{className:"subheading"},"damage resistances"),r.a.createElement(q,{text:this.state.monster.damage.resist,onChange:function(t){return e.changeValue("damage.resist",t)}}),r.a.createElement("div",{className:"subheading"},"damage vulnerabilities"),r.a.createElement(q,{text:this.state.monster.damage.vulnerable,onChange:function(t){return e.changeValue("damage.vulnerable",t)}}),r.a.createElement("div",{className:"subheading"},"damage immunities"),r.a.createElement(q,{text:this.state.monster.damage.immune,onChange:function(t){return e.changeValue("damage.immune",t)}}),r.a.createElement("div",{className:"subheading"},"condition immunities"),r.a.createElement(q,{text:this.state.monster.conditionImmunities,onChange:function(t){return e.changeValue("conditionImmunities",t)}})));break;case"actions":a=r.a.createElement(Fe,{combatant:this.state.monster,addTrait:function(t){return e.addTrait(t)},moveTrait:function(t,a){return e.moveTrait(t,a)},removeTrait:function(t){return e.removeTrait(t)},changeValue:function(t,a,n){return e.changeTrait(t,a,n)}})}var s=null;if(this.props.showSidebar&&t.length>1){var i=null;if(this.getHelpOptionsForPage(this.state.page).length>1){var o=this.getHelpOptionsForPage(this.state.page).map((function(e){return{id:e,text:e}}));i=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"fields"),r.a.createElement(ce,{options:o,selectedID:this.state.helpSection,select:function(t){return e.setHelpSection(t)}}),r.a.createElement("div",{className:"subheading"},"values"))}s=r.a.createElement("div",{className:"monster-help group-panel"},r.a.createElement("div",{className:"heading"},"information from sidebar monsters"),i,this.getHelpSection(t))}var c=null;if(this.props.showSidebar){var l=null;switch(this.state.sidebar){case"similar":l=r.a.createElement(Y,{text:"similarity criteria"},r.a.createElement(M,{label:"size "+this.state.monster.size,checked:this.state.similarFilter.size,changeValue:function(t){return e.toggleMatch("size")}}),r.a.createElement(M,{label:"type "+this.state.monster.category,checked:this.state.similarFilter.type,changeValue:function(t){return e.toggleMatch("type")}}),r.a.createElement(M,{label:this.state.monster.tag?"subtype "+this.state.monster.tag:"subtype",checked:this.state.similarFilter.subtype,disabled:!this.state.monster.tag,changeValue:function(t){return e.toggleMatch("subtype")}}),r.a.createElement(M,{label:this.state.monster.alignment?"alignment "+this.state.monster.alignment:"alignment",checked:this.state.similarFilter.alignment,disabled:!this.state.monster.alignment,changeValue:function(t){return e.toggleMatch("alignment")}}),r.a.createElement(M,{label:"challenge rating "+f.challenge(this.state.monster.challenge),checked:this.state.similarFilter.challenge,changeValue:function(t){return e.toggleMatch("challenge")}}));break;case"scratchpad":var u=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){!t.includes(a)&&e.matchMonster(a)&&u.push(a)}))})),f.sort(u);var m=u.map((function(t){return r.a.createElement("button",{key:t.id,onClick:function(){return e.addToScratchpadList(t)}},t.name)}));0===u.length&&(m=[r.a.createElement(Q,{key:"none"},"no monsters found")]);var p=null;if(t.length>0){var g=t.map((function(t){return r.a.createElement("button",{key:t.id,onClick:function(){return e.removeFromScratchpadList(t)}},t.name)}));p=r.a.createElement(Y,{text:"remove monsters from the list"},g)}l=r.a.createElement("div",null,r.a.createElement(Y,{text:"add monsters to the list"},r.a.createElement(ie,{filter:this.state.scratchpadFilter,changeValue:function(t,a){return e.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),r.a.createElement("div",{className:"divider"}),m),p)}c=r.a.createElement(h.a,{span:8,className:"scrollable sidebar right"},r.a.createElement(Re,{options:[{id:"similar",text:"similar"},{id:"scratchpad",text:"scratchpad"}],selectedID:this.state.sidebar,select:function(t){return e.setState({sidebar:t})}}),l,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{className:t.length<2?"disabled":"",onClick:function(){return e.spliceMonsters(t)}},"generate hybrid monster"),r.a.createElement("div",{className:"divider"}),this.getMonsterCards(t))}else c=r.a.createElement(h.a,{span:8,className:"scrollable sidebar right",style:{padding:"5px"}},r.a.createElement(se,{monster:this.state.monster,mode:"view full"}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:16,className:"scrollable"},r.a.createElement(Re,{options:[{id:"overview",text:"overview"},{id:"abilities",text:"abilities"},{id:"cbt-stats",text:"combat"},{id:"actions",text:"actions"}],selectedID:this.state.page,select:function(t){return e.setPage(t)}}),a,s),c,r.a.createElement(v.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Pe,{select:function(t){return e.changeValue("portrait",t)},cancel:function(){return e.toggleImageSelection()}})))}catch(b){return console.error(b),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),qe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:"",monster:e.monster},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){k.import(this.state.source,this.state.monster),this.setState({monster:this.state.monster})}},{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement(Q,null,r.a.createElement("div",null,"go to the following link to find the monster you want to import"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.dndbeyond.com/monsters",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/monsters")),r.a.createElement("div",null,"then right-click on the page and select ",r.a.createElement("b",null,"view page source")),r.a.createElement("div",null,"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(q,{text:this.state.source,placeholder:"paste page source here",lines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(h.a,{span:12,className:"scrollable",style:{padding:"5px"}},r.a.createElement(se,{monster:this.state.monster,mode:"view full"})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Je=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement(se,{monster:this.props.monster,mode:"view full"}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),_e=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"importParty",value:function(t,a){a.name="",a.pcs=[];var n=(new DOMParser).parseFromString(t,"text/html");try{a.name=n.getElementsByClassName("page-title")[0].innerText.trim()}catch(u){console.error(u)}try{for(var r=n.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-active")[0].getElementsByClassName("ddb-campaigns-character-card"),s=0;s!==r.length;++s){var i=r[s];a.pcs.push(e.getCharacter(i,!0))}}catch(u){console.error(u)}try{for(var o=n.getElementsByClassName("ddb-campaigns-detail-body-listing ddb-campaigns-detail-body-listing-inactive")[0].getElementsByClassName("ddb-campaigns-character-card"),c=0;c!==o.length;++c){var l=o[c];a.pcs.push(e.getCharacter(l,!1))}}catch(u){console.error(u)}}},{key:"getCharacter",value:function(e,t){var a=g.createPC();a.name=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-primary")[0].innerText.trim(),a.player=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[1].innerText.trim().substring(8),a.active=t;var n=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-character-info-secondary")[0].innerText.trim().split("|");a.level=Number.parseInt(n[0].substring(4).trim(),10),a.race=n[1].trim(),a.classes=n[2].trim();var r=e.getElementsByClassName("ddb-campaigns-character-card-header-upper-details-link")[0];return a.url="https://www.dndbeyond.com"+r.getAttribute("href"),a}},{key:"importPC",value:function(e,t){try{var a=JSON.parse(e);t.name=a.character.name,t.size=a.character.race.size,t.race=a.character.race.fullName;var n=0,r="";a.character.classes.forEach((function(e){n+=e.level,""!==r&&(r+=" / "),r+=e.definition.name,e.subclassDefinition&&(r+=" ("+e.subclassDefinition.name+")")})),t.classes=r,t.level=n;var s=[].concat(a.character.modifiers.race).concat(a.character.modifiers.class).concat(a.character.modifiers.background).concat(a.character.modifiers.item).concat(a.character.modifiers.feat).concat(a.character.modifiers.condition),i=s.filter((function(e){return"language"===e.type})).map((function(e){return e.friendlySubtypeName}));t.languages=i.join(", ");var o=f.proficiency(n),c=a.character.stats[3].value,l=a.character.stats[4].value;s.filter((function(e){return"bonus"===e.type&&"intelligence-score"===e.subType})).forEach((function(e){return c+=e.value})),s.filter((function(e){return"bonus"===e.type&&"wisdom-score"===e.subType})).forEach((function(e){return l+=e.value}));var u=0,m=0,p=0,d=s.filter((function(e){return"insight"===e.subType||"wisdom-ability-checks"===e.subType})).map((function(e){return e.type}));d.includes("expertise")?u=2:d.includes("proficiency")?u=1:d.includes("half-proficiency-round-up")&&(u=.5);var h=s.filter((function(e){return"investigation"===e.subType||"intelligence-ability-checks"===e.subType})).map((function(e){return e.type}));h.includes("expertise")?m=2:h.includes("proficiency")?m=1:d.includes("half-proficiency-round-up")&&(m=.5);var v=s.filter((function(e){return"perception"===e.subType||"wisdom-ability-checks"===e.subType})).map((function(e){return e.type}));v.includes("expertise")?p=2:v.includes("proficiency")?p=1:d.includes("half-proficiency-round-up")&&(p=.5),t.passiveInsight=10+f.modifierValue(l)+Math.floor(o*u),t.passiveInvestigation=10+f.modifierValue(c)+Math.floor(o*m),t.passivePerception=10+f.modifierValue(l)+Math.floor(o*p),t.companions=[],a.character.creatures.forEach((function(e){var a=g.createCompanion();a.name=e.name,t.companions.push(a)}))}catch(b){console.error(b)}}}]),e}(),Xe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];-1!==this.props.mode.indexOf("edit")&&(t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editPC(e.props.pc)}},"edit pc")),this.props.pc.url&&t.push(r.a.createElement("button",{key:"import",onClick:function(){return e.props.importPC(e.props.pc)}},"update from d&d beyond")),this.props.pc.active?t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.pc,"active",!1)}},"mark pc as inactive")):t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.pc,"active",!0)}},"mark pc as active")),t.push(r.a.createElement(D,{key:"remove",text:"delete pc",callback:function(){return e.props.removePC(e.props.pc)}})));var a=(this.props.pc.race||"unknown race")+" "+(this.props.pc.classes||"unknown class")+", level "+this.props.pc.level,n=null;this.props.pc.companions.length>0&&(n=this.props.pc.companions.map((function(e){return r.a.createElement("div",{key:e.id},e.name)})));var s=(this.props.pc?this.props.pc.displayName:null)||this.props.pc.name||"unnamed pc";return r.a.createElement("div",{className:"card pc"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},s)),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"stats"},r.a.createElement(K,{source:this.props.pc}),r.a.createElement("div",{className:"section centered lowercase"},r.a.createElement("i",null,a),r.a.createElement("div",{style:{display:this.props.pc.url?"":"none"}},r.a.createElement("a",{href:this.props.pc.url,target:"_blank",rel:"noopener noreferrer"},"d&d beyond sheet"))),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section subheading"},"languages"),r.a.createElement("div",{className:"section"},this.props.pc.languages||"-"),r.a.createElement("div",{className:"section subheading"},"passive skills"),r.a.createElement("div",{className:"section"},r.a.createElement("div",null,r.a.createElement("b",null,"insight")," ",this.props.pc.passiveInsight),r.a.createElement("div",null,r.a.createElement("b",null,"investigation")," ",this.props.pc.passiveInvestigation),r.a.createElement("div",null,r.a.createElement("b",null,"perception")," ",this.props.pc.passivePerception))),r.a.createElement("div",{style:{display:this.props.pc.companions.length>0?"":"none"}},r.a.createElement("div",{className:"section subheading"},"companions"),r.a.createElement("div",{className:"section"},n)),r.a.createElement("div",{style:{display:t.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},t))))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Xe.defaultProps={changeValue:null,nudgeValue:null,removePC:null,editPC:null,importPC:null};var Ke=a(120),Ue=a.n(Ke),Ze=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showContent:!0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggleContentVisible",value:function(){this.setState({showContent:!this.state.showContent})}},{key:"render",value:function(){var e=this;try{var t=this.props.content.filter((function(e){return!!e}));if(0===t.length)return null;var a=null;if(this.props.heading){var n=null;if(this.props.showToggle){var s=this.state.showContent?"image rotate":"image";n=r.a.createElement("img",{className:s,src:Ue.a,alt:"arrow",onClick:function(){return e.toggleContentVisible()}})}a=r.a.createElement("div",{className:"heading fixed-top"},r.a.createElement("div",{className:"title"},this.props.heading),n)}var i=null;if(this.state.showContent){var o={xs:24,sm:24,md:12,lg:8,xl:6};switch(this.props.columns){case 1:o={xs:24,sm:24,md:24,lg:24,xl:24};break;case 2:o={xs:24,sm:24,md:12,lg:12,xl:12}}i=r.a.createElement(d.a,{type:"flex",align:"top"},t.map((function(e){return r.a.createElement(h.a,{key:t.indexOf(e),xs:o.xs,sm:o.sm,md:o.md,lg:o.lg,xl:o.xl},e)})))}return r.a.createElement("div",{className:"grid-panel"},a,i)}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Ze.defaultProps={columns:3,heading:null,showToggle:!1};var Qe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:"",party:e.party},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){_e.importParty(this.state.source,this.state.party),this.setState({party:this.state.party})}},{key:"render",value:function(){var e=this;try{return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement(Q,null,r.a.createElement("div",null,"go to the following link to find the party you want to import"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.dndbeyond.com/my-campaigns",target:"_blank",rel:"noopener noreferrer"},"https://www.dndbeyond.com/my-campaigns")),r.a.createElement("div",null,"then right-click on the page and select ",r.a.createElement("b",null,"view page source")),r.a.createElement("div",null,"copy the entire page source into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(q,{text:this.state.source,placeholder:"paste page source here",lines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement(Ze,{heading:this.props.party.name,columns:1,content:this.props.party.pcs.map((function(e){return r.a.createElement(Xe,{key:e.id,pc:e,mode:"view"})}))})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),$e=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={pc:e.pc,showImageSelection:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggleImageSelection",value:function(){this.setState({showImageSelection:!this.state.showImageSelection})}},{key:"addCompanion",value:function(){var e=g.createCompanion();e.name="new companion",this.state.pc.companions.push(e),this.setState({pc:this.state.pc})}},{key:"removeCompanion",value:function(e){var t=this.state.pc;t.companions=this.state.pc.companions.filter((function(t){return t.id!==e})),this.setState({pc:t})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({pc:this.state.pc,showImageSelection:!1})}},{key:"nudgeValue",value:function(e,t,a){var n,r=e[t];switch(t){case"size":n=f.nudgeSize(r,a);break;default:n=(r||0)+a}this.changeValue(e,t,n)}},{key:"render",value:function(){var e=this;try{var t=this.state.pc.companions.map((function(t){return r.a.createElement(d.a,{gutter:10,className:"companion",key:t.id},r.a.createElement(h.a,{span:16},r.a.createElement(q,{text:t.name,onChange:function(a){return e.changeValue(t,"name",a)}})),r.a.createElement(h.a,{span:8},r.a.createElement("button",{onClick:function(){return e.removeCompanion(t.id)}},"delete")))}));return 0===t.length&&t.push(r.a.createElement("div",{className:"section",key:"empty"},r.a.createElement("i",null,"no companions (pets, retainers, mounts, etc)"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"character name:"),r.a.createElement(q,{text:this.state.pc.name,onChange:function(t){return e.changeValue(e.state.pc,"name",t)}}),r.a.createElement("div",{className:"subheading"},"player name:"),r.a.createElement(q,{text:this.state.pc.player,onChange:function(t){return e.changeValue(e.state.pc,"player",t)}}),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(H,{source:this.state.pc,name:"size",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"size",t)}}),r.a.createElement("div",{className:"subheading"},"race:"),r.a.createElement(q,{text:this.state.pc.race,onChange:function(t){return e.changeValue(e.state.pc,"race",t)}}),r.a.createElement("div",{className:"subheading"},"class:"),r.a.createElement(q,{text:this.state.pc.classes,onChange:function(t){return e.changeValue(e.state.pc,"classes",t)}}),r.a.createElement("div",{className:"subheading"},"level:"),r.a.createElement(H,{source:this.state.pc,name:"level",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"level",t)}}),r.a.createElement("div",{className:"subheading"},"passive skills"),r.a.createElement(H,{source:this.state.pc,name:"passiveInsight",label:"insight",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInsight",t)}}),r.a.createElement(H,{source:this.state.pc,name:"passiveInvestigation",label:"investigation",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInvestigation",t)}}),r.a.createElement(H,{source:this.state.pc,name:"passivePerception",label:"perception",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passivePerception",t)}})),r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement("div",{className:"subheading"},"languages:"),r.a.createElement(q,{text:this.state.pc.languages,onChange:function(t){return e.changeValue(e.state.pc,"languages",t)}}),r.a.createElement("div",{className:"subheading"},"d&d beyond link:"),r.a.createElement(q,{text:this.state.pc.url,placeholder:"https://ddb.ac/characters/...",onChange:function(t){return e.changeValue(e.state.pc,"url",t)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(K,{source:this.state.pc,edit:function(){return e.toggleImageSelection()},clear:function(){return e.changeValue(e.state.pc,"portrait","")}}),r.a.createElement("div",{className:"subheading"},"companions:"),t,r.a.createElement("button",{onClick:function(){return e.addCompanion()}},"add a new companion")),r.a.createElement(v.a,{visible:this.state.showImageSelection,closable:!1,onClose:function(){return e.toggleImageSelection()}},r.a.createElement(Pe,{select:function(t){return e.changeValue(e.state.pc,"portrait",t)},cancel:function(){return e.toggleImageSelection()}})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),et=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:"",pc:e.pc},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSource",value:function(e){this.setState({source:e})}},{key:"analyse",value:function(){_e.importPC(this.state.source,this.state.pc),this.setState({pc:this.state.pc})}},{key:"render",value:function(){var e=this;try{var t=this.state.pc.url;return t.endsWith("/")||(t+="/"),t+="json",r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement(Q,null,r.a.createElement("div",null,"go to the following link"),r.a.createElement("div",null,r.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},t)),r.a.createElement("div",null,"copy the data into the clipboard, paste it into the box below, and press the analyse button")),r.a.createElement(q,{text:this.state.source,placeholder:"paste data here",lines:10,onChange:function(t){return e.setSource(t)}}),r.a.createElement("button",{onClick:function(){return e.analyse()}},"analyse")),r.a.createElement(h.a,{span:12,className:"scrollable"},r.a.createElement(Xe,{pc:this.state.pc,mode:"view"})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),tt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).allowSearch=f.debounce((function(){a.setState({canSearch:!0})})),a.state={text:"",canSearch:!0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setSearchTerm",value:function(e){var t=this;this.setState({text:e,canSearch:!1},(function(){return t.allowSearch()}))}},{key:"render",value:function(){var e=this;try{var t=[];return this.state.canSearch?this.state.text.length>2?(this.props.parties.filter((function(t){return S.matchParty(e.state.text,t)})).forEach((function(a){var n=[];a.pcs.filter((function(t){return S.matchPC(e.state.text,t)})).forEach((function(t){var a=[];t.companions.filter((function(t){return S.matchCompanion(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.name)))})),n.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openParty(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),this.props.library.filter((function(t){return S.matchGroup(e.state.text,t)})).forEach((function(a){var n=[];a.monsters.filter((function(t){return S.matchMonster(e.state.text,t)})).forEach((function(t){var a=[];t.traits.filter((function(t){return S.matchTrait(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.name)))})),n.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openGroup(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),this.props.encounters.filter((function(t){return S.matchEncounter(e.state.text,t)})).forEach((function(a){var n=[];a.slots.filter((function(t){return S.matchEncounterSlot(e.state.text,t)})).forEach((function(e){n.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.monsterName)))}));var s=[];a.waves.filter((function(t){return S.matchEncounterWave(e.state.text,t)})).forEach((function(t){var a=[];t.slots.filter((function(t){return S.matchEncounterSlot(e.state.text,t)})).forEach((function(e){a.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},e.monsterName)))})),s.push(r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("div",{className:"section"},t.name),a))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openEncounter(a.id)}},r.a.createElement("div",{className:"section"},a.name),n,s))})),this.props.maps.filter((function(t){return S.matchMap(e.state.text,t)})).forEach((function(a){var n=[];a.notes.filter((function(t){return S.matchMapNote(e.state.text,t)})).forEach((function(e){n.push(r.a.createElement("div",{key:e.id,className:"group-panel"},r.a.createElement("div",{className:"section"},"map note")))})),t.push(r.a.createElement("div",{key:a.id,className:"group-panel clickable",onClick:function(){return e.props.openMap(a.id)}},r.a.createElement("div",{className:"section"},a.name),n))})),0===t.length&&t.push(r.a.createElement(Q,{key:"empty"},"nothing found"))):t.push(r.a.createElement(Q,{key:"empty"},"enter your search term above")):t.push(r.a.createElement(Q,{key:"pending"},"searching...")),r.a.createElement("div",{className:"scrollable",style:{padding:"10px"}},r.a.createElement(W.a.Search,{placeholder:"search",allowClear:!0,onChange:function(t){return e.setSearchTerm(t.target.value)},onSearch:function(t){return e.setSearchTerm(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),at=a(18),nt=a.n(at),rt=a(30),st=a(215),it=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"say",value:function(){var t=Object(rt.a)(nt.a.mark((function t(a,n){var r;return nt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.speechSynthesis.cancel(),r=new SpeechSynthesisUtterance(a),t.next=4,e.chooseVoice(n);case 4:r.voice=t.sent,r.rate=e.randomValue(.5,1.5),r.pitch=e.randomValue(.5,1.5),window.speechSynthesis.speak(r);case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"chooseVoice",value:function(){var t=Object(rt.a)(nt.a.mark((function t(a){var n,r,s,i;return nt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getVoices();case 2:return n=t.sent,r=a.map((function(t){return e.getLanguageCode(t)})),0===(s=n.filter((function(e){return r.includes(e.lang.substr(0,2))}))).length&&(s=n.filter((function(e){return e.default}))),0===s.length&&(s=n),i=Math.floor(Math.random()*s.length),t.abrupt("return",s[i]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getVoices",value:function(){return new Promise((function(e){var t=window.speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=function(){t=window.speechSynthesis.getVoices(),e(t)}}))}},{key:"getLanguageCode",value:function(e){switch(e){case"armenian":return"hy";case"basque":return"eu";case"bulgarian":return"bg";case"chichewa":return"ny";case"chinese":return"zh";case"croatian":return"hr";case"czech":return"cs";case"dutch":return"nl";case"german":return"de";case"greek":return"el";case"icelandic":return"is";case"irish":return"ga";case"kannada":return"kn";case"kazakh":return"kk";case"latvian":return"lv";case"lithuanian":return"lt";case"macedonian":return"mk";case"malay":return"ms";case"maltese":return"mt";case"maori":return"mi";case"polish":return"pl";case"portuguese":return"pt";case"punjabi":return"pa";case"samoan":return"sm";case"serbian":return"sr";case"shona":return"sn";case"spanish":return"es";case"swedish":return"sv";case"turkish":return"tr";case"welsh":return"cy";default:return e.substr(0,2)}}},{key:"randomValue",value:function(e,t){return e+(Math.random()+Math.random()+Math.random())/3*(t-e)}}]),e}(),ot=new Z.a.Converter;ot.setOption("tables",!0);var ct=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={view:"skills"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"skills":t=r.a.createElement(ft,null);break;case"conditions":t=r.a.createElement(ut,null);break;case"actions":t=r.a.createElement(lt,null);break;case"die":t=r.a.createElement(pt,null);break;case"language":t=r.a.createElement(dt,null);break;case"name":t=r.a.createElement(vt,null);break;case"demographics":t=r.a.createElement(mt,{library:this.props.library})}return r.a.createElement("div",{className:"tools scrollable",style:{padding:"10px"}},r.a.createElement(ce,{options:[{id:"skills",text:"skills reference"},{id:"conditions",text:"conditions reference"},{id:"actions",text:"actions reference"},{id:"die",text:"die roller"},{id:"language",text:"language generator"},{id:"name",text:"name generator"},{id:"demographics",text:"monster demographics"}],selectedID:this.state.view,itemsPerRow:3,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),lt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(){var e=Object(rt.a)(nt.a.mark((function e(){var t,a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/actions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{this.state.source||this.fetchData();var e=r.a.createElement(F.a,{type:"loading",style:{fontSize:20,marginTop:100},spin:!0});return r.a.createElement(st.a,{spinning:null===this.state.source,indicator:e},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ot.makeHtml(this.state.source||"")}}))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ut=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(){var e=Object(rt.a)(nt.a.mark((function e(){var t,a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/conditions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{this.state.source||this.fetchData();var e=r.a.createElement(F.a,{type:"loading",style:{fontSize:20,marginTop:100},spin:!0});return r.a.createElement(st.a,{spinning:null===this.state.source,indicator:e},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ot.makeHtml(this.state.source||"")}}))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),mt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={chart:"challenge"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"selectChart",value:function(e){this.setState({chart:e})}},{key:"render",value:function(){var e=this;try{var t=[];if(this.props.library.forEach((function(e){return e.monsters.forEach((function(e){return t.push(e)}))})),0===t.length)return null;var a=[];switch(this.state.chart){case"challenge":a=[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].map((function(e){return{text:"cr "+f.challenge(e),value:t.filter((function(t){return t.challenge===e})).length}}));break;case"size":a=b.map((function(e){return{text:e,value:t.filter((function(t){return t.size===e})).length}}));break;case"type":a=y.map((function(e){return{text:e,value:t.filter((function(t){return t.category===e})).length}}))}return r.a.createElement("div",null,r.a.createElement(ce,{options:[{id:"challenge",text:"challenge rating"},{id:"size",text:"size"},{id:"type",text:"type"}],selectedID:this.state.chart,select:function(t){return e.selectChart(t)}}),r.a.createElement(De,{data:a}))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),pt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={dice:"20",count:1,options:[],rolls:null,result:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setDice",value:function(e){this.setState({dice:e})}},{key:"nudgeCount",value:function(e){this.setState({count:Math.max(1,this.state.count+e)})}},{key:"toggleOption",value:function(e){if(this.state.options.includes(e)){var t=this.state.options.indexOf(e);this.state.options.splice(t,1)}else if(this.state.options.push(e),this.state.options.includes("advantage")&&this.state.options.includes("disadvantage")){var a=this.state.options.indexOf("advantage"===e?"disadvantage":"advantage");this.state.options.splice(a,1)}this.setState({options:this.state.options})}},{key:"roll",value:function(){var e=parseInt(this.state.dice,10),t=[],a=this.state.count;(this.state.options.includes("advantage")||this.state.options.includes("disadvantage"))&&(a=2);for(var n=0;n!==a;++n)t.push(f.dieRoll(e));t.sort((function(e,t){return e-t}));var r=0;1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("advantage")?r=Math.max.apply(Math,t):1===this.state.count&&"20"===this.state.dice&&this.state.options.includes("disadvantage")?r=Math.min.apply(Math,t):(t.forEach((function(e){return r+=e})),this.state.count>1&&this.state.options.includes("drop lowest")&&(r-=Math.min.apply(Math,t)),this.state.count>1&&this.state.options.includes("drop highest")&&(r-=Math.max.apply(Math,t))),this.setState({rolls:t,result:r})}},{key:"render",value:function(){var e=this;try{var t=null;"20"===this.state.dice&&1===this.state.count?t=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement(M,{label:"advantage",checked:this.state.options.includes("advantage"),changeValue:function(t){return e.toggleOption("advantage")}})),r.a.createElement(h.a,{span:12},r.a.createElement(M,{label:"disadvantage",checked:this.state.options.includes("disadvantage"),changeValue:function(t){return e.toggleOption("disadvantage")}}))):this.state.count>1&&(t=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement(M,{label:"drop lowest",checked:this.state.options.includes("drop lowest"),changeValue:function(t){return e.toggleOption("drop lowest")}})),r.a.createElement(h.a,{span:12},r.a.createElement(M,{label:"drop highest",checked:this.state.options.includes("drop highest"),changeValue:function(t){return e.toggleOption("drop highest")}}))));var a=null;null!==this.state.rolls&&this.state.rolls.length>1&&(a=r.a.createElement("div",{className:"section die-rolls"},this.state.rolls.join(", ")));var n=null;return null!==this.state.result&&(n=r.a.createElement("div",{className:"section die-result"},this.state.result)),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"die type"),r.a.createElement(ce,{options:[{id:"4",text:"d4"},{id:"6",text:"d6"},{id:"8",text:"d8"},{id:"10",text:"d10"},{id:"12",text:"d12"},{id:"20",text:"d20"},{id:"100",text:"d100"}],selectedID:this.state.dice,select:function(t){return e.setDice(t)}}),r.a.createElement("div",{className:"subheading"},"number of dice to roll"),r.a.createElement(H,{source:this.state,name:"count",display:function(t){return t+"d"+e.state.dice},nudgeValue:function(t){return e.nudgeCount(t)}}),t?r.a.createElement("div",{className:"subheading"},"options"):null,t,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.roll()}},"roll dice"),a,n)}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),dt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={sources:{},output:[]},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getLanguages",value:function(){return["afrikaans","amharic","armenian","basque","belarusian","bulgarian","chichewa","chinese","croatian","czech","danish","dutch","english","finnish","french","german","greek","hawaiian","hindi","hungarian","icelandic","irish","italian","japanese","kannada","kazakh","korean","kyrgyz","latvian","lithuanian","macedonian","malay","maltese","maori","myanmar","nepali","norwegian","polish","portuguese","punjabi","romanian","russian","samoan","serbian","shona","somali","spanish","swahili","swedish","thai","turkish","welsh","yiddish","zulu"]}},{key:"getPresets",value:function(){return[{name:"draconic",languages:["armenian","irish","maltese"]},{name:"dwarvish",languages:["czech","german","yiddish"]},{name:"elvish",languages:["finnish","spanish","welsh"]},{name:"goblin",languages:["hawaiian","kyrgyz","somali"]},{name:"orc",languages:["macedonian","russian","turkish"]}]}},{key:"addLanguage",value:function(){var e=Object(rt.a)(nt.a.mark((function e(t){var a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/langs/"+t+".txt");case 2:return a=e.sent,e.next=5,a.text();case 5:this.state.sources[t]=e.sent,this.setState({sources:this.state.sources});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeLanguage",value:function(e){delete this.state.sources[e],this.setState({sources:this.state.sources})}},{key:"usePreset",value:function(e){var t=this,a=this.getPresets().find((function(t){return t.name===e}));a&&this.setState({sources:{},output:[]},(function(){a.languages.forEach((function(e){t.addLanguage(e)}))}))}},{key:"random",value:function(){for(var e=this,t=this.getLanguages(),a=[];3!==a.length;){var n=t[Math.floor(Math.random()*t.length)];a.includes(n)||a.push(n)}this.setState({sources:{},output:[]},(function(){a.forEach((function(t){e.addLanguage(t)}))}))}},{key:"generate",value:function(){var e=this,t=[];Object.keys(this.state.sources).forEach((function(a){var n=e.state.sources[a];t.push(n)})),Ge.initModel(t),this.setState({output:Ge.generate(5).map((function(e){return e.line}))})}},{key:"reset",value:function(){this.setState({sources:{},output:[]})}},{key:"render",value:function(){var e=this;try{var t=this.getPresets().map((function(e){return{id:e.name,text:e.name}})),a="";this.getPresets().forEach((function(t){Object.keys(e.state.sources).sort().join(", ")===t.languages.sort().join(", ")&&(a=t.name)}));var n=Object.keys(this.state.sources).sort().join(", ");""===n&&(n="none");var s=this.getLanguages().map((function(t){var a=Object.keys(e.state.sources).includes(t);return r.a.createElement(M,{key:t,label:t,checked:a,changeValue:function(a){return a?e.addLanguage(t):e.removeLanguage(t)}})})),i=Object.keys(this.state.sources).length>0,o=i||this.state.output.length>0,c=[];this.state.output.length>0&&c.push(r.a.createElement("div",{key:"div",className:"divider"}));for(var l=0;l!==this.state.output.length;++l)c.push(r.a.createElement(ht,{key:l,text:this.state.output[l],languages:Object.keys(this.state.sources)}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"presets"),r.a.createElement(ce,{options:t,selectedID:a,select:function(t){return e.usePreset(t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement(Y,{text:"selected languages: "+n},r.a.createElement(Ze,{content:s})),r.a.createElement("div",{className:"divider"}),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:i?"":"disabled",onClick:function(){return e.generate()}},"generate text")),r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:o?"":"disabled",onClick:function(){return e.reset()}},"reset")),r.a.createElement(h.a,{span:8},r.a.createElement("button",{onClick:function(){return e.random()}},"random sources"))),r.a.createElement("div",{className:"language-output"},c))}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ht=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"copy",value:function(e){e.preventDefault(),navigator.clipboard.writeText(this.props.text)}},{key:"say",value:function(e){e.preventDefault(),it.say(this.props.text,this.props.languages)}},{key:"render",value:function(){var e=this;try{return r.a.createElement(Y,{text:this.props.text.toLowerCase()},r.a.createElement("button",{onClick:function(t){return e.copy(t)}},"copy to clipboard"),r.a.createElement("button",{onClick:function(t){return e.say(t)}},"say"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"note:")," speech may not work consistently on all platforms"))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),vt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={names:[]},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"generate",value:function(){var e=Object(rt.a)(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({names:Ge.generateNames(10)});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.names.length;++a)t.push(r.a.createElement("div",{key:a,className:"section name-output"},this.state.names[a].toLowerCase()));return r.a.createElement("div",{className:"name-output"},r.a.createElement("div",{className:"subheading"},"names"),r.a.createElement("button",{onClick:function(){return e.generate()}},"generate"),t)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ft=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={source:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(){var e=Object(rt.a)(nt.a.mark((function e(){var t,a;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/skills.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{this.state.source||this.fetchData();var e=r.a.createElement(F.a,{type:"loading",style:{fontSize:20,marginTop:100},spin:!0});return r.a.createElement(st.a,{spinning:null===this.state.source,indicator:e},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ot.makeHtml(this.state.source||"")}}))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),gt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t="parties"===this.props.view?"navigator-item pcs selected":"navigator-item pcs",a="library"===this.props.view?"navigator-item monsters selected":"navigator-item monsters",n="encounters"===this.props.view?"navigator-item encounters selected":"navigator-item encounters",s="maps"===this.props.view?"navigator-item maps selected":"navigator-item maps",i="combat"===this.props.view?"navigator-item combat selected":"navigator-item combat";return r.a.createElement("div",{className:"page-footer"},r.a.createElement("div",{className:t,onClick:function(){return e.props.setView("parties")}},"pcs"),r.a.createElement("div",{className:a,onClick:function(){return e.props.setView("library")}},"monsters"),r.a.createElement("div",{className:n,onClick:function(){return e.props.setView("encounters")}},"encounters"),r.a.createElement("div",{className:s,onClick:function(){return e.props.setView("maps")}},"maps"),r.a.createElement("div",{className:i,onClick:function(){return e.props.setView("combat")}},"combat"))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),bt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t="dojo";switch(this.props.view){case"parties":t="dojo: pcs";break;case"library":t="dojo: monsters";break;case"encounters":t="dojo: encounters";break;case"maps":t="dojo: maps";break;case"combat":t="dojo: combat"}return r.a.createElement("div",{className:"page-header"},r.a.createElement(F.a,{type:"menu",className:"menu-icon",onClick:function(){return e.props.openMenu()},title:"menu"}),r.a.createElement("div",{className:"app-title app-name"},t),r.a.createElement("div",{className:"drawer-icons"},r.a.createElement(F.a,{type:"search",className:"title-bar-icon",onClick:function(){return e.props.openDrawer("search")},title:"search"}),r.a.createElement(F.a,{type:"setting",className:"title-bar-icon",onClick:function(){return e.props.openDrawer("tools")},title:"dm tools"}),r.a.createElement(F.a,{type:"info-circle",className:"title-bar-icon",onClick:function(){return e.props.openDrawer("about")},title:"about"})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),yt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showParties:!1,showGroups:!1,showEncounters:!1,showMaps:!1,showCombats:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"open",value:function(e){this.setState({showParties:"parties"===e&&!this.state.showParties,showGroups:"groups"===e&&!this.state.showGroups,showEncounters:"encounters"===e&&!this.state.showEncounters,showMaps:"maps"===e&&!this.state.showMaps,showCombats:"combats"===e&&!this.state.showCombats})}},{key:"render",value:function(){var e=this;try{var t=this.props.parties.map((function(t){return r.a.createElement("div",{key:t.id,className:"nav-subitem",onClick:function(){return e.props.openParty(t.id)}},t.name)})),a=this.props.library.map((function(t){return r.a.createElement("div",{key:t.id,className:"nav-subitem",onClick:function(){return e.props.openMonsterGroup(t.id)}},t.name)})),n=this.props.encounters.map((function(t){return r.a.createElement("div",{key:t.id,className:"nav-subitem",onClick:function(){return e.props.openEncounter(t.id)}},t.name)})),s=this.props.maps.map((function(t){return r.a.createElement("div",{key:t.id,className:"nav-subitem",onClick:function(){return e.props.openMap(t.id)}},t.name)})),i=this.props.combats.map((function(t){return r.a.createElement("div",{key:t.id,className:"nav-subitem",onClick:function(){return e.props.openCombat(t.id)}},t.name)})),o=null;this.props.parties.length>0&&(o=r.a.createElement(F.a,{type:"down-circle",className:this.state.showParties?"toggle open":"toggle",onClick:function(){return e.open("parties")}}));var c=null;this.props.library.length>0&&(c=r.a.createElement(F.a,{type:"down-circle",className:this.state.showGroups?"toggle open":"toggle",onClick:function(){return e.open("groups")}}));var l=null;this.props.encounters.length>0&&(l=r.a.createElement(F.a,{type:"down-circle",className:this.state.showEncounters?"toggle open":"toggle",onClick:function(){return e.open("encounters")}}));var u=null;this.props.maps.length>0&&(u=r.a.createElement(F.a,{type:"down-circle",className:this.state.showMaps?"toggle open":"toggle",onClick:function(){return e.open("maps")}}));var m=null;return this.props.combats.length>0&&(m=r.a.createElement(F.a,{type:"down-circle",className:this.state.showCombats?"toggle open":"toggle",onClick:function(){return e.open("combats")}})),r.a.createElement("div",{className:"scrollable"},r.a.createElement("div",{className:"nav-item"},r.a.createElement("div",{className:"text",onClick:function(){return e.props.openParty(null)}},"pcs"),o),this.state.showParties?t:null,r.a.createElement("div",{className:"nav-item"},r.a.createElement("div",{className:"text",onClick:function(){return e.props.openMonsterGroup(null)}},"monsters"),c),this.state.showGroups?a:null,r.a.createElement("div",{className:"nav-item"},r.a.createElement("div",{className:"text",onClick:function(){return e.props.openEncounter(null)}},"encounters"),l),this.state.showEncounters?n:null,r.a.createElement("div",{className:"nav-item"},r.a.createElement("div",{className:"text",onClick:function(){return e.props.openMap(null)}},"maps"),u),this.state.showMaps?s:null,r.a.createElement("div",{className:"nav-item"},r.a.createElement("div",{className:"text",onClick:function(){return e.props.openCombat(null)}},"combat"),m),this.state.showCombats?i:null)}catch(p){return console.error(p),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Et=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"readaloud"},this.props.children)}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),kt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{if(!this.props.hasPCs||!this.props.hasMonsters)return r.a.createElement(d.a,{type:"flex",justify:"center",align:"middle",className:"scrollable"},r.a.createElement(h.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Et,null,r.a.createElement("div",{className:"section"},"this screen is for running combat encounters, but before you can do that you need to do these things first:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasPCs?"strikethrough":""},"define a party of pcs in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("parties")}},"pcs screen")),this.props.hasPCs?r.a.createElement(F.a,{type:"check-circle",title:"done",style:{marginLeft:"5px"}}):null),r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("library")}},"monsters screen")),this.props.hasMonsters?r.a.createElement(F.a,{type:"check-circle",title:"done",style:{marginLeft:"5px"}}):null)),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"you probably want to design your encounter in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("encounters")}},"encounters screen"),", but you don't have to (you can generate a random encounter here instead)"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"if you want to use a tactical map, you can either build one in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("maps")}},"maps screen"),", or you can generate a random one here"))));var t=this.props.combats.map((function(t){return r.a.createElement(Nt,{key:t.id,combat:t,resume:function(t){return e.props.resumeCombat(t)},delete:function(t){return e.props.deleteCombat(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"here you can run a combat encounter by specifying a party and an encounter, and optionally a tactical map"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of combats that you have paused"),r.a.createElement("div",{className:"section"},"you can resume a paused combat by selecting it"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start a combat encounter, press the ",r.a.createElement("b",null,"start a new combat")," button")),r.a.createElement("button",{onClick:function(){return e.props.createCombat()}},"start a new combat")),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{heading:"combats",content:t})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Nt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;this.props.combat.map&&(t=r.a.createElement("div",{className:"section"},r.a.createElement(he,{map:this.props.combat.map,mode:"thumbnail",size:12,combatants:this.props.combat.combatants})));var a=this.props.combat.combatants.filter((function(e){return e.active})).map((function(e){return r.a.createElement("div",{key:e.id,className:e.type+"-row"},r.a.createElement(K,{source:e,inline:!0}),r.a.createElement("div",{className:"name"},e.displayName))}));return r.a.createElement("div",{className:"card combat"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.combat.name||"unnamed combat")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"section"},"paused at round ",this.props.combat.round),t,r.a.createElement("div",{className:"subheading"},"initiative order"),a),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.resume(e.props.combat)}},"resume"),r.a.createElement(D,{text:"delete",callback:function(){return e.props.delete(e.props.combat)}})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),xt=a(218),wt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];if(this.props.combatant.conditions)for(var a=0;a!==this.props.combatant.conditions.length;++a){var n=this.props.combatant.conditions[a];t.push(r.a.createElement(Ct,{key:a,condition:n,combat:this.props.combat,nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)},editCondition:function(t){return e.props.editCondition(t)},removeCondition:function(t){return e.props.removeCondition(t)}}))}return r.a.createElement("div",{className:"section"},t,r.a.createElement("button",{onClick:function(){return e.props.addCondition()}},"add a condition"))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ct=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.condition.name||"condition";"exhaustion"===this.props.condition.name&&(t+=" ("+this.props.condition.level+")");var a=null;null!==this.props.condition.duration&&(a=r.a.createElement("div",{className:"section"},r.a.createElement("i",null,f.conditionDurationText(this.props.condition,this.props.combat))));var n=[];"exhaustion"===this.props.condition.name&&n.push(r.a.createElement("div",{key:"level",className:"section"},r.a.createElement(H,{source:this.props.condition,name:"level",label:"level",nudgeValue:function(t){return e.props.nudgeConditionValue(e.props.condition,"level",t)}})));for(var s=f.conditionText(this.props.condition),i=0;i!==s.length;++i)n.push(r.a.createElement("div",{key:i,className:"section"},s[i]));return r.a.createElement("div",{className:"group-panel condition-panel"},r.a.createElement("div",null,r.a.createElement("div",{className:"condition-name"},t),r.a.createElement("div",{className:"condition-buttons"},r.a.createElement(F.a,{type:"edit",title:"edit",onClick:function(){return e.props.editCondition(e.props.condition)}}),r.a.createElement(F.a,{type:"close",title:"remove",onClick:function(){return e.props.removeCondition(e.props.condition.id)}}))),a,n)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),St=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={externalWindow:null,containerElement:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.open("","","width=800, height=500, left=200, top=200"),a=null;t&&((a=t.document.createElement("div")).className="dojo popout",t.document.body.appendChild(a),Array.from(document.styleSheets).forEach((function(e){var a=e;if(e.href){var n=document.createElement("link");n.rel="stylesheet",n.href=e.href,t.document.head.appendChild(n)}else if(a&&a.cssRules&&a.cssRules.length>0){var r=document.createElement("style");Array.from(a.cssRules).forEach((function(e){r.appendChild(document.createTextNode(e.cssText))})),t.document.head.appendChild(r)}})),t.document.title=this.props.title,t.addEventListener("beforeunload",(function(){e.props.closeWindow()})));this.setState({externalWindow:t,containerElement:a})}},{key:"componentWillUnmount",value:function(){this.state.externalWindow&&this.state.externalWindow.close()}},{key:"render",value:function(){try{return this.state.containerElement?i.a.createPortal(this.props.children,this.state.containerElement):null}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ot=new Z.a.Converter;Ot.setOption("tables",!0);var Mt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={rightPanel:"selection",showDefeatedCombatants:!1,selectedItemID:null,addingToMapID:null,addingOverlay:!1,mapSize:30,playerView:{open:!1,showControls:!1,mapSize:30}},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(){e.setPlayerViewOpen(!1)}))}},{key:"setRightPanel",value:function(e){this.setState({rightPanel:e})}},{key:"toggleShowDefeatedCombatants",value:function(){this.setState({showDefeatedCombatants:!this.state.showDefeatedCombatants})}},{key:"setSelectedItemID",value:function(e){this.setState({selectedItemID:e,rightPanel:"selection"})}},{key:"setAddingToMapID",value:function(e){this.setState({addingToMapID:e,addingOverlay:!1})}},{key:"toggleAddingOverlay",value:function(){this.setState({addingOverlay:!this.state.addingOverlay,addingToMapID:null})}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:Math.max(this.state.mapSize+e,3)})}},{key:"setPlayerViewOpen",value:function(e){var t=this.state.playerView;t.open=e,this.setState({playerView:t})}},{key:"setPlayerViewShowControls",value:function(e){var t=this.state.playerView;t.showControls=e,this.setState({playerView:t})}},{key:"nudgePlayerViewMapSize",value:function(e){var t=this.state.playerView;t.mapSize=Math.max(t.mapSize+e,3),this.setState({playerView:t})}},{key:"nextTurn",value:function(){var e=this.props.combat.combatants.find((function(e){return e.current}));if(e)this.props.endTurn(e);else{var t=this.props.combat.combatants.find((function(e){return e.active}));t&&this.props.makeCurrent(t)}}},{key:"defeatCombatant",value:function(e){this.state.selectedItemID===e.id&&this.setState({selectedItemID:null}),this.props.makeDefeated(e)}},{key:"gridSquareClicked",value:function(e,t){var a=this;if(this.state.addingToMapID){var n=this.props.combat.combatants.find((function(e){return e.id===a.state.addingToMapID}));n&&this.props.mapAdd(n,e,t),this.setAddingToMapID(null)}if(this.state.addingOverlay){var r=g.createMapItem();r.type="overlay",r.x=e,r.y=t,r.width=1,r.height=1,r.color="#005080",r.opacity=127,r.style="square",this.props.addOverlay(r),this.setState({rightPanel:"selection",addingOverlay:!1,addingToMapID:null,selectedItemID:r.id})}}},{key:"getPlayerView",value:function(e){var t=this;if(!this.state.playerView.open)return null;var a=e.combatants.filter((function(e){return"pc"===e.type||e.showOnMap})).filter((function(e){return!e.pending&&e.active&&!e.defeated})),n=r.a.createElement(Be.List,{values:a,lockVertically:!0,onChange:function(e){var a=e.oldIndex,n=e.newIndex;return t.props.moveCombatant(a,n)},renderList:function(e){var t=e.children,a=e.props;return r.a.createElement("div",a,t)},renderItem:function(e){var a=e.value,n=e.props,s=e.isDragged;return r.a.createElement("div",Object.assign({},n,{className:s?"dragged":""}),t.createCombatantRow(a,!0))}});if(e.map){var s=null;if(e.map&&this.state.playerView.showControls){var i=e.combatants.filter((function(t){return null!==e.map&&e.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).find((function(e){return e.id===t.state.selectedItemID}));if(i||(i=e.combatants.filter((function(t){return null!==e.map&&e.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).find((function(e){return e.current}))),i){var o=i;s=r.a.createElement("div",null,r.a.createElement("div",{className:"heading lowercase"},o.displayName),r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"eight",click:function(e){return t.props.mapMove(o.id,e)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement(H,{key:"altitude",source:o,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(e){return t.props.nudgeValue(o,"altitude",5*e)}}),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"conc.",display:"button",checked:o.tags.includes("conc"),changeValue:function(e){return t.props.toggleTag(o,"conc")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"bane",display:"button",checked:o.tags.includes("bane"),changeValue:function(e){return t.props.toggleTag(o,"bane")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"bless",display:"button",checked:o.tags.includes("bless"),changeValue:function(e){return t.props.toggleTag(o,"bless")}}))),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"prone",display:"button",checked:o.conditions.some((function(e){return"prone"===e.name})),changeValue:function(e){return t.props.toggleCondition(o,"prone")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"uncon.",display:"button",checked:o.conditions.some((function(e){return"unconscious"===e.name})),changeValue:function(e){return t.props.toggleCondition(o,"unconscious")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"hidden",display:"button",checked:!o.showOnMap,changeValue:function(e){return t.props.changeValue(o,"showOnMap",!e)}}))))}}return r.a.createElement(St,{title:"Encounter",closeWindow:function(){return t.setPlayerViewOpen(!1)}},r.a.createElement(d.a,null,r.a.createElement(h.a,{xs:24,sm:24,md:12,lg:16,xl:18,className:"scrollable both-ways"},r.a.createElement(he,{key:"map",map:e.map,mode:"combat-player",size:this.state.playerView.mapSize,combatants:e.combatants,selectedItemID:this.state.selectedItemID?this.state.selectedItemID:void 0,setSelectedItemID:function(e){return t.setSelectedItemID(e)}})),r.a.createElement(h.a,{xs:24,sm:24,md:12,lg:8,xl:6,className:"scrollable"},s,r.a.createElement("div",{className:"heading fixed-top"},"initiative order"),n)))}return r.a.createElement(St,{title:"Encounter",closeWindow:function(){return t.setPlayerViewOpen(!1)}},r.a.createElement("div",{className:"scrollable"},r.a.createElement("div",{className:"heading"},"initiative order"),n))}},{key:"getTools",value:function(){var e,t=this;return e=!!this.props.combat.encounter&&this.props.combat.encounter.waves.length>0,r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"encounter"),r.a.createElement("button",{onClick:function(){return t.props.pauseCombat()}},"pause combat"),r.a.createElement(D,{text:"end combat",callback:function(){return t.props.endCombat()}}),r.a.createElement("button",{onClick:function(){return t.props.showLeaderboard()}},"leaderboard"),r.a.createElement("div",{className:"subheading"},"combatants"),r.a.createElement(M,{label:"show defeated combatants",checked:this.state.showDefeatedCombatants,changeValue:function(){return t.toggleShowDefeatedCombatants()}}),r.a.createElement("button",{onClick:function(){return t.props.addCombatants()}},"add combatants"),r.a.createElement("button",{onClick:function(){return t.props.addWave()},style:{display:e?"block":"none"}},"add wave"),r.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},r.a.createElement("div",{className:"subheading"},"map"),r.a.createElement("button",{onClick:function(){return t.props.scatterCombatants("monster")}},"scatter monsters"),r.a.createElement("button",{onClick:function(){return t.props.scatterCombatants("pc")}},"scatter pcs"),r.a.createElement(M,{label:this.state.addingOverlay?"click on the map to add the item, or click here to cancel":"add token / overlay",display:"button",checked:this.state.addingOverlay,changeValue:function(){return t.toggleAddingOverlay()}}),r.a.createElement(H,{source:this.state,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(e){return t.nudgeMapSize(3*e)}})),r.a.createElement("div",{className:"subheading"},"player view"),r.a.createElement(M,{label:"show player view",checked:this.state.playerView.open,changeValue:function(e){return t.setPlayerViewOpen(e)}}),r.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},r.a.createElement(M,{label:"show map controls",checked:this.state.playerView.showControls,changeValue:function(e){return t.setPlayerViewShowControls(e)}})),r.a.createElement("div",{style:{display:this.props.combat.map&&this.state.playerView.open?"block":"none"}},r.a.createElement(H,{source:this.state.playerView,name:"mapSize",display:function(){return"zoom"},nudgeValue:function(e){return t.nudgePlayerViewMapSize(3*e)}})))}},{key:"getSelectedCombatant",value:function(){var e=this,t=null;if(this.state.selectedItemID){var a=this.props.combat.combatants.find((function(t){return t.id===e.state.selectedItemID}));if(a&&(t=a.current?r.a.createElement(Q,{key:"selected"},r.a.createElement("div",{className:"section"},r.a.createElement("b",null,a.displayName)," is selected; it is the current initiative holder")):this.createCard(a)),!t&&this.props.combat.map){var n=this.props.combat.map.items.find((function(t){return t.id===e.state.selectedItemID}));if(n){var s=C.getNote(this.props.combat.map,n);t=r.a.createElement(Tt,{item:n,note:s,move:function(t,a){return e.props.mapMove(t.id,a)},resize:function(t,a,n){return e.props.mapResize(t.id,a,n)},remove:function(t){return e.props.mapRemove(t.id)},addNote:function(t){return e.props.mapAddNote(t)},removeNote:function(t){return e.props.mapRemoveNote(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)}})}}}return t||(t=r.a.createElement(Q,{key:"selected"},r.a.createElement("div",{className:"section"},"select a pc or monster from the ",r.a.createElement("b",null,"initiative order")," list to see its details here"))),t}},{key:"createPendingRow",value:function(e){var t=this;return r.a.createElement(It,{key:e.id,combatant:e,select:function(e){return t.setSelectedItemID(e.id)},selected:e.id===this.state.selectedItemID,nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},makeActive:function(e){return t.props.makeActive(e)}})}},{key:"createCombatantRow",value:function(e,t){var a=this;switch(e.type){case"pc":return r.a.createElement(Dt,{key:e.id,combatant:e,combat:this.props.combat,selected:e.id===this.state.selectedItemID,minimal:t,select:function(e){return a.setSelectedItemID(e.id)},addToMap:function(e){return a.setAddingToMapID(a.state.addingToMapID?null:e.id)}});case"monster":return r.a.createElement(Vt,{key:e.id,combatant:e,combat:this.props.combat,selected:e.id===this.state.selectedItemID,minimal:t,select:function(e){return a.setSelectedItemID(e.id)},addToMap:function(e){return a.setAddingToMapID(a.state.addingToMapID?null:e.id)}})}return null}},{key:"createCard",value:function(e){var t=this,a="no-map";this.props.combat.map&&(a=this.props.combat.map.items.find((function(t){return t.id===e.id}))?"on-map":"off-map");switch(e.type){case"pc":return r.a.createElement("div",null,r.a.createElement(Pt,{combatant:e,combat:this.props.combat,tactical:a,makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.defeatCombatant(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},changeHP:function(e,a,n,r){return t.props.changeHP(e,a,n,r)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(t.state.addingToMapID?null:e.id)},mapMove:function(e,a){return t.props.mapMove(e.id,a)},mapRemove:function(e){return t.props.mapRemove(e.id)},toggleTag:function(e,a){return t.props.toggleTag(e,a)},toggleCondition:function(e,a){return t.props.toggleCondition(e,a)},changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}}),r.a.createElement(Xe,{pc:e,mode:"combat",changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}}));case"monster":return r.a.createElement("div",null,r.a.createElement(Pt,{combatant:e,combat:this.props.combat,tactical:a,makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.defeatCombatant(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},changeHP:function(e,a,n,r){return t.props.changeHP(e,a,n,r)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(t.state.addingToMapID?null:e.id)},mapMove:function(e,a){return t.props.mapMove(e.id,a)},mapRemove:function(e){return t.props.mapRemove(e.id)},toggleTag:function(e,a){return t.props.toggleTag(e,a)},toggleCondition:function(e,a){return t.props.toggleCondition(e,a)},changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}}),r.a.createElement(se,{monster:e,mode:"combat",changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)}}))}return null}},{key:"render",value:function(){var e=this;try{var t=null,a=[],n=[];this.props.combat.combatants.forEach((function(r){r.pending?a.push(e.createPendingRow(r)):(r.current&&(t=e.createCard(r)),(r.active||r.defeated&&e.state.showDefeatedCombatants)&&n.push(r))})),0!==a.length&&a.unshift(r.a.createElement(Q,{key:"pending-help"},r.a.createElement("div",{className:"section"},"these combatants are not yet part of the encounter"),r.a.createElement("div",{className:"section"},"set initiative on each of them, then add them to the encounter")));var s=null;t||(s=r.a.createElement(Q,{key:"init-help"},r.a.createElement("div",{className:"section"},"these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)"),r.a.createElement("div",{className:"section"},"they are listed in initiative order (with the highest initiative score at the top of the list, and the lowest at the bottom)"),r.a.createElement("div",{className:"section"},"when you're ready to begin the encounter, press the ",r.a.createElement("b",null,"start combat")," button at the top left")),t=r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"the current initiative holder will be displayed here")));var i=r.a.createElement(Be.List,{key:"init-list",values:n,lockVertically:!0,onChange:function(t){var a=t.oldIndex,n=t.newIndex;return e.props.moveCombatant(a,n)},renderList:function(e){var t=e.children,a=e.props;return r.a.createElement("div",a,t)},renderItem:function(t){var a=t.value,n=t.props,s=t.isDragged;return r.a.createElement("div",Object.assign({},n,{className:s?"dragged":""}),e.createCombatantRow(a,!1))}}),o=null;this.props.combat.notifications.length>0&&(o=r.a.createElement("div",{className:"notifications"},this.props.combat.notifications.map((function(t){return r.a.createElement(jt,{key:t.id,notification:t,close:function(t,a){return e.props.closeNotification(t,a)}})}))));var c=null;this.props.combat.map&&(c=r.a.createElement(he,{key:"map",map:this.props.combat.map,mode:"combat",size:this.state.mapSize,showOverlay:null!==this.state.addingToMapID||this.state.addingOverlay,combatants:this.props.combat.combatants,selectedItemID:this.state.selectedItemID?this.state.selectedItemID:void 0,setSelectedItemID:function(t){return e.setSelectedItemID(t)},gridSquareClicked:function(t,a){return e.gridSquareClicked(t,a)}}));var l=[];this.props.combat.combatants.forEach((function(t){var a=t,n=a&&a.traits&&a.traits.some((function(e){return"legendary"===e.type}))&&!a.current,s=a&&a.traits&&a.traits.some((function(e){return"lair"===e.type}));(n||s)&&l.push(r.a.createElement("div",{className:"card monster",key:a.id},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},a.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement(ee,{combatant:a,mode:"combat-special",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))))}));var u=["selection","tools"].map((function(e){return{id:e,text:e}})),m=null,p=null;switch(this.state.rightPanel){case"selection":m="selected combatant",p=this.getSelectedCombatant();break;case"tools":m="tools",p=this.getTools()}return r.a.createElement("div",{className:"full-height"},r.a.createElement(d.a,{className:"combat-top-row"},r.a.createElement(h.a,{span:8,style:{padding:"0 10px"}},r.a.createElement("button",{onClick:function(){return e.nextTurn()}},this.props.combat.combatants.find((function(e){return e.current}))?"next turn":"start combat")),r.a.createElement(h.a,{span:3},r.a.createElement("div",{className:"statistic"},"round ",this.props.combat.round)),r.a.createElement(h.a,{span:2,className:"section centered"},r.a.createElement(F.a,{type:this.props.maximized?"fullscreen-exit":"fullscreen",className:"maximize-button",onClick:function(){return e.props.maximize()}})),r.a.createElement(h.a,{span:3},r.a.createElement("div",{className:"statistic"},O.getCombatXP(this.props.combat)," xp")),r.a.createElement(h.a,{span:8,style:{padding:"0 10px"}},r.a.createElement(ce,{options:u,selectedID:this.state.rightPanel,select:function(t){return e.setRightPanel(t)}}))),r.a.createElement(d.a,{className:"combat-main"},r.a.createElement(h.a,{span:8,className:"scrollable"},r.a.createElement("div",{className:"heading fixed-top"},"initiative holder"),t),r.a.createElement(h.a,{span:8,className:"scrollable"},o,r.a.createElement(Ze,{heading:"waiting for intiative",content:a,columns:1,showToggle:!0}),r.a.createElement(Ze,{heading:"don't forget",content:l,columns:1,showToggle:!0}),r.a.createElement(Ze,{heading:"encounter map",content:[c],columns:1,showToggle:!0}),r.a.createElement(Ze,{heading:"initiative order",content:[s,i],columns:1,showToggle:!0})),r.a.createElement(h.a,{span:8,className:"scrollable"},r.a.createElement("div",{className:"heading fixed-top"},m),p)),this.getPlayerView(this.props.combat))}catch(v){return console.error(v),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),jt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"success",value:function(){switch(this.props.notification.type){case"condition-save":case"condition-end":var e=this.props.notification.data;e.duration&&("saves"!==e.duration.type&&"rounds"!==e.duration.type||(e.duration.count-=1,0===e.duration.count?this.close(!0):this.close()));break;case"trait-recharge":this.props.notification.data.uses=0,this.close()}}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.close(this.props.notification,e)}},{key:"render",value:function(){var e=this;try{var t=this.props.notification.combatant,a=this.props.notification.data,n=this.props.notification.data,s=t.displayName||t.name||"unnamed monster";switch(this.props.notification.type){case"condition-save":var i=a.duration,o=i.saveType.toString();return"death"!==o&&(o=o.toUpperCase()),r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," must make a ",o," save against dc ",i.saveDC),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("button",{key:"success",onClick:function(){return e.success()}},"success")),r.a.createElement(h.a,{span:12},r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close"))));case"condition-end":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," is no longer affected by condition ",a.name),r.a.createElement("button",{onClick:function(){return e.close()}},"close"));case"trait-recharge":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," can attempt to recharge ",n.name," (",n.usage,")"),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("button",{key:"recharge",onClick:function(){return e.success()}},"recharge")),r.a.createElement(h.a,{span:12},r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close"))));default:return null}}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),It=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getInformationText",value:function(){return this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;(this.props.combatant.current||this.props.selected)&&(t+=" highlight");var a=this.props.combatant;return r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"header"},r.a.createElement(K,{source:a,inline:!0}),r.a.createElement("div",{className:"name"},a.displayName||a.name||"combatant"),r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},r.a.createElement(H,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}),r.a.createElement("button",{onClick:function(t){t.stopPropagation(),e.props.makeActive(e.props.combatant)}},"add to encounter")))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Dt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),!this.props.selected&&this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;this.props.selected&&(t+=" highlight"),this.props.combatant.defeated&&(t+=" defeated");var a=r.a.createElement(F.a,{type:"menu",className:"grabber small","data-movable-handle":!0});this.props.combatant.portrait&&(a=r.a.createElement(K,{source:this.props.combatant,inline:!0,grabber:!0}));var n=null;if(!this.props.minimal){var s=this.props.combatant.race||"unknown race",i=this.props.combatant.classes||"unknown class";n=r.a.createElement("div",{className:"section lowercase"},s+" "+i+", level "+this.props.combatant.level)}var o=[];this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find((function(t){return t.id===e.props.combatant.id}))||o.push(r.a.createElement(Q,{key:"not-on-map",white:!0},r.a.createElement("span",null,"not on the map"),r.a.createElement(F.a,{type:"environment",className:"icon-button",onClick:function(){return e.props.addToMap(e.props.combatant)}}))),this.props.combatant.showOnMap||o.push(r.a.createElement(Q,{key:"hidden",white:!0},"hidden"))),this.props.combatant.tags.forEach((function(e){o.push(r.a.createElement(Q,{key:e,white:!0},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},f.getTagTitle(e)),f.getTagDescription(e))))})),this.props.combatant.conditions&&this.props.combatant.conditions.forEach((function(t){var a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),t.duration&&(a+=" "+f.conditionDurationText(t,e.props.combat));for(var n=[],s=f.conditionText(t),i=0;i!==s.length;++i)n.push(r.a.createElement("div",{key:i,className:"condition-text"},s[i]));o.push(r.a.createElement(Q,{key:t.id,white:!0},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},a),n)))})),this.props.combatant.note&&o.push(r.a.createElement(Q,{key:"text",white:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Ot.makeHtml(this.props.combatant.note)}})));var c=null;return this.props.combatant.companions.length>0&&(c=r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"companions:")," ",this.props.combatant.companions.map((function(e){return e.name})).join(", "))),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"header"},a,r.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",this.props.combatant.player?" / "+this.props.combatant.player:""),r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},n,o,c))}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Dt.defaultProps={minimal:!1};var Vt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),!this.props.selected&&this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;this.props.selected&&(t+=" highlight"),this.props.combatant.defeated&&(t+=" defeated");var a=r.a.createElement(F.a,{type:"menu",className:"grabber small","data-movable-handle":!0});this.props.combatant.portrait&&(a=r.a.createElement(K,{source:this.props.combatant,inline:!0,grabber:!0}));var n=(this.props.combatant.hp?this.props.combatant.hp:0).toString();this.props.combatant.hpTemp>0&&(n+="+"+this.props.combatant.hpTemp);var s=null;this.props.combatant.pending||(s=r.a.createElement(pe,{combatant:this.props.combatant}));var i=[];this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find((function(t){return t.id===e.props.combatant.id}))||i.push(r.a.createElement(Q,{key:"not-on-map",white:!0},r.a.createElement("span",null,"not on the map"),r.a.createElement(F.a,{type:"environment",className:"icon-button",onClick:function(){return e.props.addToMap(e.props.combatant)}}))),this.props.combatant.showOnMap||i.push(r.a.createElement(Q,{key:"hidden",white:!0},"hidden"))),this.props.combatant.tags.forEach((function(e){i.push(r.a.createElement(Q,{key:e,white:!0},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},f.getTagTitle(e)),f.getTagDescription(e))))})),this.props.combatant.conditions&&this.props.combatant.conditions.forEach((function(t){var a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),t.duration&&(a+=" "+f.conditionDurationText(t,e.props.combat));for(var n=[],s=f.conditionText(t),o=0;o!==s.length;++o)n.push(r.a.createElement("div",{key:o,className:"condition-text"},s[o]));i.push(r.a.createElement(Q,{key:t.id,white:!0},r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},a),n)))})),this.props.combatant.note&&i.push(r.a.createElement(Q,{key:"text",white:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Ot.makeHtml(this.props.combatant.note)}})));var o=null;return this.props.minimal||(o=r.a.createElement("div",null,r.a.createElement("div",{className:"section key-stats"},r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-label"},"ac"),r.a.createElement("div",{className:"stat-value"},this.props.combatant.ac)),r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-value"},n),r.a.createElement("div",{className:"stat-label"},"hp"))),s)),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"header"},a,r.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant"),r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},o,i))}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Vt.defaultProps={minimal:!1};var Tt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={view:"position"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"getPositionSection",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"move"),r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"eight",click:function(t){return e.props.move(e.props.item,t)}})),r.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"resize"),r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"both",click:function(t,a){return e.props.resize(e.props.item,t,a)}}))))}},{key:"getStyleSection",value:function(){var e=this,t=["overlay","token"].map((function(e){return{id:e,text:e}})),a=["square","rounded","circle"].map((function(e){return{id:e,text:e}}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"type"),r.a.createElement(ce,{options:t,selectedID:this.props.item.type,select:function(t){return e.props.changeValue(e.props.item,"type",t)}}),r.a.createElement("div",{style:{display:"overlay"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"shape"),r.a.createElement(ce,{options:a,selectedID:this.props.item.style,select:function(t){return e.props.changeValue(e.props.item,"style",t)}}),r.a.createElement("div",{className:"subheading"},"color"),r.a.createElement("input",{type:"color",value:this.props.item.color,onChange:function(t){return e.props.changeValue(e.props.item,"color",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"opacity"),r.a.createElement(xt.a,{min:0,max:255,value:this.props.item.opacity,tooltipVisible:!1,onChange:function(t){return e.props.changeValue(e.props.item,"opacity",t)}})),r.a.createElement("div",{style:{display:"token"===this.props.item.type?"block":"none"}},r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(H,{source:this.props.item,name:"size",nudgeValue:function(t){return e.props.nudgeValue(e.props.item,"size",t)}})))}},{key:"getNotesSection",value:function(){var e=this;return this.props.note?r.a.createElement("div",null,r.a.createElement(q,{text:this.props.note.text,placeholder:"details",lines:5,onChange:function(t){return e.props.changeValue(e.props.note,"text",t)}}),r.a.createElement("button",{onClick:function(){return e.props.removeNote(e.props.item.id)}},"remove note")):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addNote(e.props.item.id)}},"add a note"))}},{key:"render",value:function(){var e=this;try{var t=["position","style","notes"].map((function(e){return{id:e,text:e}})),a=null;switch(this.state.view){case"position":a=this.getPositionSection();break;case"style":a=this.getStyleSection();break;case"notes":a=this.getNotesSection()}return r.a.createElement("div",{className:"card map",key:"selected"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},"map item")),r.a.createElement("div",{className:"card-content"},r.a.createElement(ce,{options:t,selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.remove(e.props.item)}},"remove from the map"))))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Pt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={view:"main",damageOrHealing:0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setDamage",value:function(e){this.setState({damageOrHealing:e})}},{key:"nudgeDamage",value:function(e){this.setState({damageOrHealing:Math.max(this.state.damageOrHealing+e,0)})}},{key:"setView",value:function(e){this.setState({view:e})}},{key:"heal",value:function(){var e=this,t=this.props.combatant,a=(t.hp?t.hp:0)+this.state.damageOrHealing;a=Math.min(a,t.hpMax),this.setState({damageOrHealing:0},(function(){e.props.changeHP(t,a,t.hpTemp,0)}))}},{key:"damage",value:function(){var e=this,t=this.props.combatant,a=t.hp?t.hp:0,n=t.hpTemp,r=this.state.damageOrHealing,s=r,i=Math.min(s,n);s-=i,n-=i,a-=s,a=Math.max(a,0),this.setState({damageOrHealing:0},(function(){e.props.changeHP(t,a,n,r)}))}},{key:"getMainSection",value:function(){var e=this;if(this.props.combatant.pending&&!this.props.combatant.active&&!this.props.combatant.defeated)return r.a.createElement("div",{className:"section"},"pending initiative entry");if(!this.props.combatant.pending&&this.props.combatant.active&&!this.props.combatant.defeated){var t=[];return this.props.combatant.current?t.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(e.props.combatant)}},"mark as defeated and end turn")):(t.push(r.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(e.props.combatant)}},"start turn")),t.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(e.props.combatant)}},"mark as defeated"))),r.a.createElement("div",null,t,r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"conc.",display:"button",checked:this.props.combatant.tags.includes("conc"),changeValue:function(t){return e.props.toggleTag(e.props.combatant,"conc")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"bane",display:"button",checked:this.props.combatant.tags.includes("bane"),changeValue:function(t){return e.props.toggleTag(e.props.combatant,"bane")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"bless",display:"button",checked:this.props.combatant.tags.includes("bless"),changeValue:function(t){return e.props.toggleTag(e.props.combatant,"bless")}}))),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"prone",display:"button",checked:this.props.combatant.conditions.some((function(e){return"prone"===e.name})),changeValue:function(t){return e.props.toggleCondition(e.props.combatant,"prone")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"uncon.",display:"button",checked:this.props.combatant.conditions.some((function(e){return"unconscious"===e.name})),changeValue:function(t){return e.props.toggleCondition(e.props.combatant,"unconscious")}})),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"hidden",display:"button",checked:!this.props.combatant.showOnMap,disabled:"no-map"===this.props.tactical,changeValue:function(t){return e.props.changeValue(e.props.combatant,"showOnMap",!t)}}))),r.a.createElement("div",null,r.a.createElement(q,{text:this.props.combatant.note,placeholder:"notes",lines:3,onChange:function(t){return e.props.changeValue(e.props.combatant,"note",t)}})))}return this.props.combatant.pending||this.props.combatant.active||!this.props.combatant.defeated?null:r.a.createElement("button",{onClick:function(){return e.props.makeActive(e.props.combatant)}},"mark as active")}},{key:"getHPSection",value:function(){var e=this;if("monster"===this.props.combatant.type){var t=this.props.combatant,a=null;return null!==t.hp&&t.hp<=0&&(a=this.props.combatant.current?r.a.createElement("button",{onClick:function(){return e.props.makeDefeated(e.props.combatant)}},"mark as defeated and end turn"):r.a.createElement("button",{onClick:function(){return e.props.makeDefeated(e.props.combatant)}},"mark as defeated")),r.a.createElement("div",null,r.a.createElement(H,{source:this.props.combatant,name:"hp",label:"hit points",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hp",t)}}),r.a.createElement(H,{source:this.props.combatant,name:"hpTemp",label:"temp hp",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hpTemp",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section",style:{display:""!==t.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",t.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==t.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",t.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==t.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",t.damage.immune),r.a.createElement(H,{source:this.state,name:"damageOrHealing",factors:[1,10],nudgeValue:function(t){return e.nudgeDamage(t)}}),r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.heal()}},"heal")),r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.setDamage(0)}},"reset")),r.a.createElement(h.a,{span:8},r.a.createElement("button",{className:0===this.state.damageOrHealing?"disabled":"",onClick:function(){return e.damage()}},"damage"))),a)}}},{key:"getConditionSection",value:function(){var e=this,t=null;if("monster"===this.props.combatant.type){var a=this.props.combatant;t=r.a.createElement("div",{className:"section",style:{display:""!==a.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",a.conditionImmunities)}return r.a.createElement("div",null,t,r.a.createElement(wt,{combatant:this.props.combatant,combat:this.props.combat,addCondition:function(){return e.props.addCondition(e.props.combatant)},editCondition:function(t){return e.props.editCondition(e.props.combatant,t)},removeCondition:function(t){return e.props.removeCondition(e.props.combatant,t)},nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)}}))}},{key:"getMapSection",value:function(){var e=this;if("on-map"===this.props.tactical){var t=null;if(this.props.combatant.aura.radius>0){t=r.a.createElement("div",null,r.a.createElement(ce,{options:[{id:"square",text:"square"},{id:"rounded",text:"rounded"},{id:"circle",text:"circle"}],selectedID:this.props.combatant.aura.style,select:function(t){return e.props.changeValue(e.props.combatant.aura,"style",t)}}),r.a.createElement("input",{type:"color",value:this.props.combatant.aura.color,onChange:function(t){return e.props.changeValue(e.props.combatant.aura,"color",t.target.value)}}))}return r.a.createElement("div",null,r.a.createElement("div",{className:"section centered"},r.a.createElement(Te,{direction:"eight",click:function(t){return e.props.mapMove(e.props.combatant,t)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement(H,{source:this.props.combatant,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"altitude",5*t)}}),r.a.createElement(Y,{text:"aura"},r.a.createElement(H,{source:this.props.combatant.aura,name:"radius",label:"size",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant.aura,"radius",5*t)}}),t),r.a.createElement("button",{onClick:function(){return e.props.mapRemove(e.props.combatant)}},"remove from map"))}return r.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(e.props.combatant)}},"add to map")}},{key:"getAdvancedSection",value:function(){var e=this,t=null;this.props.combatant.current||(t=r.a.createElement(D,{text:"remove from encounter",callback:function(){return e.props.removeCombatant(e.props.combatant)}}));var a=null;return this.props.combatant.pending||(a=r.a.createElement(Y,{text:"change initiative score"},r.a.createElement("p",null,"adjusting initiative will re-sort the initiative order"),r.a.createElement("p",null,"if you have manually changed the initiative order, your changes will be lost"),r.a.createElement(H,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}))),r.a.createElement("div",null,t,r.a.createElement(Y,{text:"change name"},r.a.createElement(q,{text:this.props.combatant.displayName,onChange:function(t){return e.props.changeValue(e.props.combatant,"displayName",t)}})),r.a.createElement(Y,{text:"change size"},r.a.createElement(H,{source:this.props.combatant,name:"displaySize",label:"size",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"displaySize",t)}})),a)}},{key:"render",value:function(){var e=this;try{var t=["main","hp","cond","map","adv"].map((function(e){return{id:e,text:e}}));"no-map"===this.props.tactical&&t.splice(3,1),"pc"===this.props.combatant.type&&t.splice(1,1);var a=null;switch(this.state.view){case"main":a=this.getMainSection();break;case"hp":a=this.getHPSection();break;case"cond":a=this.getConditionSection();break;case"map":a=this.getMapSection();break;case"adv":a=this.getAdvancedSection()}return r.a.createElement("div",{className:"group-panel combat-controls"},r.a.createElement(ce,{options:t,selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),At=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{if(!this.props.hasMonsters)return r.a.createElement(d.a,{type:"flex",justify:"center",align:"middle",className:"scrollable"},r.a.createElement(h.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Et,null,r.a.createElement("div",{className:"section"},"this screen is for building encounters, but before you can do that you need to do these things first:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:this.props.hasMonsters?"strikethrough":""},"add some monsters in the ",r.a.createElement("button",{className:"link",onClick:function(){return e.props.setView("library")}},"monsters screen")),this.props.hasMonsters?r.a.createElement(F.a,{type:"check-circle",title:"done",style:{marginLeft:"5px"}}):null)))));var t=this.props.encounters.map((function(t){return r.a.createElement(zt,{key:t.id,encounter:t,open:function(t){return e.props.selectEncounter(t)},delete:function(t){return e.props.deleteEncounter(t)},openStatBlock:function(t){return e.props.openStatBlock(t.monsterGroupName,t.monsterName)},getMonster:function(t,a){return e.props.getMonster(t,a)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"on this page you can set up encounters"),r.a.createElement("div",{className:"section"},"when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can then run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of encounters that you have created"),r.a.createElement("div",{className:"section"},"select an encounter from the list to add monsters to it"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start building an encounter, press the ",r.a.createElement("b",null,"create a new encounter")," button")),r.a.createElement("button",{onClick:function(){return e.props.addEncounter()}},"create a new encounter")),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{heading:"encounters",content:t})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),zt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getText",value:function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("div",{className:"name"},t)}},{key:"getPortrait",value:function(e){var t=this.props.getMonster(e.monsterName,e.monsterGroupName);return t&&t.portrait?r.a.createElement(K,{source:t,inline:!0}):null}},{key:"render",value:function(){var e=this;try{var t=this.props.encounter.slots.map((function(t){return r.a.createElement("div",{key:t.id,className:"monster-row"},e.getPortrait(t),e.getText(t),r.a.createElement(F.a,{className:"info-icon",type:"info-circle",onClick:function(){return e.props.openStatBlock(t)}}))}));return 0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),this.props.encounter.waves.forEach((function(a){t.push(r.a.createElement("div",{key:"name "+a.id,className:"section subheading"},a.name||"unnamed wave")),a.slots.forEach((function(a){t.push(r.a.createElement("div",{key:a.id,className:"monster-row"},e.getPortrait(a),e.getText(a),r.a.createElement(F.a,{className:"info-icon",type:"info-circle",onClick:function(){return e.props.openStatBlock(a)}})))})),0===t.length&&t.push(r.a.createElement("div",{key:"empty "+a.id,className:"section"},"no monsters"))})),r.a.createElement("div",{className:"card encounter"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.encounter.name||"unnamed encounter")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"subheading"},"monsters"),t,r.a.createElement("div",{className:"subheading"},"xp"),O.getEncounterXP(this.props.encounter,this.props.getMonster)),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.open(e.props.encounter)}},"open"),r.a.createElement(D,{text:"delete",callback:function(){return e.props.delete(e.props.encounter)}})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Gt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={filter:g.createMonsterFilter()},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"matchMonster",value:function(e){return O.matchMonster(e,this.state.filter)}},{key:"changeFilterValue",value:function(e,t){var a=this.state.filter;a[e]=t,this.setState({filter:a})}},{key:"nudgeFilterValue",value:function(e,t){var a=f.nudgeChallenge(this.state.filter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({filter:g.createMonsterFilter()})}},{key:"getMonsterCards",value:function(e,t){var a=this,n=[];return e.forEach((function(e){var s=a.props.getMonster(e.monsterName,e.monsterGroupName);s?n.push(r.a.createElement(se,{monster:s,slot:e,encounter:a.props.encounter,mode:"view encounter",library:a.props.library,nudgeValue:function(e,t,n){return a.props.nudgeValue(e,t,n)},removeEncounterSlot:function(e){return a.props.removeEncounterSlot(e,t)},swapEncounterSlot:function(e,n,r){return a.props.swapEncounterSlot(e,t,n,r)}})):n.push(r.a.createElement("div",{className:"card error"},r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"subheading"},"unknown monster"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"could not find a monster called '",r.a.createElement("b",null,e.monsterName),"' in a group called '",r.a.createElement("b",null,e.monsterGroupName,"'")),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return a.props.removeEncounterSlot(e,t)}},"remove"))))})),0===e.length&&(t?n.push(r.a.createElement(Q,null,"there are no monsters in this wave")):n.push(r.a.createElement(Q,null,r.a.createElement("p",null,"there are no monsters in this encounter"),r.a.createElement("p",null,"you can add monsters from the list below, or try 'build a random encounter'")))),n}},{key:"getLibrarySection",value:function(){var e=this,t=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){e.matchMonster(a)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var a=t.map((function(t){return r.a.createElement(se,{key:t.id,monster:t,encounter:e.props.encounter,library:e.props.library,mode:"view encounter",addEncounterSlot:function(t,a){return e.props.addEncounterSlot(t,a)}})}));return 0===a.length&&a.push(r.a.createElement(Q,null,r.a.createElement("p",null,"there are no monsters that meet the criteria ",r.a.createElement("i",null,O.getFilterDescription(this.state.filter))))),r.a.createElement(Ze,{heading:"monster library",content:a,showToggle:!0})}},{key:"render",value:function(){var e=this;try{var t=this.props.encounter.waves.map((function(t){return r.a.createElement(Ze,{key:t.id,heading:t.name||"unnamed wave",content:e.getMonsterCards(t.slots,t.id)})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Rt,{encounter:this.props.encounter,parties:this.props.parties,monsterFilter:this.state.filter,goBack:function(){return e.props.goBack()},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},addWave:function(){return e.props.addWave()},removeWave:function(t){return e.props.removeWave(t)},clearEncounter:function(){return e.props.clearEncounter()},removeEncounter:function(){return e.props.removeEncounter()},buildEncounter:function(t){return e.props.buildEncounter(t,e.state.filter)},getMonster:function(t,a){return e.props.getMonster(t,a)},changeFilterValue:function(t,a){return e.changeFilterValue(t,a)},nudgeFilterValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}})),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{content:this.getMonsterCards(this.props.encounter.slots,null),heading:this.props.encounter.name||"unnamed encounter"}),t,this.getLibrarySection()))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Rt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={randomEncounterXP:100,randomEncounterStep:100},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setRandomEncounterXP",value:function(e){this.setState({randomEncounterXP:Math.max(0,e)})}},{key:"setRandomEncounterStep",value:function(e){this.setState({randomEncounterStep:e})}},{key:"render",value:function(){var e=this;try{var t=this.props.encounter.waves.map((function(t){return r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement(q,{text:t.name,placeholder:"wave name",onChange:function(a){return e.props.changeValue(t,"name",a)}}),r.a.createElement(D,{text:"delete wave",callback:function(){return e.props.removeWave(t)}}))}));return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"encounter name"),r.a.createElement(q,{text:this.props.encounter.name,placeholder:"encounter name",onChange:function(t){return e.props.changeValue(e.props.encounter,"name",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"waves"),t,r.a.createElement("button",{onClick:function(){return e.props.addWave()}},"add a new wave")),r.a.createElement("div",{className:"divider"}),r.a.createElement(ue,{encounter:this.props.encounter,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(ie,{filter:this.props.monsterFilter,changeValue:function(t,a){return e.props.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.props.nudgeFilterValue(t,a)},resetFilter:function(){return e.props.resetFilter()}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(Y,{text:"build a random encounter"},r.a.createElement("p",null,"add random monsters to this encounter until its adjusted xp value is at least the following value"),r.a.createElement(H,{source:this.state,name:"randomEncounterXP",label:"xp",nudgeValue:function(t){return e.setRandomEncounterXP(e.state.randomEncounterXP+t*e.state.randomEncounterStep)}}),r.a.createElement(ce,{options:["10","100","1000"].map((function(e){return{id:e,text:e}})),selectedID:this.state.randomEncounterStep.toString(),select:function(t){return e.setRandomEncounterStep(Number.parseInt(t,10))}}),r.a.createElement("button",{onClick:function(){return e.props.buildEncounter(e.state.randomEncounterXP)}},"build encounter")),r.a.createElement(D,{text:"clear encounter",callback:function(){return e.props.clearEncounter()}}),r.a.createElement(D,{text:"delete encounter",callback:function(){return e.props.removeEncounter()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.goBack()}},r.a.createElement(F.a,{type:"caret-left",style:{fontSize:"10px"}})," back to the list")))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Lt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{type:"flex",justify:"center",align:"middle",className:"scrollable"},r.a.createElement(h.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Et,null,r.a.createElement("div",{className:"heading"},"welcome to ",r.a.createElement("span",{className:"app-name"},"dojo")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("span",{className:"app-name"},"dojo")," is an app for dms of dungeons and dragons fifth edition"),r.a.createElement("div",{className:"section"},"with this app you can:"),r.a.createElement("ul",null,r.a.createElement("li",null,"build unique, challenging monsters"),r.a.createElement("li",null,"create encounters of just the right difficulty for your players"),r.a.createElement("li",null,"design intricate tactical maps - or have the app generate them for you"),r.a.createElement("li",null,"run combat without the book-keeping")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"use the buttons at the bottom of the screen to explore the app's main features, or press the dm tools button at the top right for additional dm tools"))))}}]),t}(r.a.Component),Bt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.maps.map((function(t){return r.a.createElement(Ft,{key:t.id,map:t,editMap:function(t){return e.props.editMap(t)},removeMap:function(t){return e.props.deleteMap(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"on this page you can set up tactical maps"),r.a.createElement("div",{className:"section"},"when you have created a map you can use it in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of maps"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start a new map, press the ",r.a.createElement("b",null,"create a new map")," button")),r.a.createElement("button",{onClick:function(){return e.props.addMap()}},"create a new map"),r.a.createElement(Y,{text:"map generator"},r.a.createElement("button",{onClick:function(){return e.props.generateMap("dungeon")}},"create a new dungeon map"),r.a.createElement("button",{onClick:function(){return e.props.generateMap("delve")}},"create a new delve map"))),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{heading:"maps",content:t})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ft=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"card map"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.map.name||"unnamed map")),r.a.createElement("div",{className:"card-content"},r.a.createElement(d.a,{type:"flex",justify:"center",align:"middle",className:"fixed-height"},r.a.createElement(h.a,{span:24},r.a.createElement(he,{map:this.props.map,mode:"thumbnail",size:12}))),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.editMap(e.props.map)}},"edit map"),r.a.createElement(D,{text:"delete map",callback:function(){return e.props.removeMap(e.props.map)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Yt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{if(!this.props.hasMonsters)return r.a.createElement(d.a,{type:"flex",justify:"center",align:"middle",className:"scrollable"},r.a.createElement(h.a,{xs:20,sm:18,md:16,lg:12,xl:10},r.a.createElement(Et,null,r.a.createElement("div",{className:"section"},"to kickstart your monster collection, let's import all the monsters from the ",r.a.createElement("a",{href:"http://dnd.wizards.com/articles/features/systems-reference-document-srd",target:"_blank",rel:"noopener noreferrer"},"d&d system reference document")),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.addOpenGameContent()}},"import monsters"))));var t=this.props.library.map((function(t){return r.a.createElement(Ht,{key:t.id,group:t,open:function(t){return e.props.selectMonsterGroup(t)},delete:function(t){return e.props.deleteMonsterGroup(t)},openStatBlock:function(t,a){return e.props.openStatBlock(t,a)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"you can maintain your menagerie of monsters here"),r.a.createElement("div",{className:"section"},"you can then use these monsters to design combat encounters in the encounter builder"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of monster groups"),r.a.createElement("div",{className:"section"},"select a monster group from the list to see stat blocks for monsters in that group"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start adding monsters, press the ",r.a.createElement("b",null,"create a new monster group")," button")),r.a.createElement("button",{onClick:function(){return e.props.addMonsterGroup()}},"create a new monster group")),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{heading:"monster groups",content:t})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ht=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showBreakdown:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"toggleBreakdown",value:function(){this.setState({showBreakdown:!this.state.showBreakdown})}},{key:"getMonsters",value:function(){var e=this,t=this.props.group.monsters.map((function(t){return r.a.createElement("div",{key:t.id,className:"monster-row"},r.a.createElement(K,{source:t,inline:!0}),r.a.createElement("div",{className:"name"},t.name||"unnamed monster"),r.a.createElement(F.a,{className:"info-icon",type:"info-circle",onClick:function(){return e.props.openStatBlock(e.props.group.name,t.name)}}))}));return 0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),t)}},{key:"getBreakdown",value:function(){var e=this;if(0===this.props.group.monsters.length)return r.a.createElement("div",{className:"section"},"no monsters");var t=b.map((function(t){return{text:t,value:e.props.group.monsters.filter((function(e){return e.size===t})).length}})),a=y.map((function(t){return{text:t,value:e.props.group.monsters.filter((function(e){return e.category===t})).length}})),n=[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].map((function(t){return{text:"cr "+f.challenge(t),value:e.props.group.monsters.filter((function(e){return e.challenge===t})).length}}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(De,{data:t}),r.a.createElement("div",{className:"subheading"},"category"),r.a.createElement(De,{data:a,collapse:!0}),r.a.createElement("div",{className:"subheading"},"challenge rating"),r.a.createElement(De,{data:n}))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"card monster"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.group.name||"unnamed group")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},this.state.showBreakdown?this.getBreakdown():this.getMonsters()),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.open(e.props.group)}},"open"),r.a.createElement(M,{label:"breakdown",checked:this.state.showBreakdown,changeValue:function(){return e.toggleBreakdown()}}),r.a.createElement(D,{text:"delete",callback:function(){return e.props.delete(e.props.group)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Wt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];return 0!==this.props.monsterGroup.monsters.length?this.props.monsterGroup.monsters.forEach((function(a){t.push(r.a.createElement(se,{monster:a,mode:"view editable",library:e.props.library,changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},moveToGroup:function(t,a){return e.props.moveToGroup(t,a)},removeMonster:function(t){return e.props.removeMonster(t)},editMonster:function(t){return e.props.editMonster(t)},cloneMonster:function(t,a){return e.props.cloneMonster(t,a)}}))})):t.push(r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"there are no monsters in this group"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(qt,{monsterGroup:this.props.monsterGroup,goBack:function(){return e.props.goBack()},addMonster:function(){return e.props.addMonster()},importMonster:function(){return e.props.importMonster()},sortMonsters:function(){return e.props.sortMonsters()},changeValue:function(t,a){return e.props.changeValue(e.props.monsterGroup,t,a)},removeMonsterGroup:function(){return e.props.removeMonsterGroup()}})),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{content:t,heading:this.props.monsterGroup.name||"unnamed group"})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),qt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getSummary",value:function(){if(0===this.props.monsterGroup.monsters.length)return r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,"no monsters"));var e={min:null,max:null};this.props.monsterGroup.monsters.forEach((function(t){e.min=null===e.min?t.challenge:Math.min(e.min,t.challenge),e.max=null===e.max?t.challenge:Math.max(e.max,t.challenge)}));var t=e.min===e.max?e.min.toString():e.min+" - "+e.max;return r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"challenge rating")),r.a.createElement("div",{className:"section"},t))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"monster group name"),r.a.createElement(q,{text:this.props.monsterGroup.name,placeholder:"monster group name",onChange:function(t){return e.props.changeValue("name",t)}})),r.a.createElement("div",{className:"divider"}),this.getSummary(),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.addMonster()}},"add a new monster"),r.a.createElement("button",{onClick:function(){return e.props.importMonster()}},"import a monster"),r.a.createElement("button",{onClick:function(){return e.props.sortMonsters()}},"sort monsters"),r.a.createElement(D,{text:"delete group",callback:function(){return e.props.removeMonsterGroup()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.goBack()}},r.a.createElement(F.a,{type:"caret-left",style:{fontSize:"10px"}})," back to the list")))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Jt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.parties.map((function(t){return r.a.createElement(_t,{key:t.id,party:t,open:function(t){return e.props.selectParty(t)},delete:function(t){return e.props.deleteParty(t)}})}));return r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"this page is where you can tell dojo all about your pcs"),r.a.createElement("div",{className:"section"},"you can add a party for each of your gaming groups"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"on the right you will see a list of parties that you have created"),r.a.createElement("div",{className:"section"},"select a party from the list to see pc details"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"to start adding a party, press the ",r.a.createElement("b",null,"create a new party")," button")),r.a.createElement("button",{onClick:function(){return e.props.addParty()}},"create a new party"),r.a.createElement("button",{onClick:function(){return e.props.importParty()}},"import a party")),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{heading:"parties",content:t})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),_t=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getText",value:function(e){var t=e.name||"unnamed pc";return e.player&&(t+=" ("+e.player+")"),t}},{key:"render",value:function(){var e=this;try{var t=this.props.party.pcs.filter((function(e){return e.active})).map((function(t){return r.a.createElement("div",{key:t.id,className:"pc-row"},r.a.createElement(K,{source:t,inline:!0}),r.a.createElement("div",{className:"name"},e.getText(t)))}));0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no pcs"));var a=this.props.party.pcs.filter((function(e){return!e.active}));return a.length>0&&(t.push(r.a.createElement("div",{key:"inactive",className:"subheading"},"inactive pcs")),a.forEach((function(a){return t.push(r.a.createElement("div",{key:a.id,className:"pc-row"},r.a.createElement(K,{source:a,inline:!0}),r.a.createElement("div",{className:"name"},e.getText(a))))}))),r.a.createElement("div",{className:"card pc"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.party.name||"unnamed party")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"fixed-height"},r.a.createElement("div",{className:"subheading"},"pcs"),t),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.open(e.props.party)}},"open"),r.a.createElement(D,{text:"delete",callback:function(){return e.props.delete(e.props.party)}})))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Xt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.party.pcs.filter((function(e){return e.active})),a=[];t.forEach((function(t){a.push(r.a.createElement(Xe,{pc:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},importPC:function(t){return e.props.importPC(t)},removePC:function(t){return e.props.removePC(t)}}))}));var n=this.props.party.pcs.filter((function(e){return!e.active})),s=[];return n.forEach((function(t){s.push(r.a.createElement(Xe,{pc:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},importPC:function(t){return e.props.importPC(t)},removePC:function(t){return e.props.removePC(t)}}))})),0===t.length&&a.push(r.a.createElement(Q,null,r.a.createElement("div",{className:"section"},"there are no pcs in this party"))),r.a.createElement(d.a,{className:"full-height"},r.a.createElement(h.a,{xs:12,sm:12,md:8,lg:6,xl:4,className:"scrollable sidebar left"},r.a.createElement(Kt,{party:this.props.party,goBack:function(){return e.props.goBack()},addPC:function(){return e.props.addPC()},sortPCs:function(){return e.props.sortPCs()},changeValue:function(t,a){return e.props.changeValue(e.props.party,t,a)},removeParty:function(){return e.props.removeParty()}})),r.a.createElement(h.a,{xs:12,sm:12,md:16,lg:18,xl:20,className:"scrollable"},r.a.createElement(Ze,{content:a,heading:this.props.party.name||"unnamed party"}),r.a.createElement(Ze,{content:s,heading:"inactive pcs"})))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Kt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getSummary",value:function(){var e=this.props.party.pcs.filter((function(e){return e.active}));if(0===e.length)return r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,"no pcs"));var t,a,n,s;t=e.map((function(e){return e.languages})).join(", ").split(/[ ,;]+/).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[]).sort((function(e,t){return"Common"===e?-1:"Common"===t?1:e.localeCompare(t)})).join(", ");var i={min:null,max:null},o={min:null,max:null},c={min:null,max:null};return e.forEach((function(e){i.min=null===i.min?e.passiveInsight:Math.min(i.min,e.passiveInsight),i.max=null===i.max?e.passiveInsight:Math.max(i.max,e.passiveInsight),o.min=null===o.min?e.passiveInvestigation:Math.min(o.min,e.passiveInvestigation),o.max=null===o.max?e.passiveInvestigation:Math.max(o.max,e.passiveInvestigation),c.min=null===c.min?e.passivePerception:Math.min(c.min,e.passivePerception),c.max=null===c.max?e.passivePerception:Math.max(c.max,e.passivePerception)})),a=i.min===i.max?i.min.toString():i.min+" - "+i.max,n=o.min===o.max?o.min.toString():o.min+" - "+o.max,s=c.min===c.max?c.min.toString():c.min+" - "+c.max,r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"section",style:{display:""!==t?"block":"none"}},r.a.createElement("div",{className:"subheading"},"party languages")),r.a.createElement("div",{className:"section"},t),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party passive skills")),r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"insight")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"invest.")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"percep."))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},a),r.a.createElement("div",{className:"cell three"},n),r.a.createElement("div",{className:"cell three"},s))))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party name"),r.a.createElement(q,{text:this.props.party.name,placeholder:"party name",onChange:function(t){return e.props.changeValue("name",t)}})),r.a.createElement("div",{className:"divider"}),this.getSummary(),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.addPC()}},"add a new pc"),r.a.createElement("button",{onClick:function(){return e.props.sortPCs()}},"sort pcs"),r.a.createElement(D,{text:"delete party",callback:function(){return e.props.removeParty()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.goBack()}},r.a.createElement(F.a,{type:"caret-left",style:{fontSize:"10px"}})," back to the list")))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ut=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).saveAfterDelay=f.debounce((function(){return a.saveAll()}),5e3);var n=[];try{var r=window.localStorage.getItem("data-parties");r&&(n=JSON.parse(r))}catch(g){console.error("Could not parse JSON: ",g)}var s=[];try{var i=window.localStorage.getItem("data-library");i&&(s=JSON.parse(i))}catch(g){console.error("Could not parse JSON: ",g)}var o=[];try{var l=window.localStorage.getItem("data-encounters");l&&(o=JSON.parse(l))}catch(g){console.error("Could not parse JSON: ",g)}var p=[];try{var d=window.localStorage.getItem("data-maps");d&&(p=JSON.parse(d))}catch(g){console.error("Could not parse JSON: ",g)}var h=[];try{var v=window.localStorage.getItem("data-combats");v&&(h=JSON.parse(v)).forEach((function(e){e.combatants.forEach((function(e){void 0===e.note&&(e.note="")})),e.map&&void 0===e.map.notes&&(e.map.notes=[]),void 0===e.report&&(e.report=[])}))}catch(g){console.error("Could not parse JSON: ",g)}return a.state={view:"home",navigation:!1,drawer:null,maximized:!1,parties:n,library:s,encounters:o,maps:p,combats:h,selectedPartyID:null,selectedMonsterGroupID:null,selectedEncounterID:null,selectedCombatID:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.saveAfterDelay()}},{key:"setView",value:function(e){this.save(),this.setState({view:e})}},{key:"openToolsDrawer",value:function(e){this.setState({drawer:{type:e}})}},{key:"toggleNavigation",value:function(){this.setState({navigation:!this.state.navigation})}},{key:"toggleMaximized",value:function(){this.setState({maximized:!this.state.maximized})}},{key:"closeDrawer",value:function(){this.setState({drawer:null})}},{key:"selectParty",value:function(e){this.setState({selectedPartyID:e?e.id:null})}},{key:"selectMonsterGroup",value:function(e){this.setState({selectedMonsterGroupID:e?e.id:null})}},{key:"selectEncounter",value:function(e){this.setState({selectedEncounterID:e?e.id:null})}},{key:"selectPartyByID",value:function(e){this.save(),this.setState({view:"parties",navigation:!1,selectedPartyID:e})}},{key:"selectMonsterGroupByID",value:function(e){this.save(),this.setState({view:"library",navigation:!1,selectedMonsterGroupID:e})}},{key:"selectEncounterByID",value:function(e){this.save(),this.setState({view:"encounters",navigation:!1,selectedEncounterID:e})}},{key:"selectMapByID",value:function(e){this.save(),this.setState({view:"maps",navigation:!1})}},{key:"selectCombatByID",value:function(e){this.save(),null!==this.state.selectedCombatID&&null===e?this.pauseCombat():this.setState({view:"combat",navigation:!1,selectedCombatID:e})}},{key:"resetAll",value:function(){var e=this;this.setState({parties:[],library:[],encounters:[],maps:[],combats:[],selectedPartyID:null,selectedMonsterGroupID:null,selectedEncounterID:null,selectedCombatID:null},(function(){return e.saveAll()}))}},{key:"getMonster",value:function(e,t){var a=this.state.library.find((function(e){return e.name===t}));if(a){var n=a.monsters.find((function(t){return t.name===e}));if(n)return n}return null}},{key:"changeValue",value:function(e,t,a){var n=this;switch(t){case"hp":a=Math.min(a,e.hpMax),a=Math.max(a,0);break;case"hpTemp":a=Math.max(a,0);break;case"level":a=Math.max(a,1),a=void 0!==e.player?Math.min(a,20):Math.min(a,6);break;case"count":case"hitDice":a=Math.max(a,1)}for(var r=t.split("."),s=e,i=0;i!==r.length;++i){var o=r[i];i===r.length-1?s[o]=a:s=s[o]}if(f.sort(this.state.parties),f.sort(this.state.library),f.sort(this.state.encounters),"initiative"===t&&!e.pending){var c=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));this.sortCombatants(c)}this.setState({parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,combats:this.state.combats,selectedPartyID:this.state.selectedPartyID,selectedMonsterGroupID:this.state.selectedMonsterGroupID,selectedEncounterID:this.state.selectedEncounterID,selectedCombatID:this.state.selectedCombatID,drawer:this.state.drawer})}},{key:"nudgeValue",value:function(e,t,a){for(var n=t.split("."),r=e,s=0;s!==n.length;++s){var i=n[s];if(s===n.length-1){var o=null;switch(i){case"challenge":o=f.nudgeChallenge(r[i],a);break;case"size":case"displaySize":o=f.nudgeSize(r[i],a);break;default:o=r[i]+a}this.changeValue(e,t,o)}else r=r[i]}}},{key:"addParty",value:function(){var e=g.createParty();e.name="new party";var t=[].concat(this.state.parties,[e]);f.sort(t),this.setState({parties:t,selectedPartyID:e.id})}},{key:"removeCurrentParty",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));t&&this.removeParty(t)}},{key:"removeParty",value:function(e){var t=this.state.parties.indexOf(e);this.state.parties.splice(t,1),this.setState({parties:this.state.parties,selectedPartyID:null})}},{key:"importParty",value:function(){this.setState({drawer:{type:"import-party",party:g.createParty()}})}},{key:"acceptImportedParty",value:function(){this.state.parties.push(this.state.drawer.party),this.setState({parties:this.state.parties,drawer:null})}},{key:"addPC",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=g.createPC();a.name="new pc",t.pcs.push(a),this.setState({parties:this.state.parties})}}},{key:"removePC",value:function(e){var t=this,a=this.state.parties.find((function(e){return e.id===t.state.selectedPartyID}));if(a){var n=a.pcs.indexOf(e);a.pcs.splice(n,1),this.setState({parties:this.state.parties})}}},{key:"sortPCs",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));t&&(f.sort(t.pcs),this.setState({parties:this.state.parties}))}},{key:"editPC",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"pc",pc:t}})}},{key:"importPC",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"update-pc",pc:t}})}},{key:"savePC",value:function(){var e=this;f.sort(this.state.drawer.pc.companions);var t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=t.pcs.find((function(t){return t.id===e.state.drawer.pc.id}));if(a){var n=t.pcs.indexOf(a);t.pcs[n]=this.state.drawer.pc,f.sort(t.pcs),this.setState({parties:this.state.parties,drawer:null})}}}},{key:"addMonsterGroup",value:function(){var e=g.createMonsterGroup();e.name="new group";var t=[].concat(this.state.library,[e]);f.sort(t),this.setState({library:t,selectedMonsterGroupID:e.id})}},{key:"removeCurrentMonsterGroup",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&this.removeMonsterGroup(t)}},{key:"removeMonsterGroup",value:function(e){var t=this.state.library.indexOf(e);this.state.library.splice(t,1),this.setState({library:this.state.library,selectedMonsterGroupID:null})}},{key:"addMonster",value:function(){var e=this,t=g.createMonster();t.name="new monster";var a=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));a&&(a.monsters.push(t),this.setState({library:this.state.library}))}},{key:"removeMonster",value:function(e){var t=this,a=this.state.library.find((function(e){return e.id===t.state.selectedMonsterGroupID}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1),this.setState({library:this.state.library})}}},{key:"importMonster",value:function(){this.setState({drawer:{type:"import-monster",monster:g.createMonster()}})}},{key:"acceptImportedMonster",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&(t.monsters.push(this.state.drawer.monster),this.setState({library:this.state.library,drawer:null}))}},{key:"sortMonsters",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&(f.sort(t.monsters),this.setState({library:this.state.library}))}},{key:"moveToGroup",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1);var r=this.state.library.find((function(e){return e.id===t}));r&&(r.monsters.push(e),f.sort(r.monsters),this.setState({library:this.state.library}))}}},{key:"editMonster",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"monster",monster:t,showSidebar:!1}})}},{key:"saveMonster",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));if(t){var a=t.monsters.find((function(t){return t.id===e.state.drawer.monster.id}));if(a){var n=t.monsters.indexOf(a);t.monsters[n]=this.state.drawer.monster,this.setState({library:this.state.library,drawer:null})}else t.monsters.push(this.state.drawer.monster),this.setState({library:this.state.library,drawer:null})}}},{key:"toggleShowSidebar",value:function(){var e=this.state.drawer;e.showSidebar=!e.showSidebar,this.setState({drawer:e})}},{key:"cloneMonster",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=k.clone(e,t);a.monsters.push(n),f.sort(a.monsters),this.setState({library:this.state.library})}}},{key:"addOpenGameContent",value:function(){var e=this;fetch("./data/monsters.json").then((function(e){return e.json()})).then((function(t){t.forEach((function(t){try{if(t.name){var a=k.createFromJSON(t),n=a.tag||a.category;0===n.indexOf("swarm")&&(n="swarm"),"any race"===n&&(n="npc");var r=e.state.library.find((function(e){return e.name===n}));r||(r={id:f.guid(),name:n,monsters:[]},e.state.library.push(r)),r.monsters.push(a)}}catch(s){console.error(s)}})),f.sort(e.state.library),e.setState({library:e.state.library})}))}},{key:"openMonsterInfoModal",value:function(e,t){var a=this.getMonster(t,e);a&&this.setState({drawer:{type:"monster-stat-block",monster:a}})}},{key:"addEncounter",value:function(){var e=g.createEncounter();e.name="new encounter";var t=[].concat(this.state.encounters,[e]);f.sort(t),this.setState({encounters:t,selectedEncounterID:e.id})}},{key:"clearEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));t&&(t.slots=[],t.waves=[],this.setState({encounters:this.state.encounters}))}},{key:"removeCurrentEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));t&&this.removeEncounter(t)}},{key:"removeEncounter",value:function(e){var t=this.state.encounters.indexOf(e);this.state.encounters.splice(t,1),this.setState({encounters:this.state.encounters,selectedEncounterID:null})}},{key:"buildEncounter",value:function(e,t){var a=this,n=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));n&&(n.slots=[],n.waves=[],O.buildEncounter(n,e,t,this.state.library,(function(e,t){return a.getMonster(e,t)})),this.sortEncounterSlots(n),this.setState({encounters:this.state.encounters}))}},{key:"addEncounterSlot",value:function(e,t){var a=this,n=this.state.library.find((function(t){return t.monsters.includes(e)}));if(n){var r=g.createEncounterSlot();r.monsterGroupName=n.name,r.monsterName=e.name;var s=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));if(s){if(null!==t){var i=s.waves.find((function(e){return e.id===t}));i&&(i.slots.push(r),this.sortEncounterSlots(i))}else s.slots.push(r),this.sortEncounterSlots(s);this.setState({encounters:this.state.encounters})}}}},{key:"removeEncounterSlot",value:function(e,t){var a=this,n=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));if(n){if(t){var r=n.waves.find((function(e){return e.id===t}));if(r){var s=r.slots.indexOf(e);r.slots.splice(s,1)}}else{var i=n.slots.indexOf(e);n.slots.splice(i,1)}this.setState({encounters:this.state.encounters})}}},{key:"swapEncounterSlot",value:function(e,t,a,n){var r=this,s=this.state.encounters.find((function(e){return e.id===r.state.selectedEncounterID}));if(s){if(e.monsterGroupName=a,e.monsterName=n,t){var i=s.waves.find((function(e){return e.id===t}));i&&this.sortEncounterSlots(i)}else this.sortEncounterSlots(s);this.setState({encounters:this.state.encounters})}}},{key:"sortEncounterSlots",value:function(e){e.slots.sort((function(e,t){var a=e.monsterName.toLowerCase(),n=t.monsterName.toLowerCase();return a<n?-1:a>n?1:0}))}},{key:"addWaveToEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));if(t){var a=g.createEncounterWave();a.name="wave "+(t.waves.length+2),t.waves.push(a),this.setState({encounters:this.state.encounters})}}},{key:"removeWave",value:function(e){var t=this,a=this.state.encounters.find((function(e){return e.id===t.state.selectedEncounterID}));if(a){var n=a.waves.indexOf(e);a.waves.splice(n,1),this.setState({encounters:this.state.encounters})}}},{key:"addMap",value:function(){var e=g.createMap();e.name="new map",this.state.maps.push(e),this.setState({maps:this.state.maps})}},{key:"generateMap",value:function(e){var t=g.createMap();t.name="new "+e,C.generate(e,t),this.state.maps.push(t),this.setState({maps:this.state.maps})}},{key:"editMap",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({drawer:{type:"map",map:t}})}},{key:"saveMap",value:function(){var e=this,t=this.state.maps.find((function(t){return t.id===e.state.drawer.map.id}));if(t){var a=this.state.maps.indexOf(t),n=this.state.maps;n[a]=this.state.drawer.map,this.setState({maps:n,drawer:null})}}},{key:"removeMap",value:function(e){var t=this.state.maps.indexOf(e);this.state.maps.splice(t,1),this.setState({maps:this.state.maps})}},{key:"createCombat",value:function(){var e=1===this.state.parties.length?this.state.parties[0]:null,t=1===this.state.encounters.length?this.state.encounters[0]:null,a=g.createCombatSetup();a.party=e,a.encounter=t,t&&(a.monsterNames=f.getMonsterNames(t)),this.setState({drawer:{type:"combat-start",combatSetup:a}})}},{key:"startCombat",value:function(){var e=this,t=this.state.drawer.combatSetup;if(t.party&&t.encounter){var a=t.party.name||"unnamed party",n=t.encounter.name||"unnamed encounter",r=g.createCombat();r.name=a+" vs "+n,r.encounter=JSON.parse(JSON.stringify(t.encounter));var s=g.createCombatReportEntry();s.type="combat-start",r.report.push(s),t.party.pcs.filter((function(e){return e.active})).forEach((function(t){e.addPCToCombat(t,r)})),r.encounter.slots.forEach((function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName);if(n)for(var s=f.dieRoll(),i=0;i!==a.count;++i){var o=null;if(t.monsterNames){var c=t.monsterNames.find((function(e){return e.id===a.id}));c&&(o=c.names[i])}e.addMonsterToCombat(n,r,o,t.encounterInitMode,s)}else r.issues.push("unknown monster: "+a.monsterName+" in group "+a.monsterGroupName)})),this.sortCombatants(r),t.map&&(r.map=JSON.parse(JSON.stringify(t.map))),this.setState({combats:[].concat(this.state.combats,[r]),selectedCombatID:r.id,drawer:null})}}},{key:"addPCToCombat",value:function(e,t){var a=JSON.parse(JSON.stringify(e));a.current=!1,a.pending=!0,a.active=!1,a.defeated=!1,a.displayName=e.name,a.displaySize=e.size,a.showOnMap=!0,a.initiative=10,a.hp=null,a.conditions=[],a.tags=[],a.note="",a.altitude=0,a.aura={radius:0,style:"rounded",color:"#005080"},t.combatants.push(a)}},{key:"addMonsterToCombat",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"individual",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=JSON.parse(JSON.stringify(e));switch(s.id=f.guid(),n){case"group":s.initiative=f.modifierValue(e.abilityScores.dex)+r;break;case"individual":s.initiative=f.modifierValue(e.abilityScores.dex)+f.dieRoll();break;default:s.initiative=10}s.current=!1,s.pending="manual"===n,s.active="manual"!==n,s.defeated=!1,s.displayName=a,s.displaySize=e.size,s.showOnMap=!0,s.hp=s.hpMax,s.conditions=[],s.tags=[],s.note="",s.altitude=0,s.aura={radius:0,style:"rounded",color:"#005080"},t.combatants.push(s)}},{key:"openWaveModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=g.createCombatSetup();a.encounter=t.encounter,a.monsterNames=f.getMonsterNames(t.encounter),this.setState({drawer:{type:"combat-wave",combatSetup:a}})}}},{key:"addToEncounter",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&this.setState({drawer:{type:"combat-add-combatants",combatantSlots:[],combat:t}})}},{key:"addCombatantsFromModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&(this.state.drawer.combatantSlots.forEach((function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName);if(n)for(var r=f.dieRoll(),s=0;s!==a.count;++s){var i=n.name;a.count>1&&(i+=" "+(s+1)),e.addMonsterToCombat(n,t,i,"group",r)}})),this.sortCombatants(t),this.setState({combats:this.state.combats,drawer:null}))}},{key:"pauseCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=g.createCombatReportEntry();a.type="combat-pause",t.report.push(a),this.setState({selectedCombatID:null,maximized:!1})}}},{key:"resumeCombat",value:function(e){var t=g.createCombatReportEntry();t.type="combat-resume",e.report.push(t),this.setState({selectedCombatID:e.id})}},{key:"endCurrentCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&this.endCombat(t)}},{key:"endCombat",value:function(e){var t=g.createCombatReportEntry();t.type="combat-end",e.report.push(t);var a=this.state.combats.indexOf(e);this.state.combats.splice(a,1),this.setState({combats:this.state.combats,selectedCombatID:null,maximized:!1})}},{key:"makeCurrent",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){if(n.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(a){if(a.duration)switch(a.duration.type){case"saves":n&&e&&t.id===e.id&&"start"===a.duration.point&&n.notifications.push({id:f.guid(),type:"condition-save",data:a,combatant:e});break;case"combatant":if(n&&e&&a.duration.combatantID===e.id&&"start"===a.duration.point){var r=t.conditions.indexOf(a);t.conditions.splice(r,1),n.notifications.push({id:f.guid(),type:"condition-end",data:a,combatant:e})}break;case"rounds":if(e&&t.id===e.id&&(a.duration.count-=1),0===a.duration.count){var s=t.conditions.indexOf(a);t.conditions.splice(s,1),n&&n.notifications.push({id:f.guid(),type:"condition-end",data:a,combatant:e})}}}))})),e&&"monster"===e.type&&(e.traits.filter((function(e){return e.uses>0&&e.usage.toLowerCase().startsWith("recharge ")})).forEach((function(t){n.notifications.push({id:f.guid(),type:"trait-recharge",data:t,combatant:e})})),e.traits.filter((function(e){return"legendary"===e.type})).forEach((function(e){e.uses=0}))),n.combatants.forEach((function(e){e.current=!1})),e&&(e.current=!0,"pc"===e.type)){var r=g.createCombatReportEntry();r.type="turn-start",r.combatantID=e.id,n.report.push(r)}t&&(n.round+=1),this.setState({combats:this.state.combats})}}},{key:"makeActive",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=e.pending;e.pending=!1,e.active=!0,e.defeated=!1,n&&this.sortCombatants(a),this.setState({combats:this.state.combats})}}},{key:"makeDefeated",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){if(e.pending=!1,e.active=!1,e.defeated=!0,"monster"===e.type){var n=a.combatants.find((function(e){return e.current}));if(n&&"pc"===n.type){var r=g.createCombatReportEntry();r.type="kill",r.combatantID=n.id,a.report.push(r)}a.map&&(a.map.items=a.map.items.filter((function(t){return t.id!==e.id})))}e.current?this.endTurn(e):this.setState({combats:this.state.combats})}}},{key:"addWaveToCombat",value:function(){var e=this,t=this.state.drawer.combatSetup,a=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t&&t.encounter&&a){var n=t.encounter.waves.find((function(e){return e.id===t.waveID}));n&&(n.slots.forEach((function(n){var r=e.getMonster(n.monsterName,n.monsterGroupName);if(r)for(var s=parseInt(f.modifier(r.abilityScores.dex),10),i=f.dieRoll(),o=0;o!==n.count;++o){var c=f.dieRoll(),l=JSON.parse(JSON.stringify(r));if(l.id=f.guid(),l.displayName=null,t.monsterNames){var u=t.monsterNames.find((function(e){return e.id===n.id}));u&&(l.displayName=u.names[o])}switch(l.displaySize=r.size,t.encounterInitMode){case"manual":l.initiative=10;break;case"group":l.initiative=s+i;break;case"individual":l.initiative=s+c}l.showOnMap=!0,l.current=!1,l.pending="manual"===e.state.drawer.combatSetup.encounterInitMode,l.active="manual"!==e.state.drawer.combatSetup.encounterInitMode,l.defeated=!1,l.hp=l.hpMax,l.conditions=[],l.tags=[],l.altitude=0,l.aura={radius:0,style:"rounded",color:"#005080"},a&&a.combatants.push(l)}else if(a){var m="unknown monster: "+n.monsterName+" in group "+n.monsterGroupName;a.issues.push(m)}})),this.sortCombatants(a),this.setState({combats:this.state.combats,drawer:null}))}}},{key:"moveCombatant",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r,s=n.combatants.splice(e,1);(r=n.combatants).splice.apply(r,[t,0].concat(Object(o.a)(s))),this.setState({combats:this.state.combats})}}},{key:"removeCombatant",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=a.combatants.indexOf(e);if(a.combatants.splice(n,1),a.map){var r=a.map.items.find((function(t){return t.id===e.id}));if(r){var s=a.map.items.indexOf(r);a.map.items.splice(s,1)}}this.setState({combats:this.state.combats})}}},{key:"mapAdd",value:function(e,t,a){var n=this,r=g.createMapItem();r.id=e.id,r.type=e.type,r.x=t,r.y=a;var s=1;"monster"===e.type&&(s=f.miniSize(e.size)),r.height=s,r.width=s;var i=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));i&&i.map&&(i.map.items.push(r),this.setState({combats:this.state.combats}))}},{key:"mapMove",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n&&n.map){var r=n.map.items.find((function(t){return t.id===e}));if(r){switch(t){case"N":r.y-=1;break;case"NE":r.x+=1,r.y-=1;break;case"E":r.x+=1;break;case"SE":r.x+=1,r.y+=1;break;case"S":r.y+=1;break;case"SW":r.x-=1,r.y+=1;break;case"W":r.x-=1;break;case"NW":r.x-=1,r.y-=1}if("pc"===r.type){var s=g.createCombatReportEntry();s.type="movement",s.combatantID=r.id,n.report.push(s)}this.setState({combats:this.state.combats})}}}},{key:"mapResize",value:function(e,t,a){var n=this,r=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));if(r&&r.map){var s=r.map.items.find((function(t){return t.id===e}));if(s){switch(a){case"in":switch(t){case"N":s.height>1&&(s.y+=1,s.height-=1);break;case"E":s.width>1&&(s.width-=1);break;case"S":s.height>1&&(s.height-=1);break;case"W":s.width>1&&(s.x+=1,s.width-=1)}break;case"out":switch(t){case"N":s.y-=1,s.height+=1;break;case"E":s.width+=1;break;case"S":s.height+=1;break;case"W":s.x-=1,s.width+=1}}this.setState({combats:this.state.combats})}}}},{key:"mapRemove",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=a.map.items.find((function(t){return t.id===e}));if(n){var r=a.map.items.indexOf(n);a.map.items.splice(r,1),this.setState({combats:this.state.combats})}}}},{key:"mapAddNote",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=g.createMapNote();n.targetID=e,a.map.notes.push(n),this.setState({combats:this.state.combats})}}},{key:"mapRemoveNote",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=a.map.notes.findIndex((function(t){return t.targetID===e}));a.map.notes.splice(n,1),this.setState({combats:this.state.combats})}}},{key:"endTurn",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){if("pc"===e.type){var n=g.createCombatReportEntry();n.type="turn-end",n.combatantID=e.id,a.report.push(n)}a.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(n){if(n.duration)switch(n.duration.type){case"saves":if(a&&t.id===e.id&&"end"===n.duration.point){var r=g.createNotification();r.type="condition-save",r.data=n,r.combatant=e,a.notifications.push(r)}break;case"combatant":if(a&&n.duration.combatantID===e.id&&"end"===n.duration.point){var s=t.conditions.indexOf(n);t.conditions.splice(s,1);var i=g.createNotification();i.type="condition-end",i.data=n,i.combatant=e,a.notifications.push(i)}}}))}));var r=a.combatants.filter((function(e){return e.current||!e.pending&&e.active&&!e.defeated}));if(0===r.length)this.makeCurrent(null,!1);else if(1===r.length&&r[0].defeated)this.makeCurrent(null,!1);else{var s=r.indexOf(e)+1,i=!1;s>=r.length&&(s=0,i=!0),this.makeCurrent(r[s],i)}}}},{key:"changeHP",value:function(e,t,a,n){var r=this,s=this.state.combats.find((function(e){return e.id===r.state.selectedCombatID}));if(s){e.hp=t,e.hpTemp=a;var i=s.combatants.find((function(e){return e.current}));if(i&&"pc"===i.type){var o=g.createCombatReportEntry();o.type="damage",o.combatantID=i.id,o.value=n,s.report.push(o)}this.setState({combats:this.state.combats})}}},{key:"addCondition",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=g.createCondition();n.name="blinded",this.setState({drawer:{type:"condition-add",condition:n,combatant:e,combat:a}})}}},{key:"addConditionFromModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=this.state.drawer.combatant.conditions;a.push(this.state.drawer.condition);var n=t.combatants.find((function(e){return e.current}));if(n&&"pc"===n.type){var r=g.createCombatReportEntry();r.type="condition-add",r.combatantID=n.id,t.report.push(r)}this.state.drawer.combatant.conditions=f.sort(a,[{field:"name",dir:"asc"}]),this.setState({combats:this.state.combats,drawer:null})}}},{key:"editCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&this.setState({drawer:{type:"condition-edit",condition:t,combatant:e,combat:n}})}},{key:"editConditionFromModal",value:function(){var e=this,t=this.state.drawer.combatant.conditions,a=t.find((function(t){return t.id===e.state.drawer.condition.id}));if(a){var n=t.indexOf(a);t[n]=this.state.drawer.condition,this.state.drawer.combatant.conditions=f.sort(t,[{field:"name",dir:"asc"}]),this.setState({combats:this.state.combats,drawer:null})}}},{key:"removeCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=e.conditions.find((function(e){return e.id===t}));if(r){var s=e.conditions.indexOf(r);e.conditions.splice(s,1);var i=n.combatants.find((function(e){return e.current}));if(i&&"pc"===i.type){var o=g.createCombatReportEntry();o.type="condition-remove",o.combatantID=i.id,n.report.push(o)}this.setState({combats:this.state.combats})}}}},{key:"sortCombatants",value:function(e){e.combatants.sort((function(e,t){return e.initiative&&t.initiative&&e.initiative<t.initiative?1:e.initiative&&t.initiative&&e.initiative>t.initiative?-1:e.displayName<t.displayName?-1:e.displayName>t.displayName?1:0}))}},{key:"closeNotification",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=n.notifications.indexOf(e);if(n.notifications.splice(r,1),t&&e.combatant&&e.data){var s=e.combatant.conditions.indexOf(e.data);e.combatant.conditions.splice(s,1)}this.setState({combats:this.state.combats})}}},{key:"toggleTag",value:function(e,t){e.tags.includes(t)?e.tags=e.tags.filter((function(e){return e!==t})):e.tags.push(t),this.setState({combats:this.state.combats})}},{key:"toggleCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=e.conditions.find((function(e){return e.name===t}));if(r)this.removeCondition(e,r.id);else{var s=g.createCondition();s.name=t,e.conditions.push(s),e.conditions=f.sort(e.conditions,[{field:"name",dir:"asc"}]);var i=n.combatants.find((function(e){return e.current}));if(i&&"pc"===i.type){var o=g.createCombatReportEntry();o.type="condition-add",o.combatantID=i.id,n.report.push(o)}this.setState({combats:this.state.combats})}}}},{key:"scatterCombatants",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(C.scatterCombatants(a,e),this.setState({combats:this.state.combats}))}},{key:"rotateMap",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&t.map&&(C.rotateMap(t.map),this.setState({combats:this.state.combats}))}},{key:"addMapItem",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(a.map.items.push(e),this.setState({combats:this.state.combats}))}},{key:"showLeaderboard",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&this.setState({drawer:{type:"leaderboard",combat:t}})}},{key:"save",value:function(){switch(this.state.view){case"parties":this.saveKey(this.state.parties,"data-parties");break;case"library":this.saveKey(this.state.library,"data-library");break;case"encounters":this.saveKey(this.state.encounters,"data-encounters");break;case"maps":this.saveKey(this.state.maps,"data-maps");break;case"combat":this.saveKey(this.state.combats,"data-combats")}}},{key:"saveAll",value:function(){this.saveKey(this.state.parties,"data-parties"),this.saveKey(this.state.library,"data-library"),this.saveKey(this.state.encounters,"data-encounters"),this.saveKey(this.state.maps,"data-maps"),this.saveKey(this.state.combats,"data-combats")}},{key:"saveKey",value:function(e,t){try{var a=JSON.stringify(e);console.info("Saving ("+t+"): "+f.toData(a.length)),window.localStorage.setItem(t,a)}catch(n){console.error("Could not stringify data: ",n)}}},{key:"getContent",value:function(){var e=this,t=!1;this.state.parties.forEach((function(e){return t=t||e.pcs.length>0}));var a=!1;switch(this.state.library.forEach((function(e){return a=a||e.monsters.length>0})),this.state.view){case"home":return r.a.createElement(Lt,null);case"parties":return this.state.selectedPartyID?r.a.createElement(Xt,{party:this.state.parties.find((function(t){return t.id===e.state.selectedPartyID})),goBack:function(){return e.selectParty(null)},removeParty:function(){return e.removeCurrentParty()},addPC:function(){return e.addPC()},editPC:function(t){return e.editPC(t)},importPC:function(t){return e.importPC(t)},removePC:function(t){return e.removePC(t)},sortPCs:function(){return e.sortPCs()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)}}):r.a.createElement(Jt,{parties:this.state.parties,addParty:function(){return e.addParty()},importParty:function(){return e.importParty()},selectParty:function(t){return e.selectParty(t)},deleteParty:function(t){return e.removeParty(t)}});case"library":return this.state.selectedMonsterGroupID?r.a.createElement(Wt,{monsterGroup:this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID})),library:this.state.library,goBack:function(){return e.selectMonsterGroup(null)},removeMonsterGroup:function(){return e.removeCurrentMonsterGroup()},addMonster:function(){return e.addMonster()},importMonster:function(){return e.importMonster()},removeMonster:function(t){return e.removeMonster(t)},sortMonsters:function(){return e.sortMonsters()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},editMonster:function(t){return e.editMonster(t)},cloneMonster:function(t,a){return e.cloneMonster(t,a)},moveToGroup:function(t,a){return e.moveToGroup(t,a)}}):r.a.createElement(Yt,{library:this.state.library,hasMonsters:a,addMonsterGroup:function(){return e.addMonsterGroup()},selectMonsterGroup:function(t){return e.selectMonsterGroup(t)},deleteMonsterGroup:function(t){return e.removeMonsterGroup(t)},addOpenGameContent:function(){return e.addOpenGameContent()},openStatBlock:function(t,a){return e.openMonsterInfoModal(t,a)}});case"encounters":return this.state.selectedEncounterID?r.a.createElement(Gt,{encounter:this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID})),parties:this.state.parties,library:this.state.library,goBack:function(){return e.selectEncounter(null)},clearEncounter:function(){return e.clearEncounter()},removeEncounter:function(){return e.removeCurrentEncounter()},buildEncounter:function(t,a){return e.buildEncounter(t,a)},addWave:function(){return e.addWaveToEncounter()},removeWave:function(t){return e.removeWave(t)},getMonster:function(t,a){return e.getMonster(t,a)},addEncounterSlot:function(t,a){return e.addEncounterSlot(t,a)},removeEncounterSlot:function(t,a){return e.removeEncounterSlot(t,a)},swapEncounterSlot:function(t,a,n,r){return e.swapEncounterSlot(t,a,n,r)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}}):r.a.createElement(At,{encounters:this.state.encounters,hasMonsters:a,addEncounter:function(){return e.addEncounter()},selectEncounter:function(t){return e.selectEncounter(t)},deleteEncounter:function(t){return e.removeEncounter(t)},getMonster:function(t,a){return e.getMonster(t,a)},setView:function(t){return e.setView(t)},openStatBlock:function(t,a){return e.openMonsterInfoModal(t,a)}});case"maps":return r.a.createElement(Bt,{maps:this.state.maps,addMap:function(){return e.addMap()},generateMap:function(t){return e.generateMap(t)},editMap:function(t){return e.editMap(t)},deleteMap:function(t){return e.removeMap(t)}});case"combat":return this.state.selectedCombatID?r.a.createElement(Mt,{combat:this.state.combats.find((function(t){return t.id===e.state.selectedCombatID})),encounters:this.state.encounters,maximized:this.state.maximized,maximize:function(){return e.toggleMaximized()},pauseCombat:function(){return e.pauseCombat()},endCombat:function(){return e.endCurrentCombat()},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},makeCurrent:function(t){return e.makeCurrent(t,!1)},makeActive:function(t){return e.makeActive(t)},makeDefeated:function(t){return e.makeDefeated(t)},moveCombatant:function(t,a){return e.moveCombatant(t,a)},removeCombatant:function(t){return e.removeCombatant(t)},addCombatants:function(){return e.addToEncounter()},addWave:function(){return e.openWaveModal()},addCondition:function(t){return e.addCondition(t)},editCondition:function(t,a){return e.editCondition(t,a)},removeCondition:function(t,a){return e.removeCondition(t,a)},mapAdd:function(t,a,n){return e.mapAdd(t,a,n)},mapResize:function(t,a,n){return e.mapResize(t,a,n)},mapMove:function(t,a){return e.mapMove(t,a)},mapRemove:function(t){return e.mapRemove(t)},mapAddNote:function(t){return e.mapAddNote(t)},mapRemoveNote:function(t){return e.mapRemoveNote(t)},endTurn:function(t){return e.endTurn(t)},changeHP:function(t,a,n,r){return e.changeHP(t,a,n,r)},closeNotification:function(t,a){return e.closeNotification(t,a)},toggleTag:function(t,a){return e.toggleTag(t,a)},toggleCondition:function(t,a){return e.toggleCondition(t,a)},scatterCombatants:function(t){return e.scatterCombatants(t)},rotateMap:function(){return e.rotateMap()},addOverlay:function(t){return e.addMapItem(t)},showLeaderboard:function(){return e.showLeaderboard()}}):r.a.createElement(kt,{combats:this.state.combats,hasPCs:t,hasMonsters:a,createCombat:function(){return e.createCombat()},resumeCombat:function(t){return e.resumeCombat(t)},deleteCombat:function(t){return e.endCombat(t)},setView:function(t){return e.setView(t)}})}return null}},{key:"getDrawer",value:function(){var e=this,t=null,a=null,n=null,s="50%",i=!1;if(this.state.drawer)switch(this.state.drawer.type){case"import-party":t=r.a.createElement(Qe,{party:this.state.drawer.party}),a="import party",n=r.a.createElement("button",{onClick:function(){return e.acceptImportedParty()}},"accept party"),i=!0;break;case"pc":t=r.a.createElement($e,{pc:this.state.drawer.pc}),a="pc editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.savePC()}},"save changes")),r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes")));break;case"update-pc":t=r.a.createElement(et,{pc:this.state.drawer.pc}),a="update pc",n=r.a.createElement("button",{onClick:function(){return e.savePC()}},"accept pc"),i=!0;break;case"monster":t=r.a.createElement(We,{monster:this.state.drawer.monster,library:this.state.library,showSidebar:this.state.drawer.showSidebar}),a="monster editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:8},r.a.createElement("button",{onClick:function(){return e.saveMonster()}},"save changes")),r.a.createElement(h.a,{span:8},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes")),r.a.createElement(h.a,{span:8},r.a.createElement(M,{label:"advanced tools",checked:this.state.drawer.showSidebar,changeValue:function(){return e.toggleShowSidebar()}}))),s="75%";break;case"monster-stat-block":t=r.a.createElement(Je,{monster:this.state.drawer.monster}),a="monster",i=!0;break;case"import-monster":t=r.a.createElement(qe,{monster:this.state.drawer.monster}),a="import monster",n=r.a.createElement("button",{onClick:function(){return e.acceptImportedMonster()}},"accept monster"),i=!0;break;case"map":t=r.a.createElement(Ae,{map:this.state.drawer.map}),a="map editor",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.saveMap()}},"save changes")),r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes"))),s="75%";break;case"combat-start":t=r.a.createElement(ye,{combatSetup:this.state.drawer.combatSetup,parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({drawer:e.state.drawer})}}),a="start combat",n=r.a.createElement("button",{className:this.state.drawer.combatSetup.party&&this.state.drawer.combatSetup.encounter?"":"disabled",onClick:function(){return e.startCombat()}},"start encounter"),s="75%",i=!0;break;case"combat-wave":t=r.a.createElement(ye,{combatSetup:this.state.drawer.combatSetup,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({drawer:e.state.drawer})}}),a="add a wave",n=r.a.createElement("button",{className:null!==this.state.drawer.combatSetup.waveID?"":"disabled",onClick:function(){return e.addWaveToCombat()}},"add wave"),s="75%",i=!0;break;case"combat-add-combatants":t=r.a.createElement(oe,{combatantSlots:this.state.drawer.combatantSlots,library:this.state.library}),a="add combatants",n=r.a.createElement("button",{onClick:function(){return e.addCombatantsFromModal()}},"add combatants"),i=!0;break;case"condition-add":t=r.a.createElement(Ie,{condition:this.state.drawer.condition,combatant:this.state.drawer.combatant,combat:this.state.drawer.combat}),a="add a condition",n=r.a.createElement("button",{onClick:function(){return e.addConditionFromModal()}},"add"),i=!0;break;case"condition-edit":t=r.a.createElement(Ie,{condition:this.state.drawer.condition,combatant:this.state.drawer.combatant,combat:this.state.drawer.combat}),a="edit condition",n=r.a.createElement(d.a,{gutter:10},r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.editConditionFromModal()}},"save changes")),r.a.createElement(h.a,{span:12},r.a.createElement("button",{onClick:function(){return e.closeDrawer()}},"discard changes")));break;case"leaderboard":t=r.a.createElement(Ve,{combat:this.state.drawer.combat}),a="leaderboard",i=!0;break;case"tools":t=r.a.createElement(ct,{library:this.state.library}),a="dm tools",i=!0;break;case"search":t=r.a.createElement(tt,{parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,openParty:function(t){return e.selectPartyByID(t)},openGroup:function(t){return e.selectMonsterGroupByID(t)},openEncounter:function(t){return e.selectEncounterByID(t)},openMap:function(t){return e.selectMapByID(t)}}),a="search",i=!0;break;case"about":t=r.a.createElement(T,{resetAll:function(){return e.resetAll()}}),a="about",i=!0}return{content:t,header:a,footer:n,width:s,closable:i}}},{key:"render",value:function(){var e=this;try{var t=this.state.maximized?null:r.a.createElement(bt,{view:this.state.view,openMenu:function(){return e.toggleNavigation()},openDrawer:function(t){return e.openToolsDrawer(t)}}),a=this.state.maximized?null:r.a.createElement(gt,{view:this.state.view,setView:function(t){return e.setView(t)}}),n=r.a.createElement(v.a,{placement:"left",closable:!1,maskClosable:!0,width:"25%",visible:this.state.navigation,onClose:function(){return e.toggleNavigation()}},r.a.createElement("div",{className:"drawer-header"}),r.a.createElement("div",{className:"drawer-content"},r.a.createElement(yt,{parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,maps:this.state.maps,combats:this.state.combats,openParty:function(t){return e.selectPartyByID(t)},openMonsterGroup:function(t){return e.selectMonsterGroupByID(t)},openEncounter:function(t){return e.selectEncounterByID(t)},openMap:function(t){return e.selectMapByID(t)},openCombat:function(t){return e.selectCombatByID(t)}})),r.a.createElement("div",{className:"drawer-footer"},r.a.createElement("div",{style:{padding:"10px 0"}},"version ",r.a.createElement("b",null,V.version)))),s=this.getDrawer();return r.a.createElement("div",{className:"dojo"},t,r.a.createElement("div",{className:this.state.maximized?"page-content maximized":"page-content"},this.getContent()),a,n,r.a.createElement(v.a,{closable:!1,maskClosable:s.closable,width:s.width,visible:null!==s.content,onClose:function(){return e.closeDrawer()}},r.a.createElement("div",{className:"drawer-header"},r.a.createElement("div",{className:"app-title"},s.header)),r.a.createElement("div",{className:"drawer-content"},s.content),r.a.createElement("div",{className:"drawer-footer"},s.footer)))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);i.a.render(r.a.createElement(Ut,null),document.getElementById("root"))},61:function(e){e.exports=JSON.parse('{"name":"dojo","version":"5.1.4","license":"MIT","repository":"https://github.com/andyaiken/dojo.git","homepage":"https://andyaiken.github.io/dojo/","dependencies":{"antd":"^3.25.2","react":"^16.12.0","react-dom":"^16.12.0","react-movable":"^2.3.0","showdown":"^1.9.1"},"devDependencies":{"@types/node":"^12.12.11","@types/react":"^16.9.11","@types/react-dom":"^16.9.4","@types/showdown":"^1.9.3","faker":"^4.1.0","gh-pages":"^2.1.1","node-sass":"^4.13.0","react-scripts":"^3.2.0","tslint":"^5.20.1","tslint-react":"^3.6.0","typescript":"^3.7.2"},"scripts":{"update":"npm update && npm update --save-dev","start":"react-scripts start --display-error-details","lint":"tslint --config tslint.json --format verbose \'src/**/*.{ts,tsx}\'","predeploy":"react-scripts build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":["eslint-recommended","react-app"]},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},63:function(e,t,a){e.exports=a.p+"static/media/x.7645a5b9.svg"},64:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAJlQTFRF/////v7+/f399PT06enp4eHh3t7e3d3d8/Pz0dHRzc3NzMzM/Pz85+fn4+Pjzs7O6Ojo8fHx3Nzc0NDQ1tbW7e3t9fX12tra7u7u2NjY9vb2+Pj45ubm09PTz8/P29vb9/f34uLi0tLS5eXl+fn57+/v8vLy7Ozs1NTU8PDw1dXV5OTk6urq+vr619fX2dnZ+/v739/f4ODgwOjgmwAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAP8SURBVHja7d1tV6JAGIBhB6lGxzIDx8qyF61VN23r//+4/dBCGiCkCzQP9/Wxs5t77jMPBwZWWi0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMqkvIopV0t5bf/o+KRSx0d+23NxUemTTtdUrts50c4tr95px9Skc9pzrNVZ39Smf+ZULXVeYytj+ucuTeKgY2rVGTg0hBemZhfuDKIO6o4VaGdincbnDP2gUvGRsnvqzOH9OPo3h0NbqWEYffKxK4d4bxStq8uqP/oyWlsjV07ke1fRkeO66o++jo6WVz1iEYtYxCIWsX5oLNUbt7Vuj3vEyovl2ZvRbTCZBLd359eKWLti3T88xtdB3dvpjFiZsdRTuL0BfPWsiJUeS/1K7HHNF4pYqbEWKfuBc02stFj3y7Rtp6sZsZKxvKPU22LdG0WsRKx2xqb8fEysRKzfWfdEX4j1NVb8k4QTj1hfYt0/ZsVaror+1pnXkFh6khXrsei1tl5PvWbEWmTeoA7aBVstTX/aI1ahVqExZpK/thjDVkt/nNL2c2txgI9amfxJ5NRBf25X5E1i409K9eZlZc4kNv1yR29fgu+exIZfSOvwy9/ZOYlCtmjCtFivq2+uq7xJlLL597jP5p9O2wbbMYlStpWHiVrzgfruDOZNopgbFoP11nGr+7rfuto5iXJuhY2/eSsss1X2JEq8yTovcpM1YwZ3TqKsZx28mdXaroqcty93P+ueWquhD4bktMqYxGbG2jmD2ZPYyFi56ypjEpsYq1CrtElsYKwCM5gxic2LVXBdpU1i42J9o1ViEuXG+qMOmsG0SRQby45878B1lZhEqbHs2gS+OrjV9iQKjWXXxpjgRR00g4lJlBnLflQJtidxj3W1PYkiY9l19Ec2J3HPVsZMngXHilttTeJeM/ixtJ7kxrKbVeJJ3HtdiY61sa42JvGAVoJjfWn1bxL3n0HJsWyySuB7h6wrubES68oYY4KHg1pJjZXaypgDvzxKZiwbmjKIjJWxroiVEqusVhJjlTSDImOVtq4ExiqxlbhY5c2gvFhlritpscptJSvWfbmtZMVa9IlVONYTsYhFLGIRi1jEIhaxiEUsYsmM9bycl2op6Skab1Yy0c9nlYVYxCIWsYhVTSxb9Udb52J5d/E3zVT8jhL1Ej27dOfMm/ve4m/Hmg4rNY2/O+LNlVYt//MbCfqV+vxc35lYtub3qhnTsc7E8t7rjvXu0MtG7bzeVnN3FlarpYa1vocuGDr1Wlbl11gr5b8x/vBal8u6Wi0v3Xub9HgaTip/N3J3Ek7HLQep1cC/qZg/WDn7knIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9dffijal8TIpWcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMTAtMjBUMDM6MDY6MzErMDA6MDA219rQAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTEwLTIwVDAzOjA2OjMxKzAwOjAwR4pibAAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAASUVORK5CYII="},87:function(e,t,a){e.exports=a.p+"static/media/warning.67a11a95.svg"}},[[126,1,2]]]);