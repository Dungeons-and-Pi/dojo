(this.webpackJsonpdojo=this.webpackJsonpdojo||[]).push([[0],[,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/down-arrow-black.a2fc7a1f.svg"},function(e,t,a){e.exports=a.p+"static/media/ellipsis.9650a20f.svg"},function(e,t,a){e.exports=a.p+"static/media/x.7645a5b9.svg"},,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAJlQTFRF/////v7+/f399PT06enp4eHh3t7e3d3d8/Pz0dHRzc3NzMzM/Pz85+fn4+Pjzs7O6Ojo8fHx3Nzc0NDQ1tbW7e3t9fX12tra7u7u2NjY9vb2+Pj45ubm09PTz8/P29vb9/f34uLi0tLS5eXl+fn57+/v8vLy7Ozs1NTU8PDw1dXV5OTk6urq+vr619fX2dnZ+/v739/f4ODgwOjgmwAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAP8SURBVHja7d1tV6JAGIBhB6lGxzIDx8qyF61VN23r//+4/dBCGiCkCzQP9/Wxs5t77jMPBwZWWi0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMqkvIopV0t5bf/o+KRSx0d+23NxUemTTtdUrts50c4tr95px9Skc9pzrNVZ39Smf+ZULXVeYytj+ucuTeKgY2rVGTg0hBemZhfuDKIO6o4VaGdincbnDP2gUvGRsnvqzOH9OPo3h0NbqWEYffKxK4d4bxStq8uqP/oyWlsjV07ke1fRkeO66o++jo6WVz1iEYtYxCIWsX5oLNUbt7Vuj3vEyovl2ZvRbTCZBLd359eKWLti3T88xtdB3dvpjFiZsdRTuL0BfPWsiJUeS/1K7HHNF4pYqbEWKfuBc02stFj3y7Rtp6sZsZKxvKPU22LdG0WsRKx2xqb8fEysRKzfWfdEX4j1NVb8k4QTj1hfYt0/ZsVaror+1pnXkFh6khXrsei1tl5PvWbEWmTeoA7aBVstTX/aI1ahVqExZpK/thjDVkt/nNL2c2txgI9amfxJ5NRBf25X5E1i409K9eZlZc4kNv1yR29fgu+exIZfSOvwy9/ZOYlCtmjCtFivq2+uq7xJlLL597jP5p9O2wbbMYlStpWHiVrzgfruDOZNopgbFoP11nGr+7rfuto5iXJuhY2/eSsss1X2JEq8yTovcpM1YwZ3TqKsZx28mdXaroqcty93P+ueWquhD4bktMqYxGbG2jmD2ZPYyFi56ypjEpsYq1CrtElsYKwCM5gxic2LVXBdpU1i42J9o1ViEuXG+qMOmsG0SRQby45878B1lZhEqbHs2gS+OrjV9iQKjWXXxpjgRR00g4lJlBnLflQJtidxj3W1PYkiY9l19Ec2J3HPVsZMngXHilttTeJeM/ixtJ7kxrKbVeJJ3HtdiY61sa42JvGAVoJjfWn1bxL3n0HJsWyySuB7h6wrubES68oYY4KHg1pJjZXaypgDvzxKZiwbmjKIjJWxroiVEqusVhJjlTSDImOVtq4ExiqxlbhY5c2gvFhlritpscptJSvWfbmtZMVa9IlVONYTsYhFLGIRi1jEIhaxiEUsYsmM9bycl2op6Skab1Yy0c9nlYVYxCIWsYhVTSxb9Udb52J5d/E3zVT8jhL1Ej27dOfMm/ve4m/Hmg4rNY2/O+LNlVYt//MbCfqV+vxc35lYtub3qhnTsc7E8t7rjvXu0MtG7bzeVnN3FlarpYa1vocuGDr1Wlbl11gr5b8x/vBal8u6Wi0v3Xub9HgaTip/N3J3Ek7HLQep1cC/qZg/WDn7knIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9dffijal8TIpWcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMTAtMjBUMDM6MDY6MzErMDA6MDA219rQAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTEwLTIwVDAzOjA2OjMxKzAwOjAwR4pibAAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAASUVORK5CYII="},function(e,t,a){e.exports=a.p+"static/media/warning.67a11a95.svg"},,function(e,t,a){e.exports=a.p+"static/media/down-arrow.697dc1af.svg"},function(e){e.exports=JSON.parse('{"name":"dojo","version":"3.18.1","license":"MIT","repository":"https://github.com/andyaiken/dojo.git","homepage":"https://andyaiken.github.io/dojo/","dependencies":{"@types/node":"^12.7.12","@types/react":"^16.9.5","@types/react-dom":"^16.9.1","@types/showdown":"^1.9.3","gh-pages":"^2.1.1","node-sass":"^4.12.0","react":"^16.10.2","react-dom":"^16.10.2","react-reveal":"^1.2.2","react-scripts":"^3.2.0","showdown":"^1.9.0","tslint":"^5.20.0","tslint-react":"^3.6.0","typescript":"^3.6.4"},"scripts":{"start":"react-scripts start --display-error-details","lint":"tslint --config tslint.json --format verbose \'src/**/*.{ts,tsx}\'","predeploy":"react-scripts build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":["eslint-recommended","react-app"]},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},function(e,t,a){e.exports=a.p+"static/media/settings.042bb1c2.svg"},function(e,t,a){e.exports=a(28)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(12),i=a.n(s),o=(a(24),a(25),a(26),a(1)),c=a(2),l=a(4),u=a(3),m=a(5),d=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getMonsterGroup",value:function(e,t){var a=this.monsterIdToGroup[e.id];if(!a){var n=t.find((function(t){return t.monsters.includes(e)}));n&&(a=n,this.monsterIdToGroup[e.id]=a)}return a}},{key:"match",value:function(e,t){if(!e)return!0;var a=!0;return e.toLowerCase().split(" ").forEach((function(e){-1===t.toLowerCase().indexOf(e)&&(a=!1)})),a}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"sort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===t.length&&(t=[{field:"name",dir:"asc"}]);var a=function(e,t,a){if(void 0!==e[a]&&void 0!==t[a]){if(e[a]<t[a])return-1;if(e[a]>t[a])return 1}return 0};return e.sort((function(e,n){var r=0;return t.forEach((function(t){0===r&&(r=a(e,n,t.field)*("asc"===t.dir?1:-1))})),r})),e}},{key:"modifierValue",value:function(e){return Math.floor((e-10)/2)}},{key:"modifier",value:function(e){var t=this.modifierValue(e),a=t.toString();return t>=0&&(a="+"+a),a}},{key:"dieRoll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return Math.floor(Math.random()*e)+1}},{key:"miniSize",value:function(e){switch(e){case"tiny":return.4;case"small":return.6;case"medium":return 1;case"large":return 2;case"huge":return 3;case"gargantuan":return 4;default:return 1}}},{key:"hitDieType",value:function(e){switch(e){case"tiny":return 4;case"small":return 6;case"medium":return 8;case"large":return 10;case"huge":return 12;case"gargantuan":return 20;default:return 8}}},{key:"challenge",value:function(e){switch(e){case.125:return"1/8";case.25:return"1/4";case.5:return"1/2";default:return e.toString()}}},{key:"parseChallenge",value:function(e){switch(e){case"1/8":return.125;case"1/4":return.25;case"1/2":return.5;default:return parseInt(e,10)}}},{key:"challengeDetails",value:function(){var e=[];return e.push({cr:0,ac:13,hpMin:1,hpMax:6,attack:3,dmgMin:0,dmgMax:1,save:13}),e.push({cr:.125,ac:13,hpMin:7,hpMax:35,attack:3,dmgMin:2,dmgMax:3,save:13}),e.push({cr:.25,ac:13,hpMin:36,hpMax:49,attack:3,dmgMin:4,dmgMax:5,save:13}),e.push({cr:.5,ac:13,hpMin:50,hpMax:70,attack:3,dmgMin:6,dmgMax:8,save:13}),e.push({cr:1,ac:13,hpMin:71,hpMax:85,attack:3,dmgMin:9,dmgMax:14,save:13}),e.push({cr:2,ac:13,hpMin:86,hpMax:100,attack:3,dmgMin:15,dmgMax:20,save:13}),e.push({cr:3,ac:13,hpMin:101,hpMax:115,attack:4,dmgMin:21,dmgMax:26,save:13}),e.push({cr:4,ac:14,hpMin:116,hpMax:130,attack:5,dmgMin:27,dmgMax:32,save:14}),e.push({cr:5,ac:15,hpMin:131,hpMax:145,attack:6,dmgMin:33,dmgMax:38,save:15}),e.push({cr:6,ac:15,hpMin:146,hpMax:160,attack:6,dmgMin:39,dmgMax:44,save:15}),e.push({cr:7,ac:15,hpMin:161,hpMax:175,attack:6,dmgMin:45,dmgMax:50,save:15}),e.push({cr:8,ac:16,hpMin:176,hpMax:190,attack:7,dmgMin:51,dmgMax:56,save:16}),e.push({cr:9,ac:16,hpMin:191,hpMax:205,attack:7,dmgMin:57,dmgMax:62,save:16}),e.push({cr:10,ac:17,hpMin:206,hpMax:220,attack:7,dmgMin:63,dmgMax:68,save:16}),e.push({cr:11,ac:17,hpMin:221,hpMax:235,attack:8,dmgMin:69,dmgMax:74,save:17}),e.push({cr:12,ac:17,hpMin:236,hpMax:250,attack:8,dmgMin:75,dmgMax:80,save:17}),e.push({cr:13,ac:18,hpMin:251,hpMax:265,attack:8,dmgMin:81,dmgMax:86,save:18}),e.push({cr:14,ac:18,hpMin:266,hpMax:280,attack:8,dmgMin:87,dmgMax:92,save:18}),e.push({cr:15,ac:18,hpMin:281,hpMax:295,attack:8,dmgMin:93,dmgMax:98,save:18}),e.push({cr:16,ac:18,hpMin:296,hpMax:310,attack:9,dmgMin:99,dmgMax:104,save:18}),e.push({cr:17,ac:19,hpMin:311,hpMax:325,attack:10,dmgMin:105,dmgMax:110,save:19}),e.push({cr:18,ac:19,hpMin:326,hpMax:340,attack:10,dmgMin:111,dmgMax:116,save:19}),e.push({cr:19,ac:19,hpMin:341,hpMax:355,attack:10,dmgMin:117,dmgMax:122,save:19}),e.push({cr:20,ac:19,hpMin:356,hpMax:400,attack:10,dmgMin:123,dmgMax:140,save:19}),e.push({cr:21,ac:19,hpMin:401,hpMax:445,attack:11,dmgMin:141,dmgMax:158,save:20}),e.push({cr:22,ac:19,hpMin:446,hpMax:490,attack:11,dmgMin:159,dmgMax:176,save:20}),e.push({cr:23,ac:19,hpMin:491,hpMax:535,attack:11,dmgMin:177,dmgMax:194,save:20}),e.push({cr:24,ac:19,hpMin:536,hpMax:580,attack:12,dmgMin:195,dmgMax:212,save:21}),e.push({cr:25,ac:19,hpMin:581,hpMax:625,attack:12,dmgMin:213,dmgMax:230,save:21}),e.push({cr:26,ac:19,hpMin:626,hpMax:670,attack:12,dmgMin:231,dmgMax:248,save:21}),e.push({cr:27,ac:19,hpMin:671,hpMax:715,attack:13,dmgMin:249,dmgMax:266,save:22}),e.push({cr:28,ac:19,hpMin:716,hpMax:760,attack:13,dmgMin:267,dmgMax:284,save:22}),e.push({cr:29,ac:19,hpMin:761,hpMax:805,attack:13,dmgMin:285,dmgMax:302,save:22}),e.push({cr:30,ac:19,hpMin:806,hpMax:850,attack:14,dmgMin:303,dmgMax:320,save:23}),e}},{key:"experience",value:function(e){switch(e){case 0:return 10;case.125:return 25;case.25:return 50;case.5:return 100;case 1:return 200;case 2:return 450;case 3:return 700;case 4:return 1100;case 5:return 1800;case 6:return 2300;case 7:return 2900;case 8:return 3900;case 9:return 5e3;case 10:return 5900;case 11:return 7200;case 12:return 8400;case 13:return 1e4;case 14:return 11500;case 15:return 13e3;case 16:return 15e3;case 17:return 18e3;case 18:return 2e4;case 19:return 22e3;case 20:return 25e3;case 21:return 33e3;case 22:return 41e3;case 23:return 5e4;case 24:return 62e3;case 30:return 155e3;default:return 0}}},{key:"experienceFactor",value:function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 1.5;case 3:case 4:case 5:case 6:return 2;case 7:case 8:case 9:case 10:return 2.5;case 11:case 12:case 13:case 14:return 3;default:return 4}}},{key:"pcExperience",value:function(e,t){switch(t){case"easy":switch(e){case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 125;case 5:return 250;case 6:return 300;case 7:return 350;case 8:return 450;case 9:return 550;case 10:return 600;case 11:return 800;case 12:return 1e3;case 13:return 1100;case 14:return 1250;case 15:return 1400;case 16:return 1600;case 17:return 2e3;case 18:return 2100;case 19:return 2400;case 20:return 2800;default:return 0}case"medium":switch(e){case 1:return 50;case 2:return 100;case 3:return 150;case 4:return 250;case 5:return 500;case 6:return 600;case 7:return 750;case 8:return 900;case 9:return 1100;case 10:return 1200;case 11:return 1600;case 12:return 2e3;case 13:return 2200;case 14:return 2500;case 15:return 2800;case 16:return 3200;case 17:return 3900;case 18:return 4200;case 19:return 4900;case 20:return 5700;default:return 0}case"hard":switch(e){case 1:return 75;case 2:return 150;case 3:return 225;case 4:return 375;case 5:return 750;case 6:return 900;case 7:return 1100;case 8:return 1400;case 9:return 1600;case 10:return 1900;case 11:return 2400;case 12:return 3e3;case 13:return 3400;case 14:return 3800;case 15:return 4300;case 16:return 4800;case 17:return 5900;case 18:return 6300;case 19:return 7300;case 20:return 8500;default:return 0}case"deadly":switch(e){case 1:return 100;case 2:return 200;case 3:return 400;case 4:return 500;case 5:return 1100;case 6:return 1400;case 7:return 1700;case 8:return 2100;case 9:return 2400;case 10:return 2800;case 11:return 3600;case 12:return 4500;case 13:return 5100;case 14:return 5700;case 15:return 6400;case 16:return 7200;case 17:return 8800;case 18:return 9500;case 19:return 10900;case 20:return 12700;default:return 0}default:return 0}}},{key:"traitType",value:function(e,t){var a="";switch(e){case"trait":a="trait";break;case"action":a="action";break;case"bonus":a="bonus action";break;case"reaction":a="reaction";break;case"legendary":a="legendary action";break;case"lair":a="lair action"}return t&&(a+="s"),a}},{key:"nudgeChallenge",value:function(e,t){var a=0;switch(e){case 0:-1===t&&(a=0),1===t&&(a=.125);break;case.125:-1===t&&(a=0),1===t&&(a=.25);break;case.25:-1===t&&(a=.125),1===t&&(a=.5);break;case.5:-1===t&&(a=.25),1===t&&(a=1);break;case 1:-1===t&&(a=.5),1===t&&(a=2);break;default:a=e+t}return a}},{key:"nudgeSize",value:function(e,t){var a=["tiny","small","medium","large","huge","gargantuan"],n=a.indexOf(e)+t;return n<0&&(n=0),n>=a.length&&(n=a.length-1),a[n]}},{key:"conditionText",value:function(e){switch(e.name){case"blinded":return["a blinded creature can\u2019t see and automatically fails any ability check that requires sight","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage"];case"charmed":return["a charmed creature can\u2019t attack the charmer or target the charmer with harmful abilities or magical effects","the charmer has advantage on any ability check to interact socially with the creature"];case"deafened":return["a deafened creature can\u2019t hear and automatically fails any ability check that requires hearing."];case"exhaustion":switch(e.level){case 1:return["disadvantage on ability checks"];case 2:return["disadvantage on ability checks","speed halved"];case 3:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws"];case 4:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved"];case 5:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0"];case 6:return["disadvantage on ability checks","speed halved","disadvantage on attack rolls and saving throws","hit point maximum halved","speed reduced to 0","death"];default:return[]}case"frightened":return["a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight","the creature can\u2019t willingly move closer to the source of its fear"];case"grappled":return["a grappled creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","the condition ends if the grappler is incapacitated","the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect"];case"incapacitated":return["an incapacitated creature can\u2019t take actions or reactions","being incapacitated breaks concentration"];case"invisible":return["an invisible creature is impossible to see without the aid of magic or a special sense","for the purpose of hiding, the creature is heavily obscured","the creature\u2019s location can be detected by any noise it makes or any tracks it leaves","attack rolls against the creature have disadvantage, and the creature\u2019s attack rolls have advantage"];case"paralyzed":return["a paralyzed creature is incapacitated (can\u2019t take actions or reactions) and can\u2019t move or speak","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"petrified":return["a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)","its weight increases by a factor of ten, and it ceases aging","the creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","attack rolls against the creature have advantage","the creature automatically fails strength and dexterity saving throws","the creature has resistance to all damage","the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized"];case"poisoned":return["a poisoned creature has disadvantage on attack rolls and ability checks"];case"prone":return["a prone creature\u2019s only movement option is to crawl, unless it stands up and thereby ends the condition","the creature has disadvantage on attack rolls","an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage"];case"restrained":return["a restrained creature\u2019s speed becomes 0, and it can\u2019t benefit from any bonus to its speed","attack rolls against the creature have advantage, and the creature\u2019s attack rolls have disadvantage","the creature has disadvantage on dexterity saving throws"];case"stunned":return["a stunned creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move, and can speak only falteringly","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage"];case"unconscious":return["an unconscious creature is incapacitated (can\u2019t take actions or reactions), can\u2019t move or speak, and is unaware of its surroundings","the creature drops whatever its holding and falls prone","the creature automatically fails strength and dexterity saving throws","attack rolls against the creature have advantage","any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature"];case"custom":default:return[]}}},{key:"conditionDurationText",value:function(e,t){if(null!==e.duration)switch(e.duration.type){case"saves":var a=e.duration,n=a.saveType.toString();"death"!==n&&(n=n.toUpperCase());var r=a.count>1?"saves":"save";return"until you make "+a.count+" "+n+" "+r+" at dc "+a.saveDC;case"combatant":var s=e.duration,i=s.point,o=t.combatants.find((function(e){return e.id===s.combatantID}));return"until the "+i+" of "+(o?(o.displayName||o.name||"unnamed monster")+"'s":"someone's")+" next turn";case"rounds":var c=e.duration,l=c.count>1?"rounds":"round";return"for "+c.count+" "+l;default:return null}return null}},{key:"getMonsterNames",value:function(e){var t=[];return e&&e.slots.forEach((function(e){var a=[];if(1===e.count)a.push(e.monsterName);else for(var n=0;n!==e.count;++n)a.push(e.monsterName+" "+(n+1));t.push({id:e.id,names:a})})),t}},{key:"getTagDescription",value:function(e){switch(e){case"conc":return"concentrating";case"bane":return"baned (subtract d4 from attack rolls and saving throws)";case"bless":return"blessed (add d4 to attack rolls and saving throws)";case"hex":return"hexed (disadvantage on one saving throw; take additional damage on hit)";default:return e}}}]),e}();d.monsterIdToGroup={};var p=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"createParty",value:function(){return{id:d.guid(),name:"",pcs:[]}}},{key:"createPC",value:function(){return{id:d.guid(),type:"pc",active:!0,player:"",name:"",race:"",classes:"",level:1,languages:"Common",passiveInsight:10,passiveInvestigation:10,passivePerception:10,portrait:"",url:"",companions:[]}}},{key:"createCompanion",value:function(){return{id:d.guid(),name:""}}},{key:"createMonsterGroup",value:function(){return{id:d.guid(),name:"",monsters:[]}}},{key:"createMonster",value:function(){return{id:d.guid(),type:"monster",name:"",size:"medium",category:"humanoid",tag:"",alignment:"",challenge:1,abilityScores:{str:10,dex:10,con:10,int:10,wis:10,cha:10},ac:10,hpMax:4,hpTemp:0,hitDice:1,damage:{resist:"",vulnerable:"",immune:""},savingThrows:"",speed:"",skills:"",senses:"",languages:"",equipment:"",traits:[],conditionImmunities:"",portrait:""}}},{key:"createTrait",value:function(){return{id:d.guid(),name:"",usage:"",type:"action",text:"",uses:0}}},{key:"createEncounter",value:function(){return{id:d.guid(),name:"",slots:[],waves:[]}}},{key:"createEncounterSlot",value:function(){return{id:d.guid(),monsterGroupName:"",monsterName:"",count:1}}},{key:"createEncounterWave",value:function(){return{id:d.guid(),name:"",slots:[]}}},{key:"createMonsterFilter",value:function(){return{name:"",challengeMin:0,challengeMax:5,category:"all types",size:"all sizes"}}},{key:"createMapFolio",value:function(){return{id:d.guid(),name:"",maps:[]}}},{key:"createMap",value:function(){return{id:d.guid(),name:"",items:[]}}},{key:"createMapItem",value:function(){return{id:d.guid(),type:"tile",x:0,y:0,width:4,height:4,terrain:null,customBackground:"",style:null}}},{key:"createCombatSetup",value:function(){return{partyID:null,encounterID:null,waveID:null,folioID:null,mapID:null,monsterNames:[],encounterInitMode:"group"}}},{key:"createCombat",value:function(){return{id:d.guid(),name:"",encounterID:null,combatants:[],map:null,round:1,notifications:[],issues:[],timestamp:null}}},{key:"createNotification",value:function(){return{id:d.guid(),type:"condition-save",data:null,combatant:null}}},{key:"createCondition",value:function(){return{id:d.guid(),name:"",level:1,text:null,duration:null}}},{key:"createConditionDurationSaves",value:function(){return{type:"saves",count:1,saveType:"str",saveDC:10,point:"start"}}},{key:"createConditionDurationCombatant",value:function(){return{type:"combatant",point:"start",combatantID:null}}},{key:"createConditionDurationRounds",value:function(){return{type:"rounds",count:1}}}]),e}(),h=["tiny","small","medium","large","huge","gargantuan"],v=["aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","humanoid","monstrosity","ooze","plant","undead"],f=["trait","action","bonus","reaction","legendary","lair"],b=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"nudgeValue",value:function(t,a,n){var r,s=t,i=null,o=a.split(".");switch(o.forEach((function(e){e===o[o.length-1]?i=s[e]:s=s[e]})),a){case"challenge":r=d.nudgeChallenge(i,n);break;case"size":r=d.nudgeSize(i,n);break;default:r=(i||0)+n}e.changeValue(t,a,r)}},{key:"changeValue",value:function(e,t,a){var n=e,r=t.split(".");r.forEach((function(s){if(s===r[r.length-1]){if(n[s]=a,"abilityScores.con"===t||"size"===t||"hitDice"===t){var i=(d.hitDieType(e.size)+1)/2+Math.floor((e.abilityScores.con-10)/2),o=Math.floor(e.hitDice*i);e.hpMax=o}}else n=n[s]}))}},{key:"clone",value:function(e,t){return{id:d.guid(),type:"monster",name:t||e.name+" copy",size:e.size,category:e.category,tag:e.tag,alignment:e.alignment,challenge:e.challenge,abilityScores:{str:e.abilityScores.str,dex:e.abilityScores.dex,con:e.abilityScores.con,int:e.abilityScores.int,wis:e.abilityScores.wis,cha:e.abilityScores.cha},ac:e.ac,hpMax:e.hpMax,hpTemp:e.hpTemp,hitDice:e.hitDice,damage:{resist:e.damage.resist,vulnerable:e.damage.vulnerable,immune:e.damage.immune},savingThrows:e.savingThrows,speed:e.speed,skills:e.skills,senses:e.senses,languages:e.languages,equipment:e.equipment,traits:e.traits.map((function(e){return{id:d.guid(),name:e.name,usage:e.usage,type:e.type,text:e.text,uses:0}})),conditionImmunities:e.conditionImmunities,portrait:e.portrait}}},{key:"createFromJSON",value:function(e){var t=this,a=p.createMonster();a.type="monster",a.name=e.name,a.size=e.size.toLowerCase(),a.category=e.type,a.tag=e.subtype,a.alignment=e.alignment,a.challenge=d.parseChallenge(e.challenge_rating),a.ac=e.armor_class,a.hpMax=e.hit_points,a.speed=e.speed,a.senses=e.senses,a.languages=e.languages;var n=e.hit_dice.indexOf("d");a.hitDice=parseInt(e.hit_dice.substring(0,n),10),a.abilityScores.str=e.strength,a.abilityScores.dex=e.dexterity,a.abilityScores.con=e.constitution,a.abilityScores.int=e.intelligence,a.abilityScores.wis=e.wisdom,a.abilityScores.cha=e.charisma,a.damage.resist=e.damage_resistances,a.damage.vulnerable=e.damage_vulnerabilities,a.damage.immune=e.damage_immunities,a.conditionImmunities=e.condition_immunities;[{field:"strength_save",text:"Strength"},{field:"dexterity_save",text:"Dexterity"},{field:"constitution_save",text:"Constitution"},{field:"intelligence_save",text:"Intelligence"},{field:"wisdom_save",text:"Wisdom"},{field:"charisma_save",text:"Charisma"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.savingThrows+=""===a.savingThrows?n:", "+n}}));return[{field:"acrobatics",text:"Acrobatics"},{field:"animal_handling",text:"Animal handling"},{field:"arcana",text:"Arcana"},{field:"athletics",text:"Athletics"},{field:"deception",text:"Deception"},{field:"history",text:"History"},{field:"insight",text:"Insight"},{field:"intimidation",text:"Intimidation"},{field:"investigation",text:"Investigation"},{field:"medicine",text:"Medicine"},{field:"nature",text:"Nature"},{field:"perception",text:"Perception"},{field:"performance",text:"Performance"},{field:"persuasion",text:"Persuasion"},{field:"religion",text:"Religion"},{field:"sleight_of_hand",text:"Sleight of hand"},{field:"stealth",text:"Stealth"},{field:"survival",text:"Survival"}].forEach((function(t){if(e[t.field]){var n=t.text+" "+e[t.field];a.skills+=""===a.skills?n:", "+n}})),e.special_abilities&&e.special_abilities.forEach((function(e){var n=t.buildTrait(e,"trait");a.traits.push(n)})),e.actions&&e.actions.forEach((function(e){var n=t.buildTrait(e,"action");a.traits.push(n)})),e.reactions&&e.reactions.forEach((function(e){var n=t.buildTrait(e,"reaction");a.traits.push(n)})),e.legendary_actions&&e.legendary_actions.forEach((function(e){var n=t.buildTrait(e,"legendary");a.traits.push(n)})),a}},{key:"buildTrait",value:function(e,t){var a="",n="",r=e.name.indexOf("(");if(-1===r)a=e.name;else{var s=e.name.indexOf(")");a=e.name.substring(0,r-1),n=e.name.substring(r+1,s).toLowerCase()}var i=e.desc.replace(/\u2022/g,"*"),o=t;return"Lair Actions"===a&&(o="lair"),0===i.indexOf("As a bonus action")&&(o="bonus"),{id:d.guid(),type:o,name:a,usage:n,text:i,uses:0}}},{key:"copyTrait",value:function(e,t){var a=JSON.parse(JSON.stringify(t));a.id=d.guid(),e.traits.push(a)}},{key:"addTrait",value:function(e,t){var a=p.createTrait();a.type=t,a.name="New "+d.traitType(t,!1).toLowerCase(),e.traits.push(a)}},{key:"removeTrait",value:function(e,t){var a=e.traits.indexOf(t);e.traits.splice(a,1)}},{key:"swapTraits",value:function(e,t,a){var n=e.traits.indexOf(t),r=e.traits.indexOf(a);e.traits[r]=t,e.traits[n]=a}},{key:"spliceMonsters",value:function(e,t){var a=this;["size","category","tag","alignment","challenge","speed","senses","languages","equipment","abilityScores.str","abilityScores.dex","abilityScores.con","abilityScores.int","abilityScores.wis","abilityScores.cha","savingThrows","skills","ac","hitDice","damage.resist","damage.vulnerable","damage.immune","conditionImmunities"].forEach((function(n){a.setRandomValue(e,n,t)})),e.traits=[],f.forEach((function(n){var r=[];t.forEach((function(e){e.traits.filter((function(e){return e.type===n})).forEach((function(e){return r.push(e)}))}));var s=[];r.forEach((function(e){var t=s.find((function(t){return t.trait.name===e.name}));t?t.count+=1:s.push({trait:e,count:1})}));var i=[];s.filter((function(e){return e.count===t.length})).forEach((function(t){a.copyTrait(e,t.trait),i.push(t.trait.id)})),i.forEach((function(e){var t=s.findIndex((function(t){return t.trait.id===e}));s.splice(t,1)}));for(var o=r.length/t.length;e.traits.filter((function(e){return e.type===n})).length<o;){var c=Math.floor(Math.random()*s.length),l=s[c].trait;a.copyTrait(e,l),s.splice(c,1)}}))}},{key:"setRandomValue",value:function(e,t,a){var n=a[Math.floor(Math.random()*a.length)],r=null,s=t.split(".");s.forEach((function(e){e===s[s.length-1]?r=n[e]:n=n[e]})),this.changeValue(e,t,r)}},{key:"addRandomTrait",value:function(e,t,a){var n=[];a.forEach((function(e){e.traits.filter((function(e){return e.type===t})).forEach((function(e){n.push(e)}))}));var r=Math.floor(Math.random()*n.length),s=n[r];this.copyTrait(e,s)}}]),e}(),g=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"scatterCombatants",value:function(t,a){if(t.map&&(t.map.items=t.map.items.filter((function(e){return e.type!==a})),t.map.items.filter((function(e){return"tile"===e.type})).length>0)){var n=e.mapDimensions(t.map);if(n)t.combatants.filter((function(e){return e.type===a})).forEach((function(r){for(var s=[],i=n.minX;i<=n.maxX;++i)for(var o=n.minY;o<=n.maxY;++o){e.canAddMonsterHere(t.map,r,i,o)&&s.push({x:i,y:o})}if(s.length>0&&t.map){var c=s[Math.floor(Math.random()*s.length)],l=d.miniSize(r.displaySize),u=p.createMapItem();u.id=r.id,u.type=a,u.x=c.x,u.y=c.y,u.height=l,u.width=l,t.map.items.push(u)}}))}}},{key:"mapDimensions",value:function(e){var t=e.items.filter((function(e){return"tile"===e.type}));if(t.length>0){var a=t[0].x,n=t[0].y,r=t[0].x+t[0].width-1,s=t[0].y+t[0].height-1;return t.forEach((function(e){a=Math.min(a,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x+e.width-1),s=Math.max(s,e.y+e.height-1)})),{minX:a,minY:n,maxX:r,maxY:s}}return null}},{key:"canAddMonsterHere",value:function(t,a,n,r){for(var s=[],i=d.miniSize(a.displaySize),o=n+Math.max(1,i)-1,c=r+Math.max(1,i)-1,l=n;l<=o;++l)for(var u=r;u<=c;++u){var m=e.itemsAt(t,l,u),p=m.length>0&&m.every((function(e){return"tile"===e.type}));s.push(p)}return s.every((function(e){return e}))}},{key:"itemsAt",value:function(e,t,a){return e.items.filter((function(e){var n=e.x,r=e.x+e.width-1,s=e.y,i=e.y+e.height-1;return t>=n&&t<=r&&a>=s&&a<=i}))}},{key:"rotateMap",value:function(e){e.items.forEach((function(e){var t=-1*(e.y+e.height-1),a=e.x,n=e.height,r=e.width;e.x=t,e.y=a,e.width=n,e.height=r}))}}]),e}(),y=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"getMonsterCount",value:function(e){var t=0,a=[];return a=a.concat(e.slots),e.waves.forEach((function(e){a=a.concat(e.slots)})),a.forEach((function(e){t+=e.count})),t}},{key:"getEncounterXP",value:function(e,t){var a=0,n=[];return n=n.concat(e.slots),e.waves.forEach((function(e){n=n.concat(e.slots)})),n.forEach((function(e){var n=t(e.monsterName,e.monsterGroupName);n&&(a+=d.experience(n.challenge)*e.count)})),a}},{key:"getAdjustedEncounterXP",value:function(e,t){var a=0,n=0,r=[];return r=r.concat(e.slots),e.waves.forEach((function(e){r=r.concat(e.slots)})),r.forEach((function(e){a+=e.count;var r=t(e.monsterName,e.monsterGroupName);r&&(n+=d.experience(r.challenge)*e.count)})),n*d.experienceFactor(a)}},{key:"getFilterDescription",value:function(e){var t="";"all sizes"!==e.size&&(t+=t?" "+e.size:e.size),"all types"!==e.category&&(t+=t?" "+e.category:e.category);var a=d.challenge(e.challengeMin),n=d.challenge(e.challengeMax);return t+=" monsters of cr "+(e.challengeMin===e.challengeMax?a:a+" to "+n)}},{key:"buildEncounter",value:function(t,a,n,r,s){for(;e.getAdjustedEncounterXP(t,(function(e,t){return s(e,t)}))<=a;)if(t.slots.length>0&&d.dieRoll(3)>1){var i=Math.floor(Math.random()*t.slots.length);t.slots[i].count+=1}else{if("break"===function(){var a=[];if(r.forEach((function(r){r.monsters.filter((function(t){return e.matchMonster(t,n)})).filter((function(e){return!t.slots.find((function(t){return t.monsterGroupName===r.name&&t.monsterName===e.name}))})).forEach((function(e){return a.push({groupName:r.name,monsterName:e.name})}))})),a.length>0){var s=Math.floor(Math.random()*a.length),i=p.createEncounterSlot();i.monsterGroupName=a[s].groupName,i.monsterName=a[s].monsterName,t.slots.push(i)}else if(0===t.slots.length)return"break"}())break}for(var o=function(){var e=Math.floor(Math.random()*t.slots.length),a=t.slots[e];t.slots=t.slots.filter((function(e){return e.id!==a.id}));var n=p.createEncounterWave();n.name="wave "+(t.waves.length+2),n.slots.push(a),t.waves.push(n)};t.slots.length>1&&10===d.dieRoll(10);)o()}},{key:"matchMonster",value:function(e,t){return!(e.challenge<t.challengeMin)&&(!(e.challenge>t.challengeMax)&&(!(""!==t.name&&!d.match(t.name,e.name))&&(("all types"===t.category||e.category===t.category)&&("all sizes"===t.size||e.size===t.size))))}}]),e}(),E=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.changeValue(!this.props.checked)}},{key:"render",value:function(){var e=this;try{var t="checkbox "+this.props.display;this.props.checked&&(t+=" checked"),this.props.disabled&&(t+=" disabled");var a=null;return"switch"===this.props.display&&(a=r.a.createElement("div",{className:"toggle-container"},r.a.createElement("div",{className:"toggle"}))),r.a.createElement("div",{className:t,onClick:function(t){return e.click(t)}},r.a.createElement("div",{className:"checkbox-label"},this.props.label),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);E.defaultProps={display:"switch",disabled:!1};var k=["conc","bane","bless","hex"],N=a(14),x=a.n(N),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pressed:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(){this.setState({pressed:!this.state.pressed})}},{key:"perform",value:function(){this.toggle(),this.props.callback()}},{key:"render",value:function(){var e=this;try{var t=null;return t=this.state.pressed?r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.props.text," - are you sure?"),r.a.createElement("img",{className:"image",src:x.a,alt:"warning"}),this.props.details?r.a.createElement("div",{className:"details"},this.props.details):null,r.a.createElement("div",{className:"confirmation"},r.a.createElement("div",{className:"destructive",onClick:function(){return e.perform()}},"yes"),r.a.createElement("div",{className:"non-destructive",onClick:function(){return e.toggle()}},"no"))):r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.props.text),r.a.createElement("img",{className:"image",src:x.a,alt:"warning"})),r.a.createElement("button",{className:this.props.disabled?"disabled":"",onClick:function(){return e.toggle()}},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);C.defaultProps={details:null,disabled:!1};var w=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e="control-row";switch(this.props.disabled&&(e+=" disabled"),this.props.controls.length){case 1:e+=" one";break;case 2:e+=" two";break;case 3:e+=" three";break;case 4:e+=" four";break;case 5:e+=" five"}return r.a.createElement("div",{className:e},this.props.controls)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);w.defaultProps={disabled:!1};var O=a(10),M=a.n(O),S=a(11),j=a.n(S),I=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={open:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleOpen",value:function(e){e.stopPropagation(),this.setState({open:!this.state.open})}},{key:"select",value:function(e){this.setState({open:!1}),this.props.select(e)}},{key:"clear",value:function(e){e.stopPropagation(),this.props.clear()}},{key:"render",value:function(){var e=this;try{if(0===this.props.options.length)return null;var t,a=this.props.disabled?"dropdown disabled":"dropdown",n=[];if(this.props.selectedID&&(t=this.props.options.find((function(t){return t.id===e.props.selectedID}))),n.push(r.a.createElement("div",{key:"selection",className:"dropdown-top",title:t?t.text:this.props.placeholder},r.a.createElement("div",{className:"item-text"},t?t.text:this.props.placeholder),r.a.createElement("img",{className:t&&this.props.clear?"clear":"arrow",alt:t&&this.props.clear?"clear":"arrow",src:t&&this.props.clear?j.a:M.a,onClick:function(a){return t&&e.props.clear?e.clear(a):null}}))),this.state.open){a+=" open";var s=this.props.options.map((function(t){return null===t.text?r.a.createElement("div",{key:t.id,className:"divider"}):r.a.createElement(V,{key:t.id,option:t,selected:t.id===e.props.selectedID,select:function(t){return e.select(t)}})}));n.push(r.a.createElement("div",{key:"options",className:"dropdown-options"},s))}return r.a.createElement("div",{className:a,onClick:function(t){return e.toggleOpen(t)}},n)}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);I.defaultProps={selectedID:null,placeholder:"select...",disabled:!1,clear:null};var V=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="dropdown-option";return this.props.selected&&(t+=" selected"),this.props.option.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),D=a(9),T=a.n(D),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={expanded:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(){this.setState({expanded:!this.state.expanded})}},{key:"render",value:function(){var e=this;try{var t=this.props.disabled?"expander disabled":"expander";this.state.expanded&&(t+=" expanded");var a=null;return this.state.expanded&&(a=r.a.createElement("div",{className:"expander-content"},this.props.content)),r.a.createElement("div",{className:t},r.a.createElement("div",{className:"expander-header",onClick:function(){return e.toggle()}},r.a.createElement("div",{className:"expander-text"},this.props.text),r.a.createElement("img",{className:"expander-button",src:T.a,alt:"arrow"})),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);A.defaultProps={disabled:!1};var P=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.stopPropagation(),this.props.click(t,a)}},{key:"render",value:function(){var e=this;try{var t="radial "+(this.props.direction||"out");this.props.disabled&&(t+=" disabled");var a="out"===this.props.direction||"both"===this.props.direction||"eight"===this.props.direction,n="in"===this.props.direction||"both"===this.props.direction,s="eight"===this.props.direction;return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NW")}},"\u2196")),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"N","out")}},"\u2191"),r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"N","in")}},"\u2193")),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"NE")}},"\u2197")),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"W","out")}},"\u2190"),r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"W","in")}},"\u2192")),r.a.createElement("div",{className:"cell"}),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow horizontal",style:{display:n?"inline-block":"none"},onClick:function(t){return e.click(t,"E","in")}},"\u2190"),r.a.createElement("div",{className:"arrow horizontal",style:{display:a?"inline-block":"none"},onClick:function(t){return e.click(t,"E","out")}},"\u2192")),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SW")}},"\u2199")),r.a.createElement("div",{className:"cell"},r.a.createElement("div",{className:"arrow vertical",style:{display:n?"block":"none"},onClick:function(t){return e.click(t,"S","in")}},"\u2191"),r.a.createElement("div",{className:"arrow vertical",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"S","out")}},"\u2193")),r.a.createElement("div",{className:"cell",style:{display:s?"none":"inline-block"}}),r.a.createElement("div",{className:"cell",style:{display:s?"inline-block":"none"}},r.a.createElement("div",{className:"arrow diag",style:{display:a?"block":"none"},onClick:function(t){return e.click(t,"SE","out")}},"\u2198")))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);P.defaultProps={direction:"out",disabled:!1};var F=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.tabs?"selector tabs":"selector radio";this.props.disabled&&(t+=" disabled");for(var a=this.props.itemsPerRow?this.props.itemsPerRow:this.props.options.length,n=Math.ceil(this.props.options.length/a),s=[],i=0;i!==n;++i)s.push([]);this.props.options.forEach((function(t){var n=e.props.options.indexOf(t),i=Math.floor(n/a);s[i].push(r.a.createElement(z,{key:t.id,option:t,selected:t.id===e.props.selectedID,count:a,select:function(t){return e.props.select(t)}}))}));var o=s.map((function(e){var t=s.indexOf(e);return r.a.createElement("div",{key:t},e)}));return r.a.createElement("div",{className:t},o)}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);F.defaultProps={tabs:!1,disabled:!1,itemsPerRow:null};var z=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.option.disabled||this.props.select(this.props.option.id)}},{key:"render",value:function(){var e=this;try{var t="calc(((100% - 1px) / "+this.props.count+") - 2px )",a="option";return this.props.selected&&(a+=" selected"),this.props.option.disabled&&(a+=" disabled"),r.a.createElement("div",{key:this.props.option.id,className:a,style:{width:t},title:this.props.option.text,onClick:function(t){return e.click(t)}},this.props.option.text)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),G=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e,t){e.stopPropagation(),this.props.nudgeValue(t)}},{key:"touchEnd",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.props.nudgeValue(t)}},{key:"render",value:function(){var e=this;try{var t="info-value",a=this.props.source[this.props.name];0===a&&(t+=" dimmed"),this.props.display&&(a=this.props.display(a));var n=[],s=[],i=this.props.factors||[1];return i.forEach((function(t){n.push(r.a.createElement("div",{key:"minus"+t,className:1===t?"spin-button factor":"spin-button factor multiple",onTouchEnd:function(a){return e.touchEnd(a,-1*t)},onClick:function(a){return e.click(a,-1*t)}},1===t?"-":t)),s.push(r.a.createElement("div",{key:"plus"+t,className:1===t?"spin-button factor":"spin-button factor multiple",onTouchEnd:function(a){return e.touchEnd(a,1*t)},onClick:function(a){return e.click(a,1*t)}},1===t?"+":t))})),n.reverse(),r.a.createElement("div",{className:this.props.disabled?"spin disabled":"spin"},r.a.createElement("div",{className:"minus"},n),r.a.createElement("div",{className:"info",style:{width:"calc(100% - "+60*i.length+"px)"}},r.a.createElement("div",{className:"info-label"},this.props.label),r.a.createElement("div",{className:t},a)),r.a.createElement("div",{className:"plus"},s))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);G.defaultProps={label:null,disabled:!1,factors:null,display:null};var L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showAbilityScores:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleAbilityScores",value:function(){this.setState({showAbilityScores:!this.state.showAbilityScores})}},{key:"render",value:function(){var e=this;try{return this.props.edit?r.a.createElement("div",null,r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"str",label:"strength",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.str",t)}}),r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"dex",label:"dexterity",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.dex",t)}}),r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"con",label:"constitution",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.con",t)}}),r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"int",label:"intelligence",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.int",t)}}),r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"wis",label:"wisdom",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.wis",t)}}),r.a.createElement(G,{source:this.props.combatant.abilityScores,name:"cha",label:"charisma",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"abilityScores.cha",t)}})):r.a.createElement("div",{className:"ability-scores",onClick:function(){return e.toggleAbilityScores()}},r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"str"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.str:d.modifier(this.props.combatant.abilityScores.str))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"dex"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.dex:d.modifier(this.props.combatant.abilityScores.dex))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"con"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.con:d.modifier(this.props.combatant.abilityScores.con))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"int"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.int:d.modifier(this.props.combatant.abilityScores.int))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"wis"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.wis:d.modifier(this.props.combatant.abilityScores.wis))),r.a.createElement("div",{className:"ability-score"},r.a.createElement("div",{className:"ability-heading"},"cha"),r.a.createElement("div",{className:"ability-value"},this.state.showAbilityScores?this.props.combatant.abilityScores.cha:d.modifier(this.props.combatant.abilityScores.cha))))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);L.defaultProps={edit:null,nudgeValue:null};var Y=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];if(this.props.combatant.conditions)for(var a=0;a!==this.props.combatant.conditions.length;++a){var n=this.props.combatant.conditions[a];t.push(r.a.createElement(R,{key:a,condition:n,combat:this.props.combat,nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)},editCondition:function(t){return e.props.editCondition(t)},removeCondition:function(t){return e.props.removeCondition(t)}}))}return r.a.createElement("div",{className:"section"},t,r.a.createElement("button",{onClick:function(){return e.props.addCondition()}},"add a condition"))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),R=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.condition.name||"condition";"exhaustion"===this.props.condition.name&&(t+=" ("+this.props.condition.level+")"),"custom"===this.props.condition.name&&null!==this.props.condition.text&&(t=this.props.condition.text),null!==this.props.condition.duration&&(t+=" "+d.conditionDurationText(this.props.condition,this.props.combat));var a=[];"exhaustion"===this.props.condition.name&&a.push(r.a.createElement("div",{key:"level",className:"section"},r.a.createElement(G,{source:this.props.condition,name:"level",label:"level",nudgeValue:function(t){return e.props.nudgeConditionValue(e.props.condition,"level",t)}})));for(var n=d.conditionText(this.props.condition),s=0;s!==n.length;++s)a.push(r.a.createElement("div",{key:s,className:"section"},n[s]));return r.a.createElement(A,{text:t,content:r.a.createElement("div",null,a,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.editCondition(e.props.condition)}},"edit"),r.a.createElement("button",{onClick:function(){return e.props.removeCondition(e.props.condition.id)}},"remove"))})}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),W=a(13),q=a.n(W),H=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onFileSelected",value:function(e){var t=this;if(e.target.files){var a=new FileReader;a.onload=function(e){if(e.target){var a=e.target.result;t.props.setValue(a)}},a.readAsDataURL(e.target.files[0])}}},{key:"getEditor",value:function(){var e=this,t=null;return this.props.source.portrait&&(t=r.a.createElement("button",{onClick:function(){return e.props.setValue("")}},"clear image")),r.a.createElement("div",{className:"portrait editing"},r.a.createElement("div",{className:"section centered"},r.a.createElement("img",{src:this.props.source.portrait?this.props.source.portrait:q.a,alt:"portrait"})),r.a.createElement("button",{onClick:function(){return document.getElementById("file-upload").click()}},"select image"),r.a.createElement("input",{type:"file",id:"file-upload",accept:"image/*",style:{display:"none"},onChange:function(t){return e.onFileSelected(t)}}),t)}},{key:"getDisplay",value:function(){return this.props.source.portrait?r.a.createElement("div",{className:"portrait"},r.a.createElement("div",{className:"section centered"},r.a.createElement("img",{src:this.props.source.portrait,alt:"portrait"}))):null}},{key:"render",value:function(){try{return this.props.setValue?this.getEditor():this.getDisplay()}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);H.defaultProps={setValue:null};var X=a(8),J=a.n(X),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={open:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleOpen",value:function(e){e.stopPropagation(),this.setState({open:!this.state.open})}},{key:"render",value:function(){var e=this;try{var t=this.props.disabled?"menu disabled":"menu",a=[];return a.push(r.a.createElement("div",{key:"selection",className:"menu-top"},r.a.createElement("div",{className:"menu-text"},this.props.text),r.a.createElement("img",{className:"arrow",src:M.a,alt:"arrow"}))),this.state.open&&(t+=" open",a.push(r.a.createElement("div",{key:"options",className:"menu-content"},this.props.content))),r.a.createElement("div",{className:t,onClick:function(t){return e.toggleOpen(t)}},a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);U.defaultProps={disabled:!1};var _=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e="descriptive";return this.props.white&&(e+=" white"),r.a.createElement("div",{className:e},this.props.content)}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);_.defaultProps={white:!1};var B=new J.a.Converter,Z=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"createTraitPanel",value:function(e,t,a){var n=this;return r.a.createElement(K,{key:e.id,trait:e,mode:this.props.mode,prevTrait:t,nextTrait:a,changeValue:function(e,t,a){return n.props.changeValue(e,t,a)},removeTrait:function(e){return n.props.removeTrait(e)},copyTrait:function(e){return n.props.copyTrait(e)},swapTraits:function(e,t){return n.props.swapTraits(e,t)}})}},{key:"createSection",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e[t];if(0===n.length)return null;var s=null;if(a)switch(t){case"legendary":s=r.a.createElement(_,{content:"one legendary action can be used at the end of each other combatant's turn; spent actions are refreshed at the start of the monster's turn",white:!0});break;case"lair":s=r.a.createElement(_,{content:"one lair action can be taken each round on initiative 20",white:!0})}return r.a.createElement("div",{className:"edit"===this.props.mode?"group-panel":"section"},r.a.createElement("div",{className:"section subheading"},d.traitType(t,!0)),s,n)}},{key:"render",value:function(){var e=this;try{var t={};return f.forEach((function(a){for(var n=e.props.combatant.traits.filter((function(e){return e.type===a})).filter((function(t){return d.match(e.props.filter,t.name)})),r=[],s=0;s!==n.length;++s){var i=n[s],o=0!==s?n[s-1]:null,c=s!==n.length-1?n[s+1]:null;r.push(e.createTraitPanel(i,o,c))}t[a]=r})),"edit"===this.props.mode?r.a.createElement("div",null,r.a.createElement(U,{text:"add a new...",content:r.a.createElement("div",null,r.a.createElement("button",{key:"trait",onClick:function(){return e.props.addTrait("trait")}},"add a new trait"),r.a.createElement("button",{key:"action",onClick:function(){return e.props.addTrait("action")}},"add a new action"),r.a.createElement("button",{key:"bonus",onClick:function(){return e.props.addTrait("bonus")}},"add a new bonus action"),r.a.createElement("button",{key:"reaction",onClick:function(){return e.props.addTrait("reaction")}},"add a new reaction"),r.a.createElement("button",{key:"legendary",onClick:function(){return e.props.addTrait("legendary")}},"add a new legendary action"),r.a.createElement("button",{key:"lair",onClick:function(){return e.props.addTrait("lair")}},"add a new lair action"))}),r.a.createElement("div",{className:"divider"}),this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction"),this.createSection(t,"legendary"),this.createSection(t,"lair")):0===this.props.combatant.traits.length?r.a.createElement("div",null,r.a.createElement("i",null,"no traits or actions")):"combat"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action")):"combat-special"===this.props.mode?r.a.createElement("div",null,this.createSection(t,"legendary",!0),this.createSection(t,"lair",!0)):r.a.createElement("div",null,this.createSection(t,"trait"),this.createSection(t,"action"),this.createSection(t,"bonus"),this.createSection(t,"reaction"),this.createSection(t,"legendary"),this.createSection(t,"lair"))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Z.defaultProps={mode:"view",filter:"",addTrait:null,copyTrait:null,removeTrait:null,changeValue:null,swapTraits:null};var K=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=0,a=this.props.trait.name||"unnamed "+d.traitType(this.props.trait.type,!1);if(this.props.trait.usage){var n="";this.props.trait.usage.toLowerCase().startsWith("recharge ")&&(t=1,this.props.trait.uses>0&&(n="; used"));var s=this.props.trait.usage.toLowerCase().match(/(\d+)\s*\/\s*day/);s&&(t=parseInt(s[1],10),this.props.trait.uses>0&&(n="; used "+this.props.trait.uses)),a+=" *("+this.props.trait.usage+n+")*"}"legendary"===this.props.trait.type&&(t=1,this.props.trait.uses>0&&(a+=" *(used)*"));var i="**"+a+"** "+this.props.trait.text;switch(this.props.mode){case"view":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:B.makeHtml(i)}}));case"edit":var o=r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-6 medium-8 large-8"},r.a.createElement("input",{type:"text",placeholder:"name",value:this.props.trait.name,onChange:function(t){return e.props.changeValue(e.props.trait,"name",t.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"usage",value:this.props.trait.usage,onChange:function(t){return e.props.changeValue(e.props.trait,"usage",t.target.value)}})),r.a.createElement("div",{className:"columns small-6 medium-4 large-4"},r.a.createElement("div",{className:"trait-ordering"},r.a.createElement("img",{className:this.props.prevTrait?"up":"up disabled",src:T.a,alt:"move up",onClick:function(){return e.props.swapTraits(e.props.trait,e.props.prevTrait)}}),r.a.createElement("img",{className:this.props.nextTrait?"":"disabled",src:T.a,alt:"move down",onClick:function(){return e.props.swapTraits(e.props.trait,e.props.nextTrait)}})),r.a.createElement(C,{text:"delete",callback:function(){return e.props.removeTrait(e.props.trait)}}))),r.a.createElement("textarea",{placeholder:"details",value:this.props.trait.text,onChange:function(t){return e.props.changeValue(e.props.trait,"text",t.target.value)}})),c=this.props.trait.name||"unnamed "+d.traitType(this.props.trait.type,!1);return this.props.trait.usage&&(c+=" ("+this.props.trait.usage+")"),r.a.createElement(A,{text:c,content:o});case"template":return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:B.makeHtml(i)}}),r.a.createElement("button",{onClick:function(){return e.props.copyTrait(e.props.trait)}},"copy"));case"combat":case"combat-special":var l="",u=null;if(t>0)this.props.trait.uses>=t?(l="strikethrough",u=r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",0)}},"recharge")):u=r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.trait,"uses",e.props.trait.uses+1)}},"use");return r.a.createElement("div",{key:this.props.trait.id,className:"section trait"},r.a.createElement("div",{className:l,dangerouslySetInnerHTML:{__html:B.makeHtml(i)}}),u)}}catch(m){return console.error(m),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Q=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"card"},this.props.heading,r.a.createElement("div",{className:"card-content"},this.props.content))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Q.defaultProps={heading:null,content:null};var $=a(16),ee=a.n($),te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showDetails:!1,cloneName:e.combatant.name+" copy",combatMode:"main",damageOrHealing:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCloneName",value:function(e){this.setState({cloneName:e})}},{key:"toggleDetails",value:function(){this.setState({showDetails:!this.state.showDetails})}},{key:"setDamage",value:function(e){this.setState({damageOrHealing:e})}},{key:"nudgeDamage",value:function(e){this.setState({damageOrHealing:Math.max(this.state.damageOrHealing+e,0)})}},{key:"setCombatMode",value:function(e){this.setState({combatMode:e})}},{key:"heal",value:function(){var e=this,t=this.props.combatant,a=(t.hp?t.hp:0)+this.state.damageOrHealing;a=Math.min(a,this.props.combatant.hpMax),this.setState({damageOrHealing:0},(function(){e.props.changeHP(t,a,e.props.combatant.hpTemp)}))}},{key:"damage",value:function(){var e=this,t=this.props.combatant,a=t.hp?t.hp:0,n=this.props.combatant.hpTemp,r=this.state.damageOrHealing,s=Math.min(r,n);r-=s,n-=s,a-=r,a=Math.max(a,0),this.setState({damageOrHealing:0},(function(){e.props.changeHP(t,a,n)}))}},{key:"description",value:function(){var e=this.props.combatant.size,t=this.props.combatant;t&&(e=t.displaySize||e);var a=(e+" "+this.props.combatant.category).toLowerCase();this.props.combatant.tag&&(a+=" ("+this.props.combatant.tag.toLowerCase()+")"),a+=", ";var n="";return this.props.combatant.alignment&&(n=this.props.combatant.alignment.toLowerCase()+", "),a+n+("cr "+d.challenge(this.props.combatant.challenge))}},{key:"monsterIsInWave",value:function(e){var t=this;return e.slots.some((function(e){var a=t.props.library.find((function(e){return e.monsters.includes(t.props.combatant)}));return!!a&&e.monsterGroupName===a.name&&e.monsterName===t.props.combatant.name}))}},{key:"getHP",value:function(){if(0===this.props.combatant.hitDice)return this.props.combatant.hpMax;var e=d.hitDieType(this.props.combatant.size),t=d.modifierValue(this.props.combatant.abilityScores.con)*this.props.combatant.hitDice,a="";return t>0&&(a=" +"+t),t<0&&(a=" "+t),this.props.combatant.hpMax+" ("+this.props.combatant.hitDice+"d"+e+a+")"}},{key:"getCombatControls",value:function(){var e=this,t=this.props.combatant,a=[],n=["main","hp","cond","map","adv"].map((function(e){return{id:e,text:e}}));switch(-1===this.props.mode.indexOf("tactical")&&n.splice(3,1),a.push(r.a.createElement(F,{key:"selector",options:n,selectedID:this.state.combatMode,select:function(t){return e.setCombatMode(t)}})),a.push(r.a.createElement("div",{key:"selector-sep",className:"divider"})),this.state.combatMode){case"main":t.pending||!t.active||t.defeated||(t.current?(a.push(r.a.createElement("button",{key:"endTurn",onClick:function(){return e.props.endTurn(t)}},"end turn")),a.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(t)}},"mark as defeated and end turn"))):(a.push(r.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(t)}},"start turn")),a.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(t)}},"mark as defeated")))),t.pending||t.active||!t.defeated||a.push(r.a.createElement("button",{key:"makeActive",onClick:function(){return e.props.makeActive(t)}},"mark as active")),a.push(r.a.createElement("div",{key:"tag-sep",className:"divider"})),-1!==this.props.mode.indexOf("tactical")&&a.push(r.a.createElement(E,{key:"hidden",label:"hidden",display:"switch",checked:!t.showOnMap,changeValue:function(a){return e.props.changeValue(t,"showOnMap",!a)}})),a.push(r.a.createElement(w,{key:"tags",controls:k.map((function(a){return r.a.createElement(E,{key:a,label:a,display:"button",checked:t.tags.includes(a),changeValue:function(n){return e.props.toggleTag(t,a)}})}))}));break;case"hp":a.push(r.a.createElement("div",{key:"hp"},r.a.createElement(G,{source:this.props.combatant,name:"hp",label:"hit points",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hp",t)}}),r.a.createElement(G,{source:this.props.combatant,name:"hpTemp",label:"temp hp",factors:[1,10],nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"hpTemp",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",this.props.combatant.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",this.props.combatant.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",this.props.combatant.damage.immune),r.a.createElement(G,{source:this.state,name:"damageOrHealing",factors:[1,10],nudgeValue:function(t){return e.nudgeDamage(t)}}),r.a.createElement(w,{controls:[r.a.createElement("button",{key:"heal",onClick:function(){return e.heal()}},"heal"),r.a.createElement("button",{key:"reset",onClick:function(){return e.setDamage(0)}},"reset"),r.a.createElement("button",{key:"damage",onClick:function(){return e.damage()}},"damage")],disabled:0===this.state.damageOrHealing})));break;case"cond":a.push(r.a.createElement("div",{key:"conditions"},r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities),r.a.createElement(Y,{combatant:this.props.combatant,combat:this.props.combat,addCondition:function(){return e.props.addCondition(e.props.combatant)},editCondition:function(t){return e.props.editCondition(e.props.combatant,t)},removeCondition:function(t){return e.props.removeCondition(e.props.combatant,t)},nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)}})));break;case"map":if(-1!==this.props.mode.indexOf("on-map")){a.push(r.a.createElement("div",{key:"mapMove",className:"section centered"},r.a.createElement(P,{direction:"eight",click:function(a){return e.props.mapMove(t,a)}}))),a.push(r.a.createElement("div",{key:"move-sep",className:"divider"})),a.push(r.a.createElement(G,{key:"altitude",source:t,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(a){return e.props.nudgeValue(t,"altitude",5*a)}}));var s=null;if(t.aura.radius>0){s=r.a.createElement("div",null,r.a.createElement(F,{options:[{id:"square",text:"square"},{id:"rounded",text:"rounded"},{id:"circle",text:"circle"}],selectedID:t.aura.style,select:function(a){return e.props.changeValue(t.aura,"style",a)}}),r.a.createElement("input",{type:"color",value:t.aura.color,onChange:function(a){return e.props.changeValue(t.aura,"color",a.target.value)}}))}a.push(r.a.createElement(A,{key:"aura",text:"aura",content:r.a.createElement("div",null,r.a.createElement(G,{source:t.aura,name:"radius",label:"size",display:function(e){return e+" ft."},nudgeValue:function(a){return e.props.nudgeValue(t.aura,"radius",5*a)}}),s)})),a.push(r.a.createElement("button",{key:"mapRemove",onClick:function(){return e.props.mapRemove(t)}},"remove from map"))}-1!==this.props.mode.indexOf("off-map")&&a.push(r.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(t)}},"add to map"));break;case"adv":t.current||a.push(r.a.createElement(C,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(t)}})),t.pending||a.push(r.a.createElement(A,{key:"init",text:"change initiative score",content:r.a.createElement("div",null,r.a.createElement(G,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}))})),a.push(r.a.createElement(A,{key:"size",text:"change size",content:r.a.createElement("div",null,r.a.createElement(G,{source:this.props.combatant,name:"displaySize",label:"size",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"displaySize",t)}}))})),a.push(r.a.createElement(A,{key:"rename",text:"change name",content:r.a.createElement("div",null,r.a.createElement("input",{type:"text",value:t.displayName,onChange:function(t){return e.props.changeValue(e.props.combatant,"displayName",t.target.value)}}))}))}return r.a.createElement("div",null,r.a.createElement("div",{className:"group-panel"},a),r.a.createElement("div",{className:"divider"}))}},{key:"render",value:function(){var e=this;try{var t=[];if(-1===this.props.mode.indexOf("no-buttons")){if(-1!==this.props.mode.indexOf("view")){if(-1!==this.props.mode.indexOf("editable")){t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editMonster(e.props.combatant)}},"edit monster")),t.push(r.a.createElement(A,{key:"clone",text:"clone monster",content:r.a.createElement("div",null,r.a.createElement("input",{type:"text",placeholder:"monster name",value:this.state.cloneName,onChange:function(t){return e.setCloneName(t.target.value)}}),r.a.createElement("button",{onClick:function(){return e.props.cloneMonster(e.props.combatant,e.state.cloneName)}},"create copy"))}));var a=[];this.props.library.forEach((function(t){-1===t.monsters.indexOf(e.props.combatant)&&a.push({id:t.id,text:t.name})})),t.push(r.a.createElement(I,{key:"move",options:a,placeholder:"move to group...",select:function(t){return e.props.moveToGroup(e.props.combatant,t)}})),t.push(r.a.createElement(C,{key:"remove",text:"delete monster",callback:function(){return e.props.removeMonster(e.props.combatant)}}))}if(-1!==this.props.mode.indexOf("encounter"))if(this.props.slot)t.push(r.a.createElement("button",{key:"remove",onClick:function(){return e.props.removeEncounterSlot(e.props.slot)}},"remove from encounter"));else{var n=!1;if(this.monsterIsInWave(this.props.encounter)||(t.push(r.a.createElement("button",{key:"add encounter",onClick:function(){return e.props.addEncounterSlot(e.props.combatant,null)}},"add to encounter")),n=!0),this.props.encounter.waves.forEach((function(a){e.monsterIsInWave(a)||(t.push(r.a.createElement("button",{key:"add "+a.id,onClick:function(){return e.props.addEncounterSlot(e.props.combatant,a.id)}},"add to ",a.name)),n=!0)})),!n)return r.a.createElement(Q,{heading:r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.combatant.name)),content:r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,"this monster is already part of this encounter"))})}-1!==this.props.mode.indexOf("candidate")&&(-1===this.props.mode.indexOf("selected")?t.push(r.a.createElement("button",{key:"select",onClick:function(){return e.props.selectMonster(e.props.combatant)}},"select monster")):t.push(r.a.createElement("button",{key:"deselect",onClick:function(){return e.props.deselectMonster(e.props.combatant)}},"deselect monster")))}this.props.mode.indexOf("template")}var s=null;-1!==this.props.mode.indexOf("combat")&&(s=this.getCombatControls());var i=null;if(-1!==this.props.mode.indexOf("view")){var o=null;this.props.slot&&(o=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement(G,{source:this.props.slot,name:"count",label:"count",nudgeValue:function(t){return e.props.nudgeValue(e.props.slot,"count",t)}})));var c=null;(this.state.showDetails||-1!==this.props.mode.indexOf("generated"))&&(c=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"ac")," ",this.props.combatant.ac),r.a.createElement("div",{className:"section",style:{display:0!==this.props.combatant.hpMax?"":"none"}},r.a.createElement("b",null,"hp")," ",this.getHP()),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.speed?"":"none"}},r.a.createElement("b",null,"speed")," ",this.props.combatant.speed),r.a.createElement("div",{className:"section"},r.a.createElement(L,{combatant:this.props.combatant})),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.savingThrows?"":"none"}},r.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.skills?"":"none"}},r.a.createElement("b",null,"skills")," ",this.props.combatant.skills),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",this.props.combatant.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",this.props.combatant.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",this.props.combatant.damage.immune),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.senses?"":"none"}},r.a.createElement("b",null,"senses")," ",this.props.combatant.senses),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.languages?"":"none"}},r.a.createElement("b",null,"languages")," ",this.props.combatant.languages),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.equipment?"":"none"}},r.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment),r.a.createElement("div",{className:"divider"}),r.a.createElement(Z,{combatant:this.props.combatant}))),i=r.a.createElement("div",{className:"stats"},r.a.createElement(H,{source:this.props.combatant}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),o,c)}-1!==this.props.mode.indexOf("combat")&&(i=r.a.createElement("div",{className:"stats"},r.a.createElement(H,{source:this.props.combatant}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),r.a.createElement("div",{className:"divider"}),s,r.a.createElement("div",{className:"section"},r.a.createElement(L,{combatant:this.props.combatant})),r.a.createElement("div",{className:"section",style:{display:0!==this.props.combatant.ac?"":"none"}},r.a.createElement("b",null,"ac")," ",this.props.combatant.ac),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.savingThrows?"":"none"}},r.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.skills?"":"none"}},r.a.createElement("b",null,"skills")," ",this.props.combatant.skills),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.speed?"":"none"}},r.a.createElement("b",null,"speed")," ",this.props.combatant.speed),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.senses?"":"none"}},r.a.createElement("b",null,"senses")," ",this.props.combatant.senses),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.resist?"":"none"}},r.a.createElement("b",null,"damage resistances")," ",this.props.combatant.damage.resist),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.vulnerable?"":"none"}},r.a.createElement("b",null,"damage vulnerabilities")," ",this.props.combatant.damage.vulnerable),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.damage.immune?"":"none"}},r.a.createElement("b",null,"damage immunities")," ",this.props.combatant.damage.immune),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.conditionImmunities?"":"none"}},r.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.languages?"":"none"}},r.a.createElement("b",null,"languages")," ",this.props.combatant.languages),r.a.createElement("div",{className:"section",style:{display:""!==this.props.combatant.equipment?"":"none"}},r.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment),r.a.createElement("div",{className:"divider"}),r.a.createElement(Z,{combatant:this.props.combatant,mode:"combat",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))),-1!==this.props.mode.indexOf("template")&&(-1!==this.props.mode.indexOf("overview")&&(i=r.a.createElement("div",null,r.a.createElement(H,{source:this.props.combatant}),r.a.createElement("div",{className:"section centered"},r.a.createElement("i",null,this.description())),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"speed")," ",this.props.combatant.speed||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"senses")," ",this.props.combatant.senses||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"languages")," ",this.props.combatant.languages||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"equipment")," ",this.props.combatant.equipment||"-"))),-1!==this.props.mode.indexOf("abilities")&&(i=r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement(L,{combatant:this.props.combatant})),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"saving throws")," ",this.props.combatant.savingThrows||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"skills")," ",this.props.combatant.skills||"-"))),-1!==this.props.mode.indexOf("cbt-stats")&&(i=r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"ac")," ",this.props.combatant.ac),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"hp")," ",this.getHP()),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage immunity")," ",this.props.combatant.damage.immune||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage resistance")," ",this.props.combatant.damage.resist||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"damage vulnerability")," ",this.props.combatant.damage.vulnerable||"-"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"condition immunities")," ",this.props.combatant.conditionImmunities||"-"))),-1!==this.props.mode.indexOf("actions")&&(i=r.a.createElement(Z,{combatant:this.props.combatant,mode:"template",filter:this.props.filter,copyTrait:function(t){return e.props.copyTrait(t)}})));var l=null;if(-1!==this.props.mode.indexOf("combat"));else if(-1!==this.props.mode.indexOf("template"));else if(-1!==this.props.mode.indexOf("view generated"));else{var u=this.state.showDetails?"image rotate":"image";l=r.a.createElement("img",{className:u,src:ee.a,alt:"arrow",onClick:function(){return e.toggleDetails()}})}var m=(this.props.combatant?this.props.combatant.displayName:null)||this.props.combatant.name||"unnamed monster";return r.a.createElement("div",{className:"card monster"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},m),l),r.a.createElement("div",{className:"card-content"},i,r.a.createElement("div",{style:{display:t.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},t))))}catch(d){return console.error(d),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);te.defaultProps={library:null,changeValue:null,nudgeValue:null,filter:"",editMonster:null,removeMonster:null,cloneMonster:null,moveToGroup:null,copyTrait:null,selectMonster:null,deselectMonster:null,encounter:null,slot:null,addEncounterSlot:null,removeEncounterSlot:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,changeHP:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null,toggleTag:null};var ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=["all sizes"].concat(h).map((function(e){return{id:e,text:e}})),a=["all types"].concat(v).map((function(e){return{id:e,text:e}})),n=r.a.createElement("div",null,r.a.createElement("input",{type:"text",placeholder:"name",value:this.props.filter.name,onChange:function(t){return e.props.changeValue("name",t.target.value)}}),r.a.createElement(G,{source:this.props.filter,name:"challengeMin",label:"min cr",display:function(e){return d.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMin",t)}}),r.a.createElement(G,{source:this.props.filter,name:"challengeMax",label:"max cr",display:function(e){return d.challenge(e)},nudgeValue:function(t){return e.props.nudgeValue("challengeMax",t)}}),r.a.createElement(I,{options:t,placeholder:"filter by size...",selectedID:this.props.filter.size,select:function(t){return e.props.changeValue("size",t)}}),r.a.createElement(I,{options:a,placeholder:"filter by type...",selectedID:this.props.filter.category,select:function(t){return e.props.changeValue("category",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.resetFilter()}},"clear filter"))),s="showing "+y.getFilterDescription(this.props.filter);return r.a.createElement(A,{text:s,content:n})}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={combatantSlots:e.combatantSlots,filter:p.createMonsterFilter()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"changeFilterValue",value:function(e,t){this.state.filter[e]=t,this.setState({filter:this.state.filter})}},{key:"nudgeFilterValue",value:function(e,t){var a=d.nudgeChallenge(this.state.filter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({filter:p.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return y.matchMonster(e,this.state.filter)}},{key:"selectMonster",value:function(e){var t=p.createEncounterSlot();t.monsterGroupName=d.getMonsterGroup(e,this.props.library).name,t.monsterName=e.name,this.state.combatantSlots.push(t),this.state.combatantSlots.sort((function(e,t){return e.monsterName<t.monsterName?-1:e.monsterName>t.monsterName?1:0})),this.setState({combatantSlots:this.state.combatantSlots})}},{key:"deselectMonster",value:function(e){var t=d.getMonsterGroup(e,this.props.library),a=this.state.combatantSlots.find((function(a){return a.monsterGroupName===t.name&&a.monsterName===e.name}));if(a){var n=this.state.combatantSlots.indexOf(a);this.state.combatantSlots.splice(n,1),this.setState({combatantSlots:this.state.combatantSlots})}}},{key:"nudgeMonsterCount",value:function(e,t){if(e.count+=t,0===e.count){var a=this.props.library.find((function(t){return t.name===e.monsterGroupName}));if(a){var n=a.monsters.find((function(t){return t.name===e.monsterName}));n&&this.deselectMonster(n)}}else this.setState({combatantSlots:this.state.combatantSlots})}},{key:"render",value:function(){var e=this;try{var t=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){e.matchMonster(a)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var a=this.state.combatantSlots.map((function(t){var a=e.props.library.find((function(e){return e.name===t.monsterGroupName}));if(a){var n=a.monsters.find((function(e){return e.name===t.monsterName}));if(n)return n.id}return null})).filter((function(e){return!!e})),n=t.filter((function(e){return!a.includes(e.id)})).map((function(t){return r.a.createElement(te,{key:t.id,combatant:t,mode:"view candidate",selectMonster:function(t){return e.selectMonster(t)}})}));0===n.length&&(n=r.a.createElement(_,{content:r.a.createElement("div",{className:"section"},"there are no monsters that match the above criteria (or you have already selected them all)")}));var s=this.state.combatantSlots.map((function(t){var a=e.props.library.find((function(e){return e.name===t.monsterGroupName}));if(a){var n=a.monsters.find((function(e){return e.name===t.monsterName}));if(n)return r.a.createElement(te,{key:n.id,combatant:n,slot:t,mode:"view candidate selected",deselectMonster:function(t){return e.deselectMonster(t)},nudgeValue:function(a,n,r){return e.nudgeMonsterCount(t,r)}})}return null}));return r.a.createElement("div",{className:"add-combatants-modal"},r.a.createElement("div",{className:"row",style:{height:"100%"}},r.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},r.a.createElement("div",{className:"heading"},"monsters in library"),r.a.createElement(ae,{filter:this.state.filter,changeValue:function(t,a){return e.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),r.a.createElement("div",{className:"divider"}),n),r.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},r.a.createElement("div",{className:"heading"},"selected monsters"),s)))}catch(i){return console.error(i),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={selectedPartyID:e.party?e.party.id:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectParty",value:function(e){this.setState({selectedPartyID:e})}},{key:"render",value:function(){var e=this;try{var t,a,n=y.getMonsterCount(this.props.encounter),s=y.getEncounterXP(this.props.encounter,this.props.getMonster),i=y.getAdjustedEncounterXP(this.props.encounter,this.props.getMonster),o=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"xp for this encounter",r.a.createElement("div",{className:"right"},s," xp")),r.a.createElement("div",{className:"section",style:{display:i===s?"none":""}},"effective xp for ",n," monster(s)",r.a.createElement("div",{className:"right"},i," xp"))),c=this.props.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(c){var l=0,u=0,m=0,p=0,h=c.pcs.filter((function(e){return e.active}));h.forEach((function(e){l+=d.pcExperience(e.level,"easy"),u+=d.pcExperience(e.level,"medium"),m+=d.pcExperience(e.level,"hard"),p+=d.pcExperience(e.level,"deadly")}));var v="trivial",f="trivial";if(i>0&&(i>=l&&(v="easy",f="easy"),i>=u&&(v="medium",f="medium"),i>=m&&(v="hard",f="hard"),i>=p&&(v="deadly",f="deadly"),h.length<3||h.length>5)){var b=h.length<3;switch(v){case"trivial":f=b?"easy":"trivial";break;case"easy":f=b?"medium":"trivial";break;case"medium":f=b?"hard":"easy";break;case"hard":f=b?"deadly":"medium";break;case"deadly":f=b?"deadly":"hard";break;default:f=""}}t=r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell four easy"},r.a.createElement("b",null,"easy")),r.a.createElement("div",{className:"cell four medium"},r.a.createElement("b",null,"medium")),r.a.createElement("div",{className:"cell four hard"},r.a.createElement("b",null,"hard")),r.a.createElement("div",{className:"cell four deadly"},r.a.createElement("b",null,"deadly"))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell four"},l," xp"),r.a.createElement("div",{className:"cell four"},u," xp"),r.a.createElement("div",{className:"cell four"},m," xp"),r.a.createElement("div",{className:"cell four"},p," xp")));var g=function(e){return 100*e/Math.max(i,1.2*p)},E=function(e){return 100-g(e)};a=r.a.createElement("div",null,r.a.createElement("div",{className:"difficulty-gauge"},r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar trivial",style:{left:"0",right:E(l)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar easy",style:{left:g(l)+"%",right:E(u)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar medium",style:{left:g(u)+"%",right:E(m)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar hard",style:{left:g(m)+"%",right:E(p)+"%"}})),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar deadly",style:{left:g(p)+"%",right:"0"}})),r.a.createElement("div",{className:"encounter-container"},r.a.createElement("div",{className:"encounter",style:{left:g(i)-.5+"%"}}))),o,r.a.createElement("div",{className:"section"},"difficulty for this party",r.a.createElement("div",{className:"right"},v)),r.a.createElement("div",{className:"section",style:{display:f===v?"none":""}},"effective difficulty for ",h.length," pc(s)",r.a.createElement("div",{className:"right"},r.a.createElement("b",null,f))))}else a=o;var k=null;if(!this.props.party){var N=[];if(this.props.parties)for(var x=0;x!==this.props.parties.length;++x){var C=this.props.parties[x];N.push({id:C.id,text:C.name})}k=r.a.createElement(I,{options:N,placeholder:"select party...",selectedID:this.state.selectedPartyID?this.state.selectedPartyID:void 0,select:function(t){return e.selectParty(t)},clear:function(){return e.selectParty(null)}})}return r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"subheading"},"difficulty"),k,t,a)}catch(w){return console.error(w),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);re.defaultProps={party:null};var se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=this.props.combatant.hp||0,t=this.props.combatant.hpMax+this.props.combatant.hpTemp,a=this.props.combatant.hpMax/2,n=100*Math.max(e,0)/t,s="";s=e>=this.props.combatant.hpMax?"bar unhurt":e<=a?"bar bloodied":"bar injured";var i=null;if(this.props.combatant.hpTemp>0){var o=100*Math.max(this.props.combatant.hpTemp,0)/t;i=r.a.createElement("div",{className:"bar temp",style:{width:o+"%"}})}return r.a.createElement("div",{className:"hp-gauge"},r.a.createElement("div",{className:s,style:{width:n+"%"}}),i)}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setZoom",value:function(e){this.setState({zoom:Math.max(5,e)})}},{key:"getMapDimensions",value:function(e){var t=this,a=null;if(this.props.map.items.filter((function(e){return"edit"!==t.props.mode||"tile"===e.type})).forEach((function(e){a?(a.minX=Math.min(a.minX,e.x),a.maxX=Math.max(a.maxX,e.x+e.width-1),a.minY=Math.min(a.minY,e.y),a.maxY=Math.max(a.maxY,e.y+e.height-1)):a={minX:e.x,maxX:e.x+e.width-1,minY:e.y,maxY:e.y+e.height-1}})),this.props.combatants&&this.props.combatants.filter((function(e){return e.aura.radius>0})).forEach((function(e){var n=t.props.map.items.find((function(t){return t.id===e.id}));if(n){var r=e.aura.radius/5,s=1,i=e;i&&(s=d.miniSize(i.size));var o=n.x-r,c=n.x+(s-1)+r,l=n.y-r,u=n.y+(s-1)+r;a&&(a.minX=Math.min(a.minX,o),a.maxX=Math.max(a.maxX,c),a.minY=Math.min(a.minY,l),a.maxY=Math.max(a.maxY,u))}})),!a){if("thumbnail"===this.props.mode)return null;a={minX:0,maxX:0,minY:0,maxY:0}}return a.minX-=e,a.maxX+=e,a.minY-=e,a.maxY+=e,a}},{key:"getStyle",value:function(e,t,a,n,r,s){var i=0,o=0;a<1&&(i=(1-a)/2),n<1&&(o=(1-n)/2);var c="0";switch(r){case"rounded":c=this.props.size+"px";break;case"circle":c="50%"}return{left:"calc("+this.props.size+"px * "+(e+i-s.minX)+")",top:"calc("+this.props.size+"px * "+(t+o-s.minY)+")",width:"calc(("+this.props.size+"px * "+a+") + 1px)",height:"calc(("+this.props.size+"px * "+n+") + 1px)",borderRadius:c,backgroundSize:this.props.size+"px"}}},{key:"render",value:function(){var e=this;try{var t="edit"===this.props.mode?2:0,a=this.getMapDimensions(t);if(!a)return r.a.createElement("div",null,"(blank map)");var n=[];if("edit"===this.props.mode)for(var s=a.minY;s!==a.maxY+1;++s)for(var i=a.minX;i!==a.maxX+1;++i){var o=this.getStyle(i,s,1,1,"square",a);n.push(r.a.createElement(oe,{key:i+","+s,x:i,y:s,style:o,onClick:function(){return e.props.setSelectedItemID(null)}}))}var c=this.props.map.items.filter((function(e){return"tile"===e.type})).map((function(t){var n=e.getStyle(t.x,t.y,t.width,t.height,t.style,a);return r.a.createElement(ce,{key:t.id,tile:t,style:n,selectable:"edit"===e.props.mode,selected:e.props.selectedItemID===t.id,select:function(t){return"edit"===e.props.mode?e.props.setSelectedItemID(t):null}})})),l=[];"edit"!==this.props.mode&&"thumbnail"!==this.props.mode&&(l=this.props.combatants.filter((function(e){return e.aura.radius>0})).filter((function(t){return t.showOnMap||"combat-player"!==e.props.mode})).map((function(t){var n=e.props.map.items.find((function(e){return e.id===t.id}));if(n){var s=t.aura.radius/5,i=2*s+d.miniSize(t.displaySize),o=e.getStyle(n.x-s,n.y-s,i,i,t.aura.style,a);return o.backgroundColor=t.aura.color,r.a.createElement("div",{key:t.id+" aura",className:"aura",style:o})}return null})).filter((function(e){return null!==e})));var u=[];"edit"!==this.props.mode&&(u=this.props.map.items.filter((function(e){return"monster"===e.type||"pc"===e.type})).map((function(t){var n=e.props.combatants.find((function(e){return e.id===t.id}));if(n){var s=d.miniSize(n.displaySize),i=e.getStyle(t.x,t.y,s,s,"circle",a);return r.a.createElement(le,{key:t.id,token:t,combatant:n,style:i,simple:"thumbnail"===e.props.mode,showGauge:"combat"===e.props.mode,showHidden:"combat"===e.props.mode,selectable:"combat"===e.props.mode||"combat-player"===e.props.mode,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.setSelectedItemID(t)}})}return null})).filter((function(e){return null!==e})));var m=[];if(this.props.showOverlay)for(var p=a.minY;p!==a.maxY+1;++p)for(var h=a.minX;h!==a.maxX+1;++h){var v=this.getStyle(h,p,1,1,"square",a);m.push(r.a.createElement(oe,{key:h+","+p,x:h,y:p,style:v,overlay:!0,onClick:function(t,a){return e.props.gridSquareClicked(t,a)}}))}var f="map-panel "+this.props.mode,b=1+a.maxY-a.minY;return r.a.createElement("div",{className:f,onClick:function(){return e.props.setSelectedItemID(null)}},r.a.createElement("div",{className:"grid",style:{height:this.props.size*b+1+"px"}},n,c,l,u,m))}catch(g){return console.error(g),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ie.defaultProps={combatants:null,showOverlay:!1,selectedItemID:null,setSelectedItemID:null,gridSquareClicked:null};var oe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"click",value:function(e){e.stopPropagation(),this.props.onClick&&this.props.onClick(this.props.x,this.props.y)}},{key:"doubleClick",value:function(e){e.stopPropagation(),this.props.onDoubleClick&&this.props.onDoubleClick(this.props.x,this.props.y)}},{key:"render",value:function(){var e=this;try{var t="grid-square";return this.props.overlay&&(t+=" grid-overlay"),r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.click(t)},onDoubleClick:function(t){return e.doubleClick(t)}})}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);oe.defaultProps={overlay:!1,onDoubleClick:null};var ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.tile.id))}},{key:"render",value:function(){var e=this;try{var t="tile "+this.props.tile.terrain;this.props.selected&&(t+=" selected");var a=null;return"custom"===this.props.tile.terrain&&(a=r.a.createElement("img",{className:"custom-image",src:this.props.tile.customBackground?this.props.tile.customBackground:q.a,alt:"map tile"})),r.a.createElement("div",{className:t,style:this.props.style,onClick:function(t){return e.select(t)}},a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.selectable&&(e.stopPropagation(),this.props.select(this.props.token.id))}},{key:"render",value:function(){var e=this;try{var t=this.props.combatant.displayName||this.props.combatant.name||"combatant",a="token "+this.props.token.type;if(this.props.selected&&(a+=" selected"),this.props.combatant.current&&(a+=" current"),!this.props.combatant.showOnMap){if(!this.props.showHidden)return null;a+=" hidden"}var n=null,s=null,i=null,o=null;if(!this.props.simple){if(n=this.props.combatant.portrait?r.a.createElement("img",{className:"portrait",src:this.props.combatant.portrait,alt:t}):r.a.createElement("div",{className:"initials"},t.split(" ").map((function(e){return e[0]}))),"monster"===this.props.combatant.type&&this.props.showGauge){var c=this.props.combatant;(c.hp||0)<c.hpMax&&(s=r.a.createElement(se,{combatant:this.props.combatant}))}this.props.combatant.altitude>0&&(i=r.a.createElement("div",{className:"badge altitude",title:"above the map"},"\u23f6")),this.props.combatant.altitude<0&&(i=r.a.createElement("div",{className:"badge altitude",title:"below the map"},"\u23f7")),this.props.combatant.conditions&&this.props.combatant.conditions.length>0&&(o=r.a.createElement("div",{className:"badge",title:"affected by conditions"},"\u25c6"))}return r.a.createElement("div",{className:a,style:this.props.style,title:t,onClick:function(t){return e.select(t)}},n,s,i,o)}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={combatSetup:e.combatSetup},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setParty",value:function(e){var t=this;this.state.combatSetup.partyID=e,this.setState({combatSetup:this.state.combatSetup},(function(){return t.props.notify()}))}},{key:"setEncounter",value:function(e){var t=this;this.state.combatSetup.encounterID=e;var a=this.props.encounters.find((function(t){return t.id===e}));a&&(this.state.combatSetup.monsterNames=d.getMonsterNames(a)),this.setState({combatSetup:this.state.combatSetup},(function(){return t.props.notify()}))}},{key:"setFolioID",value:function(e){if(e&&""!==e){var t=this.props.mapFolios.find((function(t){return t.id===e}));t&&(this.state.combatSetup.folioID=t.id,this.state.combatSetup.mapID=1===t.maps.length?t.maps[0].id:null)}else this.state.combatSetup.folioID=null,this.state.combatSetup.mapID=null;this.setState({combatSetup:this.state.combatSetup})}},{key:"setMapID",value:function(e){this.state.combatSetup.mapID=e,this.setState({combatSetup:this.state.combatSetup})}},{key:"setWave",value:function(e){var t=this;this.state.combatSetup.waveID=e;var a=this.props.encounters.find((function(e){return e.id===t.state.combatSetup.encounterID}));if(a){var n=a.waves.find((function(t){return t.id===e}));n&&(this.state.combatSetup.monsterNames=d.getMonsterNames(n))}this.setState({combatSetup:this.state.combatSetup},(function(){return t.props.notify()}))}},{key:"setEncounterInitMode",value:function(e){this.state.combatSetup.encounterInitMode=e,this.setState({combatSetup:this.state.combatSetup})}},{key:"changeName",value:function(e,t,a){var n=this.state.combatSetup.monsterNames.find((function(t){return t.id===e}));n&&(n.names[t]=a,this.setState({combatSetup:this.state.combatSetup}))}},{key:"getPartySection",value:function(){var e=this;if(0===this.props.parties.length)return r.a.createElement("div",{className:"section"},"you have not defined any parties");var t=this.props.parties.map((function(e){return{id:e.id,text:e.name||"unnamed party"}})),a=null;if(this.state.combatSetup.partyID){var n=this.props.parties.find((function(t){return t.id===e.state.combatSetup.partyID}));if(n){var s=n.pcs.filter((function(e){return e.active})).map((function(e){return r.a.createElement("li",{key:e.id},e.name||"unnamed pc"," (level ",e.level,")")}));0===s.length&&s.push(r.a.createElement("li",{key:"empty"},"no pcs")),a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"pcs"),r.a.createElement("ul",null,s))}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"party"),r.a.createElement(I,{options:t,placeholder:"select party...",selectedID:this.state.combatSetup.partyID?this.state.combatSetup.partyID:void 0,select:function(t){return e.setParty(t)},clear:function(){return e.setParty(null)}}),a)}},{key:"getEncounterSection",value:function(){var e=this;if(0===this.props.encounters.length)return r.a.createElement("div",{className:"section"},"you have not built any encounters");var t=this.props.encounters.map((function(e){return{id:e.id,text:e.name||"unnamed encounter"}})),a=null;if(this.state.combatSetup.encounterID){var n=this.props.encounters.find((function(t){return t.id===e.state.combatSetup.encounterID}));if(n){var s=n.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("li",{key:e.id},t)}));0===s.length&&s.push(r.a.createElement("li",{key:"empty"},"no monsters"));var i=n.waves.map((function(e){if(0===e.slots.length)return null;var t=e.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" x"+e.count),r.a.createElement("li",{key:e.id},t)}));return r.a.createElement("div",{key:e.id},r.a.createElement("div",{className:"subheading"},e.name||"unnamed wave"),r.a.createElement("ul",null,t))}));a=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),r.a.createElement("ul",null,s),i)}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter"),r.a.createElement(I,{options:t,placeholder:"select encounter...",selectedID:this.state.combatSetup.encounterID?this.state.combatSetup.encounterID:void 0,select:function(t){return e.setEncounter(t)},clear:function(){return e.setEncounter(null)}}),a)}},{key:"getMapSection",value:function(){var e=this,t=this.props.mapFolios.filter((function(e){return e.maps.length>0}));if(0===t.length)return null;var a=[{id:"",text:"none"}].concat(t.map((function(e){return{id:e.id,text:e.name||"unnamed folio"}}))),n=null,s=null;if(this.state.combatSetup.folioID){var i=this.props.mapFolios.find((function(t){return t.id===e.state.combatSetup.folioID}));if(i){var o=i.maps.map((function(e){return{id:e.id,text:e.name||"unnamed map"}}));if(1!==o.length&&(n=r.a.createElement(F,{options:o,selectedID:this.state.combatSetup.mapID,select:function(t){return e.setMapID(t)}})),this.state.combatSetup.mapID){var c=i.maps.find((function(t){return t.id===e.state.combatSetup.mapID}));c&&(s=r.a.createElement(ie,{map:c,mode:"thumbnail",size:10}))}}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"map"),r.a.createElement(I,{options:a,placeholder:"select map folio...",selectedID:this.state.combatSetup.folioID?this.state.combatSetup.folioID:void 0,select:function(t){return e.setFolioID(t)},clear:function(){return e.setFolioID(null)}}),n,s)}},{key:"getWaveSection",value:function(){var e=this;if(null===this.state.combatSetup.encounterID)return r.a.createElement("div",{className:"section"},"you have not selected an encounter");var t=this.props.encounters.find((function(t){return t.id===e.state.combatSetup.encounterID}));if(t){if(0===t.waves.length)return r.a.createElement("div",{className:"section"},"you have not defined any waves");var a=t.waves.map((function(e){return{id:e.id,text:e.name||"unnamed wave"}})),n=null;if(this.state.combatSetup.waveID){var s=t.waves.find((function(t){return t.id===e.state.combatSetup.waveID}));if(s){var i=s.slots.map((function(e){var t=e.monsterName||"unnamed monster";return e.count>1&&(t+=" (x"+e.count+")"),r.a.createElement("li",{key:e.id},t)}));0===i.length&&i.push(r.a.createElement("li",{key:"empty"},"no monsters")),n=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"monsters"),r.a.createElement("ul",null,i))}}return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"wave"),r.a.createElement(I,{options:a,placeholder:"select wave...",selectedID:this.state.combatSetup.waveID?this.state.combatSetup.waveID:void 0,select:function(t){return e.setWave(t)},clear:function(){return e.setWave(null)}}),n)}return null}},{key:"getDifficultySection",value:function(){var e=this,t=this.props.parties.find((function(t){return t.id===e.state.combatSetup.partyID})),a=this.props.encounters.find((function(t){return t.id===e.state.combatSetup.encounterID}));return t&&a?r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement(re,{parties:this.props.parties,party:t,encounter:a,getMonster:function(t,a){return e.props.getMonster(t,a)}})):r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"encounter difficulty"),r.a.createElement("div",{className:"section"},"select a party and an encounter on the left to see difficulty information."))}},{key:"getMonsterSection",value:function(){var e=this;if(null===this.state.combatSetup.encounterID)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select an encounter to see monster options here."));if(!this.props.parties&&null===this.state.combatSetup.waveID)return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"section"},"select a wave to see monster options here."));var t=this.props.encounters.find((function(t){return t.id===e.state.combatSetup.encounterID}));if(t){var a=t;if(this.state.combatSetup.waveID){var n=t.waves.find((function(t){return t.id===e.state.combatSetup.waveID}));n&&(a=n)}if(0===a.slots.length)return null;var s=this.state.combatSetup.monsterNames.map((function(t){var n=a.slots.find((function(e){return e.id===t.id}));if(n){for(var s=[],i=0;i!==t.names.length;++i)s.push(r.a.createElement("div",{key:i},r.a.createElement(me,{value:t.names[i],slotID:n.id,index:i,changeName:function(t,a,n){return e.changeName(t,a,n)}})));return r.a.createElement("div",{key:t.id,className:"name-row"},r.a.createElement("div",{className:"name-label"},n.monsterName),r.a.createElement("div",{className:"name-inputs"},s))}return null}));return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monsters"),r.a.createElement("div",{className:"subheading"},"initiative"),r.a.createElement(F,{options:[{id:"manual",text:"enter manually"},{id:"individual",text:"roll individually"},{id:"group",text:"roll in groups"}],selectedID:this.state.combatSetup.encounterInitMode,select:function(t){return e.setEncounterInitMode(t)}}),r.a.createElement("div",{className:"subheading"},"names"),r.a.createElement("div",null,s))}return null}},{key:"render",value:function(){try{var e=null,t=null;return this.props.parties?(e=r.a.createElement("div",null,this.getPartySection(),this.getEncounterSection(),this.getMapSection()),t=r.a.createElement("div",null,this.getDifficultySection(),this.getMonsterSection())):(e=r.a.createElement("div",null,this.getWaveSection()),t=r.a.createElement("div",null,this.getMonsterSection())),r.a.createElement("div",{className:"row",style:{height:"100%",margin:"0 -15px"}},r.a.createElement("div",{className:"column small-6 medium-6 large-6 scrollable"},e),r.a.createElement("div",{className:"column small-6 medium-6 large-6 scrollable"},t))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);ue.defaultProps={parties:null,mapFolios:null};var me=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("input",{type:"text",value:this.props.value,onChange:function(t){return e.props.changeName(e.props.slotID,e.props.index,t.target.value)}})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),de=["blinded","charmed","deafened","exhaustion","frightened","grappled","incapacitated","invisible","paralyzed","petrified","poisoned","prone","restrained","stunned","unconscious","custom"],pe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=this.props.items.map((function(t){return r.a.createElement(he,{key:t.id,item:t,selected:e.props.selectedItemID===t.id,select:function(t){return e.props.select(t)}})}));return r.a.createElement("div",{className:"radio-group"},t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);pe.defaultProps={};var he=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="radio-item",a=null;return this.props.selected&&(t+=" selected",a=r.a.createElement("div",{className:"radio-item-details"},this.props.item.details)),this.props.item.disabled&&(t+=" disabled"),r.a.createElement("div",{className:t,onClick:function(){return e.props.select(e.props.item.id)}},r.a.createElement("div",{className:"radio-item-text"},this.props.item.text),a)}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={condition:e.condition},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCondition",value:function(e){this.state.condition.name=e,this.state.condition.level=1,this.state.condition.text="custom"===e?"custom condition":null,this.setState({condition:this.state.condition})}},{key:"setDuration",value:function(e){var t=null;switch(e){case"saves":t=p.createConditionDurationSaves();break;case"combatant":(t=p.createConditionDurationCombatant()).combatantID=this.props.combatant.id;break;case"rounds":t=p.createConditionDurationRounds()}this.state.condition.duration=t,this.setState({condition:this.state.condition})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({condition:this.state.condition})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t]+a;"level"===t&&(n=Math.max(n,1),n=Math.min(n,6)),"count"===t&&(n=Math.max(n,1)),"saveDC"===t&&(n=Math.max(n,0)),e[t]=n,this.setState({condition:this.state.condition})}},{key:"render",value:function(){var e=this;try{var t=de.map((function(t){var a=[],n=[];if(t===e.state.condition.name){"custom"===t&&a.push(r.a.createElement("input",{type:"text",placeholder:"custom condition",value:e.state.condition.text?e.state.condition.text:"",onChange:function(t){return e.changeValue(e.state.condition,"text",t.target.value)}})),"exhaustion"===t&&a.push(r.a.createElement(G,{key:"exhaustion-spin",source:e.props.condition,name:"level",label:"exhaustion",nudgeValue:function(t){return e.nudgeValue(e.props.condition,"level",t)}}));for(var s=d.conditionText(e.state.condition),i=0;i!==s.length;++i)n.push(r.a.createElement("li",{key:i,className:"section"},s[i]))}return{id:t,text:t,details:r.a.createElement("div",{key:t},a,r.a.createElement("ul",null,n)),disabled:!!e.props.combatant.conditionImmunities&&-1!==e.props.combatant.conditionImmunities.indexOf(t)}})),a=["str","dex","con","int","wis","cha","death"].map((function(e){return{id:e,text:e}})),n=[{id:"start",text:"start of turn"},{id:"end",text:"end of turn"}],s=this.props.combat.combatants.map((function(e){return{id:e.id,text:e.displayName||e.name||"unnamed monster"}})),i=[{id:"none",text:"until removed (default)",details:r.a.createElement("div",{className:"section"},r.a.createElement("div",null,"the condition persists until it is manually removed"))},{id:"saves",text:"until a successful save",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of saves required"),r.a.createElement(G,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"save dc"),r.a.createElement(G,{source:this.props.condition.duration,name:"saveDC",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"saveDC",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"type of save"),r.a.createElement(F,{options:a,selectedID:this.props.condition.duration?this.props.condition.duration.saveType:null,select:function(t){return e.changeValue(e.props.condition.duration,"saveType",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"make the save at the start or end of the turn"),r.a.createElement(F,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"combatant",text:"until someone's next turn",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"combatant"),r.a.createElement(I,{options:s,selectedID:this.props.condition.duration&&this.props.condition.duration.combatantID||void 0,select:function(t){return e.changeValue(e.props.condition.duration,"combatantID",t)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"start or end of the turn"),r.a.createElement(F,{options:n,selectedID:this.props.condition.duration?this.props.condition.duration.point:null,select:function(t){return e.changeValue(e.props.condition.duration,"point",t)}})))},{id:"rounds",text:"for a number of rounds",details:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"number of rounds"),r.a.createElement(G,{source:this.props.condition.duration,name:"count",nudgeValue:function(t){return e.nudgeValue(e.props.condition.duration,"count",t)}})))}];return r.a.createElement("div",{className:"condition-modal"},r.a.createElement("div",{className:"row",style:{height:"100%"}},r.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},r.a.createElement("div",{className:"heading"},"condition"),r.a.createElement(pe,{items:t,selectedItemID:this.state.condition.name,select:function(t){return e.setCondition(t)}})),r.a.createElement("div",{className:"columns small-6 medium-6 large-6 scrollable"},r.a.createElement("div",{className:"heading"},"duration"),r.a.createElement(pe,{items:i,selectedItemID:this.state.condition.duration?this.state.condition.duration.type:"none",select:function(t){return e.setDuration(t)}}))))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={chart:"challenge"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectChart",value:function(e){this.setState({chart:e})}},{key:"render",value:function(){var e=this;try{var t=null,a=[];if(this.props.library.forEach((function(e){return e.monsters.forEach((function(e){return a.push(e)}))})),0!==a.length){var n=[],s=0,i={};switch(this.state.chart){case"challenge":[0,.125,.25,.5,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].forEach((function(e){n.push({value:e,title:"challenge "+d.challenge(e)})})),n.forEach((function(e){var t=e.value;i[t.toString()]=a.filter((function(e){return e.challenge===t}))})),n.forEach((function(e){var t=e.value;s=Math.max(i[t].length,s)}));break;case"size":h.forEach((function(e){n.push({value:e,title:e})})),n.forEach((function(e){var t=e.value;i[t.toString()]=a.filter((function(e){return e.size===t}))})),n.forEach((function(e){var t=e.value;s=Math.max(i[t].length,s)}));break;case"type":v.forEach((function(e){n.push({value:e,title:e})})),n.forEach((function(e){var t=e.value;i[t.toString()]=a.filter((function(e){return e.category===t}))})),n.forEach((function(e){var t=e.value;s=Math.max(i[t].length,s)}))}for(var o=[],c=0;c!==n.length;++c){var l=n[c],u=i[l.value],m=u?u.length:0;o.push(r.a.createElement("div",{key:l.title,className:"bar-container",title:l.title+": "+u.length+" monsters"},r.a.createElement("div",{className:"bar",style:{width:"calc((100% - 1px) * "+m+" / "+s+")"}})))}t=r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"monster demographics"),r.a.createElement(F,{options:[{id:"challenge",text:"challenge rating"},{id:"size",text:"size"},{id:"type",text:"type"}],selectedID:this.state.chart,select:function(t){return e.selectChart(t)}}),r.a.createElement("div",{className:"chart"},r.a.createElement("div",{className:"plot"},o)))}return t}catch(p){return console.error(p),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),be=["cavern","dirt","flagstone","floorboard","grassland","pit","sand","snow","water","custom"],ge=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=be.map((function(e){return{id:e,text:e}})),a=["square","rounded","circle"].map((function(e){return{id:e,text:e}})),n=null;return"custom"===this.props.tile.terrain&&(n=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"custom image"),r.a.createElement("button",{onClick:function(){return document.getElementById("file-upload").click()}},"select image"),r.a.createElement("input",{type:"file",id:"file-upload",accept:"image/*",style:{display:"none"},onChange:function(t){if(t.target.files){var a=new FileReader;a.onload=function(t){if(t.target){var a=t.target.result;e.props.changeValue(e.props.tile,"customBackground",a)}},a.readAsDataURL(t.target.files[0])}}}),r.a.createElement("button",{onClick:function(){return e.props.changeValue(e.props.tile,"customBackground","")}},"clear image"))),r.a.createElement("div",{className:"card map-tile"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},"map tile")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement("div",{className:"section"},this.props.tile.width," sq x ",this.props.tile.height," sq"),r.a.createElement("div",{className:"section"},5*this.props.tile.width," ft x ",5*this.props.tile.height," ft"),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"terrain"),r.a.createElement(I,{options:t,placeholder:"select terrain",selectedID:this.props.tile.terrain?this.props.tile.terrain:void 0,select:function(t){return e.props.changeValue(e.props.tile,"terrain",t)}}),n,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"style"),r.a.createElement(F,{options:a,selectedID:this.props.tile.style,select:function(t){return e.props.changeValue(e.props.tile,"style",t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"move"),r.a.createElement("div",{className:"section centered"},r.a.createElement(P,{direction:"out",click:function(t){return e.props.moveMapItem(e.props.tile,t)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"resize"),r.a.createElement("div",{className:"section centered"},r.a.createElement(P,{direction:"both",click:function(t,a){return e.props.resizeMapItem(e.props.tile,t,a)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.cloneMapItem(e.props.tile)}},"clone tile"),r.a.createElement("button",{onClick:function(){return e.props.removeMapItem(e.props.tile)}},"remove tile"))))}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={map:e.map,selectedTileID:null,addingTile:!1,mapSize:30},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setSelectedTileID",value:function(e){this.setState({selectedTileID:e})}},{key:"toggleAddingTile",value:function(){this.setState({addingTile:!this.state.addingTile})}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:this.state.mapSize+e})}},{key:"addMapTile",value:function(e,t){var a=p.createMapItem();a.x=e,a.y=t,a.style="square",a.terrain="flagstone",this.state.map.items.push(a),this.setState({map:this.state.map,selectedTileID:a.id,addingTile:!1})}},{key:"moveMapItem",value:function(e,t){switch(t){case"N":e.y-=1;break;case"E":e.x+=1;break;case"S":e.y+=1;break;case"W":e.x-=1}this.setState({map:this.state.map})}},{key:"bigMapItem",value:function(e,t){switch(t){case"N":e.y-=1,e.height+=1;break;case"E":e.width+=1;break;case"S":e.height+=1;break;case"W":e.x-=1,e.width+=1}this.setState({map:this.state.map})}},{key:"smallMapItem",value:function(e,t){switch(t){case"N":e.height>1&&(e.y+=1,e.height-=1);break;case"E":e.width>1&&(e.width-=1);break;case"S":e.height>1&&(e.height-=1);break;case"W":e.width>1&&(e.x+=1,e.width-=1)}this.setState({map:this.state.map})}},{key:"resizeMapItem",value:function(e,t,a){switch(a){case"in":this.smallMapItem(e,t);break;case"out":this.bigMapItem(e,t)}}},{key:"cloneMapItem",value:function(e){var t=JSON.parse(JSON.stringify(e));t.id=d.guid(),t.x+=1,t.y+=1,this.state.map.items.push(t),this.setState({map:this.state.map,selectedTileID:t.id})}},{key:"removeMapItem",value:function(e){var t=this.state.map.items.indexOf(e);this.state.map.items.splice(t,1),this.setState({map:this.state.map,selectedTileID:null})}},{key:"rotateMap",value:function(){g.rotateMap(this.state.map),this.setState({map:this.state.map})}},{key:"clearMap",value:function(){this.state.map.items=[],this.setState({map:this.state.map,selectedTileID:null})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({map:this.state.map})}},{key:"render",value:function(){var e=this;try{var t=null;if(this.state.selectedTileID){var a=this.state.map.items.find((function(t){return t.id===e.state.selectedTileID}));a&&(t=r.a.createElement("div",{className:"tools"},r.a.createElement(ge,{tile:a,moveMapItem:function(t,a){return e.moveMapItem(t,a)},resizeMapItem:function(t,a,n){return e.resizeMapItem(t,a,n)},cloneMapItem:function(t){return e.cloneMapItem(t)},removeMapItem:function(t){return e.removeMapItem(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}})))}else t=r.a.createElement("div",{className:"tools"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("p",null,"to add a new tile to the map, click on the button below"),r.a.createElement("p",null,"to edit an existing tile, click on it to select it"))}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"subheading"},"map name"),r.a.createElement("input",{type:"text",placeholder:"map name",value:this.state.map.name,onChange:function(t){return e.changeValue(e.state.map,"name",t.target.value)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.toggleAddingTile()}},this.state.addingTile?"click somewhere on the map to add your new tile, or click here to cancel":"add a new tile"),r.a.createElement(G,{source:this.state,name:"mapSize",display:function(e){return"zoom"},nudgeValue:function(t){return e.nudgeMapSize(5*t)}}),r.a.createElement("button",{onClick:function(){return e.rotateMap()}},"rotate the map"),r.a.createElement("button",{onClick:function(){return e.clearMap()}},"clear all tiles"));return r.a.createElement("div",{className:"map-editor"},t,r.a.createElement(ie,{map:this.state.map,mode:"edit",size:this.state.mapSize,selectedItemID:this.state.selectedTileID?this.state.selectedTileID:void 0,showOverlay:this.state.addingTile,setSelectedItemID:function(t){return e.setSelectedTileID(t)},gridSquareClicked:function(t,a){return e.addMapTile(t,a)}}))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={monster:e.monster,page:"overview",showFilter:!1,helpSection:"speed",sidebar:"similar",similarFilter:{size:!0,type:!0,subtype:!1,alignment:!1,challenge:!0,text:""},scratchpadFilter:p.createMonsterFilter(),scratchpadList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setPage",value:function(e){var t=this.getHelpOptionsForPage(e);this.setState({page:e,helpSection:t[0]})}},{key:"toggleFilter",value:function(){this.setState({showFilter:!this.state.showFilter})}},{key:"setHelpSection",value:function(e){this.setState({helpSection:e})}},{key:"toggleMatch",value:function(e){this.state.similarFilter[e]=!this.state.similarFilter[e],this.setState({similarFilter:this.state.similarFilter})}},{key:"setFilterText",value:function(e){this.state.similarFilter.text=e,this.setState({similarFilter:this.state.similarFilter})}},{key:"addToScratchpadList",value:function(e){this.state.scratchpadList.push(e),d.sort(this.state.scratchpadList),this.setState({scratchpadList:this.state.scratchpadList})}},{key:"removeFromScratchpadList",value:function(e){var t=this.state.scratchpadList.indexOf(e);this.state.scratchpadList.splice(t,1),this.setState({scratchpadList:this.state.scratchpadList})}},{key:"getHelpOptionsForPage",value:function(e){switch(e){case"overview":return["speed","senses","languages","equipment"];case"abilities":return["str","dex","con","int","wis","cha","saves","skills"];case"cbt-stats":return["armor class","hit dice","resistances","vulnerabilities","immunities","conditions"];case"actions":return["actions"];default:return[]}}},{key:"getMonsters",value:function(){var e=this,t=[];return this.props.library.forEach((function(a){a.monsters.forEach((function(a){var n=!0;e.state.monster.id===a.id&&(n=!1),e.state.similarFilter.size&&e.state.monster.size!==a.size&&(n=!1),e.state.similarFilter.type&&e.state.monster.category!==a.category&&(n=!1),e.state.similarFilter.subtype&&e.state.monster.tag!==a.tag&&(n=!1),e.state.similarFilter.alignment&&e.state.monster.alignment!==a.alignment&&(n=!1),e.state.similarFilter.challenge&&e.state.monster.challenge!==a.challenge&&(n=!1),n&&t.push(a)}))})),t}},{key:"setRandomValue",value:function(e,t){b.setRandomValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"spliceMonsters",value:function(e){b.spliceMonsters(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addTrait",value:function(e){b.addTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"addRandomTrait",value:function(e,t){b.addRandomTrait(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"removeTrait",value:function(e){b.removeTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"swapTraits",value:function(e,t){b.swapTraits(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"copyTrait",value:function(e){b.copyTrait(this.state.monster,e),this.setState({monster:this.state.monster})}},{key:"changeTrait",value:function(e,t,a){e[t]=a,this.setState({monster:this.state.monster})}},{key:"nudgeValue",value:function(e,t){b.nudgeValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"changeValue",value:function(e,t){b.changeValue(this.state.monster,e,t),this.setState({monster:this.state.monster})}},{key:"changeFilterValue",value:function(e,t){this.state.scratchpadFilter[e]=t,this.setState({scratchpadFilter:this.state.scratchpadFilter})}},{key:"nudgeFilterValue",value:function(e,t){var a=d.nudgeChallenge(this.state.scratchpadFilter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({scratchpadFilter:p.createMonsterFilter()})}},{key:"matchMonster",value:function(e){return y.matchMonster(e,this.state.scratchpadFilter)}},{key:"getHelpSection",value:function(e){switch(this.state.helpSection){case"speed":return this.getValueSection("speed","text",e);case"senses":return this.getValueSection("senses","text",e);case"languages":return this.getValueSection("languages","text",e);case"equipment":return this.getValueSection("equipment","text",e);case"str":return this.getValueSection("abilityScores.str","number",e);case"dex":return this.getValueSection("abilityScores.dex","number",e);case"con":return this.getValueSection("abilityScores.con","number",e);case"int":return this.getValueSection("abilityScores.int","number",e);case"wis":return this.getValueSection("abilityScores.wis","number",e);case"cha":return this.getValueSection("abilityScores.cha","number",e);case"saves":return this.getValueSection("savingThrows","text",e);case"skills":return this.getValueSection("skills","text",e);case"armor class":return this.getValueSection("ac","number",e);case"hit dice":return this.getValueSection("hitDice","number",e);case"resistances":return this.getValueSection("damage.resist","text",e);case"vulnerabilities":return this.getValueSection("damage.vulnerable","text",e);case"immunities":return this.getValueSection("damage.immune","text",e);case"conditions":return this.getValueSection("conditionImmunities","text",e);case"actions":return this.getActionsSection(e);default:return null}}},{key:"getValueSection",value:function(e,t,a){var n=this,s=a.map((function(a){var n=e.split("."),r=a,s=null;return n.forEach((function(e){e===n[n.length-1]?s=r[e]:r=r[e]})),"text"===t&&""===s&&(s=null),s})).filter((function(e){return null!==e})),i=[];if("number"===t){var o=null,c=null;if(s.forEach((function(e){(null===o||e<o)&&(o=e),(null===c||e>c)&&(c=e)})),null!==o&&null!==c)for(var l=o;l<=c;++l)i.push({value:l,count:0})}switch(s.forEach((function(e){var t=i.find((function(t){return t.value===e}));t?t.count+=1:i.push({value:e,count:1})})),t){case"number":d.sort(i,[{field:"value",dir:"asc"}]);break;case"text":d.sort(i,[{field:"count",dir:"desc"},{field:"value",dir:"asc"}])}"text"===t&&(0!==a.length-s.length&&i.push({value:"",count:a.length-s.length}));var u=i.map((function(t){var s=100*t.count/a.length;return r.a.createElement("div",{className:"row small-up-3 medium-up-3 large-up-3 value-list",key:i.indexOf(t)},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"text-container"},t.value||"(none specified)")),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar",style:{width:s+"%"}}))),r.a.createElement("div",{className:"column"},r.a.createElement("button",{onClick:function(){return n.changeValue(e,t.value)}},"use this value")))}));return r.a.createElement("div",null,u,r.a.createElement("button",{onClick:function(){return n.setRandomValue(e,a)}},"select random value"))}},{key:"getActionsSection",value:function(e){var t=this,a=[];return a.push(r.a.createElement("div",{className:"row small-up-4 medium-up-4 large-up-4 value-list",key:"header"},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"text-container"},r.a.createElement("b",null,"type"))),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"text-container number"},r.a.createElement("b",null,"average number"))),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"text-container number"},r.a.createElement("b",null,"min - max"))))),f.forEach((function(n){var s=null,i=null,o=0;e.forEach((function(e){var t=e.traits.filter((function(e){return e.type===n})).length;(null===s||t<s)&&(s=t),(null===i||t>i)&&(i=t),o+=t}));var c=Math.round(o/e.length);a.push(r.a.createElement("div",{className:"row small-up-4 medium-up-4 large-up-4 value-list",key:n},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:0===o?"text-container disabled":"text-container"},d.traitType(n,!0))),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:0===o?"text-container number disabled":"text-container number"},c)),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:0===o?"text-container number disabled":"text-container number"},s," - ",i)),r.a.createElement("div",{className:"column"},r.a.createElement("button",{className:0===o?"disabled":"",onClick:function(){return t.addRandomTrait(n,e)}},"add random"))))})),r.a.createElement("div",null,a)}},{key:"getMonsterCards",value:function(e){var t=this,a=d.sort(e).map((function(e){return e.traits.some((function(e){return d.match(t.state.similarFilter.text,e.name)}))?r.a.createElement("div",{className:"section",key:e.id},r.a.createElement(te,{combatant:e,mode:"template "+t.state.page,filter:t.state.similarFilter.text,copyTrait:function(e){return t.copyTrait(e)}})):null})).filter((function(e){return!!e}));if(0===a.length){var n="";switch(this.state.sidebar){case"similar":n="there are no monsters in your library which match the above criteria.";break;case"scratchpad":n="your scratchpad list is empty; you can add monsters to it to see their stats here."}return r.a.createElement(_,{content:n})}return a}},{key:"render",value:function(){var e=this;try{var t=[];if(this.props.showSidebar)switch(this.state.sidebar){case"similar":t=this.getMonsters();break;case"scratchpad":t=this.state.scratchpadList}var a=null;switch(this.state.page){case"overview":var n=v.map((function(e){return{id:e,text:e}}));a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"name"),r.a.createElement("input",{type:"text",value:this.state.monster.name,onChange:function(t){return e.changeValue("name",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"size"),r.a.createElement(G,{source:this.state.monster,name:"size",nudgeValue:function(t){return e.nudgeValue("size",t)}}),r.a.createElement("div",{className:"subheading"},"type"),r.a.createElement(I,{options:n,selectedID:this.state.monster.category,select:function(t){return e.changeValue("category",t)}}),r.a.createElement("div",{className:"subheading"},"subtype"),r.a.createElement("input",{type:"text",value:this.state.monster.tag,onChange:function(t){return e.changeValue("tag",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"alignment"),r.a.createElement("input",{type:"text",value:this.state.monster.alignment,onChange:function(t){return e.changeValue("alignment",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"challenge rating"),r.a.createElement(G,{source:this.state.monster,name:"challenge",display:function(e){return d.challenge(e)},nudgeValue:function(t){return e.nudgeValue("challenge",t)}})),r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"speed"),r.a.createElement("input",{type:"text",value:this.state.monster.speed,onChange:function(t){return e.changeValue("speed",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"senses"),r.a.createElement("input",{type:"text",value:this.state.monster.senses,onChange:function(t){return e.changeValue("senses",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"languages"),r.a.createElement("input",{type:"text",value:this.state.monster.languages,onChange:function(t){return e.changeValue("languages",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"equipment"),r.a.createElement("input",{type:"text",value:this.state.monster.equipment,onChange:function(t){return e.changeValue("equipment",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(H,{source:this.state.monster,setValue:function(t){return e.changeValue("portrait",t)}})));break;case"abilities":a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"ability scores"),r.a.createElement(L,{edit:!0,combatant:this.state.monster,nudgeValue:function(t,a,n){return e.nudgeValue(a,n)}})),r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"saving throws"),r.a.createElement("input",{type:"text",value:this.state.monster.savingThrows,onChange:function(t){return e.changeValue("savingThrows",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"skills"),r.a.createElement("input",{type:"text",value:this.state.monster.skills,onChange:function(t){return e.changeValue("skills",t.target.value)}})));break;case"cbt-stats":a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"armor class"),r.a.createElement(G,{source:this.state.monster,name:"ac",nudgeValue:function(t){return e.nudgeValue("ac",t)}}),r.a.createElement("div",{className:"subheading"},"hit dice"),r.a.createElement(G,{source:this.state.monster,name:"hitDice",display:function(t){return t+"d"+d.hitDieType(e.state.monster.size)},nudgeValue:function(t){return e.nudgeValue("hitDice",t)}}),r.a.createElement("div",{className:"subheading"},"hit points"),r.a.createElement("div",{className:"hp-value"},this.state.monster.hpMax," hp")),r.a.createElement("div",{className:"columns small-6 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"damage resistances"),r.a.createElement("input",{type:"text",value:this.state.monster.damage.resist,onChange:function(t){return e.changeValue("damage.resist",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"damage vulnerabilities"),r.a.createElement("input",{type:"text",value:this.state.monster.damage.vulnerable,onChange:function(t){return e.changeValue("damage.vulnerable",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"damage immunities"),r.a.createElement("input",{type:"text",value:this.state.monster.damage.immune,onChange:function(t){return e.changeValue("damage.immune",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"condition immunities"),r.a.createElement("input",{type:"text",value:this.state.monster.conditionImmunities,onChange:function(t){return e.changeValue("conditionImmunities",t.target.value)}})));break;case"actions":a=r.a.createElement(Z,{combatant:this.state.monster,mode:"edit",addTrait:function(t){return e.addTrait(t)},removeTrait:function(t){return e.removeTrait(t)},swapTraits:function(t,a){return e.swapTraits(t,a)},changeValue:function(t,a,n){return e.changeTrait(t,a,n)}})}var s=null;if(this.props.showSidebar&&t.length>1){var i=null;if(this.getHelpOptionsForPage(this.state.page).length>1){var o=this.getHelpOptionsForPage(this.state.page).map((function(e){return{id:e,text:e}}));i=r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"fields"),r.a.createElement(F,{tabs:!1,options:o,selectedID:this.state.helpSection,select:function(t){return e.setHelpSection(t)}}),r.a.createElement("div",{className:"subheading"},"values"))}s=r.a.createElement("div",{className:"monster-help group-panel"},r.a.createElement("div",{className:"heading"},"information from sidebar monsters"),i,this.getHelpSection(t))}var c=null;if(this.props.showSidebar){var l=null;switch(this.state.sidebar){case"similar":l=r.a.createElement(A,{text:"similarity criteria",content:r.a.createElement("div",null,r.a.createElement(E,{label:"size "+this.state.monster.size,checked:this.state.similarFilter.size,changeValue:function(t){return e.toggleMatch("size")}}),r.a.createElement(E,{label:"type "+this.state.monster.category,checked:this.state.similarFilter.type,changeValue:function(t){return e.toggleMatch("type")}}),r.a.createElement(E,{label:this.state.monster.tag?"subtype "+this.state.monster.tag:"subtype",checked:this.state.similarFilter.subtype,disabled:!this.state.monster.tag,changeValue:function(t){return e.toggleMatch("subtype")}}),r.a.createElement(E,{label:this.state.monster.alignment?"alignment "+this.state.monster.alignment:"alignment",checked:this.state.similarFilter.alignment,disabled:!this.state.monster.alignment,changeValue:function(t){return e.toggleMatch("alignment")}}),r.a.createElement(E,{label:"challenge rating "+d.challenge(this.state.monster.challenge),checked:this.state.similarFilter.challenge,changeValue:function(t){return e.toggleMatch("challenge")}}))});break;case"scratchpad":var u=[];this.props.library.forEach((function(a){a.monsters.forEach((function(a){!t.includes(a)&&e.matchMonster(a)&&u.push(a)}))})),d.sort(u);var m=u.map((function(t){return r.a.createElement("button",{key:t.id,onClick:function(){return e.addToScratchpadList(t)}},t.name)}));0===u.length&&(m=[r.a.createElement(_,{key:"none",content:"no monsters found"})]);var p=null;if(t.length>0){var h=t.map((function(t){return r.a.createElement("button",{key:t.id,onClick:function(){return e.removeFromScratchpadList(t)}},t.name)}));p=r.a.createElement(A,{text:"remove monsters from the list",content:r.a.createElement("div",null,h)})}l=r.a.createElement("div",null,r.a.createElement(A,{text:"add monsters to the list",content:r.a.createElement("div",null,r.a.createElement(ae,{filter:this.state.scratchpadFilter,changeValue:function(t,a){return e.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),r.a.createElement("div",{className:"divider"}),m)}),p)}c=r.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable wide-column"},r.a.createElement(F,{tabs:!0,options:[{id:"similar",text:"similar"},{id:"scratchpad",text:"scratchpad"}],selectedID:this.state.sidebar,select:function(t){return e.setState({sidebar:t})}}),l,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{className:t.length<2?"disabled":"",onClick:function(){return e.spliceMonsters(t)}},"build random monster"),r.a.createElement("div",{className:"divider"}),this.getMonsterCards(t))}return r.a.createElement("div",{className:"row",style:{height:"100%",margin:"0 -5px"}},r.a.createElement("div",{className:this.props.showSidebar?"columns small-8 medium-8 large-8 scrollable wide-column":"columns small-12 medium-12 large-12 scrollable wide-column",style:{transition:"none"}},r.a.createElement("div",{className:"section"},r.a.createElement(F,{tabs:!0,options:[{id:"overview",text:"overview"},{id:"abilities",text:"abilities"},{id:"cbt-stats",text:"combat"},{id:"actions",text:"actions"}],selectedID:this.state.page,select:function(t){return e.setPage(t)}}),a,s)),c)}catch(f){return console.error(f),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pc:e.pc},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"addCompanion",value:function(){var e=p.createCompanion();e.name="new companion",this.state.pc.companions.push(e),this.setState({pc:this.state.pc})}},{key:"removeCompanion",value:function(e){this.state.pc.companions=this.state.pc.companions.filter((function(t){return t.id!==e})),this.setState({pc:this.state.pc})}},{key:"changeValue",value:function(e,t,a){e[t]=a,this.setState({pc:this.state.pc})}},{key:"nudgeValue",value:function(e,t,a){var n=e[t]+a;this.changeValue(e,t,n)}},{key:"render",value:function(){var e=this;try{var t=this.state.pc.companions.map((function(t){return r.a.createElement("div",{className:"row companion",key:t.id},r.a.createElement("div",{className:"columns small-12 medium-8 large-8"},r.a.createElement("input",{type:"text",value:t.name,onChange:function(a){return e.changeValue(t,"name",a.target.value)}})),r.a.createElement("div",{className:"columns small-12 medium-4 large-4"},r.a.createElement("button",{onClick:function(){return e.removeCompanion(t.id)}},"delete")))}));return 0===t.length&&t.push(r.a.createElement("div",{className:"section",key:"empty"},r.a.createElement("i",null,"no companions (pets, retainers, mounts, etc)"))),r.a.createElement("div",{className:"pc-editor"},r.a.createElement("div",{className:"row section"},r.a.createElement("div",{className:"columns small-12 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"character name:"),r.a.createElement("input",{type:"text",value:this.state.pc.name,onChange:function(t){return e.changeValue(e.state.pc,"name",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"player name:"),r.a.createElement("input",{type:"text",value:this.state.pc.player,onChange:function(t){return e.changeValue(e.state.pc,"player",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"race:"),r.a.createElement("input",{type:"text",value:this.state.pc.race,onChange:function(t){return e.changeValue(e.state.pc,"race",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"class:"),r.a.createElement("input",{type:"text",value:this.state.pc.classes,onChange:function(t){return e.changeValue(e.state.pc,"classes",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"level:"),r.a.createElement(G,{source:this.state.pc,name:"level",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"level",t)}}),r.a.createElement("div",{className:"subheading"},"passive skills"),r.a.createElement(G,{source:this.state.pc,name:"passiveInsight",label:"insight",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInsight",t)}}),r.a.createElement(G,{source:this.state.pc,name:"passiveInvestigation",label:"investigation",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passiveInvestigation",t)}}),r.a.createElement(G,{source:this.state.pc,name:"passivePerception",label:"perception",nudgeValue:function(t){return e.nudgeValue(e.state.pc,"passivePerception",t)}})),r.a.createElement("div",{className:"columns small-12 medium-6 large-6"},r.a.createElement("div",{className:"subheading"},"languages:"),r.a.createElement("input",{type:"text",value:this.state.pc.languages,onChange:function(t){return e.changeValue(e.state.pc,"languages",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"d&d beyond link:"),r.a.createElement("input",{type:"text",value:this.state.pc.url,placeholder:"https://ddb.ac/characters/...",onChange:function(t){return e.changeValue(e.state.pc,"url",t.target.value)}}),r.a.createElement("div",{className:"subheading"},"portrait"),r.a.createElement(H,{source:this.state.pc,setValue:function(t){return e.changeValue(e.state.pc,"portrait",t)}}),r.a.createElement("div",{className:"subheading"},"companions:"),t,r.a.createElement("button",{onClick:function(){return e.addCompanion()}},"add a new companion"))))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ne=a(17),xe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"designed by ",r.a.createElement("a",{href:"mailto:andy.aiken@live.co.uk"},"andy aiken")),r.a.createElement("div",{className:"section"},"version ",r.a.createElement("b",null,Ne.version)),r.a.createElement("div",{className:"section"},"if you would like to raise a bug or request a new feature, you can do so ",r.a.createElement("a",{href:"https://github.com/andyaiken/dojo",target:"_blank",rel:"noopener noreferrer"},"here")))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"open game license"),r.a.createElement("div",{className:"section"},"The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved."),r.a.createElement("ol",null,r.a.createElement("li",null,"Definitions: (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement."),r.a.createElement("li",null,"The License: This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License."),r.a.createElement("li",null,"Offer and Acceptance: By Using the Open Game Content You indicate Your acceptance of the terms of this License."),r.a.createElement("li",null,"Grant and Consideration: In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content."),r.a.createElement("li",null,"Representation of Authority to Contribute: If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License."),r.a.createElement("li",null,"Notice of License Copyright: You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute."),r.a.createElement("li",null,"Use of Product Identity: You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity."),r.a.createElement("li",null,"Identification: If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content."),r.a.createElement("li",null,"Updating the License: Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License."),r.a.createElement("li",null,"Copy of this License: You MUST include a copy of this License with every copy of the Open Game Content You Distribute."),r.a.createElement("li",null,"Use of Contributor Credits: You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so."),r.a.createElement("li",null,"Inability to Comply: If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected."),r.a.createElement("li",null,"Termination: This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License."),r.a.createElement("li",null,"Reformation: If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable."),r.a.createElement("li",null,"COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.")))}}]),t}(r.a.Component),we=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"this will reset the entire app and cannot be undone"),r.a.createElement("div",{className:"section"},"use it at your own risk"),r.a.createElement(C,{text:"clear all data",callback:function(){return e.props.resetAll()}}))}}]),t}(r.a.Component),Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"about"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"about":t=r.a.createElement(xe,null);break;case"ogl":t=r.a.createElement(Ce,null);break;case"options":t=r.a.createElement(we,{resetAll:function(){return e.props.resetAll()}})}return r.a.createElement("div",{className:"about"},r.a.createElement(F,{options:[{id:"about",text:"about dojo"},{id:"ogl",text:"ogl"},{id:"options",text:"options"}],selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={dice:"20",count:1,options:[],rolls:null,result:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setDice",value:function(e){this.setState({dice:e})}},{key:"nudgeCount",value:function(e){this.setState({count:Math.max(1,this.state.count+e)})}},{key:"toggleOption",value:function(e){if(this.state.options.includes(e)){var t=this.state.options.indexOf(e);this.state.options.splice(t,1)}else if(this.state.options.push(e),this.state.options.includes("advantage")&&this.state.options.includes("disadvantage")){var a=this.state.options.indexOf("advantage"===e?"disadvantage":"advantage");this.state.options.splice(a,1)}this.setState({options:this.state.options})}},{key:"roll",value:function(){var e=parseInt(this.state.dice,10),t=[],a=this.state.count;(this.state.options.includes("advantage")||this.state.options.includes("disadvantage"))&&(a=2);for(var n=0;n!==a;++n)t.push(d.dieRoll(e));t.sort((function(e,t){return e-t}));var r=0;this.state.options.includes("advantage")?r=Math.max.apply(Math,t):this.state.options.includes("disadvantage")?r=Math.min.apply(Math,t):(t.forEach((function(e){return r+=e})),this.state.options.includes("drop lowest")&&(r-=Math.min.apply(Math,t)),this.state.options.includes("drop highest")&&(r-=Math.max.apply(Math,t))),this.setState({rolls:t,result:r})}},{key:"render",value:function(){var e=this;try{var t=null;"20"===this.state.dice&&1===this.state.count?t=r.a.createElement(w,{controls:[r.a.createElement(E,{key:"advantage",label:"advantage",checked:this.state.options.includes("advantage"),changeValue:function(t){return e.toggleOption("advantage")}}),r.a.createElement(E,{key:"disadvantage",label:"disadvantage",checked:this.state.options.includes("disadvantage"),changeValue:function(t){return e.toggleOption("disadvantage")}})]}):this.state.count>1&&(t=r.a.createElement(w,{controls:[r.a.createElement(E,{key:"drop-lowest",label:"drop lowest",checked:this.state.options.includes("drop lowest"),changeValue:function(t){return e.toggleOption("drop lowest")}}),r.a.createElement(E,{key:"drop-highest",label:"drop highest",checked:this.state.options.includes("drop highest"),changeValue:function(t){return e.toggleOption("drop highest")}})]}));var a=null;null!==this.state.rolls&&this.state.rolls.length>1&&(a=r.a.createElement("div",{className:"section die-rolls"},this.state.rolls.join(", ")));var n=null;return null!==this.state.result&&(n=r.a.createElement("div",{className:"section die-result"},this.state.result)),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"die type"),r.a.createElement(F,{options:[{id:"4",text:"d4"},{id:"6",text:"d6"},{id:"8",text:"d8"},{id:"10",text:"d10"},{id:"12",text:"d12"},{id:"20",text:"d20"},{id:"100",text:"d100"}],selectedID:this.state.dice,select:function(t){return e.setDice(t)}}),r.a.createElement("div",{className:"subheading"},"number of dice to roll"),r.a.createElement(G,{source:this.state,name:"count",display:function(t){return t+"d"+e.state.dice},nudgeValue:function(t){return e.nudgeCount(t)}}),t?r.a.createElement("div",{className:"subheading"},"options"):null,t,r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.roll()}},"roll dice"),a,n)}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Se=a(6),je=a.n(Se),Ie=a(7),Ve=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"initModel",value:function(t){var a=[],n=0;t.forEach((function(t){t.split(/\r?\n/).forEach((function(t){t&&(e.addLineToModel(t,a),n=Math.max(n,t.length))}))})),e.model=a,e.maxLength=n}},{key:"addLineToModel",value:function(e,t){e=String.fromCharCode(0,1)+e+String.fromCharCode(2);for(var a=function(a){var n=e.substr(a-2,2),r=e.substr(a,1),s=t.find((function(e){return e.prev===n}));s||(s={prev:n,freq:[]},t.push(s));var i=s.freq.find((function(e){return e.char===r}));i||(i={char:r,count:0},s.freq.push(i)),i.count+=1},n=2;n!==e.length;++n)a(n)}},{key:"generate",value:function(t){for(var a=[],n=0;a.length<t&&n<100;){var r=e.extractLine();if(r&&!a.map((function(e){return e.line})).includes(r)&&r.length<=e.maxLength){var s=e.fit(r);a.push({line:r,fit:s})}else n+=1}return a}},{key:"extractLine",value:function(){for(var t=String.fromCharCode(0,1),a=function(){var a=t.substr(t.length-2,2),n=e.model.find((function(e){return e.prev===a}));if(!n)return{v:null};var r="";n.freq.forEach((function(e){r+=e.char.repeat(e.count)}));var s=Math.floor(Math.random()*r.length),i=r[s];if(i===String.fromCharCode(2))return{v:t=t.substr(2)};if(1===d.dieRoll()){["bdg","ptk","sz","aeiouy","lr","ckq","vf"].forEach((function(e){if(e.includes(i)){var t=Math.floor(Math.random()*e.length);i=e[t]}}))}t+=i};;){var n=a();if("object"===typeof n)return n.v}}},{key:"fit",value:function(t){t=String.fromCharCode(0,1)+t+String.fromCharCode(2);for(var a=[],n=function(n){var r=t.substr(n-2,2),s=t[n],i=e.model.find((function(e){return e.prev===r}));if(i){var o=i.freq.find((function(e){return e.char===s}));if(o){var c=i.freq.reduce((function(e,t){return Math.max(e,t.count)}),0),l=o.count/c;a.push(l)}else a.push(0)}},r=2;r!==t.length;++r)n(r);return a.reduce((function(e,t){return e+t}),0)/a.length}}]),e}();Ve.model=[],Ve.maxLength=0;var De=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"say",value:function(){var t=Object(Ie.a)(je.a.mark((function t(a,n){var r;return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.speechSynthesis.cancel(),r=new SpeechSynthesisUtterance(a),t.next=4,e.chooseVoice(n);case 4:r.voice=t.sent,r.rate=e.randomValue(.5,1.5),r.pitch=e.randomValue(.5,1.5),window.speechSynthesis.speak(r);case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"chooseVoice",value:function(){var t=Object(Ie.a)(je.a.mark((function t(a){var n,r,s,i;return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getVoices();case 2:return n=t.sent,r=a.map((function(t){return e.getLanguageCode(t)})),0===(s=n.filter((function(e){return r.includes(e.lang.substr(0,2))}))).length&&(s=n.filter((function(e){return e.default}))),0===s.length&&(s=n),i=Math.floor(Math.random()*s.length),t.abrupt("return",s[i]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getVoices",value:function(){return new Promise((function(e){var t=window.speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=function(){t=window.speechSynthesis.getVoices(),e(t)}}))}},{key:"getLanguageCode",value:function(e){switch(e){case"armenian":return"hy";case"basque":return"eu";case"bulgarian":return"bg";case"chichewa":return"ny";case"chinese":return"zh";case"croatian":return"hr";case"czech":return"cs";case"dutch":return"nl";case"german":return"de";case"greek":return"el";case"icelandic":return"is";case"irish":return"ga";case"kannada":return"kn";case"kazakh":return"kk";case"latvian":return"lv";case"lithuanian":return"lt";case"macedonian":return"mk";case"malay":return"ms";case"maltese":return"mt";case"maori":return"mi";case"polish":return"pl";case"portuguese":return"pt";case"punjabi":return"pa";case"samoan":return"sm";case"serbian":return"sr";case"shona":return"sn";case"spanish":return"es";case"swedish":return"sv";case"turkish":return"tr";case"welsh":return"cy";default:return e.substr(0,2)}}},{key:"randomValue",value:function(e,t){return e+(Math.random()+Math.random()+Math.random())/3*(t-e)}}]),e}(),Te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={sources:{},output:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLanguages",value:function(){return["afrikaans","amharic","armenian","basque","belarusian","bulgarian","chichewa","chinese","croatian","czech","danish","dutch","english","finnish","french","german","greek","hawaiian","hindi","hungarian","icelandic","irish","italian","japanese","kannada","kazakh","korean","kyrgyz","latvian","lithuanian","macedonian","malay","maltese","maori","myanmar","nepali","norwegian","polish","portuguese","punjabi","romanian","russian","samoan","serbian","shona","somali","spanish","swahili","swedish","thai","turkish","welsh","yiddish","zulu"]}},{key:"getPresets",value:function(){return[{name:"draconic",languages:["armenian","irish","maltese"]},{name:"dwarvish",languages:["czech","german","yiddish"]},{name:"elvish",languages:["finnish","spanish","welsh"]},{name:"goblin",languages:["hawaiian","kyrgyz","somali"]},{name:"orc",languages:["macedonian","russian","turkish"]}]}},{key:"addLanguage",value:function(){var e=Object(Ie.a)(je.a.mark((function e(t){var a;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/langs/"+t+".txt");case 2:return a=e.sent,e.next=5,a.text();case 5:this.state.sources[t]=e.sent,this.setState({sources:this.state.sources});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeLanguage",value:function(e){delete this.state.sources[e],this.setState({sources:this.state.sources})}},{key:"usePreset",value:function(e){var t=this,a=this.getPresets().find((function(t){return t.name===e}));a&&this.setState({sources:{},output:[]},(function(){a.languages.forEach((function(e){t.addLanguage(e)}))}))}},{key:"random",value:function(){for(var e=this,t=this.getLanguages(),a=[];3!==a.length;){var n=t[Math.floor(Math.random()*t.length)];a.includes(n)||a.push(n)}this.setState({sources:{},output:[]},(function(){a.forEach((function(t){e.addLanguage(t)}))}))}},{key:"generate",value:function(){var e=this,t=[];Object.keys(this.state.sources).forEach((function(a){var n=e.state.sources[a];t.push(n)})),Ve.initModel(t),this.setState({output:Ve.generate(5).map((function(e){return e.line}))})}},{key:"reset",value:function(){this.setState({sources:{},output:[]})}},{key:"render",value:function(){var e=this;try{var t=this.getPresets().map((function(e){return{id:e.name,text:e.name}})),a="";this.getPresets().forEach((function(t){Object.keys(e.state.sources).sort().join(", ")===t.languages.sort().join(", ")&&(a=t.name)}));var n=Object.keys(this.state.sources).sort().join(", ");""===n&&(n="none");var s=this.getLanguages().map((function(t){var a=Object.keys(e.state.sources).includes(t);return r.a.createElement("div",{className:"column",key:t},r.a.createElement(E,{label:t,display:"button",checked:a,changeValue:function(a){return a?e.addLanguage(t):e.removeLanguage(t)}}))})),i=Object.keys(this.state.sources).length>0,o=i||this.state.output.length>0,c=[];this.state.output.length>0&&c.push(r.a.createElement("div",{key:"div",className:"divider"}));for(var l=0;l!==this.state.output.length;++l)c.push(r.a.createElement(Ae,{key:l,text:this.state.output[l],languages:Object.keys(this.state.sources)}));return r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"presets"),r.a.createElement(F,{options:t,selectedID:a,select:function(t){return e.usePreset(t)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement(A,{text:"selected languages: "+n,content:r.a.createElement("div",{className:"row collapse small-up-1 medium-up-2 large-up-3 language-options"},s)}),r.a.createElement("div",{className:"divider"}),r.a.createElement(w,{controls:[r.a.createElement("button",{key:"generate",className:i?"":"disabled",onClick:function(){return e.generate()}},"generate text"),r.a.createElement("button",{key:"reset",className:o?"":"disabled",onClick:function(){return e.reset()}},"reset"),r.a.createElement("button",{key:"random",onClick:function(){return e.random()}},"random sources")]}),r.a.createElement("div",{className:"language-output"},c))}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"copy",value:function(e){e.preventDefault(),navigator.clipboard.writeText(this.props.text)}},{key:"say",value:function(e){e.preventDefault(),De.say(this.props.text,this.props.languages)}},{key:"render",value:function(){var e=this;try{return r.a.createElement(A,{text:this.props.text.toLowerCase(),content:r.a.createElement("div",null,r.a.createElement("button",{onClick:function(t){return e.copy(t)}},"copy to clipboard"),r.a.createElement("button",{onClick:function(t){return e.say(t)}},"say"),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"note:")," speech may not work consistently on all platforms"))})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={output:{male:[],female:[],surname:[]}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generate",value:function(){var e=Object(Ie.a)(je.a.mark((function e(t){var a,n,r;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/names/"+t+".txt");case 2:return a=e.sent,e.next=5,a.text();case 5:n=e.sent,Ve.initModel([n]),r=Ve.generate(10).map((function(e){return e.line})).sort(),this.state.output[t]=r,this.setState({output:this.state.output});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{for(var t=[],a=0;a!==this.state.output.male.length;++a)t.push(r.a.createElement("div",{key:a,className:"section"},this.state.output.male[a].toLowerCase()));for(var n=[],s=0;s!==this.state.output.female.length;++s)n.push(r.a.createElement("div",{key:s,className:"section"},this.state.output.female[s].toLowerCase()));for(var i=[],o=0;o!==this.state.output.surname.length;++o)i.push(r.a.createElement("div",{key:o,className:"section"},this.state.output.surname[o].toLowerCase()));return r.a.createElement("div",null,r.a.createElement("div",{className:"name-output"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-4 medium-4 large-4"},r.a.createElement("div",{className:"heading"},"male names"),r.a.createElement("button",{onClick:function(){return e.generate("male")}},"generate"),t),r.a.createElement("div",{className:"columns small-4 medium-4 large-4"},r.a.createElement("div",{className:"heading"},"female names"),r.a.createElement("button",{onClick:function(){return e.generate("female")}},"generate"),n),r.a.createElement("div",{className:"columns small-4 medium-4 large-4"},r.a.createElement("div",{className:"heading"},"surnames"),r.a.createElement("button",{onClick:function(){return e.generate("surname")}},"generate"),i))))}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"die"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"die":t=r.a.createElement(Me,null);break;case"language":t=r.a.createElement(Te,null);break;case"name":t=r.a.createElement(Pe,null)}return r.a.createElement("div",{className:"tools"},r.a.createElement(F,{options:[{id:"die",text:"die roller"},{id:"language",text:"language generator"},{id:"name",text:"name generator"}],selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ze=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return this.props.loaded?this.props.children:r.a.createElement("div",{className:"loading-wrapper"},r.a.createElement("img",{className:"rotate-forever",src:M.a,alt:"loading"}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ge=new J.a.Converter;Ge.setOption("tables",!0);var Le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(Ie.a)(je.a.mark((function e(){var t,a;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/actions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(ze,{loaded:null!==this.state.source},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Ge.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ye=new J.a.Converter;Ye.setOption("tables",!0);var Re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(Ie.a)(je.a.mark((function e(){var t,a;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/conditions.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(ze,{loaded:null!==this.state.source},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:Ye.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),We=new J.a.Converter;We.setOption("tables",!0);var qe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={source:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(Ie.a)(je.a.mark((function e(){var t,a;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/skills.md");case 2:return t=e.sent,e.next=5,t.text();case 5:a=e.sent,this.setState({source:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){try{return this.state.source||this.fetchData(),r.a.createElement(ze,{loaded:null!==this.state.source},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:We.makeHtml(this.state.source||"")}}))}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),He=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"skills"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"skills":t=r.a.createElement(qe,null);break;case"conditions":t=r.a.createElement(Re,null);break;case"actions":t=r.a.createElement(Le,null)}return r.a.createElement("div",{className:"reference"},r.a.createElement(F,{options:[{id:"skills",text:"skills"},{id:"conditions",text:"conditions"},{id:"actions",text:"actions"}],selectedID:this.state.view,select:function(t){return e.setView(t)}}),r.a.createElement("div",{className:"divider"}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"ref"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setView",value:function(e){this.setState({view:e})}},{key:"render",value:function(){var e=this;try{var t=null;switch(this.state.view){case"ref":t=r.a.createElement(He,null);break;case"dm":t=r.a.createElement(Fe,null);break;case"about":t=r.a.createElement(Oe,{resetAll:function(){return e.props.resetAll()}})}return r.a.createElement("div",{className:"about"},r.a.createElement(F,{tabs:!0,options:[{id:"ref",text:"reference"},{id:"dm",text:"dm tools"},{id:"about",text:"about"}],selectedID:this.state.view,select:function(t){return e.setView(t)}}),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Je=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t="parties"===this.props.view?"navigator-item selected":"navigator-item",a="library"===this.props.view?"navigator-item selected":"navigator-item",n="encounter"===this.props.view?"navigator-item selected":"navigator-item",s="maps"===this.props.view?"navigator-item selected":"navigator-item",i="combat"===this.props.view?"navigator-item selected":"navigator-item",o=0!==this.props.library.length,c=0!==this.props.parties.length&&0!==this.props.encounters.length;return o||(n+=" disabled"),c||(i+=" disabled"),r.a.createElement("div",{className:this.props.blur?"navbar blur":"navbar"},r.a.createElement("div",{className:t,onClick:function(){return e.props.setView("parties")}},"player characters"),r.a.createElement("div",{className:a,onClick:function(){return e.props.setView("library")}},"monster library"),r.a.createElement("div",{className:n,onClick:function(){return o?e.props.setView("encounter"):null}},"encounter builder"),r.a.createElement("div",{className:s,onClick:function(){return e.props.setView("maps")}},"map folios"),r.a.createElement("div",{className:i,onClick:function(){return c?e.props.setView("combat"):null}},"combat manager"))}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ue=a(18),_e=a.n(Ue),Be=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:this.props.blur?"titlebar blur":"titlebar"},r.a.createElement("div",{className:"app-name",onClick:function(){return e.props.openHome()}},"dojo"),this.props.actions,r.a.createElement("img",{className:"tools-icon",src:_e.a,title:"tools",alt:"tools",onClick:function(){return e.props.openTools()}}))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ze=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={combatMode:"main"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setCombatMode",value:function(e){this.setState({combatMode:e})}},{key:"getCombatControls",value:function(){var e=this,t=this.props.combatant,a=[],n=["main","cond","map","adv"].map((function(e){return{id:e,text:e}}));switch(-1===this.props.mode.indexOf("tactical")&&n.splice(2,1),a.push(r.a.createElement(F,{key:"selector",options:n,selectedID:this.state.combatMode,select:function(t){return e.setCombatMode(t)}})),a.push(r.a.createElement("div",{key:"selector-sep",className:"divider"})),this.state.combatMode){case"main":!t.pending||t.active||t.defeated||a.push(r.a.createElement("div",{key:"pending",className:"section"},"pending initiative entry")),t.pending||!t.active||t.defeated||(t.current?(a.push(r.a.createElement("button",{key:"endTurn",onClick:function(){return e.props.endTurn(t)}},"end turn")),a.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(t)}},"mark as defeated and end turn"))):(a.push(r.a.createElement("button",{key:"makeCurrent",onClick:function(){return e.props.makeCurrent(t)}},"start turn")),a.push(r.a.createElement("button",{key:"makeDefeated",onClick:function(){return e.props.makeDefeated(t)}},"mark as defeated")))),t.pending||t.active||!t.defeated||a.push(r.a.createElement("button",{key:"makeActive",onClick:function(){return e.props.makeActive(t)}},"mark as active")),t.pending||!t.active||t.defeated||(a.push(r.a.createElement("div",{key:"tag-sep",className:"divider"})),a.push(r.a.createElement(w,{key:"tags",controls:k.map((function(a){return r.a.createElement(E,{key:a,label:a,display:"button",checked:t.tags.includes(a),changeValue:function(n){return e.props.toggleTag(t,a)}})}))})));break;case"cond":a.push(r.a.createElement("div",{key:"conditions"},r.a.createElement(Y,{combatant:this.props.combatant,combat:this.props.combat,addCondition:function(){return e.props.addCondition(e.props.combatant)},editCondition:function(t){return e.props.editCondition(e.props.combatant,t)},removeCondition:function(t){return e.props.removeCondition(e.props.combatant,t)},nudgeConditionValue:function(t,a,n){return e.props.nudgeConditionValue(t,a,n)}})));break;case"map":if(-1!==this.props.mode.indexOf("on-map")){a.push(r.a.createElement("div",{key:"mapMove",className:"section centered"},r.a.createElement(P,{direction:"eight",click:function(a){return e.props.mapMove(t,a)}}))),a.push(r.a.createElement("div",{key:"move-sep",className:"divider"})),a.push(r.a.createElement(G,{key:"altitude",source:this.props.combatant,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"altitude",5*t)}}));var s=null;if(t.aura.radius>0){s=r.a.createElement("div",null,r.a.createElement(F,{options:[{id:"square",text:"square"},{id:"rounded",text:"rounded"},{id:"circle",text:"circle"}],selectedID:t.aura.style,select:function(a){return e.props.changeValue(t.aura,"style",a)}}),r.a.createElement("input",{type:"color",value:t.aura.color,onChange:function(a){return e.props.changeValue(t.aura,"color",a.target.value)}}))}a.push(r.a.createElement(A,{key:"aura",text:"aura",content:r.a.createElement("div",null,r.a.createElement(G,{source:t.aura,name:"radius",label:"size",display:function(e){return e+" ft."},nudgeValue:function(a){return e.props.nudgeValue(t.aura,"radius",5*a)}}),s)})),a.push(r.a.createElement("button",{key:"mapRemove",onClick:function(){return e.props.mapRemove(t)}},"remove from map"))}-1!==this.props.mode.indexOf("off-map")&&a.push(r.a.createElement("button",{key:"mapAdd",onClick:function(){return e.props.mapAdd(t)}},"add to map"));break;case"adv":t.current||a.push(r.a.createElement(C,{key:"remove",text:"remove from encounter",callback:function(){return e.props.removeCombatant(t)}})),t.pending||a.push(r.a.createElement(A,{key:"init",text:"change initiative score",content:r.a.createElement("div",null,r.a.createElement(G,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}))})),a.push(r.a.createElement(A,{key:"size",text:"change size",content:r.a.createElement("div",null,r.a.createElement(G,{source:this.props.combatant,name:"displaySize",label:"size",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"displaySize",t)}}))}))}return r.a.createElement("div",null,r.a.createElement("div",{className:"group-panel"},a),r.a.createElement("div",{className:"divider"}))}},{key:"render",value:function(){var e=this;try{var t=[];-1!==this.props.mode.indexOf("edit")&&(t.push(r.a.createElement("button",{key:"edit",onClick:function(){return e.props.editPC(e.props.combatant)}},"edit pc")),this.props.combatant.active?t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.combatant,"active",!1)}},"mark pc as inactive")):t.push(r.a.createElement("button",{key:"toggle-active",onClick:function(){return e.props.changeValue(e.props.combatant,"active",!0)}},"mark pc as active")),t.push(r.a.createElement(C,{key:"remove",text:"delete pc",callback:function(){return e.props.removePC(e.props.combatant)}})));var a=null;-1!==this.props.mode.indexOf("combat")&&(a=this.getCombatControls());var n=(this.props.combatant.race||"unknown race")+" "+(this.props.combatant.classes||"unknown class")+", level "+this.props.combatant.level,s=null;this.props.combatant.companions.length>0&&(s=this.props.combatant.companions.map((function(e){return r.a.createElement("div",{key:e.id},e.name)})));var i=(this.props.combatant?this.props.combatant.displayName:null)||this.props.combatant.name||"unnamed pc";return r.a.createElement("div",{className:"card pc"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},i)),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"stats"},r.a.createElement(H,{source:this.props.combatant}),r.a.createElement("div",{className:"section centered lowercase"},r.a.createElement("i",null,n),r.a.createElement("div",{style:{display:this.props.combatant.url?"":"none"}},r.a.createElement("a",{href:this.props.combatant.url,target:"_blank",rel:"noopener noreferrer"},"d&d beyond sheet"))),r.a.createElement("div",{className:"divider"}),a,r.a.createElement("div",{className:"section subheading"},"languages"),r.a.createElement("div",{className:"section"},this.props.combatant.languages||"-"),r.a.createElement("div",{className:"section subheading"},"passive skills"),r.a.createElement("div",{className:"section"},r.a.createElement("div",null,r.a.createElement("b",null,"insight")," ",this.props.combatant.passiveInsight),r.a.createElement("div",null,r.a.createElement("b",null,"investigation")," ",this.props.combatant.passiveInvestigation),r.a.createElement("div",null,r.a.createElement("b",null,"perception")," ",this.props.combatant.passivePerception))),r.a.createElement("div",{style:{display:this.props.combatant.companions.length>0?"":"none"}},r.a.createElement("div",{className:"section subheading"},"companions"),r.a.createElement("div",{className:"section"},s)),r.a.createElement("div",{style:{display:t.length>0?"":"none"}},r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},t))))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Ze.defaultProps={removePC:null,editPC:null,combat:null,makeCurrent:null,makeActive:null,makeDefeated:null,endTurn:null,mapAdd:null,mapMove:null,mapRemove:null,removeCombatant:null,addCondition:null,editCondition:null,removeCondition:null,nudgeConditionValue:null,toggleTag:null};var Ke=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;return this.props.combat.map&&(t=r.a.createElement(ie,{map:this.props.combat.map,mode:"thumbnail",size:10,combatants:this.props.combat.combatants})),r.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.combat)}},r.a.createElement("div",{className:"heading"},this.props.combat.name||"unnamed combat"),r.a.createElement("div",{className:"section"},"paused at ",this.props.combat.timestamp),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Qe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showCards:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggleCards",value:function(){this.setState({showCards:!this.state.showCards})}},{key:"render",value:function(){var e=this;try{if(this.props.hidden)return null;var t=null;if(this.props.heading){var a=null;this.props.close&&(a=r.a.createElement("img",{className:"image",src:j.a,alt:"close",onClick:function(){return e.props.close()}}));var n=null;if(this.props.showToggle){var s=this.state.showCards?"image rotate":"image";n=r.a.createElement("img",{className:s,src:T.a,alt:"arrow",onClick:function(){return e.toggleCards()}})}t=r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.heading),n,a)}var i=[];return this.props.content.length>0&&this.state.showCards&&(i=this.props.content),r.a.createElement("div",{className:"card-group"},t,r.a.createElement("div",{className:"row small-up-1 medium-up-2 large-up-3 collapse"},i))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);Qe.defaultProps={heading:null,hidden:!1,showToggle:!1,close:null};var $e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={externalWindow:null,containerElement:null},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.open("","","width=800, height=500, left=200, top=200"),a=null;t&&((a=t.document.createElement("div")).className="dojo popout",t.document.body.appendChild(a),Array.from(document.styleSheets).forEach((function(e){var a=e;if(e.href){var n=document.createElement("link");n.rel="stylesheet",n.href=e.href,t.document.head.appendChild(n)}else if(a&&a.cssRules&&a.cssRules.length>0){var r=document.createElement("style");Array.from(a.cssRules).forEach((function(e){r.appendChild(document.createTextNode(e.cssText))})),t.document.head.appendChild(r)}})),t.document.title=this.props.title,t.addEventListener("beforeunload",(function(){e.props.closeWindow()})));this.setState({externalWindow:t,containerElement:a})}},{key:"componentWillUnmount",value:function(){this.state.externalWindow&&this.state.externalWindow.close()}},{key:"render",value:function(){try{return this.state.containerElement?i.a.createPortal(this.props.children,this.state.containerElement):null}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),et=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={selectedTokenID:null,addingToMapID:null,mapSize:30,playerView:{open:!1,showControls:!0,mapSize:30}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(){e.setPlayerViewOpen(!1)}))}},{key:"setSelectedTokenID",value:function(e){this.setState({selectedTokenID:e})}},{key:"setAddingToMapID",value:function(e){this.setState({addingToMapID:e})}},{key:"nudgeMapSize",value:function(e){this.setState({mapSize:this.state.mapSize+e})}},{key:"setPlayerViewOpen",value:function(e){this.state.playerView.open=e,this.setState({playerView:this.state.playerView})}},{key:"setPlayerViewShowControls",value:function(e){this.state.playerView.showControls=e,this.setState({playerView:this.state.playerView})}},{key:"nudgePlayerViewMapSize",value:function(e){this.state.playerView.mapSize=this.state.playerView.mapSize+e,this.setState({playerView:this.state.playerView})}},{key:"getPlayerView",value:function(e){var t=this;if(!this.state.playerView.open)return null;var a=e.combatants.filter((function(e){return e.showOnMap})).filter((function(e){return!e.pending&&e.active&&!e.defeated})).map((function(e){switch(e.type){case"pc":return r.a.createElement(rt,{key:e.id,combatant:e,minimal:!0,combat:t.props.combat,select:function(e){return t.setSelectedTokenID(e.id)},selected:e.id===t.state.selectedTokenID});case"monster":return r.a.createElement(st,{key:e.id,combatant:e,minimal:!0,combat:t.props.combat,select:function(e){return t.setSelectedTokenID(e.id)},selected:e.id===t.state.selectedTokenID});default:return null}}));if(e.map){var n=null;if(e.map&&this.state.playerView.showControls){var s=e.combatants.filter((function(t){return null!==e.map&&e.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).find((function(e){return e.id===t.state.selectedTokenID}));if(s||(s=e.combatants.filter((function(t){return null!==e.map&&e.map.items.find((function(e){return e.id===t.id}))})).filter((function(e){return e.showOnMap})).find((function(e){return e.current}))),s){var i=s;n=r.a.createElement("div",null,r.a.createElement("div",{className:"heading lowercase"},i.displayName),r.a.createElement("div",{className:"section centered"},r.a.createElement(P,{direction:"eight",click:function(e){return t.props.mapMove(i,e)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement(G,{key:"altitude",source:i,name:"altitude",label:"altitude",display:function(e){return e+" ft."},nudgeValue:function(e){return t.props.nudgeValue(i,"altitude",5*e)}}),r.a.createElement(w,{key:"tags",controls:k.map((function(e){return r.a.createElement(E,{key:e,label:e,display:"button",checked:i.tags.includes(e),changeValue:function(a){return t.props.toggleTag(i,e)}})}))}))}}return r.a.createElement($e,{title:"Encounter",closeWindow:function(){return t.setPlayerViewOpen(!1)}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-12 medium-6 large-8 scrollable scrollable-both"},r.a.createElement(ie,{key:"map",map:e.map,mode:"combat-player",size:this.state.playerView.mapSize,combatants:e.combatants,selectedItemID:this.state.selectedTokenID?this.state.selectedTokenID:void 0,setSelectedItemID:function(e){return t.setSelectedTokenID(e)}})),r.a.createElement("div",{className:"columns small-12 medium-6 large-4 scrollable"},n,r.a.createElement("div",{className:"heading"},"initiative order"),a)))}return r.a.createElement($e,{title:"Encounter",closeWindow:function(){return t.setPlayerViewOpen(!1)}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"columns small-12 medium-12 large-12 scrollable"},r.a.createElement("div",{className:"heading"},"initiative order"),a)))}},{key:"createCard",value:function(e){var t=this,a="combat";this.props.combat&&this.props.combat.map&&(a+=" tactical",a+=this.props.combat.map.items.find((function(t){return t.id===e.id}))?" on-map":" off-map");switch(e.type){case"pc":return r.a.createElement(Ze,{key:"selected",combatant:e,mode:a,combat:this.props.combat,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.defeatCombatant(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(t.state.addingToMapID?null:e.id)},mapMove:function(e,a){return t.props.mapMove(e,a)},mapRemove:function(e){return t.props.mapRemove(e)},endTurn:function(e){return t.props.endTurn(e)},toggleTag:function(e,a){return t.props.toggleTag(e,a)}});case"monster":return r.a.createElement(te,{key:"selected",combatant:e,mode:a,combat:this.props.combat,changeValue:function(e,a,n){return t.props.changeValue(e,a,n)},nudgeValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},makeCurrent:function(e){return t.props.makeCurrent(e)},makeActive:function(e){return t.props.makeActive(e)},makeDefeated:function(e){return t.defeatCombatant(e)},removeCombatant:function(e){return t.props.removeCombatant(e)},addCondition:function(e){return t.props.addCondition(e)},editCondition:function(e,a){return t.props.editCondition(e,a)},removeCondition:function(e,a){return t.props.removeCondition(e,a)},nudgeConditionValue:function(e,a,n){return t.props.nudgeValue(e,a,n)},mapAdd:function(e){return t.setAddingToMapID(t.state.addingToMapID?null:e.id)},mapMove:function(e,a){return t.props.mapMove(e,a)},mapRemove:function(e){return t.props.mapRemove(e)},endTurn:function(e){return t.props.endTurn(e)},changeHP:function(e,a,n){return t.props.changeHP(e,a,n)},toggleTag:function(e,a){return t.props.toggleTag(e,a)}});default:return null}}},{key:"defeatCombatant",value:function(e){this.state.selectedTokenID===e.id&&this.setState({selectedTokenID:null}),this.props.makeDefeated(e)}},{key:"addCombatantToMap",value:function(e,t){var a=this;if(this.props.combat){var n=this.props.combat.combatants.find((function(e){return e.id===a.state.addingToMapID}));n&&this.props.mapAdd(n,e,t),this.setAddingToMapID(null)}}},{key:"render",value:function(){var e=this;try{if(this.props.combat){var t=[],a=[],n=[],s=[];if(this.props.combat.combatants.forEach((function(i){if(i.current&&t.push(r.a.createElement("div",{key:i.id},e.createCard(i))),!i.pending||i.active||i.defeated||a.push(r.a.createElement(nt,{key:i.id,combatant:i,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID,nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},makeActive:function(t){return e.props.makeActive(t)}})),!i.pending&&i.active&&!i.defeated)switch(i.type){case"pc":n.push(r.a.createElement(rt,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}));break;case"monster":n.push(r.a.createElement(st,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}))}if(!i.pending&&!i.active&&i.defeated)switch(i.type){case"pc":s.push(r.a.createElement(rt,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}));break;case"monster":s.push(r.a.createElement(st,{key:i.id,combatant:i,combat:e.props.combat,select:function(t){return e.setSelectedTokenID(t.id)},selected:i.id===e.state.selectedTokenID}))}})),0!==a.length){var i=r.a.createElement("div",{key:"pending-help"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"these combatants are not yet part of the encounter"),r.a.createElement("div",{className:"section"},"set initiative on each of them, then add them to the encounter"))}));a=[i].concat(a)}if(0===t.length){var o=r.a.createElement("div",{key:"active-help"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)"),r.a.createElement("div",{className:"section"},"they are listed in initiative order (with the highest initiative score at the top of the list, and the lowest at the bottom)"),r.a.createElement("div",{className:"section"},"when you're ready to begin the encounter, select the first combatant and press the ",r.a.createElement("b",null,"start turn")," button on their stat block"))}));n=[o].concat(n)}0===t.length&&t.push(r.a.createElement(_,{key:"current",content:r.a.createElement("div",{className:"section"},"the current initiative holder will be displayed here")}));var c=null;if(this.props.combat.notifications.length>0){var l=this.props.combat.notifications.map((function(t){return r.a.createElement(at,{key:t.id,notification:t,close:function(t,a){return e.props.closeNotification(t,a)}})}));c=r.a.createElement("div",{className:"notifications"},l)}var u=null;this.props.combat.map&&(u=r.a.createElement("div",{key:"map"},r.a.createElement(ie,{map:this.props.combat.map,mode:"combat",size:this.state.mapSize,showOverlay:null!==this.state.addingToMapID,combatants:this.props.combat.combatants,selectedItemID:this.state.selectedTokenID?this.state.selectedTokenID:void 0,setSelectedItemID:function(t){return e.setSelectedTokenID(t)},gridSquareClicked:function(t,a){return e.addCombatantToMap(t,a)}})));var m,p=this.props.combat.encounterID,h=this.props.encounters.find((function(e){return e.id===p}));m=!!h&&h.waves.length>0;var v=r.a.createElement(Qe,{heading:"tools",content:[r.a.createElement("div",{key:"tools"},r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"encounter"),r.a.createElement("button",{onClick:function(){return e.props.pauseCombat()}},"pause encounter"),r.a.createElement("button",{onClick:function(){return e.props.endCombat()}},"end encounter"),r.a.createElement("button",{onClick:function(){return e.props.addCombatants()}},"add combatants"),r.a.createElement("button",{onClick:function(){return e.props.addWave()},style:{display:m?"block":"none"}},"add wave")),r.a.createElement("div",{style:{display:this.props.combat.map?"block":"none"}},r.a.createElement("div",{className:"subheading"},"map"),r.a.createElement("button",{onClick:function(){return e.props.scatterCombatants("monster")}},"scatter monsters"),r.a.createElement("button",{onClick:function(){return e.props.scatterCombatants("pc")}},"scatter pcs"),r.a.createElement("button",{onClick:function(){return e.props.rotateMap()}},"rotate the map"),r.a.createElement(G,{source:this.state,name:"mapSize",display:function(e){return"zoom"},nudgeValue:function(t){return e.nudgeMapSize(5*t)}})),r.a.createElement("div",null,r.a.createElement("div",{className:"subheading"},"player view"),r.a.createElement(E,{label:"show player view",checked:this.state.playerView.open,changeValue:function(t){return e.setPlayerViewOpen(t)}}),r.a.createElement(E,{label:"show controls",checked:this.state.playerView.showControls,changeValue:function(t){return e.setPlayerViewShowControls(t)}}),r.a.createElement("div",{style:{display:this.props.combat.map&&this.state.playerView.open?"block":"none"}},r.a.createElement(G,{source:this.state.playerView,name:"mapSize",display:function(e){return"zoom"},nudgeValue:function(t){return e.nudgePlayerViewMapSize(5*t)}}))))],showToggle:!0}),f=[];this.props.combat.combatants.forEach((function(t){var a=t,n=a&&a.traits&&a.traits.some((function(e){return"legendary"===e.type}))&&!a.current,s=a&&a.traits&&a.traits.some((function(e){return"lair"===e.type}));(n||s)&&f.push(r.a.createElement("div",{className:"card monster",key:a.id},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},a.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement(Z,{combatant:a,mode:"combat-special",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}))))}));var b=null;if(this.state.selectedTokenID){var g=this.props.combat.combatants.find((function(t){return t.id===e.state.selectedTokenID}));g&&!g.current&&(b=this.createCard(g))}return b||(b=r.a.createElement(_,{key:"selected",content:r.a.createElement("div",{className:"section"},"select a pc or monster from the ",r.a.createElement("b",null,"initiative order")," list to see its details here")})),r.a.createElement("div",{className:"combat-manager row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},r.a.createElement(Qe,{heading:"initiative holder",content:t})),r.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},c,r.a.createElement(Qe,{heading:"waiting for intiative to be entered",content:a,hidden:0===a.length,showToggle:!0}),r.a.createElement(Qe,{heading:"encounter map",content:[u],hidden:null===u,showToggle:!0}),r.a.createElement(Qe,{heading:"initiative order",content:n,hidden:0===n.length,showToggle:!0}),r.a.createElement(Qe,{heading:"defeated",content:s,hidden:0===s.length,showToggle:!0})),r.a.createElement("div",{className:"columns small-4 medium-4 large-4 scrollable"},v,this.getPlayerView(this.props.combat),r.a.createElement(Qe,{heading:"don't forget",content:f,hidden:0===f.length,showToggle:!0}),r.a.createElement(Qe,{heading:"selected combatant",content:[b]})))}var y=this.props.combats.filter((function(t){return d.match(e.props.filter,t.name)})).map((function(t){return r.a.createElement(Ke,{key:t.id,combat:t,selected:!1,setSelection:function(t){return e.props.resumeCombat(t)}})}));return 0===y.length&&(y=[r.a.createElement(_,{key:"empty",content:"you have no in-progress encounters"})]),r.a.createElement("div",{className:"combat-manager row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},r.a.createElement("button",{onClick:function(){return e.props.createCombat()}},"start a new combat"),r.a.createElement("div",{className:"divider"}),y),r.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},r.a.createElement(tt,{combats:this.props.combats}))))))}catch(k){return console.error(k),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),tt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;return e=0===this.props.combats.length?r.a.createElement("div",{className:"section"},"to start a combat encounter, press the ",r.a.createElement("b",null,"start a new combat")," button"):r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on the left you will see a list of encounters that you have paused"),r.a.createElement("div",{className:"section"},"you can resume a paused combat by selecting it")),r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"here you can run a combat encounter by specifying a party and an encounter, and optionally a map"),r.a.createElement("div",{className:"divider"}),e)})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),at=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"success",value:function(){switch(this.props.notification.type){case"condition-save":case"condition-end":var e=this.props.notification.data;e.duration&&("saves"!==e.duration.type&&"rounds"!==e.duration.type||(e.duration.count-=1,0===e.duration.count?this.close(!0):this.close()));break;case"trait-recharge":this.props.notification.data.uses=0,this.close()}}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.close(this.props.notification,e)}},{key:"render",value:function(){var e=this;try{var t=this.props.notification.combatant,a=this.props.notification.data,n=this.props.notification.data,s=t.displayName||t.name||"unnamed monster";switch(this.props.notification.type){case"condition-save":var i=a.duration,o=i.saveType.toString();return"death"!==o&&(o=o.toUpperCase()),r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," must make a ",o," save against dc ",i.saveDC),r.a.createElement(w,{controls:[r.a.createElement("button",{key:"success",onClick:function(){return e.success()}},"success"),r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));case"condition-end":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," is no longer affected by condition ",a.name),r.a.createElement(w,{controls:[r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));case"trait-recharge":return r.a.createElement("div",{key:this.props.notification.id,className:"descriptive"},r.a.createElement("div",{className:"text"},s," can attempt to recharge ",n.name," (",n.usage,")"),r.a.createElement(w,{controls:[r.a.createElement("button",{key:"recharge",onClick:function(){return e.success()}},"recharge"),r.a.createElement("button",{key:"close",onClick:function(){return e.close()}},"close")]}));default:return null}}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),nt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;return(this.props.combatant.current||this.props.selected)&&(t+=" highlight"),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},r.a.createElement(G,{source:this.props.combatant,name:"initiative",label:"initiative",nudgeValue:function(t){return e.props.nudgeValue(e.props.combatant,"initiative",t)}}),r.a.createElement("button",{onClick:function(t){t.stopPropagation(),e.props.makeActive(e.props.combatant)}},"add to encounter")))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),rt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),!this.props.selected&&this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;this.props.selected&&(t+=" highlight");var a=null;if(!this.props.minimal){var n=this.props.combatant.race||"unknown race",s=this.props.combatant.classes||"unknown class";a=r.a.createElement("div",{className:"section lowercase"},n+" "+s+", level "+this.props.combatant.level)}var i=null;this.props.combatant.conditions&&(i=this.props.combatant.conditions.map((function(t){var a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),"custom"===t.name&&t.text&&(a=t.text),t.duration&&(a+=" "+d.conditionDurationText(t,e.props.combat));for(var n=[],s=d.conditionText(t),i=0;i!==s.length;++i)n.push(r.a.createElement("li",{key:i,className:"condition-text"},s[i]));return r.a.createElement(_,{key:t.id,white:!0,content:r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},a),r.a.createElement("ul",null,n))})})));var o=[];this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find((function(t){return t.id===e.props.combatant.id}))||o.push(r.a.createElement(_,{key:"not-on-map",white:!0,content:"not on the map"}))),this.props.combatant.tags.forEach((function(e){o.push(r.a.createElement(_,{key:e,white:!0,content:d.getTagDescription(e)}))}));var c=null;return this.props.combatant.companions.length>0&&(c=r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"companions:")," ",this.props.combatant.companions.map((function(e){return e.name})).join(", "))),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",this.props.combatant.player?" | "+this.props.combatant.player:"",r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},a,i,o,c))}catch(l){return console.error(l),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);rt.defaultProps={minimal:!1};var st=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getInformationText",value:function(){return this.props.combatant.current?"current turn":this.props.selected?"selected":null}},{key:"onClick",value:function(e){e.stopPropagation(),!this.props.selected&&this.props.select&&this.props.select(this.props.combatant)}},{key:"render",value:function(){var e=this;try{var t="combatant-row "+this.props.combatant.type;this.props.selected&&(t+=" highlight");var a=(this.props.combatant.hp?this.props.combatant.hp:0).toString();this.props.combatant.hpTemp>0&&(a+="+"+this.props.combatant.hpTemp);var n=null;this.props.combatant.pending||(n=r.a.createElement(se,{combatant:this.props.combatant}));var s=null;this.props.combatant.conditions&&(s=this.props.combatant.conditions.map((function(t){var a=t.name;"exhaustion"===t.name&&(a+=" ("+t.level+")"),"custom"===t.name&&t.text&&(a=t.text),t.duration&&(a+=" "+d.conditionDurationText(t,e.props.combat));for(var n=[],s=d.conditionText(t),i=0;i!==s.length;++i)n.push(r.a.createElement("li",{key:i,className:"condition-text"},s[i]));return r.a.createElement(_,{key:t.id,white:!0,content:r.a.createElement("div",{className:"condition"},r.a.createElement("div",{className:"condition-name"},a),r.a.createElement("ul",null,n))})})));var i=[];this.props.combat.map&&(this.props.combatant.pending||this.props.combat.map.items.find((function(t){return t.id===e.props.combatant.id}))||i.push(r.a.createElement(_,{key:"not-on-map",white:!0,content:"not on the map"}))),this.props.combatant.tags.forEach((function(e){i.push(r.a.createElement(_,{key:e,white:!0,content:d.getTagDescription(e)}))}));var o=null;return this.props.minimal||(o=r.a.createElement("div",null,r.a.createElement("div",{className:"section key-stats"},r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-label"},"ac"),r.a.createElement("div",{className:"stat-value"},this.props.combatant.ac)),r.a.createElement("div",{className:"key-stat"},r.a.createElement("div",{className:"stat-value"},a),r.a.createElement("div",{className:"stat-label"},"hp"))),n)),r.a.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.a.createElement("div",{className:"name"},this.props.combatant.displayName||this.props.combatant.name||"combatant",r.a.createElement("span",{className:"info"},this.getInformationText())),r.a.createElement("div",{className:"content"},o,s,i))}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);st.defaultProps={minimal:!1};var it=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=[];return this.props.encounter.slots.forEach((function(e){var a=e.monsterName||"unnamed monster";e.count>1&&(a+=" x"+e.count),t.push(r.a.createElement("div",{key:e.id,className:"section"},a))})),0===t.length&&t.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),this.props.encounter.waves.forEach((function(e){t.push(r.a.createElement("div",{key:"name "+e.id,className:"section subheading"},e.name||"unnamed wave")),e.slots.forEach((function(e){var a=e.monsterName||"unnamed monster";e.count>1&&(a+=" x"+e.count),t.push(r.a.createElement("div",{key:e.id,className:"section"},a))})),0===t.length&&t.push(r.a.createElement("div",{key:"empty "+e.id,className:"section"},"no monsters"))})),r.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.encounter)}},r.a.createElement("div",{className:"heading"},this.props.encounter.name||"unnamed encounter"),t)}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={filter:p.createMonsterFilter()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"matchMonster",value:function(e){return y.matchMonster(e,this.state.filter)}},{key:"changeFilterValue",value:function(e,t){this.state.filter[e]=t,this.setState({filter:this.state.filter})}},{key:"nudgeFilterValue",value:function(e,t){var a=d.nudgeChallenge(this.state.filter[e],t);this.changeFilterValue(e,a)}},{key:"resetFilter",value:function(){this.setState({filter:p.createMonsterFilter()})}},{key:"getMonsterCards",value:function(e,t){var a=this,n=[];return e.forEach((function(s){var i=a.props.getMonster(s.monsterName,s.monsterGroupName);if(i)n.push(r.a.createElement("div",{className:"column",key:i.id},r.a.createElement(te,{combatant:i,slot:s,encounter:a.props.selection,mode:"view encounter",nudgeValue:function(e,t,n){return a.props.nudgeValue(e,t,n)},removeEncounterSlot:function(e){return a.props.removeEncounterSlot(e,t)}})));else{var o=e.indexOf(s),c="unknown monster: "+s.monsterName+" in group "+s.monsterGroupName;n.push(r.a.createElement("div",{className:"column",key:o},r.a.createElement("div",{className:"card error"},r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"section"},c)))))}})),0===e.length&&(t?n.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("p",null,"there are no monsters in this wave"))}))):n.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("p",null,"there are no monsters in this encounter"),r.a.createElement("p",null,"you can add monsters from the list below, or try 'build a random encounter'"))})))),n}},{key:"getLibrarySection",value:function(){var e=this;if(!this.props.selection)return null;var t=[];this.props.selection&&(this.props.library.forEach((function(a){a.monsters.forEach((function(a){e.matchMonster(a)&&t.push(a)}))})),t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})));var a=t.map((function(t){return r.a.createElement("div",{className:"column",key:t.id},r.a.createElement(te,{key:t.id,combatant:t,encounter:e.props.selection,library:e.props.library,mode:"view encounter",addEncounterSlot:function(t,a){return e.props.addEncounterSlot(t,a)}}))}));return 0===a.length&&a.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("p",null,"there are no monsters that meet the criteria ",r.a.createElement("i",null,y.getFilterDescription(this.state.filter))))}))),r.a.createElement(Qe,{heading:"monster library",content:a,showToggle:!0})}},{key:"showEncounter",value:function(e){return d.match(this.props.filter,e.name)}},{key:"render",value:function(){var e=this;try{var t,a=null;if(this.props.selection)a=r.a.createElement("div",null,r.a.createElement(lt,{selection:this.props.selection,parties:this.props.parties,filter:this.props.filter,monsterFilter:this.state.filter,changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},addWave:function(){return e.props.addWave()},removeWave:function(t){return e.props.removeWave(t)},clearEncounter:function(){return e.props.clearEncounter()},removeEncounter:function(){return e.props.removeEncounter()},buildEncounter:function(t){return e.props.buildEncounter(t,e.state.filter)},getMonster:function(t,a){return e.props.getMonster(t,a)},changeFilterValue:function(t,a){return e.changeFilterValue(t,a)},nudgeFilterValue:function(t,a){return e.nudgeFilterValue(t,a)},resetFilter:function(){return e.resetFilter()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.selectEncounter(null)}},"\u2190 back to list"));else{var n=this.props.encounters.filter((function(t){return e.showEncounter(t)})).map((function(t){return r.a.createElement(it,{key:t.id,encounter:t,selected:t===e.props.selection,setSelection:function(t){return e.props.selectEncounter(t)}})}));0===n.length&&(n=[r.a.createElement(_,{key:"empty",content:"you have not defined any encounters yet"})]),a=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addEncounter()}},"add a new encounter"),r.a.createElement("div",{className:"divider"}),n)}var s,i=[],o=[];return this.props.selection&&(t=this.props.selection.name||"unnamed encounter",this.getMonsterCards(this.props.selection.slots,null).forEach((function(e){return i.push(e)})),o=this.props.selection.waves.map((function(t){return r.a.createElement(Qe,{key:t.id,heading:t.name||"unnamed wave",content:e.getMonsterCards(t.slots,t.id),showToggle:!0})}))),this.props.selection||(s=r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},r.a.createElement(ct,{encounters:this.props.encounters}))))),r.a.createElement("div",{className:"encounter-builder row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},a),r.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},r.a.createElement(Qe,{content:i,heading:t,hidden:!this.props.selection}),o,this.getLibrarySection(),s))}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ct=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;return e=0===this.props.encounters.length?r.a.createElement("div",{className:"section"},"to start building an encounter, press the ",r.a.createElement("b",null,"add a new encounter")," button"):r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on the left you will see a list of encounters that you have created"),r.a.createElement("div",{className:"section"},"select an encounter from the list to add monsters to it")),r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on this page you can set up encounters"),r.a.createElement("div",{className:"section"},"when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),e)})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),lt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={randomEncounterXP:100,randomEncounterStep:100},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setRandomEncounterXP",value:function(e){this.setState({randomEncounterXP:Math.max(0,e)})}},{key:"setRandomEncounterStep",value:function(e){this.setState({randomEncounterStep:e})}},{key:"render",value:function(){var e=this;try{var t=this.props.selection.waves.map((function(t){return r.a.createElement("div",{key:t.id,className:"group-panel"},r.a.createElement("input",{type:"text",placeholder:"wave name",value:t.name,onChange:function(a){return e.props.changeValue(t,"name",a.target.value)}}),r.a.createElement(C,{text:"delete wave",callback:function(){return e.props.removeWave(t)}}))}));return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"encounter name"),r.a.createElement("input",{type:"text",placeholder:"encounter name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue(e.props.selection,"name",t.target.value)}})),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"waves"),t,r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addWave()}},"add a new wave")),r.a.createElement("div",{className:"divider"}),r.a.createElement(re,{encounter:this.props.selection,parties:this.props.parties,getMonster:function(t,a){return e.props.getMonster(t,a)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(ae,{filter:this.props.monsterFilter,changeValue:function(t,a){return e.props.changeFilterValue(t,a)},nudgeValue:function(t,a){return e.props.nudgeFilterValue(t,a)},resetFilter:function(){return e.props.resetFilter()}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement(A,{text:"build a random encounter",content:r.a.createElement("div",null,r.a.createElement("p",null,"add random monsters to this encounter until its adjusted xp value is at least the following value"),r.a.createElement(G,{source:this.state,name:"randomEncounterXP",label:"xp",nudgeValue:function(t){return e.setRandomEncounterXP(e.state.randomEncounterXP+t*e.state.randomEncounterStep)}}),r.a.createElement(F,{options:["10","100","1000"].map((function(e){return{id:e,text:e}})),selectedID:this.state.randomEncounterStep.toString(),select:function(t){return e.setRandomEncounterStep(Number.parseInt(t,10))}}),r.a.createElement("button",{onClick:function(){return e.props.buildEncounter(e.state.randomEncounterXP)}},"build encounter"))}),r.a.createElement(C,{text:"clear encounter",callback:function(){return e.props.clearEncounter()}}),r.a.createElement(C,{text:"delete encounter",callback:function(){return e.props.removeEncounter()}})))}catch(a){return console.error(a),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ut=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{return r.a.createElement("div",{className:"readaloud"},this.props.content)}catch(e){return console.error(e),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),mt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{var t=null;0===this.props.library.length&&(t=r.a.createElement("div",null,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"since your collection of monsters is empty, you might want to start by pressing the button below to add monsters from the\xa0",r.a.createElement("a",{href:"http://dnd.wizards.com/articles/features/systems-reference-document-srd",target:"_blank",rel:"noopener noreferrer"},"system reference document")),r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.props.addOpenGameContent()}},"add monsters"))));var a=r.a.createElement(ut,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},"welcome to ",r.a.createElement("b",null,"dojo")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("b",null,"dojo")," is an app for dms of dungeons and dragons fifth edition"),r.a.createElement("div",{className:"section"},"with ",r.a.createElement("b",null,"dojo")," you can:",r.a.createElement("ul",null,r.a.createElement("li",null,"build unique, challenging monsters"),r.a.createElement("li",null,"create encounters of just the right difficulty for your players"),r.a.createElement("li",null,"design intricate tactical maps"),r.a.createElement("li",null,"run combat without the book-keeping"))),t,r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},"use the buttons at the bottom of the screen to explore the app's main features, or press the tools button at the top right for additional dm tools"))});return r.a.createElement("div",{className:"home scrollable"},r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},a))))}catch(n){return console.error(n),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),dt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",{className:"card map"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"title"},this.props.map.name||"unnamed map")),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"section"},r.a.createElement(ie,{map:this.props.map,mode:"thumbnail",size:10})),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.editMap(e.props.map)}},"edit map"),r.a.createElement(C,{text:"delete map",callback:function(){return e.props.removeMap(e.props.map)}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),pt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=d.match(this.props.filter,this.props.mapFolio.name),a=[],n=0;n!==this.props.mapFolio.maps.length;++n){var s=this.props.mapFolio.maps[n],i=s.name||"unnamed map";(t||d.match(this.props.filter,i))&&a.push(r.a.createElement("div",{key:s.id,className:"section"},i))}return 0===a.length&&a.push(r.a.createElement("div",{key:"empty",className:"section"},"no maps")),r.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.mapFolio)}},r.a.createElement("div",{className:"heading"},this.props.mapFolio.name||"unnamed folio"),a)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ht=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showMapFolio",value:function(e){var t=this,a=d.match(this.props.filter,e.name);return a||e.maps.forEach((function(e){a=d.match(t.props.filter,e.name)||a})),a}},{key:"render",value:function(){var e=this;try{var t=null;if(this.props.selection)t=r.a.createElement("div",null,r.a.createElement(ft,{selection:this.props.selection,filter:this.props.filter,addMap:function(){return e.props.addMap()},removeMapFolio:function(){return e.props.removeMapFolio()},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.selectMapFolio(null)}},"\u2190 back to list"));else{var a=this.props.mapFolios.filter((function(t){return e.showMapFolio(t)})).map((function(t){return r.a.createElement(pt,{key:t.id,mapFolio:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectMapFolio(t)}})}));0===a.length&&(a=[r.a.createElement(_,{key:"empty",content:"you have not set up any tactical maps yet"})]),t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addMapFolio()}},"add a new map folio"),r.a.createElement("div",{className:"divider"}),a)}var n,s=null;if(this.props.selection){var i=[];this.props.selection.maps.filter((function(t){return d.match(e.props.filter,t.name)})).forEach((function(t){i.push(r.a.createElement("div",{className:"column",key:t.id},r.a.createElement(dt,{map:t,editMap:function(t){return e.props.editMap(t)},removeMap:function(t){return e.props.removeMap(t)},changeValue:function(t,a,n){return e.props.changeValue(t,a,n)}})))})),0===i.length&&i.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",{className:"section"},"there are no maps in this folio")}))),s=r.a.createElement(Qe,{content:i,heading:this.props.selection.name||"unnamed folio"})}return this.props.selection||(n=r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},r.a.createElement(vt,{mapFolios:this.props.mapFolios}))))),r.a.createElement("div",{className:"map-builder row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t),r.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},s,n))}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),vt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;return e=0===this.props.mapFolios.length?r.a.createElement("div",{className:"section"},"to start a new folio, press the ",r.a.createElement("b",null,"add a new map folio")," button"):r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on the left you will see a list of map folios"),r.a.createElement("div",{className:"section"},"select a folio from the list to see the maps it contains")),r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on this page you can set up folios containing tactical maps"),r.a.createElement("div",{className:"section"},"when you have created a map you can use it in the combat manager"),r.a.createElement("div",{className:"divider"}),e)})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),ft=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"map folio name"),r.a.createElement("input",{type:"text",placeholder:"map folio name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue(e.props.selection,"name",t.target.value)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addMap()}},"add a new map"),r.a.createElement(C,{text:"delete folio",callback:function(){return e.props.removeMapFolio()}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),bt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=d.match(this.props.filter,this.props.group.name),a=[],n=0;n!==this.props.group.monsters.length;++n){var s=this.props.group.monsters[n],i=s.name||"unnamed monster";(t||d.match(this.props.filter,i))&&a.push(r.a.createElement("div",{key:s.id,className:"section"},i))}return 0===a.length&&a.push(r.a.createElement("div",{key:"empty",className:"section"},"no monsters")),r.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.group)}},r.a.createElement("div",{className:"heading"},this.props.group.name||"unnamed group"),a)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),gt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showMonsterGroup",value:function(e){var t=this,a=d.match(this.props.filter,e.name);return a||e.monsters.forEach((function(e){a=d.match(t.props.filter,e.name)||a})),a}},{key:"render",value:function(){var e=this;try{var t=null;if(this.props.selection)t=r.a.createElement("div",null,r.a.createElement(Et,{selection:this.props.selection,filter:this.props.filter,addMonster:function(){return e.props.addMonster()},sortMonsters:function(){return e.props.sortMonsters()},changeValue:function(t,a){return e.props.changeValue(e.props.selection,t,a)},removeMonsterGroup:function(){return e.props.removeMonsterGroup()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.selectMonsterGroup(null)}},"\u2190 back to list"));else{var a=this.props.library.filter((function(t){return e.showMonsterGroup(t)})).map((function(t){return r.a.createElement(bt,{key:t.id,group:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectMonsterGroup(t)}})}));0===a.length&&(a=[r.a.createElement(_,{key:"empty",content:"you do not have any monsters in your library"})]),t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addMonsterGroup()}},"add a new monster group"),r.a.createElement("div",{className:"divider"}),a)}var n,s,i=[];if(this.props.selection){var o=this.props.selection.monsters.filter((function(t){return d.match(e.props.filter,t.name)}));0!==o.length?o.forEach((function(t){i.push(r.a.createElement("div",{className:"column",key:t.id},r.a.createElement(te,{combatant:t,mode:"view editable",library:e.props.library,changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},moveToGroup:function(t,a){return e.props.moveToGroup(t,a)},removeMonster:function(t){return e.props.removeMonster(t)},editMonster:function(t){return e.props.editMonster(t)},cloneMonster:function(t,a){return e.props.cloneMonster(t,a)}})))})):i.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",{className:"section"},"there are no monsters in this group")})))}return this.props.selection&&((n=this.props.selection.name)||(n="unnamed group")),this.props.selection||(s=r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},r.a.createElement(yt,{library:this.props.library}))))),r.a.createElement("div",{className:"monster-library row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t),r.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},r.a.createElement(Qe,{content:i,heading:n,hidden:!this.props.selection}),s))}catch(c){return console.error(c),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),yt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;return e=0===this.props.library.length?r.a.createElement("div",{className:"section"},"to start adding monsters, press the ",r.a.createElement("b",null,"add a new monster group")," button"):r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on the left you will see a list of monster groups"),r.a.createElement("div",{className:"section"},"select a monster group from the list to see stat blocks for monsters in that group")),r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"you can maintain your menagerie of monsters here"),r.a.createElement("div",{className:"section"},"you can then use these monsters to design combat encounters in the encounter builder"),r.a.createElement("div",{className:"divider"}),e)})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Et=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"monster group name"),r.a.createElement("input",{type:"text",placeholder:"monster group name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addMonster()}},"add a new monster"),r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.sortMonsters()}},"sort monsters"),r.a.createElement(C,{text:"delete group",callback:function(){return e.props.removeMonsterGroup()}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),kt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;try{for(var t=d.match(this.props.filter,this.props.party.name),a=[],n=0;n!==this.props.party.pcs.length;++n){var s=this.props.party.pcs[n],i=s.name||"unnamed pc";s.player&&(i+=" ("+s.player+")"),(t||d.match(this.props.filter,i))&&a.push(r.a.createElement("div",{key:s.id,className:"section"},i))}return 0===a.length&&a.push(r.a.createElement("div",{key:"empty",className:"section"},"no pcs")),r.a.createElement("div",{className:this.props.selected?"list-item selected":"list-item",onClick:function(){return e.props.setSelection(e.props.party)}},r.a.createElement("div",{className:"heading"},this.props.party.name||"unnamed party"),a)}catch(o){return console.error(o),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Nt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"showParty",value:function(e){var t=this,a=d.match(this.props.filter,e.name);return a||e.pcs.forEach((function(e){a=d.match(t.props.filter,e.name)||a})),a}},{key:"render",value:function(){var e=this;try{var t=null;if(this.props.selection)t=r.a.createElement("div",null,r.a.createElement(Ct,{selection:this.props.selection,filter:this.props.filter,addPC:function(){return e.props.addPC()},sortPCs:function(){return e.props.sortPCs()},changeValue:function(t,a){return e.props.changeValue(e.props.selection,t,a)},removeParty:function(){return e.props.removeParty()}}),r.a.createElement("div",{className:"divider"}),r.a.createElement("button",{onClick:function(){return e.props.selectParty(null)}},"\u2190 back to list"));else{var a=this.props.parties.filter((function(t){return e.showParty(t)})).map((function(t){return r.a.createElement(kt,{key:t.id,party:t,filter:e.props.filter,selected:t===e.props.selection,setSelection:function(t){return e.props.selectParty(t)}})}));0===a.length&&(a=[r.a.createElement(_,{key:"empty",content:"you have not set up any parties yet"})]),t=r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.props.addParty()}},"add a new party"),r.a.createElement("div",{className:"divider"}),a)}var n,s,i=[],o=[];if(this.props.selection){var c=this.props.selection.pcs.filter((function(t){return d.match(e.props.filter,t.name)})),l=c.filter((function(e){return e.active}));l.forEach((function(t){i.push(r.a.createElement("div",{className:"column",key:t.id},r.a.createElement(Ze,{combatant:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},removePC:function(t){return e.props.removePC(t)}})))})),c.filter((function(e){return!e.active})).forEach((function(t){o.push(r.a.createElement("div",{className:"column",key:t.id},r.a.createElement(Ze,{combatant:t,mode:"edit",changeValue:function(t,a,n){return e.props.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.props.nudgeValue(t,a,n)},editPC:function(t){return e.props.editPC(t)},removePC:function(t){return e.props.removePC(t)}})))})),0===l.length&&i.push(r.a.createElement("div",{className:"column",key:"empty"},r.a.createElement(_,{content:r.a.createElement("div",{className:"section"},"there are no pcs in this party")})))}return this.props.selection&&(n=this.props.selection.name||"unnamed party"),this.props.selection||(s=r.a.createElement("div",{className:"vertical-center-outer"},r.a.createElement("div",{className:"vertical-center-middle"},r.a.createElement("div",{className:"vertical-center-inner"},r.a.createElement(xt,{parties:this.props.parties}))))),r.a.createElement("div",{className:"parties row collapse"},r.a.createElement("div",{className:"columns small-4 medium-4 large-3 scrollable list-column"},t),r.a.createElement("div",{className:"columns small-8 medium-8 large-9 scrollable"},r.a.createElement(Qe,{content:i,heading:n,hidden:!this.props.selection}),r.a.createElement(Qe,{content:o,heading:"inactive pcs",hidden:0===o.length}),s))}catch(u){return console.error(u),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),xt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=null;return e=0===this.props.parties.length?r.a.createElement("div",{className:"section"},"to start adding a party, press the ",r.a.createElement("b",null,"add a new party")," button"):r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"on the left you will see a list of parties that you have created"),r.a.createElement("div",{className:"section"},"select a party from the list to see pc details")),r.a.createElement(_,{content:r.a.createElement("div",null,r.a.createElement("div",{className:"section"},"this page is where you can tell dojo all about your pcs"),r.a.createElement("div",{className:"section"},"you can add a party for each of your gaming groups"),r.a.createElement("div",{className:"section"},"when you have set up a party and an encounter you can run the encounter in the combat manager"),r.a.createElement("div",{className:"divider"}),e)})}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),Ct=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getSummary",value:function(){var e=this.props.selection.pcs.filter((function(e){return e.active}));if(0===e.length)return null;var t,a,n,s;t=e.map((function(e){return e.languages})).join(", ").split(/[ ,;]+/).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[]).sort((function(e,t){return"Common"===e?-1:"Common"===t?1:e.localeCompare(t)})).join(", ");var i={min:null,max:null},o={min:null,max:null},c={min:null,max:null};return e.forEach((function(e){i.min=null===i.min?e.passiveInsight:Math.min(i.min,e.passiveInsight),i.max=null===i.max?e.passiveInsight:Math.max(i.max,e.passiveInsight),o.min=null===o.min?e.passiveInvestigation:Math.min(o.min,e.passiveInvestigation),o.max=null===o.max?e.passiveInvestigation:Math.max(o.max,e.passiveInvestigation),c.min=null===c.min?e.passivePerception:Math.min(c.min,e.passivePerception),c.max=null===c.max?e.passivePerception:Math.max(c.max,e.passivePerception)})),a=i.min===i.max?i.min.toString():i.min+" - "+i.max,n=o.min===o.max?o.min.toString():o.min+" - "+o.max,s=c.min===c.max?c.min.toString():c.min+" - "+c.max,r.a.createElement("div",{className:"group-panel"},r.a.createElement("div",{className:"section",style:{display:""!==t?"block":"none"}},r.a.createElement("div",{className:"subheading"},"party languages")),r.a.createElement("div",{className:"section"},t),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party passive skills")),r.a.createElement("div",{className:"table"},r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"insight")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"invest.")),r.a.createElement("div",{className:"cell three"},r.a.createElement("b",null,"percep."))),r.a.createElement("div",null,r.a.createElement("div",{className:"cell three"},a),r.a.createElement("div",{className:"cell three"},n),r.a.createElement("div",{className:"cell three"},s))))}},{key:"render",value:function(){var e=this;try{return r.a.createElement("div",null,r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"subheading"},"party name"),r.a.createElement("input",{type:"text",placeholder:"party name",value:this.props.selection.name,disabled:!!this.props.filter,onChange:function(t){return e.props.changeValue("name",t.target.value)}})),this.getSummary(),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"section"},r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.addPC()}},"add a new pc"),r.a.createElement("button",{className:this.props.filter?"disabled":"",onClick:function(){return e.props.sortPCs()}},"sort pcs"),r.a.createElement(C,{text:"delete party",callback:function(){return e.props.removeParty()}})))}catch(t){return console.error(t),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component),wt=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={view:"home",modal:null,filter:"",parties:[],library:[],encounters:[],mapFolios:[],combats:[],selectedPartyID:null,selectedMonsterGroupID:null,selectedEncounterID:null,selectedMapFolioID:null,selectedCombatID:null};try{var n=null;try{var r=window.localStorage.getItem("data");r&&(n=JSON.parse(r))}catch(s){console.error("Could not parse JSON: ",s),n=null}null!==n&&(n.parties.forEach((function(e){e.pcs.forEach((function(e){void 0===e.companions&&(e.companions=[])}))})),n.library.forEach((function(e){e.monsters.forEach((function(e){e.traits.forEach((function(e){void 0===e.uses&&(e.uses=0)}))}))})),n.encounters.forEach((function(e){e.waves||(e.waves=[])})),n.mapFolios||(n.mapFolios=[],n.selectedMapFolioID=null),n.mapFolios.forEach((function(e){e.maps.forEach((function(e){e.items.forEach((function(e){void 0===e.style&&(e.style=null)}))}))})),n.combats.forEach((function(e){e.notifications||(e.notifications=[]),e.combatants.forEach((function(e){(void 0===e.showOnMap&&(e.showOnMap=!0),void 0===e.altitude&&(e.altitude=0),void 0===e.tags&&(e.tags=[]),void 0===e.aura&&(e.aura={radius:0,style:"rounded",color:"#005080"}),"monster"===e.type)&&e.traits.forEach((function(e){void 0===e.uses&&(e.uses=0)}))}))})),n.view="home",n.modal=null,n.filter="",a.state=n)}catch(s){console.error(s)}return a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=null;try{e=JSON.stringify(this.state)}catch(t){console.error("Could not stringify data: ",t),e=null}null!==e&&window.localStorage.setItem("data",e)}},{key:"addParty",value:function(){var e=p.createParty();e.name="new party";var t=[].concat(this.state.parties,[e]);d.sort(t),this.setState({parties:t,selectedPartyID:e.id})}},{key:"removeParty",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=this.state.parties.indexOf(t);this.state.parties.splice(a,1),this.setState({parties:this.state.parties,selectedPartyID:null})}}},{key:"addPC",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=p.createPC();a.name="new pc",t.pcs.push(a),this.setState({parties:this.state.parties})}}},{key:"removePC",value:function(e){var t=this,a=this.state.parties.find((function(e){return e.id===t.state.selectedPartyID}));if(a){var n=a.pcs.indexOf(e);a.pcs.splice(n,1),this.setState({parties:this.state.parties})}}},{key:"sortPCs",value:function(){var e=this,t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));t&&(d.sort(t.pcs),this.setState({parties:this.state.parties}))}},{key:"editPC",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({modal:{type:"pc",pc:t}})}},{key:"savePC",value:function(){var e=this;d.sort(this.state.modal.pc.companions);var t=this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}));if(t){var a=t.pcs.find((function(t){return t.id===e.state.modal.pc.id}));if(a){var n=t.pcs.indexOf(a);t.pcs[n]=this.state.modal.pc,this.setState({library:this.state.library,modal:null})}}}},{key:"addMonsterGroup",value:function(){var e=p.createMonsterGroup();e.name="new group";var t=[].concat(this.state.library,[e]);d.sort(t),this.setState({library:t,selectedMonsterGroupID:e.id})}},{key:"removeMonsterGroup",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));if(t){var a=this.state.library.indexOf(t);this.state.library.splice(a,1),this.setState({library:this.state.library,selectedMonsterGroupID:null})}}},{key:"addMonster",value:function(){var e=this,t=p.createMonster();t.name="new monster";var a=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));a&&(a.monsters.push(t),this.setState({library:this.state.library}))}},{key:"removeMonster",value:function(e){var t=this,a=this.state.library.find((function(e){return e.id===t.state.selectedMonsterGroupID}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1),this.setState({library:this.state.library})}}},{key:"sortMonsters",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));t&&(d.sort(t.monsters),this.setState({library:this.state.library}))}},{key:"moveToGroup",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=a.monsters.indexOf(e);a.monsters.splice(n,1);var r=this.state.library.find((function(e){return e.id===t}));r&&(r.monsters.push(e),d.sort(r.monsters),this.setState({library:this.state.library}))}}},{key:"editMonster",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({modal:{type:"monster",monster:t,showSidebar:!1}})}},{key:"saveMonster",value:function(){var e=this,t=this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}));if(t){var a=t.monsters.find((function(t){return t.id===e.state.modal.monster.id}));if(a){var n=t.monsters.indexOf(a);t.monsters[n]=this.state.modal.monster,this.setState({library:this.state.library,modal:null})}else t.monsters.push(this.state.modal.monster),this.setState({library:this.state.library,modal:null})}}},{key:"toggleShowSidebar",value:function(){this.state.modal.showSidebar=!this.state.modal.showSidebar,this.setState({modal:this.state.modal})}},{key:"openDemographics",value:function(){this.setState({modal:{type:"demographics"}})}},{key:"cloneMonster",value:function(e,t){var a=this.state.library.find((function(t){return t.monsters.includes(e)}));if(a){var n=b.clone(e,t);a.monsters.push(n),d.sort(a.monsters),this.setState({library:this.state.library})}}},{key:"addOpenGameContent",value:function(){var e=this;fetch("./data/monsters.json").then((function(e){return e.json()})).then((function(t){t.forEach((function(t){try{if(t.name){var a=b.createFromJSON(t),n=a.tag||a.category;0===n.indexOf("swarm")&&(n="swarm"),"any race"===n&&(n="npc");var r=e.state.library.find((function(e){return e.name===n}));r||(r={id:d.guid(),name:n,monsters:[]},e.state.library.push(r)),r.monsters.push(a)}}catch(s){console.error(s)}})),d.sort(e.state.library),e.setState({view:"library",library:e.state.library})}))}},{key:"addEncounter",value:function(){var e=p.createEncounter();e.name="new encounter";var t=[].concat(this.state.encounters,[e]);d.sort(t),this.setState({encounters:t,selectedEncounterID:e.id})}},{key:"clearEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));t&&(t.slots=[],t.waves=[],this.setState({encounters:this.state.encounters}))}},{key:"removeEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));if(t){var a=this.state.encounters.indexOf(t);this.state.encounters.splice(a,1),this.setState({encounters:this.state.encounters,selectedEncounterID:null})}}},{key:"buildEncounter",value:function(e,t){var a=this,n=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));n&&(n.slots=[],n.waves=[],y.buildEncounter(n,e,t,this.state.library,(function(e,t){return a.getMonster(e,t)})),this.sortEncounterSlots(n),this.setState({encounters:this.state.encounters}))}},{key:"addEncounterSlot",value:function(e,t){var a=this,n=this.state.library.find((function(t){return t.monsters.includes(e)}));if(n){var r=p.createEncounterSlot();r.monsterGroupName=n.name,r.monsterName=e.name;var s=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));if(s){if(null!==t){var i=s.waves.find((function(e){return e.id===t}));i&&(i.slots.push(r),this.sortEncounterSlots(i))}else s.slots.push(r),this.sortEncounterSlots(s);this.setState({encounters:this.state.encounters})}}}},{key:"removeEncounterSlot",value:function(e,t){var a=this,n=this.state.encounters.find((function(e){return e.id===a.state.selectedEncounterID}));if(n){if(t){var r=n.waves.find((function(e){return e.id===t}));if(r){var s=r.slots.indexOf(e);r.slots.splice(s,1)}}else{var i=n.slots.indexOf(e);n.slots.splice(i,1)}this.setState({encounters:this.state.encounters})}}},{key:"sortEncounterSlots",value:function(e){e.slots.sort((function(e,t){var a=e.monsterName.toLowerCase(),n=t.monsterName.toLowerCase();return a<n?-1:a>n?1:0}))}},{key:"addWaveToEncounter",value:function(){var e=this,t=this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}));if(t){var a=p.createEncounterWave();a.name="wave "+(t.waves.length+2),t.waves.push(a),this.setState({encounters:this.state.encounters})}}},{key:"removeWave",value:function(e){var t=this,a=this.state.encounters.find((function(e){return e.id===t.state.selectedEncounterID}));if(a){var n=a.waves.indexOf(e);a.waves.splice(n,1),this.setState({encounters:this.state.encounters})}}},{key:"addMapFolio",value:function(){var e=p.createMapFolio();e.name="new folio";var t=[].concat(this.state.mapFolios,[e]);d.sort(t),this.setState({mapFolios:t,selectedMapFolioID:e.id})}},{key:"removeMapFolio",value:function(){var e=this,t=this.state.mapFolios.find((function(t){return t.id===e.state.selectedMapFolioID}));if(t){var a=this.state.mapFolios.indexOf(t);this.state.mapFolios.splice(a,1),this.setState({mapFolios:this.state.mapFolios,selectedMapFolioID:null})}}},{key:"addMap",value:function(){var e=this,t=this.state.mapFolios.find((function(t){return t.id===e.state.selectedMapFolioID}));if(t){var a=p.createMap();a.name="new map",t.maps.push(a),this.setState({mapFolios:this.state.mapFolios})}}},{key:"editMap",value:function(e){var t=JSON.parse(JSON.stringify(e));this.setState({modal:{type:"map",map:t}})}},{key:"saveMap",value:function(){var e=this,t=this.state.mapFolios.find((function(t){return t.id===e.state.selectedMapFolioID}));if(t){var a=t.maps.find((function(t){return t.id===e.state.modal.map.id}));if(a){var n=t.maps.indexOf(a);t.maps[n]=this.state.modal.map,this.setState({mapFolios:this.state.mapFolios,modal:null})}}}},{key:"removeMap",value:function(e){var t=this,a=this.state.mapFolios.find((function(e){return e.id===t.state.selectedMapFolioID}));if(a){var n=a.maps.indexOf(e);a.maps.splice(n,1),this.setState({mapFolios:this.state.mapFolios})}}},{key:"createCombat",value:function(){var e=1===this.state.parties.length?this.state.parties[0]:null,t=1===this.state.encounters.length?this.state.encounters[0]:null,a=p.createCombatSetup();a.partyID=e?e.id:null,a.encounterID=t?t.id:null,t&&(a.monsterNames=d.getMonsterNames(t)),this.setState({modal:{type:"combat-start",combatSetup:a}})}},{key:"startCombat",value:function(){var e=this,t=this.state.modal.combatSetup,a=this.state.parties.find((function(e){return e.id===t.partyID})),n=this.state.encounters.find((function(e){return e.id===t.encounterID}));if(a&&n){var r=a.name||"unnamed party",s=n.name||"unnamed encounter",i=p.createCombat();if(i.name=r+" vs "+s,i.encounterID=n.id,a.pcs.filter((function(e){return e.active})).forEach((function(t){e.addPCToCombat(t,i)})),n.slots.forEach((function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName);if(n)for(var r=d.dieRoll(),s=0;s!==a.count;++s){var o=null;if(t.monsterNames){var c=t.monsterNames.find((function(e){return e.id===a.id}));c&&(o=c.names[s])}e.addMonsterToCombat(n,i,o,t.encounterInitMode,r)}else i.issues.push("unknown monster: "+a.monsterName+" in group "+a.monsterGroupName)})),this.sortCombatants(i),t.folioID&&t.mapID){var o=this.state.mapFolios.find((function(e){return e.id===t.folioID}));if(o){var c=o.maps.find((function(e){return e.id===t.mapID}));c&&(i.map=JSON.parse(JSON.stringify(c)))}}this.setState({combats:[].concat(this.state.combats,[i]),selectedCombatID:i.id,modal:null})}}},{key:"addPCToCombat",value:function(e,t){var a=JSON.parse(JSON.stringify(e));a.current=!1,a.pending=!0,a.active=!1,a.defeated=!1,a.displayName=e.name,a.displaySize="medium",a.showOnMap=!0,a.initiative=10,a.hp=null,a.conditions=[],a.tags=[],a.altitude=0,a.aura={radius:0,style:"rounded",color:"#005080"},t.combatants.push(a)}},{key:"addMonsterToCombat",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"individual",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=JSON.parse(JSON.stringify(e));switch(s.id=d.guid(),n){case"group":s.initiative=d.modifierValue(e.abilityScores.dex)+r;break;case"individual":s.initiative=d.modifierValue(e.abilityScores.dex)+d.dieRoll();break;default:s.initiative=10}s.current=!1,s.pending="manual"===n,s.active="manual"!==n,s.defeated=!1,s.displayName=a,s.displaySize=e.size,s.showOnMap=!0,s.hp=s.hpMax,s.conditions=[],s.tags=[],s.altitude=0,s.aura={radius:0,style:"rounded",color:"#005080"},t.combatants.push(s)}},{key:"openWaveModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=this.state.encounters.find((function(e){return e.id===t.encounterID}));if(a){var n=p.createCombatSetup();n.encounterID=t.encounterID,n.monsterNames=d.getMonsterNames(a),this.setState({modal:{type:"combat-wave",combatSetup:n}})}}}},{key:"addToEncounter",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&this.setState({modal:{type:"combat-add-combatants",combatantSlots:[],combat:t}})}},{key:"addCombatantsFromModal",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&(this.state.modal.combatantSlots.forEach((function(a){var n=e.getMonster(a.monsterName,a.monsterGroupName);if(n)for(var r=d.dieRoll(),s=0;s!==a.count;++s){var i=n.name;a.count>1&&(i+=" "+(s+1)),e.addMonsterToCombat(n,t,i,"group",r)}})),this.sortCombatants(t),this.setState({combats:this.state.combats,modal:null}))}},{key:"pauseCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&(t.timestamp=(new Date).toLocaleString(),this.setState({combats:this.state.combats,selectedCombatID:null}))}},{key:"resumeCombat",value:function(e){this.setState({selectedCombatID:e.id})}},{key:"endCombat",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=this.state.combats.indexOf(t);this.state.combats.splice(a,1),this.setState({combats:this.state.combats,selectedCombatID:null})}}},{key:"makeCurrent",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&(n.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(a){if(a.duration)switch(a.duration.type){case"saves":n&&e&&t.id===e.id&&"start"===a.duration.point&&n.notifications.push({id:d.guid(),type:"condition-save",data:a,combatant:e});break;case"combatant":if(n&&e&&a.duration.combatantID===e.id&&"start"===a.duration.point){var r=t.conditions.indexOf(a);t.conditions.splice(r,1),n.notifications.push({id:d.guid(),type:"condition-end",data:a,combatant:e})}break;case"rounds":if(e&&t.id===e.id&&(a.duration.count-=1),0===a.duration.count){var s=t.conditions.indexOf(a);t.conditions.splice(s,1),n&&n.notifications.push({id:d.guid(),type:"condition-end",data:a,combatant:e})}}}))})),e&&"monster"===e.type&&(e.traits.filter((function(e){return e.uses>0&&e.usage.toLowerCase().startsWith("recharge ")})).forEach((function(t){n.notifications.push({id:d.guid(),type:"trait-recharge",data:t,combatant:e})})),e.traits.filter((function(e){return"legendary"===e.type})).forEach((function(e){e.uses=0}))),n.combatants.forEach((function(e){e.current=!1})),e&&(e.current=!0),t&&(n.round+=1),this.setState({combats:this.state.combats}))}},{key:"makeActive",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&(e.pending=!1,e.active=!0,e.defeated=!1,this.sortCombatants(a),this.setState({combats:this.state.combats}))}},{key:"makeDefeated",value:function(e){var t=this;if(e.pending=!1,e.active=!1,e.defeated=!0,"monster"===e.type){var a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(a.map.items=a.map.items.filter((function(t){return t.id!==e.id})))}e.current?this.endTurn(e):this.setState({combats:this.state.combats})}},{key:"addWaveToCombat",value:function(){var e=this,t=this.state.modal.combatSetup,a=this.state.encounters.find((function(e){return e.id===t.encounterID})),n=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t&&a&&n){var r=a.waves.find((function(e){return e.id===t.waveID}));r&&(r.slots.forEach((function(a){var r=e.getMonster(a.monsterName,a.monsterGroupName);if(r)for(var s=parseInt(d.modifier(r.abilityScores.dex),10),i=d.dieRoll(),o=0;o!==a.count;++o){var c=d.dieRoll(),l=JSON.parse(JSON.stringify(r));if(l.id=d.guid(),l.displayName=null,t.monsterNames){var u=t.monsterNames.find((function(e){return e.id===a.id}));u&&(l.displayName=u.names[o])}switch(l.displaySize=r.size,t.encounterInitMode){case"manual":l.initiative=10;break;case"group":l.initiative=s+i;break;case"individual":l.initiative=s+c}l.showOnMap=!0,l.current=!1,l.pending="manual"===e.state.modal.combatSetup.encounterInitMode,l.active="manual"!==e.state.modal.combatSetup.encounterInitMode,l.defeated=!1,l.hp=l.hpMax,l.conditions=[],l.tags=[],l.altitude=0,l.aura={radius:0,style:"rounded",color:"#005080"},n&&n.combatants.push(l)}else if(n){var m="unknown monster: "+a.monsterName+" in group "+a.monsterGroupName;n.issues.push(m)}})),this.sortCombatants(n),this.setState({combats:this.state.combats,modal:null}))}}},{key:"removeCombatant",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=a.combatants.indexOf(e);if(a.combatants.splice(n,1),a.map){var r=a.map.items.find((function(t){return t.id===e.id}));if(r){var s=a.map.items.indexOf(r);a.map.items.splice(s,1)}}this.setState({combats:this.state.combats})}}},{key:"mapAdd",value:function(e,t,a){var n=this,r=p.createMapItem();r.id=e.id,r.type=e.type,r.x=t,r.y=a;var s=1;"monster"===e.type&&(s=d.miniSize(e.size)),r.height=s,r.width=s;var i=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));i&&i.map&&(i.map.items.push(r),this.setState({combats:this.state.combats}))}},{key:"mapMove",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n&&n.map){var r=n.map.items.find((function(t){return t.id===e.id}));if(r){switch(t){case"N":r.y-=1;break;case"NE":r.x+=1,r.y-=1;break;case"E":r.x+=1;break;case"SE":r.x+=1,r.y+=1;break;case"S":r.y+=1;break;case"SW":r.x-=1,r.y+=1;break;case"W":r.x-=1;break;case"NW":r.x-=1,r.y-=1}this.setState({combats:this.state.combats})}}}},{key:"mapRemove",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a&&a.map){var n=a.map.items.find((function(t){return t.id===e.id}));if(n){var r=a.map.items.indexOf(n);a.map.items.splice(r,1),this.setState({combats:this.state.combats})}}}},{key:"endTurn",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){a.combatants.filter((function(e){return e.conditions})).forEach((function(t){t.conditions.forEach((function(n){if(n.duration)switch(n.duration.type){case"saves":if(a&&t.id===e.id&&"end"===n.duration.point){var r=p.createNotification();r.type="condition-save",r.data=n,r.combatant=e,a.notifications.push(r)}break;case"combatant":if(a&&n.duration.combatantID===e.id&&"end"===n.duration.point){var s=t.conditions.indexOf(n);t.conditions.splice(s,1);var i=p.createNotification();i.type="condition-end",i.data=n,i.combatant=e,a.notifications.push(i)}}}))}));var n=a.combatants.filter((function(e){return e.current||!e.pending&&e.active&&!e.defeated}));if(0===n.length)this.makeCurrent(null,!1);else if(1===n.length&&n[0].defeated)this.makeCurrent(null,!1);else{var r=n.indexOf(e)+1,s=!1;r>=n.length&&(r=0,s=!0),this.makeCurrent(n[r],s)}}}},{key:"changeHP",value:function(e,t,a){e.hp=t,e.hpTemp=a,this.setState({combats:this.state.combats})}},{key:"addCondition",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));if(a){var n=p.createCondition();n.name="blinded",this.setState({modal:{type:"condition-add",condition:n,combatant:e,combat:a}})}}},{key:"addConditionFromModal",value:function(){this.state.modal.combatant.conditions.push(this.state.modal.condition),this.setState({combats:this.state.combats,modal:null})}},{key:"editCondition",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));n&&this.setState({modal:{type:"condition-edit",condition:t,combatant:e,combat:n}})}},{key:"editConditionFromModal",value:function(){var e=this,t=this.state.modal.combatant.conditions,a=t.find((function(t){return t.id===e.state.modal.condition.id}));if(a){var n=t.indexOf(a);t[n]=this.state.modal.condition,this.setState({combats:this.state.combats,modal:null})}}},{key:"removeCondition",value:function(e,t){var a=e.conditions.find((function(e){return e.id===t}));if(a){var n=e.conditions.indexOf(a);e.conditions.splice(n,1),this.setState({combats:this.state.combats})}}},{key:"sortCombatants",value:function(e){e.combatants.sort((function(e,t){return e.initiative&&t.initiative&&e.initiative<t.initiative?1:e.initiative&&t.initiative&&e.initiative>t.initiative?-1:e.name<t.name?-1:e.name>t.name?1:0}))}},{key:"closeNotification",value:function(e,t){var a=this,n=this.state.combats.find((function(e){return e.id===a.state.selectedCombatID}));if(n){var r=n.notifications.indexOf(e);if(n.notifications.splice(r,1),t&&e.combatant&&e.data){var s=e.combatant.conditions.indexOf(e.data);e.combatant.conditions.splice(s,1)}this.setState({combats:this.state.combats})}}},{key:"toggleTag",value:function(e,t){e.tags.includes(t)?e.tags=e.tags.filter((function(e){return e!==t})):e.tags.push(t),this.setState({combats:this.state.combats})}},{key:"scatterCombatants",value:function(e){var t=this,a=this.state.combats.find((function(e){return e.id===t.state.selectedCombatID}));a&&a.map&&(g.scatterCombatants(a,e),this.setState({combats:this.state.combats}))}},{key:"rotateMap",value:function(){var e=this,t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));t&&t.map&&(g.rotateMap(t.map),this.setState({combats:this.state.combats}))}},{key:"setView",value:function(e){this.setState({view:e})}},{key:"openToolsSidebar",value:function(){this.setState({modal:{type:"tools-sidebar"}})}},{key:"closeModal",value:function(){this.setState({modal:null})}},{key:"selectParty",value:function(e){this.setState({selectedPartyID:e?e.id:null})}},{key:"selectMonsterGroup",value:function(e){this.setState({selectedMonsterGroupID:e?e.id:null})}},{key:"selectEncounter",value:function(e){this.setState({selectedEncounterID:e?e.id:null})}},{key:"selectMapFolio",value:function(e){this.setState({selectedMapFolioID:e?e.id:null})}},{key:"resetAll",value:function(){this.setState({parties:[],selectedPartyID:null,library:[],selectedMonsterGroupID:null,encounters:[],selectedEncounterID:null,mapFolios:[],selectedMapFolioID:null,combats:[],selectedCombatID:null})}},{key:"getMonster",value:function(e,t){var a=this.state.library.find((function(e){return e.name===t}));if(a){var n=a.monsters.find((function(t){return t.name===e}));if(n)return n}return null}},{key:"changeValue",value:function(e,t,a){var n=this;switch(t){case"hp":a=Math.min(a,e.hpMax),a=Math.max(a,0);break;case"hpTemp":a=Math.max(a,0);break;case"level":a=Math.max(a,1),a=void 0!==e.player?Math.min(a,20):Math.min(a,6);break;case"count":case"hitDice":a=Math.max(a,1)}for(var r=t.split("."),s=e,i=0;i!==r.length;++i){var o=r[i];i===r.length-1?s[o]=a:s=s[o]}if(d.sort(this.state.parties),d.sort(this.state.library),d.sort(this.state.encounters),"initiative"===t&&!e.pending){var c=this.state.combats.find((function(e){return e.id===n.state.selectedCombatID}));this.sortCombatants(c)}this.setState({parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,combats:this.state.combats,selectedPartyID:this.state.selectedPartyID,selectedMonsterGroupID:this.state.selectedMonsterGroupID,selectedEncounterID:this.state.selectedEncounterID,selectedCombatID:this.state.selectedCombatID,modal:this.state.modal})}},{key:"nudgeValue",value:function(e,t,a){for(var n=t.split("."),r=e,s=0;s!==n.length;++s){var i=n[s];if(s===n.length-1){var o=null;switch(i){case"challenge":o=d.nudgeChallenge(r[i],a);break;case"size":case"displaySize":o=d.nudgeSize(r[i],a);break;default:o=r[i]+a}this.changeValue(e,t,o)}else r=r[i]}}},{key:"getActions",value:function(){var e=this;switch(this.state.view){case"parties":case"encounter":case"maps":return r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"section"},r.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));case"library":return r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"section"},r.a.createElement("button",{onClick:function(){return e.openDemographics()}},"demographics")),r.a.createElement("div",{className:"section"},r.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})));case"combat":var t=this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}));if(t){var a=0;return this.state.encounters.find((function(e){return e.id===t.encounterID}))&&t.combatants.filter((function(e){return"monster"===e.type})).forEach((function(e){a+=d.experience(e.challenge)})),r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"text"},"round: ",t.round)),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"text"},"xp: ",a)))}return r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"section"},r.a.createElement("input",{type:"text",placeholder:"search",value:this.state.filter,onChange:function(t){return e.changeValue(e.state,"filter",t.target.value)}})))}return null}},{key:"getContent",value:function(){var e=this;switch(this.state.view){case"home":return r.a.createElement(mt,{library:this.state.library,addOpenGameContent:function(){return e.addOpenGameContent()}});case"parties":return r.a.createElement(Nt,{parties:this.state.parties,selection:this.state.parties.find((function(t){return t.id===e.state.selectedPartyID}))||null,filter:this.state.filter,selectParty:function(t){return e.selectParty(t)},addParty:function(){return e.addParty()},removeParty:function(){return e.removeParty()},addPC:function(){return e.addPC()},editPC:function(t){return e.editPC(t)},removePC:function(t){return e.removePC(t)},sortPCs:function(){return e.sortPCs()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)}});case"library":return r.a.createElement(gt,{library:this.state.library,selection:this.state.library.find((function(t){return t.id===e.state.selectedMonsterGroupID}))||null,filter:this.state.filter,selectMonsterGroup:function(t){return e.selectMonsterGroup(t)},addMonsterGroup:function(){return e.addMonsterGroup()},removeMonsterGroup:function(){return e.removeMonsterGroup()},addMonster:function(){return e.addMonster()},removeMonster:function(t){return e.removeMonster(t)},sortMonsters:function(){return e.sortMonsters()},changeValue:function(t,a,n){return e.changeValue(t,a,n)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},editMonster:function(t){return e.editMonster(t)},cloneMonster:function(t,a){return e.cloneMonster(t,a)},moveToGroup:function(t,a){return e.moveToGroup(t,a)}});case"encounter":return r.a.createElement(ot,{encounters:this.state.encounters,selection:this.state.encounters.find((function(t){return t.id===e.state.selectedEncounterID}))||null,filter:this.state.filter,parties:this.state.parties,library:this.state.library,selectEncounter:function(t){return e.selectEncounter(t)},addEncounter:function(){return e.addEncounter()},clearEncounter:function(){return e.clearEncounter()},removeEncounter:function(){return e.removeEncounter()},buildEncounter:function(t,a){return e.buildEncounter(t,a)},addWave:function(){return e.addWaveToEncounter()},removeWave:function(t){return e.removeWave(t)},getMonster:function(t,a){return e.getMonster(t,a)},addEncounterSlot:function(t,a){return e.addEncounterSlot(t,a)},removeEncounterSlot:function(t,a){return e.removeEncounterSlot(t,a)},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}});case"maps":return r.a.createElement(ht,{mapFolios:this.state.mapFolios,selection:this.state.mapFolios.find((function(t){return t.id===e.state.selectedMapFolioID}))||null,filter:this.state.filter,selectMapFolio:function(t){return e.selectMapFolio(t)},addMapFolio:function(){return e.addMapFolio()},removeMapFolio:function(){return e.removeMapFolio()},addMap:function(){return e.addMap()},editMap:function(t){return e.editMap(t)},removeMap:function(t){return e.removeMap(t)},changeValue:function(t,a,n){return e.changeValue(t,a,n)}});case"combat":return r.a.createElement(et,{combats:this.state.combats,encounters:this.state.encounters,combat:this.state.combats.find((function(t){return t.id===e.state.selectedCombatID}))||null,filter:this.state.filter,createCombat:function(){return e.createCombat()},pauseCombat:function(){return e.pauseCombat()},resumeCombat:function(t){return e.resumeCombat(t)},endCombat:function(){return e.endCombat()},nudgeValue:function(t,a,n){return e.nudgeValue(t,a,n)},changeValue:function(t,a,n){return e.changeValue(t,a,n)},makeCurrent:function(t){return e.makeCurrent(t,!1)},makeActive:function(t){return e.makeActive(t)},makeDefeated:function(t){return e.makeDefeated(t)},removeCombatant:function(t){return e.removeCombatant(t)},addCombatants:function(){return e.addToEncounter()},addWave:function(){return e.openWaveModal()},addCondition:function(t){return e.addCondition(t)},editCondition:function(t,a){return e.editCondition(t,a)},removeCondition:function(t,a){return e.removeCondition(t,a)},mapAdd:function(t,a,n){return e.mapAdd(t,a,n)},mapMove:function(t,a){return e.mapMove(t,a)},mapRemove:function(t){return e.mapRemove(t)},endTurn:function(t){return e.endTurn(t)},changeHP:function(t,a,n){return e.changeHP(t,a,n)},closeNotification:function(t,a){return e.closeNotification(t,a)},toggleTag:function(t,a){return e.toggleTag(t,a)},scatterCombatants:function(t){return e.scatterCombatants(t)},rotateMap:function(){return e.rotateMap()}})}return null}},{key:"getModal",value:function(){var e=this;if(this.state.modal){var t=!1,a=null,n=null,s=!0,i={left:[],right:[r.a.createElement("button",{key:"close",onClick:function(){return e.closeModal()}},"close")]};switch(this.state.modal.type){case"tools-sidebar":t=!0,n=r.a.createElement(Xe,{resetAll:function(){return e.resetAll()}}),i.right=[];break;case"demographics":t=!0,n=r.a.createElement(fe,{library:this.state.library}),i.right=[];break;case"pc":a="pc editor",n=r.a.createElement(ke,{pc:this.state.modal.pc}),i.right=[r.a.createElement("button",{key:"save",onClick:function(){return e.savePC()}},"save"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"monster":a="monster editor",n=r.a.createElement(Ee,{monster:this.state.modal.monster,library:this.state.library,showSidebar:this.state.modal.showSidebar}),s=!1,i.left=[r.a.createElement(E,{key:"sidebar",label:"advanced tools",checked:this.state.modal.showSidebar,changeValue:function(){return e.toggleShowSidebar()}})],i.right=[r.a.createElement("button",{key:"save",onClick:function(){return e.saveMonster()}},"save"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"map":a="map editor",n=r.a.createElement(ye,{map:this.state.modal.map}),s=!1,i.right=[r.a.createElement("button",{key:"save",onClick:function(){return e.saveMap()}},"save"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"combat-start":a="start a new encounter",n=r.a.createElement(ue,{combatSetup:this.state.modal.combatSetup,parties:this.state.parties,encounters:this.state.encounters,mapFolios:this.state.mapFolios,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({modal:e.state.modal})}}),s=!1,i.right=[r.a.createElement("button",{key:"start encounter",className:this.state.modal.combatSetup.partyID&&this.state.modal.combatSetup.encounterID?"":"disabled",onClick:function(){return e.startCombat()}},"start encounter"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"combat-wave":a="encounter waves",n=r.a.createElement(ue,{combatSetup:this.state.modal.combatSetup,encounters:this.state.encounters,getMonster:function(t,a){return e.getMonster(t,a)},notify:function(){return e.setState({modal:e.state.modal})}}),s=!1,i.right=[r.a.createElement("button",{key:"add wave",className:null!==this.state.modal.combatSetup.waveID?"":"disabled",onClick:function(){return e.addWaveToCombat()}},"add wave"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"combat-add-combatants":a="add combatants",n=r.a.createElement(ne,{combatantSlots:this.state.modal.combatantSlots,library:this.state.library}),s=!1,i.right=[r.a.createElement("button",{key:"add combatants",onClick:function(){return e.addCombatantsFromModal()}},"add combatants"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"condition-add":a="add a condition",n=r.a.createElement(ve,{condition:this.state.modal.condition,combatant:this.state.modal.combatant,combat:this.state.modal.combat}),s=!1,i.right=[r.a.createElement("button",{key:"add",onClick:function(){return e.addConditionFromModal()}},"add"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")];break;case"condition-edit":a="edit condition",n=r.a.createElement(ve,{condition:this.state.modal.condition,combatant:this.state.modal.combatant,combat:this.state.modal.combat}),i.right=[r.a.createElement("button",{key:"save",onClick:function(){return e.editConditionFromModal()}},"save"),r.a.createElement("button",{key:"cancel",onClick:function(){return e.closeModal()}},"cancel")]}return r.a.createElement("div",{className:"overlay",onClick:function(){return t?e.closeModal():null}},r.a.createElement("div",{className:t?"modal sidebar":"modal",onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"modal-header"},r.a.createElement("div",{className:"title"},a),t?r.a.createElement("img",{className:"image",src:j.a,alt:"close",onClick:function(){return e.closeModal()}}):null),r.a.createElement("div",{className:s?"modal-content scrollable":"modal-content"},n),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("div",{className:"left"},i.left),r.a.createElement("div",{className:"right"},i.right))))}return null}},{key:"render",value:function(){var e=this;try{var t=this.getContent(),a=this.getActions(),n=this.getModal();return r.a.createElement("div",{className:"dojo"},r.a.createElement(Be,{actions:a,blur:null!==n,openHome:function(){return e.setView("home")},openTools:function(){return e.openToolsSidebar()}}),r.a.createElement("div",{className:null===n?"page-content":"page-content blur"},t),r.a.createElement(Je,{view:this.state.view,parties:this.state.parties,library:this.state.library,encounters:this.state.encounters,blur:null!==n,setView:function(t){return e.setView(t)}}),n)}catch(s){return console.error(s),r.a.createElement("div",{className:"render-error"})}}}]),t}(r.a.Component);i.a.render(r.a.createElement(wt,null),document.getElementById("root"))}],[[19,1,2]]]);